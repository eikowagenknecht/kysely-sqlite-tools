var yd=Object.defineProperty;var gd=(Te,we,He)=>we in Te?yd(Te,we,{enumerable:!0,configurable:!0,writable:!0,value:He}):Te[we]=He;var Oe=(Te,we,He)=>(gd(Te,typeof we!="symbol"?we+"":we,He),He),bo=(Te,we,He)=>{if(!we.has(Te))throw TypeError("Cannot "+He)};var o=(Te,we,He)=>(bo(Te,we,"read from private field"),He?He.call(Te):we.get(Te)),D=(Te,we,He)=>{if(we.has(Te))throw TypeError("Cannot add the same private member more than once");we instanceof WeakSet?we.add(Te):we.set(Te,He)},G=(Te,we,He,Tr)=>(bo(Te,we,"write to private field"),Tr?Tr.call(Te,He):we.set(Te,He),He);var Ae=(Te,we,He)=>(bo(Te,we,"access private method"),He);(function(){var Bt,Wn,or,Le,Yr,Ut,_e,ae,ce,ar,ls,lr,Fn,Ln,us,Ga,cs,$a,ds,Ha,Dn,vi,ei,qo,fs,Ka,ti,De,ni,ur,cr,Mn,ri,No,U,dr,fr,qn,hr,Nn,Bn,Un,St,_r,mr,yr,gr,Ht,wr,vn,ii,vo,br,qr,xn,Pe,Qn,an,si,Qt,ht,Ye,Me,$e,We,kt,Se,at,mt,yt,ws,Qe,lt,Ot,At,it,Nr,Xt,Yt,ln,jt,Sn,un,Vn,ci,bs,Xa,qs,Ya,Ns,Za,vs,el,di,xo,fi,kn,xs,tl,On,Jn,ut,zt,Gn,Vt,vt,Er,Ps,hi,Eo,pi,So,Sr,An,Ss,kr,$n,Or,ks,nl,_i,xa,mi,Ea;"use strict";function Te(t){return typeof t>"u"||t===void 0}function we(t){return typeof t=="string"}function He(t){return typeof t=="number"}function Tr(t){return typeof t=="boolean"}function ko(t){return t===null}function rl(t){return t instanceof Date}function il(t){return typeof t=="bigint"}function Tt(t){return typeof t=="function"}function Jt(t){return typeof t=="object"&&t!==null}function h(t){return Object.freeze(t)}function Cr(t){return Array.isArray(t)}function Yn(t){return t}const Ke=h({is(t){return t.kind==="AlterTableNode"},create(t){return h({kind:"AlterTableNode",table:t})},cloneWithTableProps(t,e){return h({...t,...e})},cloneWithColumnAlteration(t,e){return h({...t,columnAlterations:t.columnAlterations?[...t.columnAlterations,e]:[e]})}}),Ue=h({is(t){return t.kind==="IdentifierNode"},create(t){return h({kind:"IdentifierNode",name:t})}}),hn=h({is(t){return t.kind==="CreateIndexNode"},create(t){return h({kind:"CreateIndexNode",name:Ue.create(t)})},cloneWith(t,e){return h({...t,...e})},cloneWithColumns(t,e){return h({...t,columns:[...t.columns||[],...e]})}}),Oo=h({is(t){return t.kind==="CreateSchemaNode"},create(t,e){return h({kind:"CreateSchemaNode",schema:Ue.create(t),...e})},cloneWith(t,e){return h({...t,...e})}}),sl=["preserve rows","delete rows","drop"],Dt=h({is(t){return t.kind==="CreateTableNode"},create(t){return h({kind:"CreateTableNode",table:t,columns:h([])})},cloneWithColumn(t,e){return h({...t,columns:h([...t.columns,e])})},cloneWithConstraint(t,e){return h({...t,constraints:t.constraints?h([...t.constraints,e]):h([e])})},cloneWithFrontModifier(t,e){return h({...t,frontModifiers:t.frontModifiers?h([...t.frontModifiers,e]):h([e])})},cloneWithEndModifier(t,e){return h({...t,endModifiers:t.endModifiers?h([...t.endModifiers,e]):h([e])})},cloneWith(t,e){return h({...t,...e})}}),pn=h({is(t){return t.kind==="SchemableIdentifierNode"},create(t){return h({kind:"SchemableIdentifierNode",identifier:Ue.create(t)})},createWithSchema(t,e){return h({kind:"SchemableIdentifierNode",schema:Ue.create(t),identifier:Ue.create(e)})}}),xi=h({is(t){return t.kind==="DropIndexNode"},create(t,e){return h({kind:"DropIndexNode",name:pn.create(t),...e})},cloneWith(t,e){return h({...t,...e})}}),Ws=h({is(t){return t.kind==="DropSchemaNode"},create(t,e){return h({kind:"DropSchemaNode",schema:Ue.create(t),...e})},cloneWith(t,e){return h({...t,...e})}}),Fs=h({is(t){return t.kind==="DropTableNode"},create(t,e){return h({kind:"DropTableNode",table:t,...e})},cloneWith(t,e){return h({...t,...e})}}),_n=h({is(t){return t.kind==="AliasNode"},create(t,e){return h({kind:"AliasNode",node:t,alias:e})}}),mn=h({is(t){return t.kind==="TableNode"},create(t){return h({kind:"TableNode",table:pn.create(t)})},createWithSchema(t,e){return h({kind:"TableNode",table:pn.createWithSchema(t,e)})}});function Ct(t){return Jt(t)&&Tt(t.toOperationNode)}function Ls(t){return Jt(t)&&"expressionType"in t&&Ct(t)}function ol(t){return Jt(t)&&"expression"in t&&we(t.alias)&&Ct(t)}const tn=h({is(t){return t.kind==="SelectModifierNode"},create(t){return h({kind:"SelectModifierNode",modifier:t})},createWithExpression(t){return h({kind:"SelectModifierNode",rawModifier:t})}}),Tn=h({is(t){return t.kind==="AndNode"},create(t,e){return h({kind:"AndNode",left:t,right:e})}}),Cn=h({is(t){return t.kind==="OrNode"},create(t,e){return h({kind:"OrNode",left:t,right:e})}}),Ds=h({is(t){return t.kind==="OnNode"},create(t){return h({kind:"OnNode",on:t})},cloneWithOperation(t,e,r){return h({...t,on:e==="And"?Tn.create(t.on,r):Cn.create(t.on,r)})}}),Pr=h({is(t){return t.kind==="JoinNode"},create(t,e){return h({kind:"JoinNode",joinType:t,table:e,on:void 0})},createWithOn(t,e,r){return h({kind:"JoinNode",joinType:t,table:e,on:Ds.create(r)})},cloneWithOn(t,e){return h({...t,on:t.on?Ds.cloneWithOperation(t.on,"And",e):Ds.create(e)})}}),Rs=h({is(t){return t.kind==="BinaryOperationNode"},create(t,e,r){return h({kind:"BinaryOperationNode",leftOperand:t,operator:e,rightOperand:r})}}),Ao=["=","==","!=","<>",">",">=","<","<=","in","not in","is","is not","like","not like","match","ilike","not ilike","@>","<@","?","?&","!<","!>","<=>","!~","~","~*","!~*","@@","@@@","!!","<->","regexp"],al=["+","-","*","/","%","^","&","|","#","<<",">>"],Io=["->","->>"],To=[...Ao,...al,"&&","||"],ll=["not","-",...["exists","not exists"]],ul=[...To,...Io,...ll],Wr=h({is(t){return t.kind==="OperatorNode"},create(t){return h({kind:"OperatorNode",operator:t})}});function cl(t){return we(t)&&To.includes(t)}function dl(t){return we(t)&&Ao.includes(t)}function Co(t){return we(t)&&Io.includes(t)}const Ve=h({is(t){return t.kind==="ColumnNode"},create(t){return h({kind:"ColumnNode",column:Ue.create(t)})}}),Ms=h({is(t){return t.kind==="SelectAllNode"},create(){return h({kind:"SelectAllNode"})}}),Ei=h({is(t){return t.kind==="ReferenceNode"},create(t,e){return h({kind:"ReferenceNode",table:e,column:t})},createSelectAll(t){return h({kind:"ReferenceNode",table:t,column:Ms.create()})}}),fl=h({is(t){return t.kind==="OrderByItemNode"},create(t,e){return h({kind:"OrderByItemNode",orderBy:t,direction:e})}}),pt=h({is(t){return t.kind==="RawNode"},create(t,e){return h({kind:"RawNode",sqlFragments:h(t),parameters:h(e)})},createWithSql(t){return pt.create([t],[])},createWithChild(t){return pt.create(["",""],[t])},createWithChildren(t){return pt.create(new Array(t.length+1).fill(""),t)}});function hl(t){return t==="asc"||t==="desc"}function Si(t,e){return fl.create(pl(t),_l(e))}function pl(t){return nn(t)}function _l(t){if(t)return t==="asc"||t==="desc"?pt.createWithSql(t):t.toOperationNode()}const Bs=h({is(t){return t.kind==="JSONReferenceNode"},create(t,e){return h({kind:"JSONReferenceNode",reference:t,traversal:e})},cloneWithTraversal(t,e){return h({...t,traversal:e})}}),Po=h({is(t){return t.kind==="JSONOperatorChainNode"},create(t){return h({kind:"JSONOperatorChainNode",operator:t,values:h([])})},cloneWithValue(t,e){return h({...t,values:h([...t.values,e])})}}),Us=h({is(t){return t.kind==="JSONPathNode"},create(t){return h({kind:"JSONPathNode",inOperator:t,pathLegs:h([])})},cloneWithLeg(t,e){return h({...t,pathLegs:h([...t.pathLegs,e])})}});function Wo(t){return we(t)?Pn(t):t.toOperationNode()}function Fr(t){return Cr(t)?t.map(e=>nn(e)):[nn(t)]}function nn(t){return Ui(t)?Bi(t):Wo(t)}function ml(t,e){const r=Pn(t);if(Co(e))return Bs.create(r,Po.create(Wr.create(e)));const n=e.slice(0,-1);if(Co(n))return Bs.create(r,Us.create(Wr.create(n)));throw new Error(`Invalid JSON operator: ${e}`)}function Pn(t){const e=".";if(!t.includes(e))return Ei.create(Ve.create(t));const r=t.split(e).map(Qs);if(r.length===3)return gl(r);if(r.length===2)return wl(r);throw new Error(`invalid column reference ${t}`)}function yl(t){const e=" as ";if(t.includes(e)){const[r,n]=t.split(e).map(Qs);return _n.create(Pn(r),Ue.create(n))}else return Pn(t)}function Fo(t){return Ve.create(t)}function Lo(t){const e=" ";if(t.includes(e)){const[r,n]=t.split(e).map(Qs);if(!hl(n))throw new Error(`invalid order direction "${n}" next to "${r}"`);return Si(r,n)}else return Fo(t)}function gl(t){const[e,r,n]=t;return Ei.create(Ve.create(n),mn.createWithSchema(e,r))}function wl(t){const[e,r]=t;return Ei.create(Ve.create(r),mn.create(e))}function Qs(t){return t.trim()}const Do=h({is(t){return t.kind==="PrimitiveValueListNode"},create(t){return h({kind:"PrimitiveValueListNode",values:h([...t])})}}),js=h({is(t){return t.kind==="ValueListNode"},create(t){return h({kind:"ValueListNode",values:h(t)})}}),Rt=h({is(t){return t.kind==="ValueNode"},create(t){return h({kind:"ValueNode",value:t})},createImmediate(t){return h({kind:"ValueNode",value:t,immediate:!0})}});function Ro(t){return Cr(t)?bl(t):rn(t)}function rn(t){return Ui(t)?Bi(t):Rt.create(t)}function bl(t){return t.some(Ui)?js.create(t.map(e=>rn(e))):Do.create(t)}function _t(t){if(t.length>1&&!Uo(t[1]))throw new Error(`invalid comparison operator ${JSON.stringify(t[1])}`);return Mo(t)}function Mo(t){if(t.length===3)return ki(t[0],t[1],t[2]);if(t.length===1)return El(t[0]);throw new Error(`invalid arguments: ${JSON.stringify(t)}`)}function ki(t,e,r){if(!Bo(e))throw new Error(`invalid binary operator ${JSON.stringify(e)}`);return Nl(e)&&vl(r)?xl(t,e,r):Rs.create(nn(t),zs(e),Ro(r))}function sn(t,e,r){if(!Uo(e))throw new Error(`invalid comparison operator ${JSON.stringify(e)}`);return ql(t,e,r)}function ql(t,e,r){if(!Bo(e))throw new Error(`invalid binary operator ${JSON.stringify(e)}`);return Rs.create(nn(t),zs(e),nn(r))}function Bo(t){return cl(t)||Ls(t)}function Uo(t){return dl(t)||Ls(t)}function Nl(t){return t==="is"||t==="is not"}function vl(t){return ko(t)||Tr(t)}function xl(t,e,r){return Rs.create(nn(t),zs(e),Rt.createImmediate(r))}function zs(t){if(we(t)&&ul.includes(t))return Wr.create(t);if(Ct(t))return t.toOperationNode();throw new Error(`invalid operator ${JSON.stringify(t)}`)}function El(t){return Tt(t)?t(eo()).toOperationNode():Ct(t)?t.toOperationNode():Rt.create(t)}const Zn=h({is(t){return t.kind==="OrderByNode"},create(t){return h({kind:"OrderByNode",items:h([t])})},cloneWithItem(t,e){return h({...t,items:h([...t.items,e])})}}),Qo=h({is(t){return t.kind==="PartitionByNode"},create(t){return h({kind:"PartitionByNode",items:h(t)})},cloneWithItems(t,e){return h({...t,items:h([...t.items,...e])})}}),Vs=h({is(t){return t.kind==="OverNode"},create(){return h({kind:"OverNode"})},cloneWithOrderByItem(t,e){return h({...t,orderBy:t.orderBy?Zn.cloneWithItem(t.orderBy,e):Zn.create(e)})},cloneWithPartitionByItems(t,e){return h({...t,partitionBy:t.partitionBy?Qo.cloneWithItems(t.partitionBy,e):Qo.create(e)})}}),Oi=h({is(t){return t.kind==="FromNode"},create(t){return h({kind:"FromNode",froms:h(t)})},cloneWithFroms(t,e){return h({...t,froms:h([...t.froms,...e])})}}),jo=h({is(t){return t.kind==="GroupByNode"},create(t){return h({kind:"GroupByNode",items:h(t)})},cloneWithItems(t,e){return h({...t,items:h([...t.items,...e])})}}),zo=h({is(t){return t.kind==="HavingNode"},create(t){return h({kind:"HavingNode",having:t})},cloneWithOperation(t,e,r){return h({...t,having:e==="And"?Tn.create(t.having,r):Cn.create(t.having,r)})}}),xe=h({is(t){return t.kind==="SelectQueryNode"},create(t,e){return h({kind:"SelectQueryNode",from:Oi.create(t),...e&&{with:e}})},cloneWithSelections(t,e){return h({...t,selections:t.selections?h([...t.selections,...e]):h(e)})},cloneWithDistinctOn(t,e){return h({...t,distinctOn:t.distinctOn?h([...t.distinctOn,...e]):h(e)})},cloneWithFrontModifier(t,e){return h({...t,frontModifiers:t.frontModifiers?h([...t.frontModifiers,e]):h([e])})},cloneWithEndModifier(t,e){return h({...t,endModifiers:t.endModifiers?h([...t.endModifiers,e]):h([e])})},cloneWithOrderByItem(t,e){return h({...t,orderBy:t.orderBy?Zn.cloneWithItem(t.orderBy,e):Zn.create(e)})},cloneWithGroupByItems(t,e){return h({...t,groupBy:t.groupBy?jo.cloneWithItems(t.groupBy,e):jo.create(e)})},cloneWithLimit(t,e){return h({...t,limit:e})},cloneWithOffset(t,e){return h({...t,offset:e})},cloneWithHaving(t,e){return h({...t,having:t.having?zo.cloneWithOperation(t.having,"And",e):zo.create(e)})},cloneWithSetOperation(t,e){return h({...t,setOperations:t.setOperations?h([...t.setOperations,e]):h([e])})},cloneWithoutSelections(t){return h({...t,selections:[]})},cloneWithoutLimit(t){return h({...t,limit:void 0})},cloneWithoutOffset(t){return h({...t,offset:void 0})},cloneWithoutOrderBy(t){return h({...t,orderBy:void 0})}});function Ee(t,e){Object.defineProperties(t.prototype,{then:{enumerable:!1,value:()=>{throw new Error(e)}}})}const Xr=class Xr{constructor(e){D(this,Bt,void 0);G(this,Bt,h(e))}on(...e){return new Xr({...o(this,Bt),joinNode:Pr.cloneWithOn(o(this,Bt).joinNode,_t(e))})}onRef(e,r,n){return new Xr({...o(this,Bt),joinNode:Pr.cloneWithOn(o(this,Bt).joinNode,sn(e,r,n))})}onTrue(){return new Xr({...o(this,Bt),joinNode:Pr.cloneWithOn(o(this,Bt).joinNode,pt.createWithSql("true"))})}$call(e){return e(this)}toOperationNode(){return o(this,Bt).joinNode}};Bt=new WeakMap;let Ai=Xr;Ee(Ai,"don't await JoinBuilder instances. They are never executed directly and are always just a part of a query.");const Sl=h({is(t){return t.kind==="PartitionByItemNode"},create(t){return h({kind:"PartitionByItemNode",partitionBy:t})}});function kl(t){return Fr(t).map(Sl.create)}const as=class as{constructor(e){D(this,Wn,void 0);G(this,Wn,h(e))}orderBy(e,r){return new as({overNode:Vs.cloneWithOrderByItem(o(this,Wn).overNode,Si(e,r))})}partitionBy(e){return new as({overNode:Vs.cloneWithPartitionByItems(o(this,Wn).overNode,kl(e))})}$call(e){return e(this)}toOperationNode(){return o(this,Wn).overNode}};Wn=new WeakMap;let Ii=as;Ee(Ii,"don't await OverBuilder instances. They are never executed directly and are always just a part of a query.");const Lr=h({is(t){return t.kind==="SelectionNode"},create(t){return h({kind:"SelectionNode",selection:t})},createSelectAll(){return h({kind:"SelectionNode",selection:Ms.create()})},createSelectAllFromTable(t){return h({kind:"SelectionNode",selection:Ei.createSelectAll(t)})}});class Ol{constructor(e){D(this,or,void 0);G(this,or,e)}get dynamicReference(){return o(this,or)}get refType(){}toOperationNode(){return Wo(o(this,or))}}or=new WeakMap;function Al(t){return Jt(t)&&Ct(t)&&we(t.dynamicReference)}function Dr(t){return Tt(t)?Dr(t(ir())):Cr(t)?t.map(e=>Vo(e)):[Vo(t)]}function Vo(t){return we(t)?Lr.create(yl(t)):Al(t)?Lr.create(t.toOperationNode()):Lr.create(aa(t))}function Rr(t){return t?Array.isArray(t)?t.map(Jo):[Jo(t)]:[Lr.createSelectAll()]}function Jo(t){if(we(t))return Lr.createSelectAllFromTable(Nt(t));throw new Error(`invalid value selectAll expression: ${JSON.stringify(t)}`)}const Il=h({is(t){return t.kind==="ValuesNode"},create(t){return h({kind:"ValuesNode",values:h(t)})}}),Tl=h({is(t){return t.kind==="DefaultInsertValueNode"},create(){return h({kind:"DefaultInsertValueNode"})}});function Cl(t){const e=Tt(t)?t(ir()):t,r=Cr(e)?e:h([e]);return Pl(r)}function Pl(t){const e=Wl(t);return[h([...e.keys()].map(Ve.create)),Il.create(t.map(r=>Fl(r,e)))]}function Wl(t){const e=new Map;for(const r of t){const n=Object.keys(r);for(const A of n)!e.has(A)&&r[A]!==void 0&&e.set(A,e.size)}return e}function Fl(t,e){const r=Object.keys(t),n=Array.from({length:e.size});let A=!1;for(const Y of r){const pe=e.get(Y);if(Te(pe))continue;const Ie=t[Y];(Te(Ie)||Ui(Ie))&&(A=!0),n[pe]=Ie}if(r.length<e.size||A){const Y=Tl.create();return js.create(n.map(pe=>Te(pe)?Y:rn(pe)))}return Do.create(n)}const Gt=h({is(t){return t.kind==="InsertQueryNode"},create(t,e,r){return h({kind:"InsertQueryNode",into:t,...e&&{with:e},replace:r})},cloneWith(t,e){return h({...t,...e})}}),Ti=h({is(t){return t.kind==="UpdateQueryNode"},create(t,e){return h({kind:"UpdateQueryNode",table:t,...e&&{with:e}})},cloneWithFromItems(t,e){return h({...t,from:t.from?Oi.cloneWithFroms(t.from,e):Oi.create(e)})},cloneWithUpdates(t,e){return h({...t,updates:t.updates?h([...t.updates,...e]):e})}}),Go=h({is(t){return t.kind==="UsingNode"},create(t){return h({kind:"UsingNode",tables:h(t)})},cloneWithTables(t,e){return h({...t,tables:h([...t.tables,...e])})}}),Mr=h({is(t){return t.kind==="DeleteQueryNode"},create(t,e){return h({kind:"DeleteQueryNode",from:Oi.create(t),...e&&{with:e}})},cloneWithOrderByItem(t,e){return h({...t,orderBy:t.orderBy?Zn.cloneWithItem(t.orderBy,e):Zn.create(e)})},cloneWithLimit(t,e){return h({...t,limit:e})},cloneWithUsing(t,e){return h({...t,using:t.using!==void 0?Go.cloneWithTables(t.using,e):Go.create(e)})}}),bt=h({is(t){return t.kind==="WhereNode"},create(t){return h({kind:"WhereNode",where:t})},cloneWithOperation(t,e,r){return h({...t,where:e==="And"?Tn.create(t.where,r):Cn.create(t.where,r)})}}),$o=h({is(t){return t.kind==="ReturningNode"},create(t){return h({kind:"ReturningNode",selections:h(t)})},cloneWithSelections(t,e){return h({...t,selections:t.selections?h([...t.selections,...e]):h(e)})}}),Ll=h({is(t){return t.kind==="ExplainNode"},create(t,e){return h({kind:"ExplainNode",format:t,options:e})}}),ye=h({is(t){return xe.is(t)||Gt.is(t)||Ti.is(t)||Mr.is(t)},cloneWithWhere(t,e){return h({...t,where:t.where?bt.cloneWithOperation(t.where,"And",e):bt.create(e)})},cloneWithJoin(t,e){return h({...t,joins:t.joins?h([...t.joins,e]):h([e])})},cloneWithReturning(t,e){return h({...t,returning:t.returning?$o.cloneWithSelections(t.returning,e):$o.create(e)})},cloneWithoutWhere(t){return h({...t,where:void 0})},cloneWithExplain(t,e,r){return h({...t,explain:Ll.create(e,r==null?void 0:r.toOperationNode())})}}),Dl=h({is(t){return t.kind==="ColumnUpdateNode"},create(t,e){return h({kind:"ColumnUpdateNode",column:t,value:e})}});function Js(t){const e=Tt(t)?t(ir()):t;return Object.entries(e).filter(([r,n])=>n!==void 0).map(([r,n])=>Dl.create(Ve.create(r),rn(n)))}const Rl=h({is(t){return t.kind==="OnDuplicateKeyNode"},create(t){return h({kind:"OnDuplicateKeyNode",updates:t})}});class Ml{constructor(e,r){Oe(this,"insertId");Oe(this,"numInsertedOrUpdatedRows");this.insertId=e,this.numInsertedOrUpdatedRows=r}}class Ci extends Error{constructor(r){super("no result");Oe(this,"node");this.node=r}}function Pi(t){return Object.prototype.hasOwnProperty.call(t,"prototype")}const xt=h({is(t){return t.kind==="OnConflictNode"},create(){return h({kind:"OnConflictNode"})},cloneWith(t,e){return h({...t,...e})},cloneWithIndexWhere(t,e){return h({...t,indexWhere:t.indexWhere?bt.cloneWithOperation(t.indexWhere,"And",e):bt.create(e)})},cloneWithIndexOrWhere(t,e){return h({...t,indexWhere:t.indexWhere?bt.cloneWithOperation(t.indexWhere,"Or",e):bt.create(e)})},cloneWithUpdateWhere(t,e){return h({...t,updateWhere:t.updateWhere?bt.cloneWithOperation(t.updateWhere,"And",e):bt.create(e)})},cloneWithUpdateOrWhere(t,e){return h({...t,updateWhere:t.updateWhere?bt.cloneWithOperation(t.updateWhere,"Or",e):bt.create(e)})},cloneWithoutIndexWhere(t){return h({...t,indexWhere:void 0})},cloneWithoutUpdateWhere(t){return h({...t,updateWhere:void 0})}}),on=class on{constructor(e){D(this,Le,void 0);G(this,Le,h(e))}column(e){const r=Ve.create(e);return new on({...o(this,Le),onConflictNode:xt.cloneWith(o(this,Le).onConflictNode,{columns:o(this,Le).onConflictNode.columns?h([...o(this,Le).onConflictNode.columns,r]):h([r])})})}columns(e){const r=e.map(Ve.create);return new on({...o(this,Le),onConflictNode:xt.cloneWith(o(this,Le).onConflictNode,{columns:o(this,Le).onConflictNode.columns?h([...o(this,Le).onConflictNode.columns,...r]):h(r)})})}constraint(e){return new on({...o(this,Le),onConflictNode:xt.cloneWith(o(this,Le).onConflictNode,{constraint:Ue.create(e)})})}expression(e){return new on({...o(this,Le),onConflictNode:xt.cloneWith(o(this,Le).onConflictNode,{indexExpression:e.toOperationNode()})})}where(...e){return new on({...o(this,Le),onConflictNode:xt.cloneWithIndexWhere(o(this,Le).onConflictNode,_t(e))})}whereRef(e,r,n){return new on({...o(this,Le),onConflictNode:xt.cloneWithIndexWhere(o(this,Le).onConflictNode,sn(e,r,n))})}clearWhere(){return new on({...o(this,Le),onConflictNode:xt.cloneWithoutIndexWhere(o(this,Le).onConflictNode)})}doNothing(){return new Ho({...o(this,Le),onConflictNode:xt.cloneWith(o(this,Le).onConflictNode,{doNothing:!0})})}doUpdateSet(e){return new Fi({...o(this,Le),onConflictNode:xt.cloneWith(o(this,Le).onConflictNode,{updates:Js(e)})})}$call(e){return e(this)}};Le=new WeakMap;let Wi=on;Ee(Wi,"don't await OnConflictBuilder instances.");class Ho{constructor(e){D(this,Yr,void 0);G(this,Yr,h(e))}toOperationNode(){return o(this,Yr).onConflictNode}}Yr=new WeakMap,Ee(Ho,"don't await OnConflictDoNothingBuilder instances.");const Zr=class Zr{constructor(e){D(this,Ut,void 0);G(this,Ut,h(e))}where(...e){return new Zr({...o(this,Ut),onConflictNode:xt.cloneWithUpdateWhere(o(this,Ut).onConflictNode,_t(e))})}whereRef(e,r,n){return new Zr({...o(this,Ut),onConflictNode:xt.cloneWithUpdateWhere(o(this,Ut).onConflictNode,sn(e,r,n))})}clearWhere(){return new Zr({...o(this,Ut),onConflictNode:xt.cloneWithoutUpdateWhere(o(this,Ut).onConflictNode)})}$call(e){return e(this)}toOperationNode(){return o(this,Ut).onConflictNode}};Ut=new WeakMap;let Fi=Zr;Ee(Fi,"don't await OnConflictUpdateBuilder instances.");const ft=class ft{constructor(e){D(this,_e,void 0);G(this,_e,h(e))}values(e){const[r,n]=Cl(e);return new ft({...o(this,_e),queryNode:Gt.cloneWith(o(this,_e).queryNode,{columns:r,values:n})})}columns(e){return new ft({...o(this,_e),queryNode:Gt.cloneWith(o(this,_e).queryNode,{columns:h(e.map(Ve.create))})})}expression(e){return new ft({...o(this,_e),queryNode:Gt.cloneWith(o(this,_e).queryNode,{values:Bi(e)})})}ignore(){return new ft({...o(this,_e),queryNode:Gt.cloneWith(o(this,_e).queryNode,{ignore:!0})})}onConflict(e){return new ft({...o(this,_e),queryNode:Gt.cloneWith(o(this,_e).queryNode,{onConflict:e(new Wi({onConflictNode:xt.create()})).toOperationNode()})})}onDuplicateKeyUpdate(e){return new ft({...o(this,_e),queryNode:Gt.cloneWith(o(this,_e).queryNode,{onDuplicateKey:Rl.create(Js(e))})})}returning(e){return new ft({...o(this,_e),queryNode:ye.cloneWithReturning(o(this,_e).queryNode,Dr(e))})}returningAll(){return new ft({...o(this,_e),queryNode:ye.cloneWithReturning(o(this,_e).queryNode,Rr())})}$call(e){return e(this)}$if(e,r){return e?r(this):new ft({...o(this,_e)})}$castTo(){return new ft(o(this,_e))}$narrowType(){return new ft(o(this,_e))}$assertType(){return new ft(o(this,_e))}withPlugin(e){return new ft({...o(this,_e),executor:o(this,_e).executor.withPlugin(e)})}toOperationNode(){return o(this,_e).executor.transformQuery(o(this,_e).queryNode,o(this,_e).queryId)}compile(){return o(this,_e).executor.compileQuery(this.toOperationNode(),o(this,_e).queryId)}async execute(){const e=this.compile(),r=e.query,n=await o(this,_e).executor.executeQuery(e,o(this,_e).queryId);return o(this,_e).executor.adapter.supportsReturning&&r.returning?n.rows:[new Ml(n.insertId,n.numAffectedRows??n.numUpdatedOrDeletedRows)]}async executeTakeFirst(){const[e]=await this.execute();return e}async executeTakeFirstOrThrow(e=Ci){const r=await this.executeTakeFirst();if(r===void 0)throw Pi(e)?new e(this.toOperationNode()):e(this.toOperationNode());return r}async*stream(e=100){const r=this.compile(),n=o(this,_e).executor.stream(r,e,o(this,_e).queryId);for await(const A of n)yield*A.rows}async explain(e,r){return await new ft({...o(this,_e),queryNode:ye.cloneWithExplain(o(this,_e).queryNode,e,r)}).execute()}};_e=new WeakMap;let Br=ft;Ee(Br,"don't await InsertQueryBuilder instances directly. To execute the query you need to call `execute` or `executeTakeFirst`.");class Bl{constructor(e){Oe(this,"numDeletedRows");this.numDeletedRows=e}}const Ko=h({is(t){return t.kind==="LimitNode"},create(t){return h({kind:"LimitNode",limit:Rt.create(t)})}}),Xe=class Xe{constructor(e){D(this,ae,void 0);G(this,ae,h(e))}where(...e){return new Xe({...o(this,ae),queryNode:ye.cloneWithWhere(o(this,ae).queryNode,_t(e))})}whereRef(e,r,n){return new Xe({...o(this,ae),queryNode:ye.cloneWithWhere(o(this,ae).queryNode,sn(e,r,n))})}clearWhere(){return new Xe({...o(this,ae),queryNode:ye.cloneWithoutWhere(o(this,ae).queryNode)})}using(e){return new Xe({...o(this,ae),queryNode:Mr.cloneWithUsing(o(this,ae).queryNode,zr(e))})}innerJoin(...e){return new Xe({...o(this,ae),queryNode:ye.cloneWithJoin(o(this,ae).queryNode,qt("InnerJoin",e))})}leftJoin(...e){return new Xe({...o(this,ae),queryNode:ye.cloneWithJoin(o(this,ae).queryNode,qt("LeftJoin",e))})}rightJoin(...e){return new Xe({...o(this,ae),queryNode:ye.cloneWithJoin(o(this,ae).queryNode,qt("RightJoin",e))})}fullJoin(...e){return new Xe({...o(this,ae),queryNode:ye.cloneWithJoin(o(this,ae).queryNode,qt("FullJoin",e))})}returning(e){return new Xe({...o(this,ae),queryNode:ye.cloneWithReturning(o(this,ae).queryNode,Dr(e))})}returningAll(e){return new Xe({...o(this,ae),queryNode:ye.cloneWithReturning(o(this,ae).queryNode,Rr(e))})}orderBy(e,r){return new Xe({...o(this,ae),queryNode:Mr.cloneWithOrderByItem(o(this,ae).queryNode,Si(e,r))})}limit(e){return new Xe({...o(this,ae),queryNode:Mr.cloneWithLimit(o(this,ae).queryNode,Ko.create(e))})}$call(e){return e(this)}$if(e,r){return e?r(this):new Xe({...o(this,ae)})}$castTo(){return new Xe(o(this,ae))}$narrowType(){return new Xe(o(this,ae))}$assertType(){return new Xe(o(this,ae))}withPlugin(e){return new Xe({...o(this,ae),executor:o(this,ae).executor.withPlugin(e)})}toOperationNode(){return o(this,ae).executor.transformQuery(o(this,ae).queryNode,o(this,ae).queryId)}compile(){return o(this,ae).executor.compileQuery(this.toOperationNode(),o(this,ae).queryId)}async execute(){const e=this.compile(),r=e.query,n=await o(this,ae).executor.executeQuery(e,o(this,ae).queryId);return o(this,ae).executor.adapter.supportsReturning&&r.returning?n.rows:[new Bl(n.numAffectedRows??n.numUpdatedOrDeletedRows??BigInt(0))]}async executeTakeFirst(){const[e]=await this.execute();return e}async executeTakeFirstOrThrow(e=Ci){const r=await this.executeTakeFirst();if(r===void 0)throw Pi(e)?new e(this.toOperationNode()):e(this.toOperationNode());return r}async*stream(e=100){const r=this.compile(),n=o(this,ae).executor.stream(r,e,o(this,ae).queryId);for await(const A of n)yield*A.rows}async explain(e,r){return await new Xe({...o(this,ae),queryNode:ye.cloneWithExplain(o(this,ae).queryNode,e,r)}).execute()}};ae=new WeakMap;let Li=Xe;Ee(Li,"don't await DeleteQueryBuilder instances directly. To execute the query you need to call `execute` or `executeTakeFirst`.");class Ul{constructor(e,r){Oe(this,"numUpdatedRows");Oe(this,"numChangedRows");this.numUpdatedRows=e,this.numChangedRows=r}}const nt=class nt{constructor(e){D(this,ce,void 0);G(this,ce,h(e))}where(...e){return new nt({...o(this,ce),queryNode:ye.cloneWithWhere(o(this,ce).queryNode,_t(e))})}whereRef(e,r,n){return new nt({...o(this,ce),queryNode:ye.cloneWithWhere(o(this,ce).queryNode,sn(e,r,n))})}clearWhere(){return new nt({...o(this,ce),queryNode:ye.cloneWithoutWhere(o(this,ce).queryNode)})}from(e){return new nt({...o(this,ce),queryNode:Ti.cloneWithFromItems(o(this,ce).queryNode,zr(e))})}innerJoin(...e){return new nt({...o(this,ce),queryNode:ye.cloneWithJoin(o(this,ce).queryNode,qt("InnerJoin",e))})}leftJoin(...e){return new nt({...o(this,ce),queryNode:ye.cloneWithJoin(o(this,ce).queryNode,qt("LeftJoin",e))})}rightJoin(...e){return new nt({...o(this,ce),queryNode:ye.cloneWithJoin(o(this,ce).queryNode,qt("RightJoin",e))})}fullJoin(...e){return new nt({...o(this,ce),queryNode:ye.cloneWithJoin(o(this,ce).queryNode,qt("FullJoin",e))})}set(e){return new nt({...o(this,ce),queryNode:Ti.cloneWithUpdates(o(this,ce).queryNode,Js(e))})}returning(e){return new nt({...o(this,ce),queryNode:ye.cloneWithReturning(o(this,ce).queryNode,Dr(e))})}returningAll(){return new nt({...o(this,ce),queryNode:ye.cloneWithReturning(o(this,ce).queryNode,Rr())})}$call(e){return e(this)}$if(e,r){return e?r(this):new nt({...o(this,ce)})}$castTo(){return new nt(o(this,ce))}$narrowType(){return new nt(o(this,ce))}$assertType(){return new nt(o(this,ce))}withPlugin(e){return new nt({...o(this,ce),executor:o(this,ce).executor.withPlugin(e)})}toOperationNode(){return o(this,ce).executor.transformQuery(o(this,ce).queryNode,o(this,ce).queryId)}compile(){return o(this,ce).executor.compileQuery(this.toOperationNode(),o(this,ce).queryId)}async execute(){const e=this.compile(),r=e.query,n=await o(this,ce).executor.executeQuery(e,o(this,ce).queryId);return o(this,ce).executor.adapter.supportsReturning&&r.returning?n.rows:[new Ul(n.numAffectedRows??n.numUpdatedOrDeletedRows??BigInt(0),n.numChangedRows)]}async executeTakeFirst(){const[e]=await this.execute();return e}async executeTakeFirstOrThrow(e=Ci){const r=await this.executeTakeFirst();if(r===void 0)throw Pi(e)?new e(this.toOperationNode()):e(this.toOperationNode());return r}async*stream(e=100){const r=this.compile(),n=o(this,ce).executor.stream(r,e,o(this,ce).queryId);for await(const A of n)yield*A.rows}async explain(e,r){return await new nt({...o(this,ce),queryNode:ye.cloneWithExplain(o(this,ce).queryNode,e,r)}).execute()}};ce=new WeakMap;let Di=nt;Ee(Di,"don't await UpdateQueryBuilder instances directly. To execute the query you need to call `execute` or `executeTakeFirst`.");const Ql=h({is(t){return t.kind==="CommonTableExpressionNode"},create(t,e){return h({kind:"CommonTableExpressionNode",name:t,expression:e})}}),Xo=h({is(t){return t.kind==="CommonTableExpressionNameNode"},create(t,e){return h({kind:"CommonTableExpressionNameNode",table:mn.create(t),columns:e?h(e.map(Ve.create)):void 0})}});function Yo(t,e){const r=e(Yl());return Ql.create(jl(t),r.toOperationNode())}function jl(t){if(t.includes("(")){const e=t.split(/[\(\)]/),r=e[0],n=e[1].split(",").map(A=>A.trim());return Xo.create(r,n)}else return Xo.create(t)}const Ri=h({is(t){return t.kind==="WithNode"},create(t,e){return h({kind:"WithNode",expressions:h([t]),...e})},cloneWithExpression(t,e){return h({...t,expressions:h([...t.expressions,e])})}}),Zo=["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","0","1","2","3","4","5","6","7","8","9"];function zl(t){let e="";for(let r=0;r<t;++r)e+=Vl();return e}function Vl(){return Zo[~~(Math.random()*Zo.length)]}function Fe(){return new Jl}class Jl{constructor(){D(this,ar,void 0)}get queryId(){return o(this,ar)===void 0&&G(this,ar,zl(8)),o(this,ar)}}ar=new WeakMap;function bd(t){return t}class Gs{constructor(){Oe(this,"nodeStack",[]);D(this,ls,h({AliasNode:this.transformAlias.bind(this),ColumnNode:this.transformColumn.bind(this),IdentifierNode:this.transformIdentifier.bind(this),SchemableIdentifierNode:this.transformSchemableIdentifier.bind(this),RawNode:this.transformRaw.bind(this),ReferenceNode:this.transformReference.bind(this),SelectQueryNode:this.transformSelectQuery.bind(this),SelectionNode:this.transformSelection.bind(this),TableNode:this.transformTable.bind(this),FromNode:this.transformFrom.bind(this),SelectAllNode:this.transformSelectAll.bind(this),AndNode:this.transformAnd.bind(this),OrNode:this.transformOr.bind(this),ValueNode:this.transformValue.bind(this),ValueListNode:this.transformValueList.bind(this),PrimitiveValueListNode:this.transformPrimitiveValueList.bind(this),ParensNode:this.transformParens.bind(this),JoinNode:this.transformJoin.bind(this),OperatorNode:this.transformOperator.bind(this),WhereNode:this.transformWhere.bind(this),InsertQueryNode:this.transformInsertQuery.bind(this),DeleteQueryNode:this.transformDeleteQuery.bind(this),ReturningNode:this.transformReturning.bind(this),CreateTableNode:this.transformCreateTable.bind(this),AddColumnNode:this.transformAddColumn.bind(this),ColumnDefinitionNode:this.transformColumnDefinition.bind(this),DropTableNode:this.transformDropTable.bind(this),DataTypeNode:this.transformDataType.bind(this),OrderByNode:this.transformOrderBy.bind(this),OrderByItemNode:this.transformOrderByItem.bind(this),GroupByNode:this.transformGroupBy.bind(this),GroupByItemNode:this.transformGroupByItem.bind(this),UpdateQueryNode:this.transformUpdateQuery.bind(this),ColumnUpdateNode:this.transformColumnUpdate.bind(this),LimitNode:this.transformLimit.bind(this),OffsetNode:this.transformOffset.bind(this),OnConflictNode:this.transformOnConflict.bind(this),OnDuplicateKeyNode:this.transformOnDuplicateKey.bind(this),CreateIndexNode:this.transformCreateIndex.bind(this),DropIndexNode:this.transformDropIndex.bind(this),ListNode:this.transformList.bind(this),PrimaryKeyConstraintNode:this.transformPrimaryKeyConstraint.bind(this),UniqueConstraintNode:this.transformUniqueConstraint.bind(this),ReferencesNode:this.transformReferences.bind(this),CheckConstraintNode:this.transformCheckConstraint.bind(this),WithNode:this.transformWith.bind(this),CommonTableExpressionNode:this.transformCommonTableExpression.bind(this),CommonTableExpressionNameNode:this.transformCommonTableExpressionName.bind(this),HavingNode:this.transformHaving.bind(this),CreateSchemaNode:this.transformCreateSchema.bind(this),DropSchemaNode:this.transformDropSchema.bind(this),AlterTableNode:this.transformAlterTable.bind(this),DropColumnNode:this.transformDropColumn.bind(this),RenameColumnNode:this.transformRenameColumn.bind(this),AlterColumnNode:this.transformAlterColumn.bind(this),ModifyColumnNode:this.transformModifyColumn.bind(this),AddConstraintNode:this.transformAddConstraint.bind(this),DropConstraintNode:this.transformDropConstraint.bind(this),ForeignKeyConstraintNode:this.transformForeignKeyConstraint.bind(this),CreateViewNode:this.transformCreateView.bind(this),DropViewNode:this.transformDropView.bind(this),GeneratedNode:this.transformGenerated.bind(this),DefaultValueNode:this.transformDefaultValue.bind(this),OnNode:this.transformOn.bind(this),ValuesNode:this.transformValues.bind(this),SelectModifierNode:this.transformSelectModifier.bind(this),CreateTypeNode:this.transformCreateType.bind(this),DropTypeNode:this.transformDropType.bind(this),ExplainNode:this.transformExplain.bind(this),DefaultInsertValueNode:this.transformDefaultInsertValue.bind(this),AggregateFunctionNode:this.transformAggregateFunction.bind(this),OverNode:this.transformOver.bind(this),PartitionByNode:this.transformPartitionBy.bind(this),PartitionByItemNode:this.transformPartitionByItem.bind(this),SetOperationNode:this.transformSetOperation.bind(this),BinaryOperationNode:this.transformBinaryOperation.bind(this),UnaryOperationNode:this.transformUnaryOperation.bind(this),UsingNode:this.transformUsing.bind(this),FunctionNode:this.transformFunction.bind(this),CaseNode:this.transformCase.bind(this),WhenNode:this.transformWhen.bind(this),JSONReferenceNode:this.transformJSONReference.bind(this),JSONPathNode:this.transformJSONPath.bind(this),JSONPathLegNode:this.transformJSONPathLeg.bind(this),JSONOperatorChainNode:this.transformJSONOperatorChain.bind(this)}))}transformNode(e){if(!e)return e;this.nodeStack.push(e);const r=this.transformNodeImpl(e);return this.nodeStack.pop(),h(r)}transformNodeImpl(e){return o(this,ls)[e.kind](e)}transformNodeList(e){return e&&h(e.map(r=>this.transformNode(r)))}transformSelectQuery(e){return{kind:"SelectQueryNode",from:this.transformNode(e.from),selections:this.transformNodeList(e.selections),distinctOn:this.transformNodeList(e.distinctOn),joins:this.transformNodeList(e.joins),groupBy:this.transformNode(e.groupBy),orderBy:this.transformNode(e.orderBy),where:this.transformNode(e.where),frontModifiers:this.transformNodeList(e.frontModifiers),endModifiers:this.transformNodeList(e.endModifiers),limit:this.transformNode(e.limit),offset:this.transformNode(e.offset),with:this.transformNode(e.with),having:this.transformNode(e.having),explain:this.transformNode(e.explain),setOperations:this.transformNodeList(e.setOperations)}}transformSelection(e){return{kind:"SelectionNode",selection:this.transformNode(e.selection)}}transformColumn(e){return{kind:"ColumnNode",column:this.transformNode(e.column)}}transformAlias(e){return{kind:"AliasNode",node:this.transformNode(e.node),alias:this.transformNode(e.alias)}}transformTable(e){return{kind:"TableNode",table:this.transformNode(e.table)}}transformFrom(e){return{kind:"FromNode",froms:this.transformNodeList(e.froms)}}transformReference(e){return{kind:"ReferenceNode",column:this.transformNode(e.column),table:this.transformNode(e.table)}}transformAnd(e){return{kind:"AndNode",left:this.transformNode(e.left),right:this.transformNode(e.right)}}transformOr(e){return{kind:"OrNode",left:this.transformNode(e.left),right:this.transformNode(e.right)}}transformValueList(e){return{kind:"ValueListNode",values:this.transformNodeList(e.values)}}transformParens(e){return{kind:"ParensNode",node:this.transformNode(e.node)}}transformJoin(e){return{kind:"JoinNode",joinType:e.joinType,table:this.transformNode(e.table),on:this.transformNode(e.on)}}transformRaw(e){return{kind:"RawNode",sqlFragments:h([...e.sqlFragments]),parameters:this.transformNodeList(e.parameters)}}transformWhere(e){return{kind:"WhereNode",where:this.transformNode(e.where)}}transformInsertQuery(e){return{kind:"InsertQueryNode",into:this.transformNode(e.into),columns:this.transformNodeList(e.columns),values:this.transformNode(e.values),returning:this.transformNode(e.returning),onConflict:this.transformNode(e.onConflict),onDuplicateKey:this.transformNode(e.onDuplicateKey),with:this.transformNode(e.with),ignore:e.ignore,replace:e.replace,explain:this.transformNode(e.explain)}}transformValues(e){return{kind:"ValuesNode",values:this.transformNodeList(e.values)}}transformDeleteQuery(e){return{kind:"DeleteQueryNode",from:this.transformNode(e.from),using:this.transformNode(e.using),joins:this.transformNodeList(e.joins),where:this.transformNode(e.where),returning:this.transformNode(e.returning),with:this.transformNode(e.with),orderBy:this.transformNode(e.orderBy),limit:this.transformNode(e.limit),explain:this.transformNode(e.explain)}}transformReturning(e){return{kind:"ReturningNode",selections:this.transformNodeList(e.selections)}}transformCreateTable(e){return{kind:"CreateTableNode",table:this.transformNode(e.table),columns:this.transformNodeList(e.columns),constraints:this.transformNodeList(e.constraints),temporary:e.temporary,ifNotExists:e.ifNotExists,onCommit:e.onCommit,frontModifiers:this.transformNodeList(e.frontModifiers),endModifiers:this.transformNodeList(e.endModifiers)}}transformColumnDefinition(e){return{kind:"ColumnDefinitionNode",column:this.transformNode(e.column),dataType:this.transformNode(e.dataType),references:this.transformNode(e.references),primaryKey:e.primaryKey,autoIncrement:e.autoIncrement,unique:e.unique,notNull:e.notNull,unsigned:e.unsigned,defaultTo:this.transformNode(e.defaultTo),check:this.transformNode(e.check),generated:this.transformNode(e.generated),frontModifiers:this.transformNodeList(e.frontModifiers),endModifiers:this.transformNodeList(e.endModifiers)}}transformAddColumn(e){return{kind:"AddColumnNode",column:this.transformNode(e.column)}}transformDropTable(e){return{kind:"DropTableNode",table:this.transformNode(e.table),ifExists:e.ifExists,cascade:e.cascade}}transformOrderBy(e){return{kind:"OrderByNode",items:this.transformNodeList(e.items)}}transformOrderByItem(e){return{kind:"OrderByItemNode",orderBy:this.transformNode(e.orderBy),direction:this.transformNode(e.direction)}}transformGroupBy(e){return{kind:"GroupByNode",items:this.transformNodeList(e.items)}}transformGroupByItem(e){return{kind:"GroupByItemNode",groupBy:this.transformNode(e.groupBy)}}transformUpdateQuery(e){return{kind:"UpdateQueryNode",table:this.transformNode(e.table),from:this.transformNode(e.from),joins:this.transformNodeList(e.joins),where:this.transformNode(e.where),updates:this.transformNodeList(e.updates),returning:this.transformNode(e.returning),with:this.transformNode(e.with),explain:this.transformNode(e.explain)}}transformColumnUpdate(e){return{kind:"ColumnUpdateNode",column:this.transformNode(e.column),value:this.transformNode(e.value)}}transformLimit(e){return{kind:"LimitNode",limit:this.transformNode(e.limit)}}transformOffset(e){return{kind:"OffsetNode",offset:this.transformNode(e.offset)}}transformOnConflict(e){return{kind:"OnConflictNode",columns:this.transformNodeList(e.columns),constraint:this.transformNode(e.constraint),indexExpression:this.transformNode(e.indexExpression),indexWhere:this.transformNode(e.indexWhere),updates:this.transformNodeList(e.updates),updateWhere:this.transformNode(e.updateWhere),doNothing:e.doNothing}}transformOnDuplicateKey(e){return{kind:"OnDuplicateKeyNode",updates:this.transformNodeList(e.updates)}}transformCreateIndex(e){return{kind:"CreateIndexNode",name:this.transformNode(e.name),table:this.transformNode(e.table),columns:this.transformNodeList(e.columns),unique:e.unique,using:this.transformNode(e.using),ifNotExists:e.ifNotExists,where:this.transformNode(e.where)}}transformList(e){return{kind:"ListNode",items:this.transformNodeList(e.items)}}transformDropIndex(e){return{kind:"DropIndexNode",name:this.transformNode(e.name),table:this.transformNode(e.table),ifExists:e.ifExists,cascade:e.cascade}}transformPrimaryKeyConstraint(e){return{kind:"PrimaryKeyConstraintNode",columns:this.transformNodeList(e.columns),name:this.transformNode(e.name)}}transformUniqueConstraint(e){return{kind:"UniqueConstraintNode",columns:this.transformNodeList(e.columns),name:this.transformNode(e.name)}}transformForeignKeyConstraint(e){return{kind:"ForeignKeyConstraintNode",columns:this.transformNodeList(e.columns),references:this.transformNode(e.references),name:this.transformNode(e.name),onDelete:e.onDelete,onUpdate:e.onUpdate}}transformSetOperation(e){return{kind:"SetOperationNode",operator:e.operator,expression:this.transformNode(e.expression),all:e.all}}transformReferences(e){return{kind:"ReferencesNode",table:this.transformNode(e.table),columns:this.transformNodeList(e.columns),onDelete:e.onDelete,onUpdate:e.onUpdate}}transformCheckConstraint(e){return{kind:"CheckConstraintNode",expression:this.transformNode(e.expression),name:this.transformNode(e.name)}}transformWith(e){return{kind:"WithNode",expressions:this.transformNodeList(e.expressions),recursive:e.recursive}}transformCommonTableExpression(e){return{kind:"CommonTableExpressionNode",name:this.transformNode(e.name),expression:this.transformNode(e.expression)}}transformCommonTableExpressionName(e){return{kind:"CommonTableExpressionNameNode",table:this.transformNode(e.table),columns:this.transformNodeList(e.columns)}}transformHaving(e){return{kind:"HavingNode",having:this.transformNode(e.having)}}transformCreateSchema(e){return{kind:"CreateSchemaNode",schema:this.transformNode(e.schema),ifNotExists:e.ifNotExists}}transformDropSchema(e){return{kind:"DropSchemaNode",schema:this.transformNode(e.schema),ifExists:e.ifExists,cascade:e.cascade}}transformAlterTable(e){return{kind:"AlterTableNode",table:this.transformNode(e.table),renameTo:this.transformNode(e.renameTo),setSchema:this.transformNode(e.setSchema),columnAlterations:this.transformNodeList(e.columnAlterations),addConstraint:this.transformNode(e.addConstraint),dropConstraint:this.transformNode(e.dropConstraint)}}transformDropColumn(e){return{kind:"DropColumnNode",column:this.transformNode(e.column)}}transformRenameColumn(e){return{kind:"RenameColumnNode",column:this.transformNode(e.column),renameTo:this.transformNode(e.renameTo)}}transformAlterColumn(e){return{kind:"AlterColumnNode",column:this.transformNode(e.column),dataType:this.transformNode(e.dataType),dataTypeExpression:this.transformNode(e.dataTypeExpression),setDefault:this.transformNode(e.setDefault),dropDefault:e.dropDefault,setNotNull:e.setNotNull,dropNotNull:e.dropNotNull}}transformModifyColumn(e){return{kind:"ModifyColumnNode",column:this.transformNode(e.column)}}transformAddConstraint(e){return{kind:"AddConstraintNode",constraint:this.transformNode(e.constraint)}}transformDropConstraint(e){return{kind:"DropConstraintNode",constraintName:this.transformNode(e.constraintName),ifExists:e.ifExists,modifier:e.modifier}}transformCreateView(e){return{kind:"CreateViewNode",name:this.transformNode(e.name),temporary:e.temporary,orReplace:e.orReplace,ifNotExists:e.ifNotExists,materialized:e.materialized,columns:this.transformNodeList(e.columns),as:this.transformNode(e.as)}}transformDropView(e){return{kind:"DropViewNode",name:this.transformNode(e.name),ifExists:e.ifExists,materialized:e.materialized,cascade:e.cascade}}transformGenerated(e){return{kind:"GeneratedNode",byDefault:e.byDefault,always:e.always,identity:e.identity,stored:e.stored,expression:this.transformNode(e.expression)}}transformDefaultValue(e){return{kind:"DefaultValueNode",defaultValue:this.transformNode(e.defaultValue)}}transformOn(e){return{kind:"OnNode",on:this.transformNode(e.on)}}transformSelectModifier(e){return{kind:"SelectModifierNode",modifier:e.modifier,rawModifier:this.transformNode(e.rawModifier)}}transformCreateType(e){return{kind:"CreateTypeNode",name:this.transformNode(e.name),enum:this.transformNode(e.enum)}}transformDropType(e){return{kind:"DropTypeNode",name:this.transformNode(e.name),ifExists:e.ifExists}}transformExplain(e){return{kind:"ExplainNode",format:e.format,options:this.transformNode(e.options)}}transformSchemableIdentifier(e){return{kind:"SchemableIdentifierNode",schema:this.transformNode(e.schema),identifier:this.transformNode(e.identifier)}}transformAggregateFunction(e){return{kind:"AggregateFunctionNode",aggregated:this.transformNodeList(e.aggregated),distinct:e.distinct,filter:this.transformNode(e.filter),func:e.func,over:this.transformNode(e.over)}}transformOver(e){return{kind:"OverNode",orderBy:this.transformNode(e.orderBy),partitionBy:this.transformNode(e.partitionBy)}}transformPartitionBy(e){return{kind:"PartitionByNode",items:this.transformNodeList(e.items)}}transformPartitionByItem(e){return{kind:"PartitionByItemNode",partitionBy:this.transformNode(e.partitionBy)}}transformBinaryOperation(e){return{kind:"BinaryOperationNode",leftOperand:this.transformNode(e.leftOperand),operator:this.transformNode(e.operator),rightOperand:this.transformNode(e.rightOperand)}}transformUnaryOperation(e){return{kind:"UnaryOperationNode",operator:this.transformNode(e.operator),operand:this.transformNode(e.operand)}}transformUsing(e){return{kind:"UsingNode",tables:this.transformNodeList(e.tables)}}transformFunction(e){return{kind:"FunctionNode",func:e.func,arguments:this.transformNodeList(e.arguments)}}transformCase(e){return{kind:"CaseNode",value:this.transformNode(e.value),when:this.transformNodeList(e.when),else:this.transformNode(e.else),isStatement:e.isStatement}}transformWhen(e){return{kind:"WhenNode",condition:this.transformNode(e.condition),result:this.transformNode(e.result)}}transformJSONReference(e){return{kind:"JSONReferenceNode",reference:this.transformNode(e.reference),traversal:this.transformNode(e.traversal)}}transformJSONPath(e){return{kind:"JSONPathNode",inOperator:this.transformNode(e.inOperator),pathLegs:this.transformNodeList(e.pathLegs)}}transformJSONPathLeg(e){return{kind:"JSONPathLegNode",type:e.type,value:e.value}}transformJSONOperatorChain(e){return{kind:"JSONOperatorChainNode",operator:this.transformNode(e.operator),values:this.transformNodeList(e.values)}}transformDataType(e){return e}transformSelectAll(e){return e}transformIdentifier(e){return e}transformValue(e){return e}transformPrimitiveValueList(e){return e}transformOperator(e){return e}transformDefaultInsertValue(e){return e}}ls=new WeakMap;const Gl=h({AlterTableNode:!0,CreateIndexNode:!0,CreateSchemaNode:!0,CreateTableNode:!0,CreateTypeNode:!0,CreateViewNode:!0,DeleteQueryNode:!0,DropIndexNode:!0,DropSchemaNode:!0,DropTableNode:!0,DropTypeNode:!0,DropViewNode:!0,InsertQueryNode:!0,RawNode:!0,SelectQueryNode:!0,UpdateQueryNode:!0});class $l extends Gs{constructor(r){super();D(this,us);D(this,cs);D(this,ds);D(this,Dn);D(this,ei);D(this,fs);D(this,lr,void 0);D(this,Fn,new Set);D(this,Ln,new Set);G(this,lr,r)}transformNodeImpl(r){if(!Ae(this,us,Ga).call(this,r))return super.transformNodeImpl(r);const n=Ae(this,ds,Ha).call(this,r);for(const Y of n)o(this,Ln).add(Y);const A=Ae(this,cs,$a).call(this,r);for(const Y of A)o(this,Fn).add(Y);const V=super.transformNodeImpl(r);for(const Y of A)o(this,Fn).delete(Y);for(const Y of n)o(this,Ln).delete(Y);return V}transformSchemableIdentifier(r){const n=super.transformSchemableIdentifier(r);return n.schema||!o(this,Fn).has(r.identifier.name)?n:{...n,schema:Ue.create(o(this,lr))}}transformReferences(r){const n=super.transformReferences(r);return n.table.table.schema?n:{...n,table:mn.createWithSchema(o(this,lr),n.table.table.identifier.name)}}}lr=new WeakMap,Fn=new WeakMap,Ln=new WeakMap,us=new WeakSet,Ga=function(r){return r.kind in Gl},cs=new WeakSet,$a=function(r){const n=new Set;if("name"in r&&r.name&&pn.is(r.name)&&Ae(this,ei,qo).call(this,r.name,n),"from"in r&&r.from)for(const A of r.from.froms)Ae(this,Dn,vi).call(this,A,n);if("into"in r&&r.into&&Ae(this,Dn,vi).call(this,r.into,n),"table"in r&&r.table&&Ae(this,Dn,vi).call(this,r.table,n),"joins"in r&&r.joins)for(const A of r.joins)Ae(this,Dn,vi).call(this,A.table,n);return n},ds=new WeakSet,Ha=function(r){const n=new Set;return"with"in r&&r.with&&Ae(this,fs,Ka).call(this,r.with,n),n},Dn=new WeakSet,vi=function(r,n){const A=mn.is(r)?r:_n.is(r)&&mn.is(r.node)?r.node:null;A&&Ae(this,ei,qo).call(this,A.table,n)},ei=new WeakSet,qo=function(r,n){const A=r.identifier.name;!o(this,Fn).has(A)&&!o(this,Ln).has(A)&&n.add(A)},fs=new WeakSet,Ka=function(r,n){for(const A of r.expressions){const V=A.name.table.table.identifier.name;o(this,Ln).has(V)||n.add(V)}};class Ur{constructor(e){D(this,ti,void 0);G(this,ti,new $l(e))}transformQuery(e){return o(this,ti).transformNode(e.node)}async transformResult(e){return e.result}}ti=new WeakMap;const Rn=class Rn{constructor(e){D(this,De,void 0);G(this,De,h(e))}selectFrom(e){return new Qr({queryId:Fe(),executor:o(this,De).executor,queryNode:xe.create(zr(e),o(this,De).withNode)})}insertInto(e){return new Br({queryId:Fe(),executor:o(this,De).executor,queryNode:Gt.create(Nt(e),o(this,De).withNode)})}replaceInto(e){return new Br({queryId:Fe(),executor:o(this,De).executor,queryNode:Gt.create(Nt(e),o(this,De).withNode,!0)})}deleteFrom(e){return new Li({queryId:Fe(),executor:o(this,De).executor,queryNode:Mr.create(zr(e),o(this,De).withNode)})}updateTable(e){return new Di({queryId:Fe(),executor:o(this,De).executor,queryNode:Ti.create(Vr(e),o(this,De).withNode)})}with(e,r){const n=Yo(e,r);return new Rn({...o(this,De),withNode:o(this,De).withNode?Ri.cloneWithExpression(o(this,De).withNode,n):Ri.create(n)})}withRecursive(e,r){const n=Yo(e,r);return new Rn({...o(this,De),withNode:o(this,De).withNode?Ri.cloneWithExpression(o(this,De).withNode,n):Ri.create(n,{recursive:!0})})}withPlugin(e){return new Rn({...o(this,De),executor:o(this,De).executor.withPlugin(e)})}withoutPlugins(){return new Rn({...o(this,De),executor:o(this,De).executor.withoutPlugins()})}withSchema(e){return new Rn({...o(this,De),executor:o(this,De).executor.withPluginAtFront(new Ur(e))})}};De=new WeakMap;let Mi=Rn;class ea{constructor(){D(this,ni,void 0);D(this,ur,void 0);D(this,cr,void 0);Oe(this,"resolve",e=>{o(this,ur)&&o(this,ur).call(this,e)});Oe(this,"reject",e=>{o(this,cr)&&o(this,cr).call(this,e)});G(this,ni,new Promise((e,r)=>{G(this,cr,r),G(this,ur,e)}))}get promise(){return o(this,ni)}}ni=new WeakMap,ur=new WeakMap,cr=new WeakMap;const ta=new Set;function Hl(t){ta.has(t)||(ta.add(t),console.log(t))}const Kl=h([]);class na{constructor(e=Kl){D(this,ri);D(this,Mn,void 0);G(this,Mn,e)}get plugins(){return o(this,Mn)}transformQuery(e,r){for(const n of o(this,Mn)){const A=n.transformQuery({node:e,queryId:r});if(A.kind===e.kind)e=A;else throw new Error(["KyselyPlugin.transformQuery must return a node","of the same kind that was given to it.",`The plugin was given a ${e.kind}`,`but it returned a ${A.kind}`].join(" "))}return e}async executeQuery(e,r){return await this.provideConnection(async n=>{const A=await n.executeQuery(e),V=await Ae(this,ri,No).call(this,A,r);return Xl(A,V),V})}async*stream(e,r,n){const A=new ea,V=new ea;this.provideConnection(async pe=>(A.resolve(pe),await V.promise)).catch(pe=>A.reject(pe));const Y=await A.promise;try{for await(const pe of Y.streamQuery(e,r))yield await Ae(this,ri,No).call(this,pe,n)}finally{V.resolve()}}}Mn=new WeakMap,ri=new WeakSet,No=async function(e,r){for(const n of o(this,Mn))e=await n.transformResult({result:e,queryId:r});return e};function Xl(t,e){const{numAffectedRows:r}=t;r===void 0&&t.numUpdatedOrDeletedRows===void 0||r!==void 0&&e.numAffectedRows!==void 0||Hl("kysely:warning: outdated driver/plugin detected! QueryResult.numUpdatedOrDeletedRows is deprecated and will be removed in a future release.")}class er extends na{get adapter(){throw new Error("this query cannot be compiled to SQL")}compileQuery(){throw new Error("this query cannot be compiled to SQL")}provideConnection(){throw new Error("this query cannot be executed")}withConnectionProvider(){throw new Error("this query cannot have a connection provider")}withPlugin(e){return new er([...this.plugins,e])}withPlugins(e){return new er([...this.plugins,...e])}withPluginAtFront(e){return new er([e,...this.plugins])}withoutPlugins(){return new er([])}}const $s=new er;function Yl(){return new Mi({executor:$s})}function Zl(t,e){return new Ai({joinNode:Pr.create(t,Vr(e))})}function eu(){return new Ii({overNode:Vs.create()})}function qt(t,e){if(e.length===3)return nu(t,e[0],e[1],e[2]);if(e.length===2)return tu(t,e[0],e[1]);throw new Error("not implemented")}function tu(t,e,r){return r(Zl(t,e)).toOperationNode()}function nu(t,e,r,n){return Pr.createWithOn(t,Vr(e),sn(r,"=",n))}const ru=h({is(t){return t.kind==="OffsetNode"},create(t){return h({kind:"OffsetNode",offset:Rt.create(t)})}}),iu=h({is(t){return t.kind==="GroupByItemNode"},create(t){return h({kind:"GroupByItemNode",groupBy:t})}});function su(t){return t=Tt(t)?t(ir()):t,Fr(t).map(iu.create)}const ra=h({is(t){return t.kind==="SetOperationNode"},create(t,e,r){return h({kind:"SetOperationNode",operator:t,expression:e,all:r})}});function tr(t,e,r){return ra.create(t,e.toOperationNode(),r)}const le=class le{constructor(e){D(this,U,void 0);G(this,U,h(e))}get expressionType(){}where(...e){return new le({...o(this,U),queryNode:ye.cloneWithWhere(o(this,U).queryNode,_t(e))})}whereRef(e,r,n){return new le({...o(this,U),queryNode:ye.cloneWithWhere(o(this,U).queryNode,sn(e,r,n))})}having(...e){return new le({...o(this,U),queryNode:xe.cloneWithHaving(o(this,U).queryNode,_t(e))})}havingRef(e,r,n){return new le({...o(this,U),queryNode:xe.cloneWithHaving(o(this,U).queryNode,sn(e,r,n))})}select(e){return new le({...o(this,U),queryNode:xe.cloneWithSelections(o(this,U).queryNode,Dr(e))})}distinctOn(e){return new le({...o(this,U),queryNode:xe.cloneWithDistinctOn(o(this,U).queryNode,Fr(e))})}modifyFront(e){return new le({...o(this,U),queryNode:xe.cloneWithFrontModifier(o(this,U).queryNode,tn.createWithExpression(e.toOperationNode()))})}modifyEnd(e){return new le({...o(this,U),queryNode:xe.cloneWithEndModifier(o(this,U).queryNode,tn.createWithExpression(e.toOperationNode()))})}distinct(){return new le({...o(this,U),queryNode:xe.cloneWithFrontModifier(o(this,U).queryNode,tn.create("Distinct"))})}forUpdate(){return new le({...o(this,U),queryNode:xe.cloneWithEndModifier(o(this,U).queryNode,tn.create("ForUpdate"))})}forShare(){return new le({...o(this,U),queryNode:xe.cloneWithEndModifier(o(this,U).queryNode,tn.create("ForShare"))})}forKeyShare(){return new le({...o(this,U),queryNode:xe.cloneWithEndModifier(o(this,U).queryNode,tn.create("ForKeyShare"))})}forNoKeyUpdate(){return new le({...o(this,U),queryNode:xe.cloneWithEndModifier(o(this,U).queryNode,tn.create("ForNoKeyUpdate"))})}skipLocked(){return new le({...o(this,U),queryNode:xe.cloneWithEndModifier(o(this,U).queryNode,tn.create("SkipLocked"))})}noWait(){return new le({...o(this,U),queryNode:xe.cloneWithEndModifier(o(this,U).queryNode,tn.create("NoWait"))})}selectAll(e){return new le({...o(this,U),queryNode:xe.cloneWithSelections(o(this,U).queryNode,Rr(e))})}innerJoin(...e){return new le({...o(this,U),queryNode:ye.cloneWithJoin(o(this,U).queryNode,qt("InnerJoin",e))})}leftJoin(...e){return new le({...o(this,U),queryNode:ye.cloneWithJoin(o(this,U).queryNode,qt("LeftJoin",e))})}rightJoin(...e){return new le({...o(this,U),queryNode:ye.cloneWithJoin(o(this,U).queryNode,qt("RightJoin",e))})}fullJoin(...e){return new le({...o(this,U),queryNode:ye.cloneWithJoin(o(this,U).queryNode,qt("FullJoin",e))})}innerJoinLateral(...e){return new le({...o(this,U),queryNode:ye.cloneWithJoin(o(this,U).queryNode,qt("LateralInnerJoin",e))})}leftJoinLateral(...e){return new le({...o(this,U),queryNode:ye.cloneWithJoin(o(this,U).queryNode,qt("LateralLeftJoin",e))})}orderBy(e,r){return new le({...o(this,U),queryNode:xe.cloneWithOrderByItem(o(this,U).queryNode,Si(e,r))})}groupBy(e){return new le({...o(this,U),queryNode:xe.cloneWithGroupByItems(o(this,U).queryNode,su(e))})}limit(e){return new le({...o(this,U),queryNode:xe.cloneWithLimit(o(this,U).queryNode,Ko.create(e))})}offset(e){return new le({...o(this,U),queryNode:xe.cloneWithOffset(o(this,U).queryNode,ru.create(e))})}union(e){return new le({...o(this,U),queryNode:xe.cloneWithSetOperation(o(this,U).queryNode,tr("union",e,!1))})}unionAll(e){return new le({...o(this,U),queryNode:xe.cloneWithSetOperation(o(this,U).queryNode,tr("union",e,!0))})}intersect(e){return new le({...o(this,U),queryNode:xe.cloneWithSetOperation(o(this,U).queryNode,tr("intersect",e,!1))})}intersectAll(e){return new le({...o(this,U),queryNode:xe.cloneWithSetOperation(o(this,U).queryNode,tr("intersect",e,!0))})}except(e){return new le({...o(this,U),queryNode:xe.cloneWithSetOperation(o(this,U).queryNode,tr("except",e,!1))})}exceptAll(e){return new le({...o(this,U),queryNode:xe.cloneWithSetOperation(o(this,U).queryNode,tr("except",e,!0))})}as(e){return new ou(this,e)}clearSelect(){return new le({...o(this,U),queryNode:xe.cloneWithoutSelections(o(this,U).queryNode)})}clearWhere(){return new le({...o(this,U),queryNode:ye.cloneWithoutWhere(o(this,U).queryNode)})}clearLimit(){return new le({...o(this,U),queryNode:xe.cloneWithoutLimit(o(this,U).queryNode)})}clearOffset(){return new le({...o(this,U),queryNode:xe.cloneWithoutOffset(o(this,U).queryNode)})}clearOrderBy(){return new le({...o(this,U),queryNode:xe.cloneWithoutOrderBy(o(this,U).queryNode)})}$call(e){return e(this)}$if(e,r){return e?r(this):new le({...o(this,U)})}$castTo(){return new le(o(this,U))}$narrowType(){return new le(o(this,U))}$assertType(){return new le(o(this,U))}withPlugin(e){return new le({...o(this,U),executor:o(this,U).executor.withPlugin(e)})}toOperationNode(){return o(this,U).executor.transformQuery(o(this,U).queryNode,o(this,U).queryId)}compile(){return o(this,U).executor.compileQuery(this.toOperationNode(),o(this,U).queryId)}async execute(){const e=this.compile();return(await o(this,U).executor.executeQuery(e,o(this,U).queryId)).rows}async executeTakeFirst(){const[e]=await this.execute();return e}async executeTakeFirstOrThrow(e=Ci){const r=await this.executeTakeFirst();if(r===void 0)throw Pi(e)?new e(this.toOperationNode()):e(this.toOperationNode());return r}async*stream(e=100){const r=this.compile(),n=o(this,U).executor.stream(r,e,o(this,U).queryId);for await(const A of n)yield*A.rows}async explain(e,r){return await new le({...o(this,U),queryNode:ye.cloneWithExplain(o(this,U).queryNode,e,r)}).execute()}};U=new WeakMap;let Qr=le;Ee(Qr,"don't await SelectQueryBuilder instances directly. To execute the query you need to call `execute` or `executeTakeFirst`.");class ou{constructor(e,r){D(this,dr,void 0);D(this,fr,void 0);G(this,dr,e),G(this,fr,r)}get expression(){return o(this,dr)}get alias(){return o(this,fr)}toOperationNode(){return _n.create(o(this,dr).toOperationNode(),Ue.create(o(this,fr)))}}dr=new WeakMap,fr=new WeakMap;const nr=h({is(t){return t.kind==="ParensNode"},create(t){return h({kind:"ParensNode",node:t})}}),lo=class lo{constructor(e){D(this,qn,void 0);G(this,qn,e)}get expressionType(){}as(e){return new Hs(this,e)}or(...e){return new Ks(Cn.create(o(this,qn),_t(e)))}and(...e){return new Xs(Tn.create(o(this,qn),_t(e)))}$castTo(){return new lo(o(this,qn))}toOperationNode(){return o(this,qn)}};qn=new WeakMap;let Je=lo;class Hs{constructor(e,r){D(this,hr,void 0);D(this,Nn,void 0);G(this,hr,e),G(this,Nn,r)}get expression(){return o(this,hr)}get alias(){return o(this,Nn)}toOperationNode(){return _n.create(o(this,hr).toOperationNode(),Ct(o(this,Nn))?o(this,Nn).toOperationNode():Ue.create(o(this,Nn)))}}hr=new WeakMap,Nn=new WeakMap;const hs=class hs{constructor(e){D(this,Bn,void 0);G(this,Bn,e)}get expressionType(){}as(e){return new Hs(this,e)}or(...e){return new hs(Cn.create(o(this,Bn),_t(e)))}$castTo(){return new hs(o(this,Bn))}toOperationNode(){return nr.create(o(this,Bn))}};Bn=new WeakMap;let Ks=hs;const ps=class ps{constructor(e){D(this,Un,void 0);G(this,Un,e)}get expressionType(){}as(e){return new Hs(this,e)}and(...e){return new ps(Tn.create(o(this,Un),_t(e)))}$castTo(){return new ps(o(this,Un))}toOperationNode(){return nr.create(o(this,Un))}};Un=new WeakMap;let Xs=ps;const rr=h({is(t){return t.kind==="AggregateFunctionNode"},create(t,e=[]){return h({kind:"AggregateFunctionNode",func:t,aggregated:e})},cloneWithDistinct(t){return h({...t,distinct:!0})},cloneWithFilter(t,e){return h({...t,filter:t.filter?bt.cloneWithOperation(t.filter,"And",e):bt.create(e)})},cloneWithOrFilter(t,e){return h({...t,filter:t.filter?bt.cloneWithOperation(t.filter,"Or",e):bt.create(e)})},cloneWithOver(t,e){return h({...t,over:e})}}),au=h({is(t){return t.kind==="FunctionNode"},create(t,e){return h({kind:"FunctionNode",func:t,arguments:e})}}),pr=class pr{constructor(e){D(this,St,void 0);G(this,St,h(e))}get expressionType(){}as(e){return new lu(this,e)}distinct(){return new pr({...o(this,St),aggregateFunctionNode:rr.cloneWithDistinct(o(this,St).aggregateFunctionNode)})}filterWhere(...e){return new pr({...o(this,St),aggregateFunctionNode:rr.cloneWithFilter(o(this,St).aggregateFunctionNode,_t(e))})}filterWhereRef(e,r,n){return new pr({...o(this,St),aggregateFunctionNode:rr.cloneWithFilter(o(this,St).aggregateFunctionNode,sn(e,r,n))})}over(e){const r=eu();return new pr({...o(this,St),aggregateFunctionNode:rr.cloneWithOver(o(this,St).aggregateFunctionNode,(e?e(r):r).toOperationNode())})}$call(e){return e(this)}toOperationNode(){return o(this,St).aggregateFunctionNode}};St=new WeakMap;let jr=pr;Ee(jr,"don't await AggregateFunctionBuilder instances. They are never executed directly and are always just a part of a query.");class lu{constructor(e,r){D(this,_r,void 0);D(this,mr,void 0);G(this,_r,e),G(this,mr,r)}get expression(){return o(this,_r)}get alias(){return o(this,mr)}toOperationNode(){return _n.create(o(this,_r).toOperationNode(),Ue.create(o(this,mr)))}}_r=new WeakMap,mr=new WeakMap;function ia(){const t=(r,n)=>new Je(au.create(r,Fr(n))),e=(r,n)=>new jr({aggregateFunctionNode:rr.create(r,n?Fr(n):void 0)});return Object.assign(t,{agg:e,avg(r){return e("avg",[r])},coalesce(r,...n){return t("coalesce",[r,...n])},count(r){return e("count",[r])},countAll(r){return new jr({aggregateFunctionNode:rr.create("count",Rr(r))})},max(r){return e("max",[r])},min(r){return e("min",[r])},sum(r){return e("sum",[r])}})}const uu=h({is(t){return t.kind==="UnaryOperationNode"},create(t,e){return h({kind:"UnaryOperationNode",operator:t,operand:e})}});function cu(t,e){return uu.create(Wr.create(t),nn(e))}const Ys=h({is(t){return t.kind==="WhenNode"},create(t){return h({kind:"WhenNode",condition:t})},cloneWithResult(t,e){return h({...t,result:e})}}),$t=h({is(t){return t.kind==="CaseNode"},create(t){return h({kind:"CaseNode",value:t})},cloneWithWhen(t,e){return h({...t,when:h(t.when?[...t.when,e]:[e])})},cloneWithThen(t,e){return h({...t,when:t.when?h([...t.when.slice(0,-1),Ys.cloneWithResult(t.when[t.when.length-1],e)]):void 0})},cloneWith(t,e){return h({...t,...e})}});class sa{constructor(e){D(this,yr,void 0);G(this,yr,h(e))}when(...e){return new oa({...o(this,yr),node:$t.cloneWithWhen(o(this,yr).node,Ys.create(_t(e)))})}}yr=new WeakMap;class oa{constructor(e){D(this,gr,void 0);G(this,gr,h(e))}then(e){return new du({...o(this,gr),node:$t.cloneWithThen(o(this,gr).node,rn(e))})}}gr=new WeakMap;class du{constructor(e){D(this,Ht,void 0);G(this,Ht,h(e))}when(...e){return new oa({...o(this,Ht),node:$t.cloneWithWhen(o(this,Ht).node,Ys.create(_t(e)))})}else(e){return new fu({...o(this,Ht),node:$t.cloneWith(o(this,Ht).node,{else:rn(e)})})}end(){return new Je($t.cloneWith(o(this,Ht).node,{isStatement:!1}))}endCase(){return new Je($t.cloneWith(o(this,Ht).node,{isStatement:!0}))}}Ht=new WeakMap;class fu{constructor(e){D(this,wr,void 0);G(this,wr,h(e))}end(){return new Je($t.cloneWith(o(this,wr).node,{isStatement:!1}))}endCase(){return new Je($t.cloneWith(o(this,wr).node,{isStatement:!0}))}}wr=new WeakMap;const hu=h({is(t){return t.kind==="JSONPathLegNode"},create(t,e){return h({kind:"JSONPathLegNode",type:t,value:e})}});class Zs{constructor(e){D(this,ii);D(this,vn,void 0);G(this,vn,e)}at(e){return Ae(this,ii,vo).call(this,"ArrayLocation",e)}key(e){return Ae(this,ii,vo).call(this,"Member",e)}}vn=new WeakMap,ii=new WeakSet,vo=function(e,r){return new pu(Bs.cloneWithTraversal(o(this,vn),Us.is(o(this,vn).traversal)?Us.cloneWithLeg(o(this,vn).traversal,hu.create(e,r)):Po.cloneWithValue(o(this,vn).traversal,Rt.createImmediate(r))))};class pu extends Zs{constructor(r){super(r);D(this,br,void 0);G(this,br,r)}get expressionType(){}as(r){return new _u(this,r)}$castTo(){return new Zs(o(this,br))}toOperationNode(){return o(this,br)}}br=new WeakMap;class _u{constructor(e,r){D(this,qr,void 0);D(this,xn,void 0);G(this,qr,e),G(this,xn,r)}get expression(){return o(this,qr)}get alias(){return o(this,xn)}toOperationNode(){return _n.create(o(this,qr).toOperationNode(),Ct(o(this,xn))?o(this,xn).toOperationNode():Ue.create(o(this,xn)))}}qr=new WeakMap,xn=new WeakMap;function eo(t=$s){function e(A,V,Y){return new Je(ki(A,V,Y))}function r(A,V){return new Je(cu(A,V))}const n=Object.assign(e,{fn:void 0,eb:void 0,selectFrom(A){return new Qr({queryId:Fe(),executor:t,queryNode:xe.create(zr(A))})},case(A){return new sa({node:$t.create(Te(A)?void 0:nn(A))})},ref(A,V){return Te(V)?new Je(Pn(A)):new Zs(ml(A,V))},val(A){return new Je(Ro(A))},cmpr(A,V,Y){return new Je(ki(A,V,Y))},bxp(A,V,Y){return new Je(ki(A,V,Y))},unary:r,not(A){return r("not",A)},exists(A){return r("exists",A)},neg(A){return r("-",A)},and(A){if(A.length===0)return new Je(Rt.createImmediate(!0));if(A.length===1)return new Je(A[0].toOperationNode());let V=Tn.create(A[0].toOperationNode(),A[1].toOperationNode());for(let Y=2;Y<A.length;++Y)V=Tn.create(V,A[Y].toOperationNode());return new Je(nr.create(V))},or(A){if(A.length===0)return new Je(Rt.createImmediate(!1));if(A.length===1)return new Je(A[0].toOperationNode());let V=Cn.create(A[0].toOperationNode(),A[1].toOperationNode());for(let Y=2;Y<A.length;++Y)V=Cn.create(V,A[Y].toOperationNode());return new Je(nr.create(V))},parens(...A){const V=Mo(A);return nr.is(V)?new Je(V):new Je(nr.create(V))},withSchema(A){return eo(t.withPluginAtFront(new Ur(A)))}});return n.fn=ia(),n.eb=n,n}function ir(t){return eo()}function Bi(t){if(Ct(t))return t.toOperationNode();if(Tt(t))return t(ir()).toOperationNode();throw new Error(`invalid expression: ${JSON.stringify(t)}`)}function aa(t){if(Ct(t))return t.toOperationNode();if(Tt(t))return t(ir()).toOperationNode();throw new Error(`invalid aliased expression: ${JSON.stringify(t)}`)}function Ui(t){return Ls(t)||ol(t)||Tt(t)}function zr(t){return Cr(t)?t.map(e=>Vr(e)):[Vr(t)]}function Vr(t){return we(t)?mu(t):aa(t)}function mu(t){const e=" as ";if(t.includes(e)){const[r,n]=t.split(e).map(la);return _n.create(Nt(r),Ue.create(n))}else return Nt(t)}function Nt(t){const e=".";if(t.includes(e)){const[r,n]=t.split(e).map(la);return mn.createWithSchema(r,n)}else return mn.create(t)}function la(t){return t.trim()}const ua=h({is(t){return t.kind==="AddColumnNode"},create(t){return h({kind:"AddColumnNode",column:t})}}),Ge=h({is(t){return t.kind==="ColumnDefinitionNode"},create(t,e){return h({kind:"ColumnDefinitionNode",column:Ve.create(t),dataType:e})},cloneWithFrontModifier(t,e){return h({...t,frontModifiers:t.frontModifiers?h([...t.frontModifiers,e]):[e]})},cloneWithEndModifier(t,e){return h({...t,endModifiers:t.endModifiers?h([...t.endModifiers,e]):[e]})},cloneWith(t,e){return h({...t,...e})}}),ca=h({is(t){return t.kind==="DropColumnNode"},create(t){return h({kind:"DropColumnNode",column:Ve.create(t)})}}),da=h({is(t){return t.kind==="RenameColumnNode"},create(t,e){return h({kind:"RenameColumnNode",column:Ve.create(t),renameTo:Ve.create(e)})}}),to=h({is(t){return t.kind==="CheckConstraintNode"},create(t,e){return h({kind:"CheckConstraintNode",expression:t,name:e?Ue.create(e):void 0})}}),yu=["no action","restrict","cascade","set null","set default"],Qi=h({is(t){return t.kind==="ReferencesNode"},create(t,e){return h({kind:"ReferencesNode",table:t,columns:h([...e])})},cloneWithOnDelete(t,e){return h({...t,onDelete:e})},cloneWithOnUpdate(t,e){return h({...t,onUpdate:e})}});function fa(t){return Ct(t)?t.toOperationNode():Rt.createImmediate(t)}const ji=h({is(t){return t.kind==="GeneratedNode"},create(t){return h({kind:"GeneratedNode",...t})},createWithExpression(t){return h({kind:"GeneratedNode",always:!0,expression:t})},cloneWith(t,e){return h({...t,...e})}}),gu=h({is(t){return t.kind==="DefaultValueNode"},create(t){return h({kind:"DefaultValueNode",defaultValue:t})}});function zi(t){if(yu.includes(t))return t;throw new Error(`invalid OnModifyForeignAction ${t}`)}const rt=class rt{constructor(e){D(this,Pe,void 0);G(this,Pe,e)}autoIncrement(){return new rt(Ge.cloneWith(o(this,Pe),{autoIncrement:!0}))}primaryKey(){return new rt(Ge.cloneWith(o(this,Pe),{primaryKey:!0}))}references(e){const r=Pn(e);if(!r.table||Ms.is(r.column))throw new Error(`invalid call references('${e}'). The reference must have format table.column or schema.table.column`);return new rt(Ge.cloneWith(o(this,Pe),{references:Qi.create(r.table,[r.column])}))}onDelete(e){if(!o(this,Pe).references)throw new Error("on delete constraint can only be added for foreign keys");return new rt(Ge.cloneWith(o(this,Pe),{references:Qi.cloneWithOnDelete(o(this,Pe).references,zi(e))}))}onUpdate(e){if(!o(this,Pe).references)throw new Error("on update constraint can only be added for foreign keys");return new rt(Ge.cloneWith(o(this,Pe),{references:Qi.cloneWithOnUpdate(o(this,Pe).references,zi(e))}))}unique(){return new rt(Ge.cloneWith(o(this,Pe),{unique:!0}))}notNull(){return new rt(Ge.cloneWith(o(this,Pe),{notNull:!0}))}unsigned(){return new rt(Ge.cloneWith(o(this,Pe),{unsigned:!0}))}defaultTo(e){return new rt(Ge.cloneWith(o(this,Pe),{defaultTo:gu.create(fa(e))}))}check(e){return new rt(Ge.cloneWith(o(this,Pe),{check:to.create(e.toOperationNode())}))}generatedAlwaysAs(e){return new rt(Ge.cloneWith(o(this,Pe),{generated:ji.createWithExpression(e.toOperationNode())}))}generatedAlwaysAsIdentity(){return new rt(Ge.cloneWith(o(this,Pe),{generated:ji.create({identity:!0,always:!0})}))}generatedByDefaultAsIdentity(){return new rt(Ge.cloneWith(o(this,Pe),{generated:ji.create({identity:!0,byDefault:!0})}))}stored(){if(!o(this,Pe).generated)throw new Error("stored() can only be called after generatedAlwaysAs");return new rt(Ge.cloneWith(o(this,Pe),{generated:ji.cloneWith(o(this,Pe).generated,{stored:!0})}))}modifyFront(e){return new rt(Ge.cloneWithFrontModifier(o(this,Pe),e.toOperationNode()))}modifyEnd(e){return new rt(Ge.cloneWithEndModifier(o(this,Pe),e.toOperationNode()))}$call(e){return e(this)}toOperationNode(){return o(this,Pe)}};Pe=new WeakMap;let yn=rt;Ee(yn,"don't await ColumnDefinitionBuilder instances directly.");const ha=h({is(t){return t.kind==="ModifyColumnNode"},create(t){return h({kind:"ModifyColumnNode",column:t})}}),wu=h({is(t){return t.kind==="DataTypeNode"},create(t){return h({kind:"DataTypeNode",dataType:t})}});function sr(t){return Ct(t)?t.toOperationNode():wu.create(t)}const Vi=h({is(t){return t.kind==="ForeignKeyConstraintNode"},create(t,e,r,n){return h({kind:"ForeignKeyConstraintNode",columns:t,references:Qi.create(e,r),name:n?Ue.create(n):void 0})},cloneWith(t,e){return h({...t,...e})}}),_s=class _s{constructor(e){D(this,Qn,void 0);G(this,Qn,e)}onDelete(e){return new _s(Vi.cloneWith(o(this,Qn),{onDelete:zi(e)}))}onUpdate(e){return new _s(Vi.cloneWith(o(this,Qn),{onUpdate:zi(e)}))}$call(e){return e(this)}toOperationNode(){return o(this,Qn)}};Qn=new WeakMap;let Jr=_s;Ee(Jr,"don't await ForeignKeyConstraintBuilder instances directly.");const no=h({is(t){return t.kind==="AddConstraintNode"},create(t){return h({kind:"AddConstraintNode",constraint:t})}}),pa=h({is(t){return t.kind==="UniqueConstraintNode"},create(t,e){return h({kind:"UniqueConstraintNode",columns:h(t.map(Ve.create)),name:e?Ue.create(e):void 0})}}),Ji=h({is(t){return t.kind==="DropConstraintNode"},create(t){return h({kind:"DropConstraintNode",constraintName:Ue.create(t)})},cloneWith(t,e){return h({...t,...e})}}),Gr=h({is(t){return t.kind==="AlterColumnNode"},create(t,e,r){return h({kind:"AlterColumnNode",column:Ve.create(t),[e]:r})}});class ro{constructor(e){D(this,an,void 0);G(this,an,e)}setDataType(e){return new $r(Gr.create(o(this,an),"dataType",sr(e)))}setDefault(e){return new $r(Gr.create(o(this,an),"setDefault",fa(e)))}dropDefault(){return new $r(Gr.create(o(this,an),"dropDefault",!0))}setNotNull(){return new $r(Gr.create(o(this,an),"setNotNull",!0))}dropNotNull(){return new $r(Gr.create(o(this,an),"dropNotNull",!0))}$call(e){return e(this)}}an=new WeakMap;class $r{constructor(e){D(this,si,void 0);G(this,si,e)}toOperationNode(){return o(this,si)}}si=new WeakMap;class Hr{constructor(e){D(this,Qt,void 0);G(this,Qt,h(e))}toOperationNode(){return o(this,Qt).executor.transformQuery(o(this,Qt).node,o(this,Qt).queryId)}compile(){return o(this,Qt).executor.compileQuery(this.toOperationNode(),o(this,Qt).queryId)}async execute(){await o(this,Qt).executor.executeQuery(this.compile(),o(this,Qt).queryId)}}Qt=new WeakMap,Ee(Hr,"don't await AlterTableExecutor instances directly. To execute the query you need to call `execute`");const ms=class ms{constructor(e){D(this,ht,void 0);G(this,ht,h(e))}onDelete(e){return new ms({...o(this,ht),constraintBuilder:o(this,ht).constraintBuilder.onDelete(e)})}onUpdate(e){return new ms({...o(this,ht),constraintBuilder:o(this,ht).constraintBuilder.onUpdate(e)})}$call(e){return e(this)}toOperationNode(){return o(this,ht).executor.transformQuery(Ke.cloneWithTableProps(o(this,ht).node,{addConstraint:no.create(o(this,ht).constraintBuilder.toOperationNode())}),o(this,ht).queryId)}compile(){return o(this,ht).executor.compileQuery(this.toOperationNode(),o(this,ht).queryId)}async execute(){await o(this,ht).executor.executeQuery(this.compile(),o(this,ht).queryId)}};ht=new WeakMap;let Gi=ms;Ee(Gi,"don't await AlterTableAddForeignKeyConstraintBuilder instances directly. To execute the query you need to call `execute`");const oi=class oi{constructor(e){D(this,Ye,void 0);G(this,Ye,h(e))}ifExists(){return new oi({...o(this,Ye),node:Ke.cloneWithTableProps(o(this,Ye).node,{dropConstraint:Ji.cloneWith(o(this,Ye).node.dropConstraint,{ifExists:!0})})})}cascade(){return new oi({...o(this,Ye),node:Ke.cloneWithTableProps(o(this,Ye).node,{dropConstraint:Ji.cloneWith(o(this,Ye).node.dropConstraint,{modifier:"cascade"})})})}restrict(){return new oi({...o(this,Ye),node:Ke.cloneWithTableProps(o(this,Ye).node,{dropConstraint:Ji.cloneWith(o(this,Ye).node.dropConstraint,{modifier:"restrict"})})})}$call(e){return e(this)}toOperationNode(){return o(this,Ye).executor.transformQuery(o(this,Ye).node,o(this,Ye).queryId)}compile(){return o(this,Ye).executor.compileQuery(this.toOperationNode(),o(this,Ye).queryId)}async execute(){await o(this,Ye).executor.executeQuery(this.compile(),o(this,Ye).queryId)}};Ye=new WeakMap;let $i=oi;Ee($i,"don't await AlterTableDropConstraintBuilder instances directly. To execute the query you need to call `execute`");class _a{constructor(e){D(this,Me,void 0);G(this,Me,h(e))}renameTo(e){return new Hr({...o(this,Me),node:Ke.cloneWithTableProps(o(this,Me).node,{renameTo:Nt(e)})})}setSchema(e){return new Hr({...o(this,Me),node:Ke.cloneWithTableProps(o(this,Me).node,{setSchema:Ue.create(e)})})}alterColumn(e,r){const n=r(new ro(e));return new gn({...o(this,Me),node:Ke.cloneWithColumnAlteration(o(this,Me).node,n.toOperationNode())})}dropColumn(e){return new gn({...o(this,Me),node:Ke.cloneWithColumnAlteration(o(this,Me).node,ca.create(e))})}renameColumn(e,r){return new gn({...o(this,Me),node:Ke.cloneWithColumnAlteration(o(this,Me).node,da.create(e,r))})}addColumn(e,r,n=Yn){const A=n(new yn(Ge.create(e,sr(r))));return new gn({...o(this,Me),node:Ke.cloneWithColumnAlteration(o(this,Me).node,ua.create(A.toOperationNode()))})}modifyColumn(e,r,n=Yn){const A=n(new yn(Ge.create(e,sr(r))));return new gn({...o(this,Me),node:Ke.cloneWithColumnAlteration(o(this,Me).node,ha.create(A.toOperationNode()))})}addUniqueConstraint(e,r){return new Hr({...o(this,Me),node:Ke.cloneWithTableProps(o(this,Me).node,{addConstraint:no.create(pa.create(r,e))})})}addCheckConstraint(e,r){return new Hr({...o(this,Me),node:Ke.cloneWithTableProps(o(this,Me).node,{addConstraint:no.create(to.create(r.toOperationNode(),e))})})}addForeignKeyConstraint(e,r,n,A){return new Gi({...o(this,Me),constraintBuilder:new Jr(Vi.create(r.map(Ve.create),Nt(n),A.map(Ve.create),e))})}dropConstraint(e){return new $i({...o(this,Me),node:Ke.cloneWithTableProps(o(this,Me).node,{dropConstraint:Ji.create(e)})})}$call(e){return e(this)}}Me=new WeakMap;const jn=class jn{constructor(e){D(this,$e,void 0);G(this,$e,h(e))}alterColumn(e,r){const n=r(new ro(e));return new jn({...o(this,$e),node:Ke.cloneWithColumnAlteration(o(this,$e).node,n.toOperationNode())})}dropColumn(e){return new jn({...o(this,$e),node:Ke.cloneWithColumnAlteration(o(this,$e).node,ca.create(e))})}renameColumn(e,r){return new jn({...o(this,$e),node:Ke.cloneWithColumnAlteration(o(this,$e).node,da.create(e,r))})}addColumn(e,r,n=Yn){const A=n(new yn(Ge.create(e,sr(r))));return new jn({...o(this,$e),node:Ke.cloneWithColumnAlteration(o(this,$e).node,ua.create(A.toOperationNode()))})}modifyColumn(e,r,n=Yn){const A=n(new yn(Ge.create(e,sr(r))));return new jn({...o(this,$e),node:Ke.cloneWithColumnAlteration(o(this,$e).node,ha.create(A.toOperationNode()))})}toOperationNode(){return o(this,$e).executor.transformQuery(o(this,$e).node,o(this,$e).queryId)}compile(){return o(this,$e).executor.compileQuery(this.toOperationNode(),o(this,$e).queryId)}async execute(){await o(this,$e).executor.executeQuery(this.compile(),o(this,$e).queryId)}};$e=new WeakMap;let gn=jn;Ee(_a,"don't await AlterTableBuilder instances"),Ee(ro,"don't await AlterColumnBuilder instances"),Ee(gn,"don't await AlterTableColumnAlteringBuilder instances directly. To execute the query you need to call `execute`");class ma extends Gs{transformValue(e){return{...super.transformValue(e),immediate:!0}}}const Kt=class Kt{constructor(e){D(this,We,void 0);G(this,We,h(e))}ifNotExists(){return new Kt({...o(this,We),node:hn.cloneWith(o(this,We).node,{ifNotExists:!0})})}unique(){return new Kt({...o(this,We),node:hn.cloneWith(o(this,We).node,{unique:!0})})}on(e){return new Kt({...o(this,We),node:hn.cloneWith(o(this,We).node,{table:Nt(e)})})}column(e){return new Kt({...o(this,We),node:hn.cloneWithColumns(o(this,We).node,[Lo(e)])})}columns(e){return new Kt({...o(this,We),node:hn.cloneWithColumns(o(this,We).node,e.map(Lo))})}expression(e){return new Kt({...o(this,We),node:hn.cloneWithColumns(o(this,We).node,[e.toOperationNode()])})}using(e){return new Kt({...o(this,We),node:hn.cloneWith(o(this,We).node,{using:pt.createWithSql(e)})})}where(...e){const r=new ma;return new Kt({...o(this,We),node:ye.cloneWithWhere(o(this,We).node,r.transformNode(_t(e)))})}$call(e){return e(this)}toOperationNode(){return o(this,We).executor.transformQuery(o(this,We).node,o(this,We).queryId)}compile(){return o(this,We).executor.compileQuery(this.toOperationNode(),o(this,We).queryId)}async execute(){await o(this,We).executor.executeQuery(this.compile(),o(this,We).queryId)}};We=new WeakMap;let Hi=Kt;Ee(Hi,"don't await CreateIndexBuilder instances directly. To execute the query you need to call `execute`");const uo=class uo{constructor(e){D(this,kt,void 0);G(this,kt,h(e))}ifNotExists(){return new uo({...o(this,kt),node:Oo.cloneWith(o(this,kt).node,{ifNotExists:!0})})}$call(e){return e(this)}toOperationNode(){return o(this,kt).executor.transformQuery(o(this,kt).node,o(this,kt).queryId)}compile(){return o(this,kt).executor.compileQuery(this.toOperationNode(),o(this,kt).queryId)}async execute(){await o(this,kt).executor.executeQuery(this.compile(),o(this,kt).queryId)}};kt=new WeakMap;let Ki=uo;Ee(Ki,"don't await CreateSchemaBuilder instances directly. To execute the query you need to call `execute`");const bu=h({is(t){return t.kind==="PrimaryKeyConstraintNode"},create(t,e){return h({kind:"PrimaryKeyConstraintNode",columns:h(t.map(Ve.create)),name:e?Ue.create(e):void 0})}});function qu(t){if(sl.includes(t))return t;throw new Error(`invalid OnCommitAction ${t}`)}const Pt=class Pt{constructor(e){D(this,Se,void 0);G(this,Se,h(e))}temporary(){return new Pt({...o(this,Se),node:Dt.cloneWith(o(this,Se).node,{temporary:!0})})}onCommit(e){return new Pt({...o(this,Se),node:Dt.cloneWith(o(this,Se).node,{onCommit:qu(e)})})}ifNotExists(){return new Pt({...o(this,Se),node:Dt.cloneWith(o(this,Se).node,{ifNotExists:!0})})}addColumn(e,r,n=Yn){const A=n(new yn(Ge.create(e,sr(r))));return new Pt({...o(this,Se),node:Dt.cloneWithColumn(o(this,Se).node,A.toOperationNode())})}addPrimaryKeyConstraint(e,r){return new Pt({...o(this,Se),node:Dt.cloneWithConstraint(o(this,Se).node,bu.create(r,e))})}addUniqueConstraint(e,r){return new Pt({...o(this,Se),node:Dt.cloneWithConstraint(o(this,Se).node,pa.create(r,e))})}addCheckConstraint(e,r){return new Pt({...o(this,Se),node:Dt.cloneWithConstraint(o(this,Se).node,to.create(r.toOperationNode(),e))})}addForeignKeyConstraint(e,r,n,A,V=Yn){const Y=V(new Jr(Vi.create(r.map(Ve.create),Nt(n),A.map(Ve.create),e)));return new Pt({...o(this,Se),node:Dt.cloneWithConstraint(o(this,Se).node,Y.toOperationNode())})}modifyFront(e){return new Pt({...o(this,Se),node:Dt.cloneWithFrontModifier(o(this,Se).node,e.toOperationNode())})}modifyEnd(e){return new Pt({...o(this,Se),node:Dt.cloneWithEndModifier(o(this,Se).node,e.toOperationNode())})}$call(e){return e(this)}toOperationNode(){return o(this,Se).executor.transformQuery(o(this,Se).node,o(this,Se).queryId)}compile(){return o(this,Se).executor.compileQuery(this.toOperationNode(),o(this,Se).queryId)}async execute(){await o(this,Se).executor.executeQuery(this.compile(),o(this,Se).queryId)}};Se=new WeakMap;let Xi=Pt;Ee(Xi,"don't await CreateTableBuilder instances directly. To execute the query you need to call `execute`");const ai=class ai{constructor(e){D(this,at,void 0);G(this,at,h(e))}on(e){return new ai({...o(this,at),node:xi.cloneWith(o(this,at).node,{table:Nt(e)})})}ifExists(){return new ai({...o(this,at),node:xi.cloneWith(o(this,at).node,{ifExists:!0})})}cascade(){return new ai({...o(this,at),node:xi.cloneWith(o(this,at).node,{cascade:!0})})}$call(e){return e(this)}toOperationNode(){return o(this,at).executor.transformQuery(o(this,at).node,o(this,at).queryId)}compile(){return o(this,at).executor.compileQuery(this.toOperationNode(),o(this,at).queryId)}async execute(){await o(this,at).executor.executeQuery(this.compile(),o(this,at).queryId)}};at=new WeakMap;let Yi=ai;Ee(Yi,"don't await DropIndexBuilder instances directly. To execute the query you need to call `execute`");const ys=class ys{constructor(e){D(this,mt,void 0);G(this,mt,h(e))}ifExists(){return new ys({...o(this,mt),node:Ws.cloneWith(o(this,mt).node,{ifExists:!0})})}cascade(){return new ys({...o(this,mt),node:Ws.cloneWith(o(this,mt).node,{cascade:!0})})}$call(e){return e(this)}toOperationNode(){return o(this,mt).executor.transformQuery(o(this,mt).node,o(this,mt).queryId)}compile(){return o(this,mt).executor.compileQuery(this.toOperationNode(),o(this,mt).queryId)}async execute(){await o(this,mt).executor.executeQuery(this.compile(),o(this,mt).queryId)}};mt=new WeakMap;let Zi=ys;Ee(Zi,"don't await DropSchemaBuilder instances directly. To execute the query you need to call `execute`");const gs=class gs{constructor(e){D(this,yt,void 0);G(this,yt,h(e))}ifExists(){return new gs({...o(this,yt),node:Fs.cloneWith(o(this,yt).node,{ifExists:!0})})}cascade(){return new gs({...o(this,yt),node:Fs.cloneWith(o(this,yt).node,{cascade:!0})})}$call(e){return e(this)}toOperationNode(){return o(this,yt).executor.transformQuery(o(this,yt).node,o(this,yt).queryId)}compile(){return o(this,yt).executor.compileQuery(this.toOperationNode(),o(this,yt).queryId)}async execute(){await o(this,yt).executor.executeQuery(this.compile(),o(this,yt).queryId)}};yt=new WeakMap;let es=gs;Ee(es,"don't await DropTableBuilder instances directly. To execute the query you need to call `execute`");const wn=h({is(t){return t.kind==="CreateViewNode"},create(t){return h({kind:"CreateViewNode",name:pn.create(t)})},cloneWith(t,e){return h({...t,...e})}});class Nu{constructor(){D(this,ws,new ma)}transformQuery(e){return o(this,ws).transformNode(e.node)}transformResult(e){return Promise.resolve(e.result)}}ws=new WeakMap;const En=class En{constructor(e){D(this,Qe,void 0);G(this,Qe,h(e))}temporary(){return new En({...o(this,Qe),node:wn.cloneWith(o(this,Qe).node,{temporary:!0})})}materialized(){return new En({...o(this,Qe),node:wn.cloneWith(o(this,Qe).node,{materialized:!0})})}ifNotExists(){return new En({...o(this,Qe),node:wn.cloneWith(o(this,Qe).node,{ifNotExists:!0})})}orReplace(){return new En({...o(this,Qe),node:wn.cloneWith(o(this,Qe).node,{orReplace:!0})})}columns(e){return new En({...o(this,Qe),node:wn.cloneWith(o(this,Qe).node,{columns:e.map(Fo)})})}as(e){const r=e.withPlugin(new Nu).toOperationNode();return new En({...o(this,Qe),node:wn.cloneWith(o(this,Qe).node,{as:r})})}$call(e){return e(this)}toOperationNode(){return o(this,Qe).executor.transformQuery(o(this,Qe).node,o(this,Qe).queryId)}compile(){return o(this,Qe).executor.compileQuery(this.toOperationNode(),o(this,Qe).queryId)}async execute(){await o(this,Qe).executor.executeQuery(this.compile(),o(this,Qe).queryId)}};Qe=new WeakMap;let ts=En;Ee(ts,"don't await CreateViewBuilder instances directly. To execute the query you need to call `execute`");const ns=h({is(t){return t.kind==="DropViewNode"},create(t){return h({kind:"DropViewNode",name:pn.create(t)})},cloneWith(t,e){return h({...t,...e})}}),li=class li{constructor(e){D(this,lt,void 0);G(this,lt,h(e))}materialized(){return new li({...o(this,lt),node:ns.cloneWith(o(this,lt).node,{materialized:!0})})}ifExists(){return new li({...o(this,lt),node:ns.cloneWith(o(this,lt).node,{ifExists:!0})})}cascade(){return new li({...o(this,lt),node:ns.cloneWith(o(this,lt).node,{cascade:!0})})}$call(e){return e(this)}toOperationNode(){return o(this,lt).executor.transformQuery(o(this,lt).node,o(this,lt).queryId)}compile(){return o(this,lt).executor.compileQuery(this.toOperationNode(),o(this,lt).queryId)}async execute(){await o(this,lt).executor.executeQuery(this.compile(),o(this,lt).queryId)}};lt=new WeakMap;let rs=li;Ee(rs,"don't await DropViewBuilder instances directly. To execute the query you need to call `execute`");const ya=h({is(t){return t.kind==="CreateTypeNode"},create(t){return h({kind:"CreateTypeNode",name:t})},cloneWithEnum(t,e){return h({...t,enum:js.create(e.map(r=>Rt.createImmediate(r)))})}}),co=class co{constructor(e){D(this,Ot,void 0);G(this,Ot,h(e))}toOperationNode(){return o(this,Ot).executor.transformQuery(o(this,Ot).node,o(this,Ot).queryId)}asEnum(e){return new co({...o(this,Ot),node:ya.cloneWithEnum(o(this,Ot).node,e)})}$call(e){return e(this)}compile(){return o(this,Ot).executor.compileQuery(this.toOperationNode(),o(this,Ot).queryId)}async execute(){await o(this,Ot).executor.executeQuery(this.compile(),o(this,Ot).queryId)}};Ot=new WeakMap;let is=co;Ee(is,"don't await CreateTypeBuilder instances directly. To execute the query you need to call `execute`");const ga=h({is(t){return t.kind==="DropTypeNode"},create(t){return h({kind:"DropTypeNode",name:t})},cloneWith(t,e){return h({...t,...e})}}),fo=class fo{constructor(e){D(this,At,void 0);G(this,At,h(e))}ifExists(){return new fo({...o(this,At),node:ga.cloneWith(o(this,At).node,{ifExists:!0})})}$call(e){return e(this)}toOperationNode(){return o(this,At).executor.transformQuery(o(this,At).node,o(this,At).queryId)}compile(){return o(this,At).executor.compileQuery(this.toOperationNode(),o(this,At).queryId)}async execute(){await o(this,At).executor.executeQuery(this.compile(),o(this,At).queryId)}};At=new WeakMap;let ss=fo;Ee(ss,"don't await DropTypeBuilder instances directly. To execute the query you need to call `execute`");function wa(t){const e=".";if(t.includes(e)){const r=t.split(e).map(vu);if(r.length===2)return pn.createWithSchema(r[0],r[1]);throw new Error(`invalid schemable identifier ${t}`)}else return pn.create(t)}function vu(t){return t.trim()}const ui=class ui{constructor(e){D(this,it,void 0);G(this,it,e)}createTable(e){return new Xi({queryId:Fe(),executor:o(this,it),node:Dt.create(Nt(e))})}dropTable(e){return new es({queryId:Fe(),executor:o(this,it),node:Fs.create(Nt(e))})}createIndex(e){return new Hi({queryId:Fe(),executor:o(this,it),node:hn.create(e)})}dropIndex(e){return new Yi({queryId:Fe(),executor:o(this,it),node:xi.create(e)})}createSchema(e){return new Ki({queryId:Fe(),executor:o(this,it),node:Oo.create(e)})}dropSchema(e){return new Zi({queryId:Fe(),executor:o(this,it),node:Ws.create(e)})}alterTable(e){return new _a({queryId:Fe(),executor:o(this,it),node:Ke.create(Nt(e))})}createView(e){return new ts({queryId:Fe(),executor:o(this,it),node:wn.create(e)})}dropView(e){return new rs({queryId:Fe(),executor:o(this,it),node:ns.create(e)})}createType(e){return new is({queryId:Fe(),executor:o(this,it),node:ya.create(wa(e))})}dropType(e){return new ss({queryId:Fe(),executor:o(this,it),node:ga.create(wa(e))})}withPlugin(e){return new ui(o(this,it).withPlugin(e))}withoutPlugins(){return new ui(o(this,it).withoutPlugins())}withSchema(e){return new ui(o(this,it).withPluginAtFront(new Ur(e)))}};it=new WeakMap;let io=ui;class xu{ref(e){return new Ol(e)}}class Eu{constructor(e){D(this,Nr,void 0);G(this,Nr,e)}async provideConnection(e){const r=await o(this,Nr).acquireConnection();try{return await e(r)}finally{await o(this,Nr).releaseConnection(r)}}}Nr=new WeakMap;const zn=class zn extends na{constructor(r,n,A,V=[]){super(V);D(this,Xt,void 0);D(this,Yt,void 0);D(this,ln,void 0);G(this,Xt,r),G(this,Yt,n),G(this,ln,A)}get adapter(){return o(this,Yt)}compileQuery(r){return o(this,Xt).compileQuery(r)}provideConnection(r){return o(this,ln).provideConnection(r)}withPlugins(r){return new zn(o(this,Xt),o(this,Yt),o(this,ln),[...this.plugins,...r])}withPlugin(r){return new zn(o(this,Xt),o(this,Yt),o(this,ln),[...this.plugins,r])}withPluginAtFront(r){return new zn(o(this,Xt),o(this,Yt),o(this,ln),[r,...this.plugins])}withConnectionProvider(r){return new zn(o(this,Xt),o(this,Yt),r,[...this.plugins])}withoutPlugins(){return new zn(o(this,Xt),o(this,Yt),o(this,ln),[])}};Xt=new WeakMap,Yt=new WeakMap,ln=new WeakMap;let so=zn;function ba(){return typeof performance<"u"&&Tt(performance.now)?performance.now():Date.now()}class Su{constructor(e,r){D(this,bs);D(this,qs);D(this,Ns);D(this,vs);D(this,di);D(this,jt,void 0);D(this,Sn,void 0);D(this,un,void 0);D(this,Vn,void 0);D(this,ci,new WeakSet);G(this,jt,e),G(this,Sn,r)}async init(){o(this,un)||G(this,un,o(this,jt).init().catch(e=>(G(this,un,void 0),Promise.reject(e)))),await o(this,un)}async acquireConnection(){await this.init();const e=await o(this,jt).acquireConnection();return o(this,ci).has(e)||(Ae(this,bs,Xa).call(this)&&Ae(this,qs,Ya).call(this,e),o(this,ci).add(e)),e}async releaseConnection(e){await o(this,jt).releaseConnection(e)}beginTransaction(e,r){return o(this,jt).beginTransaction(e,r)}commitTransaction(e){return o(this,jt).commitTransaction(e)}rollbackTransaction(e){return o(this,jt).rollbackTransaction(e)}async destroy(){o(this,un)&&(await o(this,un),o(this,Vn)||G(this,Vn,o(this,jt).destroy().catch(e=>(G(this,Vn,void 0),Promise.reject(e)))),await o(this,Vn))}}jt=new WeakMap,Sn=new WeakMap,un=new WeakMap,Vn=new WeakMap,ci=new WeakMap,bs=new WeakSet,Xa=function(){return o(this,Sn).isLevelEnabled("query")||o(this,Sn).isLevelEnabled("error")},qs=new WeakSet,Ya=function(e){const r=e.executeQuery;e.executeQuery=async n=>{const A=ba();try{return await r.call(e,n)}catch(V){throw await Ae(this,Ns,Za).call(this,V,n,A),V}finally{await Ae(this,vs,el).call(this,n,A)}}},Ns=new WeakSet,Za=async function(e,r,n){await o(this,Sn).error(()=>({level:"error",error:e,query:r,queryDurationMillis:Ae(this,di,xo).call(this,n)}))},vs=new WeakSet,el=async function(e,r){await o(this,Sn).query(()=>({level:"query",query:e,queryDurationMillis:Ae(this,di,xo).call(this,r)}))},di=new WeakSet,xo=function(e){return ba()-e};class qa{constructor(e){D(this,xs);D(this,fi,void 0);D(this,kn,void 0);G(this,fi,e)}async provideConnection(e){for(;o(this,kn);)await o(this,kn);const r=Ae(this,xs,tl).call(this,e);return G(this,kn,r.then(()=>{G(this,kn,void 0)}).catch(()=>{G(this,kn,void 0)})),r}}fi=new WeakMap,kn=new WeakMap,xs=new WeakSet,tl=async function(e){return await e(o(this,fi))};const ku=["read uncommitted","read committed","repeatable read","serializable"];h(["query","error"]);class Ou{constructor(e){D(this,On,void 0);D(this,Jn,void 0);Tt(e)?(G(this,Jn,e),G(this,On,h({query:!0,error:!0}))):(G(this,Jn,Au),G(this,On,h({query:e.includes("query"),error:e.includes("error")})))}isLevelEnabled(e){return o(this,On)[e]}async query(e){o(this,On).query&&await o(this,Jn).call(this,e())}async error(e){o(this,On).error&&await o(this,Jn).call(this,e())}}On=new WeakMap,Jn=new WeakMap;function Au(t){t.level==="query"?(console.log(`kysely:query: ${t.query.sql}`),console.log(`kysely:query: duration: ${t.queryDurationMillis.toFixed(1)}ms`)):t.level==="error"&&(t.error instanceof Error?console.error(`kysely:error: ${t.error.stack??t.error.message}`):console.error(`kysely:error: ${t}`))}function Iu(t){return Jt(t)&&Tt(t.compile)}const vr=class vr extends Mi{constructor(r){let n,A;if(Tu(r))n={executor:r.executor},A={...r};else{const V=r.dialect,Y=V.createDriver(),pe=V.createQueryCompiler(),Ie=V.createAdapter(),ct=new Ou(r.log??[]),Ze=new Su(Y,ct),et=new Eu(Ze),se=new so(pe,Ie,et,r.plugins??[]);n={executor:se},A={config:r,executor:se,dialect:V,driver:Ze}}super(n);D(this,ut,void 0);G(this,ut,h(A))}get schema(){return new io(o(this,ut).executor)}get dynamic(){return new xu}get introspection(){return o(this,ut).dialect.createIntrospector(this.withoutPlugins())}case(r){return new sa({node:$t.create(Te(r)?void 0:Bi(r))})}get fn(){return ia()}transaction(){return new os({...o(this,ut)})}connection(){return new Na({...o(this,ut)})}withPlugin(r){return new vr({...o(this,ut),executor:o(this,ut).executor.withPlugin(r)})}withoutPlugins(){return new vr({...o(this,ut),executor:o(this,ut).executor.withoutPlugins()})}withSchema(r){return new vr({...o(this,ut),executor:o(this,ut).executor.withPluginAtFront(new Ur(r))})}withTables(){return new vr({...o(this,ut)})}async destroy(){await o(this,ut).driver.destroy()}get isTransaction(){return!1}getExecutor(){return o(this,ut).executor}executeQuery(r,n=Fe()){const A=Iu(r)?r.compile():r;return this.getExecutor().executeQuery(A,n)}};ut=new WeakMap;let Kr=vr;const xr=class xr extends Kr{constructor(r){super(r);D(this,zt,void 0);G(this,zt,r)}get isTransaction(){return!0}transaction(){throw new Error("calling the transaction method for a Transaction is not supported")}connection(){throw new Error("calling the connection method for a Transaction is not supported")}async destroy(){throw new Error("calling the destroy method for a Transaction is not supported")}withPlugin(r){return new xr({...o(this,zt),executor:o(this,zt).executor.withPlugin(r)})}withoutPlugins(){return new xr({...o(this,zt),executor:o(this,zt).executor.withoutPlugins()})}withSchema(r){return new xr({...o(this,zt),executor:o(this,zt).executor.withPluginAtFront(new Ur(r))})}withTables(){return new xr({...o(this,zt)})}};zt=new WeakMap;let oo=xr;function Tu(t){return Jt(t)&&Jt(t.config)&&Jt(t.driver)&&Jt(t.executor)&&Jt(t.dialect)}class Na{constructor(e){D(this,Gn,void 0);G(this,Gn,h(e))}async execute(e){return o(this,Gn).executor.provideConnection(async r=>{const n=o(this,Gn).executor.withConnectionProvider(new qa(r)),A=new Kr({...o(this,Gn),executor:n});return await e(A)})}}Gn=new WeakMap,Ee(Na,"don't await ConnectionBuilder instances directly. To execute the query you need to call the `execute` method");const ho=class ho{constructor(e){D(this,Vt,void 0);G(this,Vt,h(e))}setIsolationLevel(e){return new ho({...o(this,Vt),isolationLevel:e})}async execute(e){const{isolationLevel:r,...n}=o(this,Vt),A={isolationLevel:r};return Cu(A),o(this,Vt).executor.provideConnection(async V=>{const Y=o(this,Vt).executor.withConnectionProvider(new qa(V)),pe=new oo({...n,executor:Y});try{await o(this,Vt).driver.beginTransaction(V,A);const Ie=await e(pe);return await o(this,Vt).driver.commitTransaction(V),Ie}catch(Ie){throw await o(this,Vt).driver.rollbackTransaction(V),Ie}})}};Vt=new WeakMap;let os=ho;Ee(os,"don't await TransactionBuilder instances directly. To execute the transaction you need to call the `execute` method");function Cu(t){if(t.isolationLevel&&!ku.includes(t.isolationLevel))throw new Error(`invalid transaction isolation level ${t.isolationLevel}`)}const Es=class Es{constructor(e){D(this,Er);D(this,hi);D(this,pi);D(this,vt,void 0);G(this,vt,h(e))}get expressionType(){}as(e){return new Pu(this,e)}$castTo(){return new Es({...o(this,vt)})}castTo(){return this.$castTo()}withPlugin(e){return new Es({...o(this,vt),plugins:o(this,vt).plugins!==void 0?h([...o(this,vt).plugins,e]):h([e])})}toOperationNode(){return Ae(this,hi,Eo).call(this,Ae(this,Er,Ps).call(this))}compile(e){return Ae(this,pi,So).call(this,Ae(this,Er,Ps).call(this,e))}async execute(e){const r=Ae(this,Er,Ps).call(this,e);return r.executeQuery(Ae(this,pi,So).call(this,r),o(this,vt).queryId)}};vt=new WeakMap,Er=new WeakSet,Ps=function(e){const r=e!==void 0?e.getExecutor():$s;return o(this,vt).plugins!==void 0?r.withPlugins(o(this,vt).plugins):r},hi=new WeakSet,Eo=function(e){return e.transformQuery(o(this,vt).rawNode,o(this,vt).queryId)},pi=new WeakSet,So=function(e){return e.compileQuery(Ae(this,hi,Eo).call(this,e),o(this,vt).queryId)};let Mt=Es;Ee(Mt,"don't await RawBuilder instances directly. To execute the query you need to call `execute`");class Pu{constructor(e,r){D(this,Sr,void 0);D(this,An,void 0);G(this,Sr,e),G(this,An,r)}get expression(){return o(this,Sr)}get alias(){return o(this,An)}toOperationNode(){return _n.create(o(this,Sr).toOperationNode(),Ct(o(this,An))?o(this,An).toOperationNode():Ue.create(o(this,An)))}}Sr=new WeakMap,An=new WeakMap;const Et=Object.assign((t,...e)=>new Mt({queryId:Fe(),rawNode:pt.create(t,(e==null?void 0:e.map(rn))??[])}),{ref(t){return new Mt({queryId:Fe(),rawNode:pt.createWithChild(Pn(t))})},val(t){return new Mt({queryId:Fe(),rawNode:pt.createWithChild(rn(t))})},value(t){return this.val(t)},table(t){return new Mt({queryId:Fe(),rawNode:pt.createWithChild(Nt(t))})},id(...t){const e=new Array(t.length+1).fill(".");return e[0]="",e[e.length-1]="",new Mt({queryId:Fe(),rawNode:pt.create(e,t.map(Ue.create))})},lit(t){return new Mt({queryId:Fe(),rawNode:pt.createWithChild(Rt.createImmediate(t))})},literal(t){return this.lit(t)},raw(t){return new Mt({queryId:Fe(),rawNode:pt.createWithSql(t)})},join(t,e=Et`, `){const r=new Array(2*t.length-1),n=e.toOperationNode();for(let A=0;A<t.length;++A)r[2*A]=rn(t[A]),A!==t.length-1&&(r[2*A+1]=n);return new Mt({queryId:Fe(),rawNode:pt.createWithChildren(r)})}});class Wu{constructor(){Oe(this,"nodeStack",[]);D(this,Ss,h({AliasNode:this.visitAlias.bind(this),ColumnNode:this.visitColumn.bind(this),IdentifierNode:this.visitIdentifier.bind(this),SchemableIdentifierNode:this.visitSchemableIdentifier.bind(this),RawNode:this.visitRaw.bind(this),ReferenceNode:this.visitReference.bind(this),SelectQueryNode:this.visitSelectQuery.bind(this),SelectionNode:this.visitSelection.bind(this),TableNode:this.visitTable.bind(this),FromNode:this.visitFrom.bind(this),SelectAllNode:this.visitSelectAll.bind(this),AndNode:this.visitAnd.bind(this),OrNode:this.visitOr.bind(this),ValueNode:this.visitValue.bind(this),ValueListNode:this.visitValueList.bind(this),PrimitiveValueListNode:this.visitPrimitiveValueList.bind(this),ParensNode:this.visitParens.bind(this),JoinNode:this.visitJoin.bind(this),OperatorNode:this.visitOperator.bind(this),WhereNode:this.visitWhere.bind(this),InsertQueryNode:this.visitInsertQuery.bind(this),DeleteQueryNode:this.visitDeleteQuery.bind(this),ReturningNode:this.visitReturning.bind(this),CreateTableNode:this.visitCreateTable.bind(this),AddColumnNode:this.visitAddColumn.bind(this),ColumnDefinitionNode:this.visitColumnDefinition.bind(this),DropTableNode:this.visitDropTable.bind(this),DataTypeNode:this.visitDataType.bind(this),OrderByNode:this.visitOrderBy.bind(this),OrderByItemNode:this.visitOrderByItem.bind(this),GroupByNode:this.visitGroupBy.bind(this),GroupByItemNode:this.visitGroupByItem.bind(this),UpdateQueryNode:this.visitUpdateQuery.bind(this),ColumnUpdateNode:this.visitColumnUpdate.bind(this),LimitNode:this.visitLimit.bind(this),OffsetNode:this.visitOffset.bind(this),OnConflictNode:this.visitOnConflict.bind(this),OnDuplicateKeyNode:this.visitOnDuplicateKey.bind(this),CreateIndexNode:this.visitCreateIndex.bind(this),DropIndexNode:this.visitDropIndex.bind(this),ListNode:this.visitList.bind(this),PrimaryKeyConstraintNode:this.visitPrimaryKeyConstraint.bind(this),UniqueConstraintNode:this.visitUniqueConstraint.bind(this),ReferencesNode:this.visitReferences.bind(this),CheckConstraintNode:this.visitCheckConstraint.bind(this),WithNode:this.visitWith.bind(this),CommonTableExpressionNode:this.visitCommonTableExpression.bind(this),CommonTableExpressionNameNode:this.visitCommonTableExpressionName.bind(this),HavingNode:this.visitHaving.bind(this),CreateSchemaNode:this.visitCreateSchema.bind(this),DropSchemaNode:this.visitDropSchema.bind(this),AlterTableNode:this.visitAlterTable.bind(this),DropColumnNode:this.visitDropColumn.bind(this),RenameColumnNode:this.visitRenameColumn.bind(this),AlterColumnNode:this.visitAlterColumn.bind(this),ModifyColumnNode:this.visitModifyColumn.bind(this),AddConstraintNode:this.visitAddConstraint.bind(this),DropConstraintNode:this.visitDropConstraint.bind(this),ForeignKeyConstraintNode:this.visitForeignKeyConstraint.bind(this),CreateViewNode:this.visitCreateView.bind(this),DropViewNode:this.visitDropView.bind(this),GeneratedNode:this.visitGenerated.bind(this),DefaultValueNode:this.visitDefaultValue.bind(this),OnNode:this.visitOn.bind(this),ValuesNode:this.visitValues.bind(this),SelectModifierNode:this.visitSelectModifier.bind(this),CreateTypeNode:this.visitCreateType.bind(this),DropTypeNode:this.visitDropType.bind(this),ExplainNode:this.visitExplain.bind(this),DefaultInsertValueNode:this.visitDefaultInsertValue.bind(this),AggregateFunctionNode:this.visitAggregateFunction.bind(this),OverNode:this.visitOver.bind(this),PartitionByNode:this.visitPartitionBy.bind(this),PartitionByItemNode:this.visitPartitionByItem.bind(this),SetOperationNode:this.visitSetOperation.bind(this),BinaryOperationNode:this.visitBinaryOperation.bind(this),UnaryOperationNode:this.visitUnaryOperation.bind(this),UsingNode:this.visitUsing.bind(this),FunctionNode:this.visitFunction.bind(this),CaseNode:this.visitCase.bind(this),WhenNode:this.visitWhen.bind(this),JSONReferenceNode:this.visitJSONReference.bind(this),JSONPathNode:this.visitJSONPath.bind(this),JSONPathLegNode:this.visitJSONPathLeg.bind(this),JSONOperatorChainNode:this.visitJSONOperatorChain.bind(this)}));Oe(this,"visitNode",e=>{this.nodeStack.push(e),o(this,Ss)[e.kind](e),this.nodeStack.pop()})}get parentNode(){return this.nodeStack[this.nodeStack.length-2]}}Ss=new WeakMap;class Fu extends Wu{constructor(){super(...arguments);D(this,kr,"");D(this,$n,[])}get numParameters(){return o(this,$n).length}compileQuery(r){return G(this,kr,""),G(this,$n,[]),this.visitNode(r),h({query:r,sql:this.getSql(),parameters:[...o(this,$n)]})}getSql(){return o(this,kr)}visitSelectQuery(r){const n=this.parentNode!==void 0&&!Gt.is(this.parentNode)&&!wn.is(this.parentNode)&&!ra.is(this.parentNode);this.parentNode===void 0&&r.explain&&(this.visitNode(r.explain),this.append(" ")),n&&this.append("("),r.with&&(this.visitNode(r.with),this.append(" ")),this.append("select "),r.distinctOn&&(this.compileDistinctOn(r.distinctOn),this.append(" ")),r.frontModifiers&&r.frontModifiers.length>0&&(this.compileList(r.frontModifiers," "),this.append(" ")),r.selections&&(this.compileList(r.selections),this.append(" ")),this.visitNode(r.from),r.joins&&(this.append(" "),this.compileList(r.joins," ")),r.where&&(this.append(" "),this.visitNode(r.where)),r.groupBy&&(this.append(" "),this.visitNode(r.groupBy)),r.having&&(this.append(" "),this.visitNode(r.having)),r.setOperations&&(this.append(" "),this.compileList(r.setOperations," ")),r.orderBy&&(this.append(" "),this.visitNode(r.orderBy)),r.limit&&(this.append(" "),this.visitNode(r.limit)),r.offset&&(this.append(" "),this.visitNode(r.offset)),r.endModifiers&&r.endModifiers.length>0&&(this.append(" "),this.compileList(r.endModifiers," ")),n&&this.append(")")}visitFrom(r){this.append("from "),this.compileList(r.froms)}visitSelection(r){this.visitNode(r.selection)}visitColumn(r){this.visitNode(r.column)}compileDistinctOn(r){this.append("distinct on ("),this.compileList(r),this.append(")")}compileList(r,n=", "){const A=r.length-1;for(let V=0;V<=A;V++)this.visitNode(r[V]),V<A&&this.append(n)}visitWhere(r){this.append("where "),this.visitNode(r.where)}visitHaving(r){this.append("having "),this.visitNode(r.having)}visitInsertQuery(r){const n=this.nodeStack.find(ye.is)!==r;!n&&r.explain&&(this.visitNode(r.explain),this.append(" ")),n&&this.append("("),r.with&&(this.visitNode(r.with),this.append(" ")),this.append(r.replace?"replace":"insert"),r.ignore&&this.append(" ignore"),this.append(" into "),this.visitNode(r.into),r.columns&&(this.append(" ("),this.compileList(r.columns),this.append(")")),r.values&&(this.append(" "),this.visitNode(r.values)),r.onConflict&&(this.append(" "),this.visitNode(r.onConflict)),r.onDuplicateKey&&(this.append(" "),this.visitNode(r.onDuplicateKey)),r.returning&&(this.append(" "),this.visitNode(r.returning)),n&&this.append(")")}visitValues(r){this.append("values "),this.compileList(r.values)}visitDeleteQuery(r){const n=this.nodeStack.find(ye.is)!==r;!n&&r.explain&&(this.visitNode(r.explain),this.append(" ")),n&&this.append("("),r.with&&(this.visitNode(r.with),this.append(" ")),this.append("delete "),this.visitNode(r.from),r.using&&(this.append(" "),this.visitNode(r.using)),r.joins&&(this.append(" "),this.compileList(r.joins," ")),r.where&&(this.append(" "),this.visitNode(r.where)),r.orderBy&&(this.append(" "),this.visitNode(r.orderBy)),r.limit&&(this.append(" "),this.visitNode(r.limit)),r.returning&&(this.append(" "),this.visitNode(r.returning)),n&&this.append(")")}visitReturning(r){this.append("returning "),this.compileList(r.selections)}visitAlias(r){this.visitNode(r.node),this.append(" as "),this.visitNode(r.alias)}visitReference(r){r.table&&(this.visitNode(r.table),this.append(".")),this.visitNode(r.column)}visitSelectAll(r){this.append("*")}visitIdentifier(r){this.append(this.getLeftIdentifierWrapper()),this.compileUnwrappedIdentifier(r),this.append(this.getRightIdentifierWrapper())}compileUnwrappedIdentifier(r){if(!we(r.name))throw new Error("a non-string identifier was passed to compileUnwrappedIdentifier.");this.append(this.sanitizeIdentifier(r.name))}visitAnd(r){this.visitNode(r.left),this.append(" and "),this.visitNode(r.right)}visitOr(r){this.visitNode(r.left),this.append(" or "),this.visitNode(r.right)}visitValue(r){r.immediate?this.appendImmediateValue(r.value):this.appendValue(r.value)}visitValueList(r){this.append("("),this.compileList(r.values),this.append(")")}visitPrimitiveValueList(r){this.append("(");const{values:n}=r;for(let A=0;A<n.length;++A)this.appendValue(n[A]),A!==n.length-1&&this.append(", ");this.append(")")}visitParens(r){this.append("("),this.visitNode(r.node),this.append(")")}visitJoin(r){this.append(Du[r.joinType]),this.append(" "),this.visitNode(r.table),r.on&&(this.append(" "),this.visitNode(r.on))}visitOn(r){this.append("on "),this.visitNode(r.on)}visitRaw(r){const{sqlFragments:n,parameters:A}=r;for(let V=0;V<n.length;++V)this.append(n[V]),A.length>V&&this.visitNode(A[V])}visitOperator(r){this.append(r.operator)}visitTable(r){this.visitNode(r.table)}visitSchemableIdentifier(r){r.schema&&(this.visitNode(r.schema),this.append(".")),this.visitNode(r.identifier)}visitCreateTable(r){this.append("create "),r.frontModifiers&&r.frontModifiers.length>0&&(this.compileList(r.frontModifiers," "),this.append(" ")),r.temporary&&this.append("temporary "),this.append("table "),r.ifNotExists&&this.append("if not exists "),this.visitNode(r.table),this.append(" ("),this.compileList([...r.columns,...r.constraints??[]]),this.append(")"),r.onCommit&&(this.append(" on commit "),this.append(r.onCommit)),r.endModifiers&&r.endModifiers.length>0&&(this.append(" "),this.compileList(r.endModifiers," "))}visitColumnDefinition(r){this.visitNode(r.column),this.append(" "),this.visitNode(r.dataType),r.unsigned&&this.append(" unsigned"),r.frontModifiers&&r.frontModifiers.length>0&&(this.append(" "),this.compileList(r.frontModifiers," ")),r.generated&&(this.append(" "),this.visitNode(r.generated)),r.defaultTo&&(this.append(" "),this.visitNode(r.defaultTo)),r.notNull&&this.append(" not null"),r.unique&&this.append(" unique"),r.primaryKey&&this.append(" primary key"),r.autoIncrement&&(this.append(" "),this.append(this.getAutoIncrement())),r.references&&(this.append(" "),this.visitNode(r.references)),r.check&&(this.append(" "),this.visitNode(r.check)),r.endModifiers&&r.endModifiers.length>0&&(this.append(" "),this.compileList(r.endModifiers," "))}getAutoIncrement(){return"auto_increment"}visitReferences(r){this.append("references "),this.visitNode(r.table),this.append(" ("),this.compileList(r.columns),this.append(")"),r.onDelete&&(this.append(" on delete "),this.append(r.onDelete)),r.onUpdate&&(this.append(" on update "),this.append(r.onUpdate))}visitDropTable(r){this.append("drop table "),r.ifExists&&this.append("if exists "),this.visitNode(r.table),r.cascade&&this.append(" cascade")}visitDataType(r){this.append(r.dataType)}visitOrderBy(r){this.append("order by "),this.compileList(r.items)}visitOrderByItem(r){this.visitNode(r.orderBy),r.direction&&(this.append(" "),this.visitNode(r.direction))}visitGroupBy(r){this.append("group by "),this.compileList(r.items)}visitGroupByItem(r){this.visitNode(r.groupBy)}visitUpdateQuery(r){const n=this.nodeStack.find(ye.is)!==r;!n&&r.explain&&(this.visitNode(r.explain),this.append(" ")),n&&this.append("("),r.with&&(this.visitNode(r.with),this.append(" ")),this.append("update "),this.visitNode(r.table),this.append(" set "),r.updates&&this.compileList(r.updates),r.from&&(this.append(" "),this.visitNode(r.from)),r.joins&&(this.append(" "),this.compileList(r.joins," ")),r.where&&(this.append(" "),this.visitNode(r.where)),r.returning&&(this.append(" "),this.visitNode(r.returning)),n&&this.append(")")}visitColumnUpdate(r){this.visitNode(r.column),this.append(" = "),this.visitNode(r.value)}visitLimit(r){this.append("limit "),this.visitNode(r.limit)}visitOffset(r){this.append("offset "),this.visitNode(r.offset)}visitOnConflict(r){this.append("on conflict"),r.columns?(this.append(" ("),this.compileList(r.columns),this.append(")")):r.constraint?(this.append(" on constraint "),this.visitNode(r.constraint)):r.indexExpression&&(this.append(" ("),this.visitNode(r.indexExpression),this.append(")")),r.indexWhere&&(this.append(" "),this.visitNode(r.indexWhere)),r.doNothing===!0?this.append(" do nothing"):r.updates&&(this.append(" do update set "),this.compileList(r.updates),r.updateWhere&&(this.append(" "),this.visitNode(r.updateWhere)))}visitOnDuplicateKey(r){this.append("on duplicate key update "),this.compileList(r.updates)}visitCreateIndex(r){this.append("create "),r.unique&&this.append("unique "),this.append("index "),r.ifNotExists&&this.append("if not exists "),this.visitNode(r.name),r.table&&(this.append(" on "),this.visitNode(r.table)),r.using&&(this.append(" using "),this.visitNode(r.using)),r.columns&&(this.append(" ("),this.compileList(r.columns),this.append(")")),r.where&&(this.append(" "),this.visitNode(r.where))}visitDropIndex(r){this.append("drop index "),r.ifExists&&this.append("if exists "),this.visitNode(r.name),r.table&&(this.append(" on "),this.visitNode(r.table)),r.cascade&&this.append(" cascade")}visitCreateSchema(r){this.append("create schema "),r.ifNotExists&&this.append("if not exists "),this.visitNode(r.schema)}visitDropSchema(r){this.append("drop schema "),r.ifExists&&this.append("if exists "),this.visitNode(r.schema),r.cascade&&this.append(" cascade")}visitPrimaryKeyConstraint(r){r.name&&(this.append("constraint "),this.visitNode(r.name),this.append(" ")),this.append("primary key ("),this.compileList(r.columns),this.append(")")}visitUniqueConstraint(r){r.name&&(this.append("constraint "),this.visitNode(r.name),this.append(" ")),this.append("unique ("),this.compileList(r.columns),this.append(")")}visitCheckConstraint(r){r.name&&(this.append("constraint "),this.visitNode(r.name),this.append(" ")),this.append("check ("),this.visitNode(r.expression),this.append(")")}visitForeignKeyConstraint(r){r.name&&(this.append("constraint "),this.visitNode(r.name),this.append(" ")),this.append("foreign key ("),this.compileList(r.columns),this.append(") "),this.visitNode(r.references),r.onDelete&&(this.append(" on delete "),this.append(r.onDelete)),r.onUpdate&&(this.append(" on update "),this.append(r.onUpdate))}visitList(r){this.compileList(r.items)}visitWith(r){this.append("with "),r.recursive&&this.append("recursive "),this.compileList(r.expressions)}visitCommonTableExpression(r){this.visitNode(r.name),this.append(" as "),this.visitNode(r.expression)}visitCommonTableExpressionName(r){this.visitNode(r.table),r.columns&&(this.append("("),this.compileList(r.columns),this.append(")"))}visitAlterTable(r){this.append("alter table "),this.visitNode(r.table),this.append(" "),r.renameTo&&(this.append("rename to "),this.visitNode(r.renameTo)),r.setSchema&&(this.append("set schema "),this.visitNode(r.setSchema)),r.addConstraint&&this.visitNode(r.addConstraint),r.dropConstraint&&this.visitNode(r.dropConstraint),r.columnAlterations&&this.compileList(r.columnAlterations)}visitAddColumn(r){this.append("add column "),this.visitNode(r.column)}visitRenameColumn(r){this.append("rename column "),this.visitNode(r.column),this.append(" to "),this.visitNode(r.renameTo)}visitDropColumn(r){this.append("drop column "),this.visitNode(r.column)}visitAlterColumn(r){this.append("alter column "),this.visitNode(r.column),this.append(" "),r.dataType&&(this.append("type "),this.visitNode(r.dataType),r.dataTypeExpression&&(this.append("using "),this.visitNode(r.dataTypeExpression))),r.setDefault&&(this.append("set default "),this.visitNode(r.setDefault)),r.dropDefault&&this.append("drop default"),r.setNotNull&&this.append("set not null"),r.dropNotNull&&this.append("drop not null")}visitModifyColumn(r){this.append("modify column "),this.visitNode(r.column)}visitAddConstraint(r){this.append("add "),this.visitNode(r.constraint)}visitDropConstraint(r){this.append("drop constraint "),r.ifExists&&this.append("if exists "),this.visitNode(r.constraintName),r.modifier==="cascade"?this.append(" cascade"):r.modifier==="restrict"&&this.append(" restrict")}visitSetOperation(r){this.append(r.operator),this.append(" "),r.all&&this.append("all "),this.visitNode(r.expression)}visitCreateView(r){this.append("create "),r.orReplace&&this.append("or replace "),r.materialized&&this.append("materialized "),r.temporary&&this.append("temporary "),this.append("view "),r.ifNotExists&&this.append("if not exists "),this.visitNode(r.name),this.append(" "),r.columns&&(this.append("("),this.compileList(r.columns),this.append(") ")),r.as&&(this.append("as "),this.visitNode(r.as))}visitDropView(r){this.append("drop "),r.materialized&&this.append("materialized "),this.append("view "),r.ifExists&&this.append("if exists "),this.visitNode(r.name),r.cascade&&this.append(" cascade")}visitGenerated(r){this.append("generated "),r.always&&this.append("always "),r.byDefault&&this.append("by default "),this.append("as "),r.identity&&this.append("identity"),r.expression&&(this.append("("),this.visitNode(r.expression),this.append(")")),r.stored&&this.append(" stored")}visitDefaultValue(r){this.append("default "),this.visitNode(r.defaultValue)}visitSelectModifier(r){r.rawModifier?this.visitNode(r.rawModifier):this.append(Lu[r.modifier])}visitCreateType(r){this.append("create type "),this.visitNode(r.name),r.enum&&(this.append(" as enum "),this.visitNode(r.enum))}visitDropType(r){this.append("drop type "),r.ifExists&&this.append("if exists "),this.visitNode(r.name)}visitExplain(r){this.append("explain"),(r.options||r.format)&&(this.append(" "),this.append(this.getLeftExplainOptionsWrapper()),r.options&&(this.visitNode(r.options),r.format&&this.append(this.getExplainOptionsDelimiter())),r.format&&(this.append("format"),this.append(this.getExplainOptionAssignment()),this.append(r.format)),this.append(this.getRightExplainOptionsWrapper()))}visitDefaultInsertValue(r){this.append("default")}visitAggregateFunction(r){this.append(r.func),this.append("("),r.distinct&&this.append("distinct "),this.compileList(r.aggregated),this.append(")"),r.filter&&(this.append(" filter("),this.visitNode(r.filter),this.append(")")),r.over&&(this.append(" "),this.visitNode(r.over))}visitOver(r){this.append("over("),r.partitionBy&&(this.visitNode(r.partitionBy),r.orderBy&&this.append(" ")),r.orderBy&&this.visitNode(r.orderBy),this.append(")")}visitPartitionBy(r){this.append("partition by "),this.compileList(r.items)}visitPartitionByItem(r){this.visitNode(r.partitionBy)}visitBinaryOperation(r){this.visitNode(r.leftOperand),this.append(" "),this.visitNode(r.operator),this.append(" "),this.visitNode(r.rightOperand)}visitUnaryOperation(r){this.visitNode(r.operator),this.isMinusOperator(r.operator)||this.append(" "),this.visitNode(r.operand)}isMinusOperator(r){return Wr.is(r)&&r.operator==="-"}visitUsing(r){this.append("using "),this.compileList(r.tables)}visitFunction(r){this.append(r.func),this.append("("),this.compileList(r.arguments),this.append(")")}visitCase(r){this.append("case"),r.value&&(this.append(" "),this.visitNode(r.value)),r.when&&(this.append(" "),this.compileList(r.when," ")),r.else&&(this.append(" else "),this.visitNode(r.else)),this.append(" end"),r.isStatement&&this.append(" case")}visitWhen(r){this.append("when "),this.visitNode(r.condition),r.result&&(this.append(" then "),this.visitNode(r.result))}visitJSONReference(r){this.visitNode(r.reference),this.visitNode(r.traversal)}visitJSONPath(r){r.inOperator&&this.visitNode(r.inOperator),this.append("'$");for(const n of r.pathLegs)this.visitNode(n);this.append("'")}visitJSONPathLeg(r){const n=r.type==="ArrayLocation";this.append(n?"[":"."),this.append(String(r.value)),n&&this.append("]")}visitJSONOperatorChain(r){for(let n=0,A=r.values.length;n<A;n++)n===A-1?this.visitNode(r.operator):this.append("->"),this.visitNode(r.values[n])}append(r){G(this,kr,o(this,kr)+r)}appendValue(r){this.addParameter(r),this.append(this.getCurrentParameterPlaceholder())}getLeftIdentifierWrapper(){return'"'}getRightIdentifierWrapper(){return'"'}getCurrentParameterPlaceholder(){return"$"+this.numParameters}getLeftExplainOptionsWrapper(){return"("}getExplainOptionAssignment(){return" "}getExplainOptionsDelimiter(){return", "}getRightExplainOptionsWrapper(){return")"}sanitizeIdentifier(r){const n=this.getLeftIdentifierWrapper(),A=this.getRightIdentifierWrapper();let V="";for(const Y of r)V+=Y,Y===n?V+=n:Y===A&&(V+=A);return V}addParameter(r){o(this,$n).push(r)}appendImmediateValue(r){if(we(r))this.append(`'${r}'`);else if(He(r)||Tr(r))this.append(r.toString());else if(ko(r))this.append("null");else if(rl(r))this.appendImmediateValue(r.toISOString());else if(il(r))this.appendImmediateValue(r.toString());else throw new Error(`invalid immediate value ${r}`)}}kr=new WeakMap,$n=new WeakMap;const Lu=h({ForKeyShare:"for key share",ForNoKeyUpdate:"for no key update",ForUpdate:"for update",ForShare:"for share",NoWait:"nowait",SkipLocked:"skip locked",Distinct:"distinct"}),Du=h({InnerJoin:"inner join",LeftJoin:"left join",RightJoin:"right join",FullJoin:"full join",LateralInnerJoin:"inner join lateral",LateralLeftJoin:"left join lateral"}),bn=h({raw(t,e=[]){return h({sql:t,query:pt.createWithSql(t),parameters:h(e)})}}),Ru=/"/g;class Mu extends Fu{getCurrentParameterPlaceholder(){return"?"}getLeftExplainOptionsWrapper(){return""}getRightExplainOptionsWrapper(){return""}getLeftIdentifierWrapper(){return'"'}getRightIdentifierWrapper(){return'"'}getAutoIncrement(){return"autoincrement"}sanitizeIdentifier(e){return e.replace(Ru,'""')}visitDefaultInsertValue(e){this.append("null")}}const Bu="kysely_migration",Uu="kysely_migration_lock";h({__noMigrations__:!0});class Qu{constructor(e){D(this,ks);D(this,Or,void 0);G(this,Or,e)}async getSchemas(){return[]}async getTables(e={withInternalKyselyTables:!1}){let r=o(this,Or).selectFrom("sqlite_master").where("type","in",["table","view"]).where("name","not like","sqlite_%").select("name").orderBy("name").$castTo();e.withInternalKyselyTables||(r=r.where("name","!=",Bu).where("name","!=",Uu));const n=await r.execute();return Promise.all(n.map(({name:A})=>Ae(this,ks,nl).call(this,A)))}async getMetadata(e){return{tables:await this.getTables(e)}}}Or=new WeakMap,ks=new WeakSet,nl=async function(e){var Y,pe,Ie,ct,Ze,et;const r=o(this,Or),n=await r.selectFrom("sqlite_master").where("name","=",e).select(["sql","type"]).$castTo().executeTakeFirstOrThrow(),A=(et=(Ze=(ct=(Ie=(pe=(Y=n.sql)==null?void 0:Y.split(/[\(\),]/))==null?void 0:pe.find(se=>se.toLowerCase().includes("autoincrement")))==null?void 0:Ie.trimStart())==null?void 0:ct.split(/\s+/))==null?void 0:Ze[0])==null?void 0:et.replace(/["`]/g,""),V=await r.selectFrom(Et`pragma_table_info(${e})`.as("table_info")).select(["name","type","notnull","dflt_value"]).orderBy("cid").execute();return{name:e,isView:n.type==="view",columns:V.map(se=>({name:se.name,dataType:se.type,isNullable:!se.notnull,isAutoIncrementing:se.name===A,hasDefaultValue:se.dflt_value!=null}))}};class ju{get supportsTransactionalDdl(){return!1}get supportsReturning(){return!0}async acquireMigrationLock(){}async releaseMigrationLock(){}}var zu=class{createQueryCompiler(){return new Mu}createAdapter(){return new ju}createIntrospector(t){return new Qu(t)}},Vu=(xa=class{constructor(){D(this,_i,new Ju);Oe(this,"connection")}async acquireConnection(){return await o(this,_i).lock(),this.connection}async beginTransaction(t){await t.executeQuery(bn.raw("begin"))}async commitTransaction(t){await t.executeQuery(bn.raw("commit"))}async rollbackTransaction(t){await t.executeQuery(bn.raw("rollback"))}async releaseConnection(){o(this,_i).unlock()}},_i=new WeakMap,xa),Ju=class{constructor(){Oe(this,"promise");Oe(this,"resolve")}async lock(){for(;this.promise;)await this.promise;this.promise=new Promise(t=>{this.resolve=t})}unlock(){const t=this.resolve;this.promise=void 0,this.resolve=void 0,t==null||t()}},Gu=class{streamQuery(){throw new Error("Sqlite driver doesn't support streaming")}async executeQuery(t){const{parameters:e,sql:r,query:n}=t;return["SelectQueryNode","RawNode"].includes(n.kind)?{rows:await this.query(r,e)}:{rows:[],...await this.exec(r,e)}}},$u=class extends Vu{constructor(e){super();Oe(this,"config");Oe(this,"db");this.config=e}async init(){var e,r;this.db=typeof this.config.database=="function"?await this.config.database():this.config.database,this.connection=new Hu(this.db),await((r=(e=this.config).onCreateConnection)==null?void 0:r.call(e,this.connection))}async destroy(){var e;(e=this.db)==null||e.close()}},Hu=class extends Gu{constructor(e){super();Oe(this,"db");this.db=e}query(e,r){const n=[];return this.db.exec({sql:e,bind:r??[],rowMode:"object",resultRows:n}),n}exec(e,r){return this.db.exec({sql:e,bind:r??[]}),{numAffectedRows:BigInt(this.db.changes(!1,!0)),insertId:BigInt(this.query("SELECT last_insert_rowid() as id")[0].id)}}},Ku=(Ea=class extends zu{constructor(e){super();D(this,mi,void 0);G(this,mi,e)}createDriver(){return new $u(o(this,mi))}},mi=new WeakMap,Ea);async function Xu(t,e=4096,r=32*1024){await t.executeQuery(bn.raw(`PRAGMA cache_size = ${e};`)),await t.executeQuery(bn.raw("PRAGMA journal_mode = WAL;")),await t.executeQuery(bn.raw("PRAGMA temp_store = MEMORY;")),await t.executeQuery(bn.raw(`PRAGMA page_size = ${r};`)),await t.executeQuery(bn.raw("PRAGMA synchronous = NORMAL;"))}var Yu=(()=>{var t=self.location.href;return function(e){var r=e||{},n=typeof r<"u"?r:{},A,V;n.ready=new Promise(function(s,i){A=s,V=i});const Y=globalThis.sqlite3InitModuleState||Object.assign(Object.create(null),{debugModule:()=>{}});delete globalThis.sqlite3InitModuleState,Y.debugModule("globalThis.location =",globalThis.location);const pe="emscripten-bug-17951";n[pe]=function s(i,l){i.env.foo=function(){};const a=n.locateFile(s.uri,typeof se>"u"?"":se);Y.debugModule("instantiateWasm() uri =",a);const u=()=>fetch(a,{credentials:"same-origin"});return(WebAssembly.instantiateStreaming?async()=>WebAssembly.instantiateStreaming(u(),i).then(N=>l(N.instance,N.module)):async()=>u().then(N=>N.arrayBuffer()).then(N=>WebAssembly.instantiate(N,i)).then(N=>l(N.instance,N.module)))(),{}},n[pe].uri="sqlite3.wasm";var Ie=Object.assign({},n),ct="./this.program",Ze=typeof window=="object",et=typeof importScripts=="function";typeof process=="object"&&typeof process.versions=="object"&&process.versions.node;var se="";function Wt(s){return n.locateFile?n.locateFile(s,se):se+s}var Be,cn,yi;(Ze||et)&&(et?se=self.location.href:typeof document<"u"&&document.currentScript&&(se=document.currentScript.src),t&&(se=t),se.indexOf("blob:")!==0?se=se.substr(0,se.replace(/[?#].*/,"").lastIndexOf("/")+1):se="",Be=s=>{var i=new XMLHttpRequest;return i.open("GET",s,!1),i.send(null),i.responseText},et&&(yi=s=>{var i=new XMLHttpRequest;return i.open("GET",s,!1),i.responseType="arraybuffer",i.send(null),new Uint8Array(i.response)}),cn=(s,i,l)=>{var a=new XMLHttpRequest;a.open("GET",s,!0),a.responseType="arraybuffer",a.onload=()=>{if(a.status==200||a.status==0&&a.response){i(a.response);return}l()},a.onerror=l,a.send(null)});var dn=n.print||console.log.bind(console),gt=n.printErr||console.warn.bind(console);Object.assign(n,Ie),Ie=null,n.arguments&&n.arguments,n.thisProgram&&(ct=n.thisProgram),n.quit&&n.quit;var gi;n.wasmBinary&&(gi=n.wasmBinary),n.noExitRuntime,typeof WebAssembly!="object"&&Kn("no native wasm support detected");var In,Sa=!1;function cc(s,i){s||Kn(i)}var ka=typeof TextDecoder<"u"?new TextDecoder("utf8"):void 0;function Ar(s,i,l){for(var a=i+l,u=i;s[u]&&!(u>=a);)++u;if(u-i>16&&s.buffer&&ka)return ka.decode(s.subarray(i,u));for(var d="";i<u;){var N=s[i++];if(!(N&128)){d+=String.fromCharCode(N);continue}var S=s[i++]&63;if((N&224)==192){d+=String.fromCharCode((N&31)<<6|S);continue}var C=s[i++]&63;if((N&240)==224?N=(N&15)<<12|S<<6|C:N=(N&7)<<18|S<<12|C<<6|s[i++]&63,N<65536)d+=String.fromCharCode(N);else{var z=N-65536;d+=String.fromCharCode(55296|z>>10,56320|z&1023)}}return d}function dc(s,i){return s?Ar(bi,s,i):""}function Os(s,i,l,a){if(!(a>0))return 0;for(var u=l,d=l+a-1,N=0;N<s.length;++N){var S=s.charCodeAt(N);if(S>=55296&&S<=57343){var C=s.charCodeAt(++N);S=65536+((S&1023)<<10)|C&1023}if(S<=127){if(l>=d)break;i[l++]=S}else if(S<=2047){if(l+1>=d)break;i[l++]=192|S>>6,i[l++]=128|S&63}else if(S<=65535){if(l+2>=d)break;i[l++]=224|S>>12,i[l++]=128|S>>6&63,i[l++]=128|S&63}else{if(l+3>=d)break;i[l++]=240|S>>18,i[l++]=128|S>>12&63,i[l++]=128|S>>6&63,i[l++]=128|S&63}}return i[l]=0,l-u}function Oa(s,i,l){return Os(s,bi,i,l)}function wi(s){for(var i=0,l=0;l<s.length;++l){var a=s.charCodeAt(l);a<=127?i++:a<=2047?i+=2:a>=55296&&a<=57343?(i+=4,++l):i+=3}return i}var It,bi,Aa,me,tt;function Ia(){var s=In.buffer;n.HEAP8=It=new Int8Array(s),n.HEAP16=Aa=new Int16Array(s),n.HEAP32=me=new Int32Array(s),n.HEAPU8=bi=new Uint8Array(s),n.HEAPU16=new Uint16Array(s),n.HEAPU32=tt=new Uint32Array(s),n.HEAPF32=new Float32Array(s),n.HEAPF64=new Float64Array(s),n.HEAP64=new BigInt64Array(s),n.HEAPU64=new BigUint64Array(s)}var Ta=n.INITIAL_MEMORY||16777216;n.wasmMemory?In=n.wasmMemory:In=new WebAssembly.Memory({initial:Ta/65536,maximum:2147483648/65536}),Ia(),Ta=In.buffer.byteLength;var Ca=[],Pa=[],Wa=[];function fc(){if(n.preRun)for(typeof n.preRun=="function"&&(n.preRun=[n.preRun]);n.preRun.length;)_c(n.preRun.shift());_o(Ca)}function hc(){!n.noFSInit&&!c.init.initialized&&c.init(),c.ignorePermissions=!1,_o(Pa)}function pc(){if(n.postRun)for(typeof n.postRun=="function"&&(n.postRun=[n.postRun]);n.postRun.length;)yc(n.postRun.shift());_o(Wa)}function _c(s){Ca.unshift(s)}function mc(s){Pa.unshift(s)}function yc(s){Wa.unshift(s)}var Hn=0,qi=null;function qd(s){return s}function po(s){Hn++,n.monitorRunDependencies&&n.monitorRunDependencies(Hn)}function As(s){if(Hn--,n.monitorRunDependencies&&n.monitorRunDependencies(Hn),Hn==0&&qi){var i=qi;qi=null,i()}}function Kn(s){n.onAbort&&n.onAbort(s),s="Aborted("+s+")",gt(s),Sa=!0,s+=". Build with -sASSERTIONS for more info.";var i=new WebAssembly.RuntimeError(s);throw V(i),i}var gc="data:application/octet-stream;base64,";function Fa(s){return s.startsWith(gc)}var Ft;n.locateFile?(Ft="sqlite3.wasm",Fa(Ft)||(Ft=Wt(Ft))):Ft=new URL(""+new URL("sqlite3-14470338.wasm",self.location.href).href,self.location).href;function La(s){try{if(s==Ft&&gi)return new Uint8Array(gi);if(yi)return yi(s);throw"both async and sync fetching of the wasm failed"}catch(i){Kn(i)}}function wc(){return!gi&&(Ze||et)&&typeof fetch=="function"?fetch(Ft,{credentials:"same-origin"}).then(function(s){if(!s.ok)throw"failed to load wasm binary file at '"+Ft+"'";return s.arrayBuffer()}).catch(function(){return La(Ft)}):Promise.resolve().then(function(){return La(Ft)})}function bc(){var s={env:Qa,wasi_snapshot_preview1:Qa};function i(N,S){var C=N.exports;n.asm=C,n.asm.__indirect_function_table,mc(n.asm.__wasm_call_ctors),As()}po();function l(N){i(N.instance)}function a(N){return wc().then(function(S){return WebAssembly.instantiate(S,s)}).then(function(S){return S}).then(N,function(S){gt("failed to asynchronously prepare wasm: "+S),Kn(S)})}function u(){return!gi&&typeof WebAssembly.instantiateStreaming=="function"&&!Fa(Ft)&&typeof fetch=="function"?fetch(Ft,{credentials:"same-origin"}).then(function(N){var S=WebAssembly.instantiateStreaming(N,s);return S.then(l,function(C){return gt("wasm streaming compile failed: "+C),gt("falling back to ArrayBuffer instantiation"),a(l)})}):a(l)}if(n.instantiateWasm)try{var d=n.instantiateWasm(s,i);return d}catch(N){gt("Module.instantiateWasm callback failed with error: "+N),V(N)}return u().catch(V),{}}var ge,st;function _o(s){for(;s.length>0;)s.shift()(n)}var ve={isAbs:s=>s.charAt(0)==="/",splitPath:s=>{var i=/^(\/?|)([\s\S]*?)((?:\.{1,2}|[^\/]+?|)(\.[^.\/]*|))(?:[\/]*)$/;return i.exec(s).slice(1)},normalizeArray:(s,i)=>{for(var l=0,a=s.length-1;a>=0;a--){var u=s[a];u==="."?s.splice(a,1):u===".."?(s.splice(a,1),l++):l&&(s.splice(a,1),l--)}if(i)for(;l;l--)s.unshift("..");return s},normalize:s=>{var i=ve.isAbs(s),l=s.substr(-1)==="/";return s=ve.normalizeArray(s.split("/").filter(a=>!!a),!i).join("/"),!s&&!i&&(s="."),s&&l&&(s+="/"),(i?"/":"")+s},dirname:s=>{var i=ve.splitPath(s),l=i[0],a=i[1];return!l&&!a?".":(a&&(a=a.substr(0,a.length-1)),l+a)},basename:s=>{if(s==="/")return"/";s=ve.normalize(s),s=s.replace(/\/$/,"");var i=s.lastIndexOf("/");return i===-1?s:s.substr(i+1)},join:function(){var s=Array.prototype.slice.call(arguments);return ve.normalize(s.join("/"))},join2:(s,i)=>ve.normalize(s+"/"+i)};function qc(){if(typeof crypto=="object"&&typeof crypto.getRandomValues=="function"){var s=new Uint8Array(1);return()=>(crypto.getRandomValues(s),s[0])}else return()=>Kn("randomDevice")}var fn={resolve:function(){for(var s="",i=!1,l=arguments.length-1;l>=-1&&!i;l--){var a=l>=0?arguments[l]:c.cwd();if(typeof a!="string")throw new TypeError("Arguments to path.resolve must be strings");if(!a)return"";s=a+"/"+s,i=ve.isAbs(a)}return s=ve.normalizeArray(s.split("/").filter(u=>!!u),!i).join("/"),(i?"/":"")+s||"."},relative:(s,i)=>{s=fn.resolve(s).substr(1),i=fn.resolve(i).substr(1);function l(z){for(var K=0;K<z.length&&z[K]==="";K++);for(var te=z.length-1;te>=0&&z[te]==="";te--);return K>te?[]:z.slice(K,te-K+1)}for(var a=l(s.split("/")),u=l(i.split("/")),d=Math.min(a.length,u.length),N=d,S=0;S<d;S++)if(a[S]!==u[S]){N=S;break}for(var C=[],S=N;S<a.length;S++)C.push("..");return C=C.concat(u.slice(N)),C.join("/")}};function mo(s,i,l){var a=l>0?l:wi(s)+1,u=new Array(a),d=Os(s,u,0,u.length);return i&&(u.length=d),u}var Xn={ttys:[],init:function(){},shutdown:function(){},register:function(s,i){Xn.ttys[s]={input:[],output:[],ops:i},c.registerDevice(s,Xn.stream_ops)},stream_ops:{open:function(s){var i=Xn.ttys[s.node.rdev];if(!i)throw new c.ErrnoError(43);s.tty=i,s.seekable=!1},close:function(s){s.tty.ops.fsync(s.tty)},fsync:function(s){s.tty.ops.fsync(s.tty)},read:function(s,i,l,a,u){if(!s.tty||!s.tty.ops.get_char)throw new c.ErrnoError(60);for(var d=0,N=0;N<a;N++){var S;try{S=s.tty.ops.get_char(s.tty)}catch{throw new c.ErrnoError(29)}if(S===void 0&&d===0)throw new c.ErrnoError(6);if(S==null)break;d++,i[l+N]=S}return d&&(s.node.timestamp=Date.now()),d},write:function(s,i,l,a,u){if(!s.tty||!s.tty.ops.put_char)throw new c.ErrnoError(60);try{for(var d=0;d<a;d++)s.tty.ops.put_char(s.tty,i[l+d])}catch{throw new c.ErrnoError(29)}return a&&(s.node.timestamp=Date.now()),d}},default_tty_ops:{get_char:function(s){if(!s.input.length){var i=null;if(typeof window<"u"&&typeof window.prompt=="function"?(i=window.prompt("Input: "),i!==null&&(i+=`
`)):typeof readline=="function"&&(i=readline(),i!==null&&(i+=`
`)),!i)return null;s.input=mo(i,!0)}return s.input.shift()},put_char:function(s,i){i===null||i===10?(dn(Ar(s.output,0)),s.output=[]):i!=0&&s.output.push(i)},fsync:function(s){s.output&&s.output.length>0&&(dn(Ar(s.output,0)),s.output=[])}},default_tty1_ops:{put_char:function(s,i){i===null||i===10?(gt(Ar(s.output,0)),s.output=[]):i!=0&&s.output.push(i)},fsync:function(s){s.output&&s.output.length>0&&(gt(Ar(s.output,0)),s.output=[])}}};function Da(s){Kn()}var fe={ops_table:null,mount:function(s){return fe.createNode(null,"/",16895,0)},createNode:function(s,i,l,a){if(c.isBlkdev(l)||c.isFIFO(l))throw new c.ErrnoError(63);fe.ops_table||(fe.ops_table={dir:{node:{getattr:fe.node_ops.getattr,setattr:fe.node_ops.setattr,lookup:fe.node_ops.lookup,mknod:fe.node_ops.mknod,rename:fe.node_ops.rename,unlink:fe.node_ops.unlink,rmdir:fe.node_ops.rmdir,readdir:fe.node_ops.readdir,symlink:fe.node_ops.symlink},stream:{llseek:fe.stream_ops.llseek}},file:{node:{getattr:fe.node_ops.getattr,setattr:fe.node_ops.setattr},stream:{llseek:fe.stream_ops.llseek,read:fe.stream_ops.read,write:fe.stream_ops.write,allocate:fe.stream_ops.allocate,mmap:fe.stream_ops.mmap,msync:fe.stream_ops.msync}},link:{node:{getattr:fe.node_ops.getattr,setattr:fe.node_ops.setattr,readlink:fe.node_ops.readlink},stream:{}},chrdev:{node:{getattr:fe.node_ops.getattr,setattr:fe.node_ops.setattr},stream:c.chrdev_stream_ops}});var u=c.createNode(s,i,l,a);return c.isDir(u.mode)?(u.node_ops=fe.ops_table.dir.node,u.stream_ops=fe.ops_table.dir.stream,u.contents={}):c.isFile(u.mode)?(u.node_ops=fe.ops_table.file.node,u.stream_ops=fe.ops_table.file.stream,u.usedBytes=0,u.contents=null):c.isLink(u.mode)?(u.node_ops=fe.ops_table.link.node,u.stream_ops=fe.ops_table.link.stream):c.isChrdev(u.mode)&&(u.node_ops=fe.ops_table.chrdev.node,u.stream_ops=fe.ops_table.chrdev.stream),u.timestamp=Date.now(),s&&(s.contents[i]=u,s.timestamp=u.timestamp),u},getFileDataAsTypedArray:function(s){return s.contents?s.contents.subarray?s.contents.subarray(0,s.usedBytes):new Uint8Array(s.contents):new Uint8Array(0)},expandFileStorage:function(s,i){var l=s.contents?s.contents.length:0;if(!(l>=i)){var a=1024*1024;i=Math.max(i,l*(l<a?2:1.125)>>>0),l!=0&&(i=Math.max(i,256));var u=s.contents;s.contents=new Uint8Array(i),s.usedBytes>0&&s.contents.set(u.subarray(0,s.usedBytes),0)}},resizeFileStorage:function(s,i){if(s.usedBytes!=i)if(i==0)s.contents=null,s.usedBytes=0;else{var l=s.contents;s.contents=new Uint8Array(i),l&&s.contents.set(l.subarray(0,Math.min(i,s.usedBytes))),s.usedBytes=i}},node_ops:{getattr:function(s){var i={};return i.dev=c.isChrdev(s.mode)?s.id:1,i.ino=s.id,i.mode=s.mode,i.nlink=1,i.uid=0,i.gid=0,i.rdev=s.rdev,c.isDir(s.mode)?i.size=4096:c.isFile(s.mode)?i.size=s.usedBytes:c.isLink(s.mode)?i.size=s.link.length:i.size=0,i.atime=new Date(s.timestamp),i.mtime=new Date(s.timestamp),i.ctime=new Date(s.timestamp),i.blksize=4096,i.blocks=Math.ceil(i.size/i.blksize),i},setattr:function(s,i){i.mode!==void 0&&(s.mode=i.mode),i.timestamp!==void 0&&(s.timestamp=i.timestamp),i.size!==void 0&&fe.resizeFileStorage(s,i.size)},lookup:function(s,i){throw c.genericErrors[44]},mknod:function(s,i,l,a){return fe.createNode(s,i,l,a)},rename:function(s,i,l){if(c.isDir(s.mode)){var a;try{a=c.lookupNode(i,l)}catch{}if(a)for(var u in a.contents)throw new c.ErrnoError(55)}delete s.parent.contents[s.name],s.parent.timestamp=Date.now(),s.name=l,i.contents[l]=s,i.timestamp=s.parent.timestamp,s.parent=i},unlink:function(s,i){delete s.contents[i],s.timestamp=Date.now()},rmdir:function(s,i){var l=c.lookupNode(s,i);for(var a in l.contents)throw new c.ErrnoError(55);delete s.contents[i],s.timestamp=Date.now()},readdir:function(s){var i=[".",".."];for(var l in s.contents)s.contents.hasOwnProperty(l)&&i.push(l);return i},symlink:function(s,i,l){var a=fe.createNode(s,i,41471,0);return a.link=l,a},readlink:function(s){if(!c.isLink(s.mode))throw new c.ErrnoError(28);return s.link}},stream_ops:{read:function(s,i,l,a,u){var d=s.node.contents;if(u>=s.node.usedBytes)return 0;var N=Math.min(s.node.usedBytes-u,a);if(N>8&&d.subarray)i.set(d.subarray(u,u+N),l);else for(var S=0;S<N;S++)i[l+S]=d[u+S];return N},write:function(s,i,l,a,u,d){if(i.buffer===It.buffer&&(d=!1),!a)return 0;var N=s.node;if(N.timestamp=Date.now(),i.subarray&&(!N.contents||N.contents.subarray)){if(d)return N.contents=i.subarray(l,l+a),N.usedBytes=a,a;if(N.usedBytes===0&&u===0)return N.contents=i.slice(l,l+a),N.usedBytes=a,a;if(u+a<=N.usedBytes)return N.contents.set(i.subarray(l,l+a),u),a}if(fe.expandFileStorage(N,u+a),N.contents.subarray&&i.subarray)N.contents.set(i.subarray(l,l+a),u);else for(var S=0;S<a;S++)N.contents[u+S]=i[l+S];return N.usedBytes=Math.max(N.usedBytes,u+a),a},llseek:function(s,i,l){var a=i;if(l===1?a+=s.position:l===2&&c.isFile(s.node.mode)&&(a+=s.node.usedBytes),a<0)throw new c.ErrnoError(28);return a},allocate:function(s,i,l){fe.expandFileStorage(s.node,i+l),s.node.usedBytes=Math.max(s.node.usedBytes,i+l)},mmap:function(s,i,l,a,u){if(!c.isFile(s.node.mode))throw new c.ErrnoError(43);var d,N,S=s.node.contents;if(!(u&2)&&S.buffer===It.buffer)N=!1,d=S.byteOffset;else{if((l>0||l+i<S.length)&&(S.subarray?S=S.subarray(l,l+i):S=Array.prototype.slice.call(S,l,l+i)),N=!0,d=Da(),!d)throw new c.ErrnoError(48);It.set(S,d)}return{ptr:d,allocated:N}},msync:function(s,i,l,a,u){return fe.stream_ops.write(s,i,0,a,l,!1),0}}};function Nc(s,i,l,a){var u=a?"":"al "+s;cn(s,d=>{cc(d,'Loading data file "'+s+'" failed (no arrayBuffer).'),i(new Uint8Array(d)),u&&As()},d=>{if(l)l();else throw'Loading data file "'+s+'" failed.'}),u&&po()}var c={root:null,mounts:[],devices:{},streams:[],nextInode:1,nameTable:null,currentPath:"/",initialized:!1,ignorePermissions:!0,ErrnoError:null,genericErrors:{},filesystems:null,syncFSRequests:0,lookupPath:(s,i={})=>{if(s=fn.resolve(s),!s)return{path:"",node:null};var l={follow_mount:!0,recurse_count:0};if(i=Object.assign(l,i),i.recurse_count>8)throw new c.ErrnoError(32);for(var a=s.split("/").filter(te=>!!te),u=c.root,d="/",N=0;N<a.length;N++){var S=N===a.length-1;if(S&&i.parent)break;if(u=c.lookupNode(u,a[N]),d=ve.join2(d,a[N]),c.isMountpoint(u)&&(!S||S&&i.follow_mount)&&(u=u.mounted.root),!S||i.follow)for(var C=0;c.isLink(u.mode);){var z=c.readlink(d);d=fn.resolve(ve.dirname(d),z);var K=c.lookupPath(d,{recurse_count:i.recurse_count+1});if(u=K.node,C++>40)throw new c.ErrnoError(32)}}return{path:d,node:u}},getPath:s=>{for(var i;;){if(c.isRoot(s)){var l=s.mount.mountpoint;return i?l[l.length-1]!=="/"?l+"/"+i:l+i:l}i=i?s.name+"/"+i:s.name,s=s.parent}},hashName:(s,i)=>{for(var l=0,a=0;a<i.length;a++)l=(l<<5)-l+i.charCodeAt(a)|0;return(s+l>>>0)%c.nameTable.length},hashAddNode:s=>{var i=c.hashName(s.parent.id,s.name);s.name_next=c.nameTable[i],c.nameTable[i]=s},hashRemoveNode:s=>{var i=c.hashName(s.parent.id,s.name);if(c.nameTable[i]===s)c.nameTable[i]=s.name_next;else for(var l=c.nameTable[i];l;){if(l.name_next===s){l.name_next=s.name_next;break}l=l.name_next}},lookupNode:(s,i)=>{var l=c.mayLookup(s);if(l)throw new c.ErrnoError(l,s);for(var a=c.hashName(s.id,i),u=c.nameTable[a];u;u=u.name_next){var d=u.name;if(u.parent.id===s.id&&d===i)return u}return c.lookup(s,i)},createNode:(s,i,l,a)=>{var u=new c.FSNode(s,i,l,a);return c.hashAddNode(u),u},destroyNode:s=>{c.hashRemoveNode(s)},isRoot:s=>s===s.parent,isMountpoint:s=>!!s.mounted,isFile:s=>(s&61440)===32768,isDir:s=>(s&61440)===16384,isLink:s=>(s&61440)===40960,isChrdev:s=>(s&61440)===8192,isBlkdev:s=>(s&61440)===24576,isFIFO:s=>(s&61440)===4096,isSocket:s=>(s&49152)===49152,flagModes:{r:0,"r+":2,w:577,"w+":578,a:1089,"a+":1090},modeStringToFlags:s=>{var i=c.flagModes[s];if(typeof i>"u")throw new Error("Unknown file open mode: "+s);return i},flagsToPermissionString:s=>{var i=["r","w","rw"][s&3];return s&512&&(i+="w"),i},nodePermissions:(s,i)=>c.ignorePermissions?0:i.includes("r")&&!(s.mode&292)||i.includes("w")&&!(s.mode&146)||i.includes("x")&&!(s.mode&73)?2:0,mayLookup:s=>{var i=c.nodePermissions(s,"x");return i||(s.node_ops.lookup?0:2)},mayCreate:(s,i)=>{try{var l=c.lookupNode(s,i);return 20}catch{}return c.nodePermissions(s,"wx")},mayDelete:(s,i,l)=>{var a;try{a=c.lookupNode(s,i)}catch(d){return d.errno}var u=c.nodePermissions(s,"wx");if(u)return u;if(l){if(!c.isDir(a.mode))return 54;if(c.isRoot(a)||c.getPath(a)===c.cwd())return 10}else if(c.isDir(a.mode))return 31;return 0},mayOpen:(s,i)=>s?c.isLink(s.mode)?32:c.isDir(s.mode)&&(c.flagsToPermissionString(i)!=="r"||i&512)?31:c.nodePermissions(s,c.flagsToPermissionString(i)):44,MAX_OPEN_FDS:4096,nextfd:(s=0,i=c.MAX_OPEN_FDS)=>{for(var l=s;l<=i;l++)if(!c.streams[l])return l;throw new c.ErrnoError(33)},getStream:s=>c.streams[s],createStream:(s,i,l)=>{c.FSStream||(c.FSStream=function(){this.shared={}},c.FSStream.prototype={},Object.defineProperties(c.FSStream.prototype,{object:{get:function(){return this.node},set:function(u){this.node=u}},isRead:{get:function(){return(this.flags&2097155)!==1}},isWrite:{get:function(){return(this.flags&2097155)!==0}},isAppend:{get:function(){return this.flags&1024}},flags:{get:function(){return this.shared.flags},set:function(u){this.shared.flags=u}},position:{get:function(){return this.shared.position},set:function(u){this.shared.position=u}}})),s=Object.assign(new c.FSStream,s);var a=c.nextfd(i,l);return s.fd=a,c.streams[a]=s,s},closeStream:s=>{c.streams[s]=null},chrdev_stream_ops:{open:s=>{var i=c.getDevice(s.node.rdev);s.stream_ops=i.stream_ops,s.stream_ops.open&&s.stream_ops.open(s)},llseek:()=>{throw new c.ErrnoError(70)}},major:s=>s>>8,minor:s=>s&255,makedev:(s,i)=>s<<8|i,registerDevice:(s,i)=>{c.devices[s]={stream_ops:i}},getDevice:s=>c.devices[s],getMounts:s=>{for(var i=[],l=[s];l.length;){var a=l.pop();i.push(a),l.push.apply(l,a.mounts)}return i},syncfs:(s,i)=>{typeof s=="function"&&(i=s,s=!1),c.syncFSRequests++,c.syncFSRequests>1&&gt("warning: "+c.syncFSRequests+" FS.syncfs operations in flight at once, probably just doing extra work");var l=c.getMounts(c.root.mount),a=0;function u(N){return c.syncFSRequests--,i(N)}function d(N){if(N)return d.errored?void 0:(d.errored=!0,u(N));++a>=l.length&&u(null)}l.forEach(N=>{if(!N.type.syncfs)return d(null);N.type.syncfs(N,s,d)})},mount:(s,i,l)=>{var a=l==="/",u=!l,d;if(a&&c.root)throw new c.ErrnoError(10);if(!a&&!u){var N=c.lookupPath(l,{follow_mount:!1});if(l=N.path,d=N.node,c.isMountpoint(d))throw new c.ErrnoError(10);if(!c.isDir(d.mode))throw new c.ErrnoError(54)}var S={type:s,opts:i,mountpoint:l,mounts:[]},C=s.mount(S);return C.mount=S,S.root=C,a?c.root=C:d&&(d.mounted=S,d.mount&&d.mount.mounts.push(S)),C},unmount:s=>{var i=c.lookupPath(s,{follow_mount:!1});if(!c.isMountpoint(i.node))throw new c.ErrnoError(28);var l=i.node,a=l.mounted,u=c.getMounts(a);Object.keys(c.nameTable).forEach(N=>{for(var S=c.nameTable[N];S;){var C=S.name_next;u.includes(S.mount)&&c.destroyNode(S),S=C}}),l.mounted=null;var d=l.mount.mounts.indexOf(a);l.mount.mounts.splice(d,1)},lookup:(s,i)=>s.node_ops.lookup(s,i),mknod:(s,i,l)=>{var a=c.lookupPath(s,{parent:!0}),u=a.node,d=ve.basename(s);if(!d||d==="."||d==="..")throw new c.ErrnoError(28);var N=c.mayCreate(u,d);if(N)throw new c.ErrnoError(N);if(!u.node_ops.mknod)throw new c.ErrnoError(63);return u.node_ops.mknod(u,d,i,l)},create:(s,i)=>(i=i!==void 0?i:438,i&=4095,i|=32768,c.mknod(s,i,0)),mkdir:(s,i)=>(i=i!==void 0?i:511,i&=1023,i|=16384,c.mknod(s,i,0)),mkdirTree:(s,i)=>{for(var l=s.split("/"),a="",u=0;u<l.length;++u)if(l[u]){a+="/"+l[u];try{c.mkdir(a,i)}catch(d){if(d.errno!=20)throw d}}},mkdev:(s,i,l)=>(typeof l>"u"&&(l=i,i=438),i|=8192,c.mknod(s,i,l)),symlink:(s,i)=>{if(!fn.resolve(s))throw new c.ErrnoError(44);var l=c.lookupPath(i,{parent:!0}),a=l.node;if(!a)throw new c.ErrnoError(44);var u=ve.basename(i),d=c.mayCreate(a,u);if(d)throw new c.ErrnoError(d);if(!a.node_ops.symlink)throw new c.ErrnoError(63);return a.node_ops.symlink(a,u,s)},rename:(s,i)=>{var l=ve.dirname(s),a=ve.dirname(i),u=ve.basename(s),d=ve.basename(i),N,S,C;if(N=c.lookupPath(s,{parent:!0}),S=N.node,N=c.lookupPath(i,{parent:!0}),C=N.node,!S||!C)throw new c.ErrnoError(44);if(S.mount!==C.mount)throw new c.ErrnoError(75);var z=c.lookupNode(S,u),K=fn.relative(s,a);if(K.charAt(0)!==".")throw new c.ErrnoError(28);if(K=fn.relative(i,l),K.charAt(0)!==".")throw new c.ErrnoError(55);var te;try{te=c.lookupNode(C,d)}catch{}if(z!==te){var k=c.isDir(z.mode),m=c.mayDelete(S,u,k);if(m)throw new c.ErrnoError(m);if(m=te?c.mayDelete(C,d,k):c.mayCreate(C,d),m)throw new c.ErrnoError(m);if(!S.node_ops.rename)throw new c.ErrnoError(63);if(c.isMountpoint(z)||te&&c.isMountpoint(te))throw new c.ErrnoError(10);if(C!==S&&(m=c.nodePermissions(S,"w"),m))throw new c.ErrnoError(m);c.hashRemoveNode(z);try{S.node_ops.rename(z,C,d)}catch(y){throw y}finally{c.hashAddNode(z)}}},rmdir:s=>{var i=c.lookupPath(s,{parent:!0}),l=i.node,a=ve.basename(s),u=c.lookupNode(l,a),d=c.mayDelete(l,a,!0);if(d)throw new c.ErrnoError(d);if(!l.node_ops.rmdir)throw new c.ErrnoError(63);if(c.isMountpoint(u))throw new c.ErrnoError(10);l.node_ops.rmdir(l,a),c.destroyNode(u)},readdir:s=>{var i=c.lookupPath(s,{follow:!0}),l=i.node;if(!l.node_ops.readdir)throw new c.ErrnoError(54);return l.node_ops.readdir(l)},unlink:s=>{var i=c.lookupPath(s,{parent:!0}),l=i.node;if(!l)throw new c.ErrnoError(44);var a=ve.basename(s),u=c.lookupNode(l,a),d=c.mayDelete(l,a,!1);if(d)throw new c.ErrnoError(d);if(!l.node_ops.unlink)throw new c.ErrnoError(63);if(c.isMountpoint(u))throw new c.ErrnoError(10);l.node_ops.unlink(l,a),c.destroyNode(u)},readlink:s=>{var i=c.lookupPath(s),l=i.node;if(!l)throw new c.ErrnoError(44);if(!l.node_ops.readlink)throw new c.ErrnoError(28);return fn.resolve(c.getPath(l.parent),l.node_ops.readlink(l))},stat:(s,i)=>{var l=c.lookupPath(s,{follow:!i}),a=l.node;if(!a)throw new c.ErrnoError(44);if(!a.node_ops.getattr)throw new c.ErrnoError(63);return a.node_ops.getattr(a)},lstat:s=>c.stat(s,!0),chmod:(s,i,l)=>{var a;if(typeof s=="string"){var u=c.lookupPath(s,{follow:!l});a=u.node}else a=s;if(!a.node_ops.setattr)throw new c.ErrnoError(63);a.node_ops.setattr(a,{mode:i&4095|a.mode&-4096,timestamp:Date.now()})},lchmod:(s,i)=>{c.chmod(s,i,!0)},fchmod:(s,i)=>{var l=c.getStream(s);if(!l)throw new c.ErrnoError(8);c.chmod(l.node,i)},chown:(s,i,l,a)=>{var u;if(typeof s=="string"){var d=c.lookupPath(s,{follow:!a});u=d.node}else u=s;if(!u.node_ops.setattr)throw new c.ErrnoError(63);u.node_ops.setattr(u,{timestamp:Date.now()})},lchown:(s,i,l)=>{c.chown(s,i,l,!0)},fchown:(s,i,l)=>{var a=c.getStream(s);if(!a)throw new c.ErrnoError(8);c.chown(a.node,i,l)},truncate:(s,i)=>{if(i<0)throw new c.ErrnoError(28);var l;if(typeof s=="string"){var a=c.lookupPath(s,{follow:!0});l=a.node}else l=s;if(!l.node_ops.setattr)throw new c.ErrnoError(63);if(c.isDir(l.mode))throw new c.ErrnoError(31);if(!c.isFile(l.mode))throw new c.ErrnoError(28);var u=c.nodePermissions(l,"w");if(u)throw new c.ErrnoError(u);l.node_ops.setattr(l,{size:i,timestamp:Date.now()})},ftruncate:(s,i)=>{var l=c.getStream(s);if(!l)throw new c.ErrnoError(8);if(!(l.flags&2097155))throw new c.ErrnoError(28);c.truncate(l.node,i)},utime:(s,i,l)=>{var a=c.lookupPath(s,{follow:!0}),u=a.node;u.node_ops.setattr(u,{timestamp:Math.max(i,l)})},open:(s,i,l)=>{if(s==="")throw new c.ErrnoError(44);i=typeof i=="string"?c.modeStringToFlags(i):i,l=typeof l>"u"?438:l,i&64?l=l&4095|32768:l=0;var a;if(typeof s=="object")a=s;else{s=ve.normalize(s);try{var u=c.lookupPath(s,{follow:!(i&131072)});a=u.node}catch{}}var d=!1;if(i&64)if(a){if(i&128)throw new c.ErrnoError(20)}else a=c.mknod(s,l,0),d=!0;if(!a)throw new c.ErrnoError(44);if(c.isChrdev(a.mode)&&(i&=-513),i&65536&&!c.isDir(a.mode))throw new c.ErrnoError(54);if(!d){var N=c.mayOpen(a,i);if(N)throw new c.ErrnoError(N)}i&512&&!d&&c.truncate(a,0),i&=-131713;var S=c.createStream({node:a,path:c.getPath(a),flags:i,seekable:!0,position:0,stream_ops:a.stream_ops,ungotten:[],error:!1});return S.stream_ops.open&&S.stream_ops.open(S),n.logReadFiles&&!(i&1)&&(c.readFiles||(c.readFiles={}),s in c.readFiles||(c.readFiles[s]=1)),S},close:s=>{if(c.isClosed(s))throw new c.ErrnoError(8);s.getdents&&(s.getdents=null);try{s.stream_ops.close&&s.stream_ops.close(s)}catch(i){throw i}finally{c.closeStream(s.fd)}s.fd=null},isClosed:s=>s.fd===null,llseek:(s,i,l)=>{if(c.isClosed(s))throw new c.ErrnoError(8);if(!s.seekable||!s.stream_ops.llseek)throw new c.ErrnoError(70);if(l!=0&&l!=1&&l!=2)throw new c.ErrnoError(28);return s.position=s.stream_ops.llseek(s,i,l),s.ungotten=[],s.position},read:(s,i,l,a,u)=>{if(a<0||u<0)throw new c.ErrnoError(28);if(c.isClosed(s))throw new c.ErrnoError(8);if((s.flags&2097155)===1)throw new c.ErrnoError(8);if(c.isDir(s.node.mode))throw new c.ErrnoError(31);if(!s.stream_ops.read)throw new c.ErrnoError(28);var d=typeof u<"u";if(!d)u=s.position;else if(!s.seekable)throw new c.ErrnoError(70);var N=s.stream_ops.read(s,i,l,a,u);return d||(s.position+=N),N},write:(s,i,l,a,u,d)=>{if(a<0||u<0)throw new c.ErrnoError(28);if(c.isClosed(s))throw new c.ErrnoError(8);if(!(s.flags&2097155))throw new c.ErrnoError(8);if(c.isDir(s.node.mode))throw new c.ErrnoError(31);if(!s.stream_ops.write)throw new c.ErrnoError(28);s.seekable&&s.flags&1024&&c.llseek(s,0,2);var N=typeof u<"u";if(!N)u=s.position;else if(!s.seekable)throw new c.ErrnoError(70);var S=s.stream_ops.write(s,i,l,a,u,d);return N||(s.position+=S),S},allocate:(s,i,l)=>{if(c.isClosed(s))throw new c.ErrnoError(8);if(i<0||l<=0)throw new c.ErrnoError(28);if(!(s.flags&2097155))throw new c.ErrnoError(8);if(!c.isFile(s.node.mode)&&!c.isDir(s.node.mode))throw new c.ErrnoError(43);if(!s.stream_ops.allocate)throw new c.ErrnoError(138);s.stream_ops.allocate(s,i,l)},mmap:(s,i,l,a,u)=>{if(a&2&&!(u&2)&&(s.flags&2097155)!==2)throw new c.ErrnoError(2);if((s.flags&2097155)===1)throw new c.ErrnoError(2);if(!s.stream_ops.mmap)throw new c.ErrnoError(43);return s.stream_ops.mmap(s,i,l,a,u)},msync:(s,i,l,a,u)=>s.stream_ops.msync?s.stream_ops.msync(s,i,l,a,u):0,munmap:s=>0,ioctl:(s,i,l)=>{if(!s.stream_ops.ioctl)throw new c.ErrnoError(59);return s.stream_ops.ioctl(s,i,l)},readFile:(s,i={})=>{if(i.flags=i.flags||0,i.encoding=i.encoding||"binary",i.encoding!=="utf8"&&i.encoding!=="binary")throw new Error('Invalid encoding type "'+i.encoding+'"');var l,a=c.open(s,i.flags),u=c.stat(s),d=u.size,N=new Uint8Array(d);return c.read(a,N,0,d,0),i.encoding==="utf8"?l=Ar(N,0):i.encoding==="binary"&&(l=N),c.close(a),l},writeFile:(s,i,l={})=>{l.flags=l.flags||577;var a=c.open(s,l.flags,l.mode);if(typeof i=="string"){var u=new Uint8Array(wi(i)+1),d=Os(i,u,0,u.length);c.write(a,u,0,d,void 0,l.canOwn)}else if(ArrayBuffer.isView(i))c.write(a,i,0,i.byteLength,void 0,l.canOwn);else throw new Error("Unsupported data type");c.close(a)},cwd:()=>c.currentPath,chdir:s=>{var i=c.lookupPath(s,{follow:!0});if(i.node===null)throw new c.ErrnoError(44);if(!c.isDir(i.node.mode))throw new c.ErrnoError(54);var l=c.nodePermissions(i.node,"x");if(l)throw new c.ErrnoError(l);c.currentPath=i.path},createDefaultDirectories:()=>{c.mkdir("/tmp"),c.mkdir("/home"),c.mkdir("/home/web_user")},createDefaultDevices:()=>{c.mkdir("/dev"),c.registerDevice(c.makedev(1,3),{read:()=>0,write:(i,l,a,u,d)=>u}),c.mkdev("/dev/null",c.makedev(1,3)),Xn.register(c.makedev(5,0),Xn.default_tty_ops),Xn.register(c.makedev(6,0),Xn.default_tty1_ops),c.mkdev("/dev/tty",c.makedev(5,0)),c.mkdev("/dev/tty1",c.makedev(6,0));var s=qc();c.createDevice("/dev","random",s),c.createDevice("/dev","urandom",s),c.mkdir("/dev/shm"),c.mkdir("/dev/shm/tmp")},createSpecialDirectories:()=>{c.mkdir("/proc");var s=c.mkdir("/proc/self");c.mkdir("/proc/self/fd"),c.mount({mount:()=>{var i=c.createNode(s,"fd",16895,73);return i.node_ops={lookup:(l,a)=>{var u=+a,d=c.getStream(u);if(!d)throw new c.ErrnoError(8);var N={parent:null,mount:{mountpoint:"fake"},node_ops:{readlink:()=>d.path}};return N.parent=N,N}},i}},{},"/proc/self/fd")},createStandardStreams:()=>{n.stdin?c.createDevice("/dev","stdin",n.stdin):c.symlink("/dev/tty","/dev/stdin"),n.stdout?c.createDevice("/dev","stdout",null,n.stdout):c.symlink("/dev/tty","/dev/stdout"),n.stderr?c.createDevice("/dev","stderr",null,n.stderr):c.symlink("/dev/tty1","/dev/stderr"),c.open("/dev/stdin",0),c.open("/dev/stdout",1),c.open("/dev/stderr",1)},ensureErrnoError:()=>{c.ErrnoError||(c.ErrnoError=function(i,l){this.node=l,this.setErrno=function(a){this.errno=a},this.setErrno(i),this.message="FS error"},c.ErrnoError.prototype=new Error,c.ErrnoError.prototype.constructor=c.ErrnoError,[44].forEach(s=>{c.genericErrors[s]=new c.ErrnoError(s),c.genericErrors[s].stack="<generic error, no stack>"}))},staticInit:()=>{c.ensureErrnoError(),c.nameTable=new Array(4096),c.mount(fe,{},"/"),c.createDefaultDirectories(),c.createDefaultDevices(),c.createSpecialDirectories(),c.filesystems={MEMFS:fe}},init:(s,i,l)=>{c.init.initialized=!0,c.ensureErrnoError(),n.stdin=s||n.stdin,n.stdout=i||n.stdout,n.stderr=l||n.stderr,c.createStandardStreams()},quit:()=>{c.init.initialized=!1;for(var s=0;s<c.streams.length;s++){var i=c.streams[s];i&&c.close(i)}},getMode:(s,i)=>{var l=0;return s&&(l|=365),i&&(l|=146),l},findObject:(s,i)=>{var l=c.analyzePath(s,i);return l.exists?l.object:null},analyzePath:(s,i)=>{try{var l=c.lookupPath(s,{follow:!i});s=l.path}catch{}var a={isRoot:!1,exists:!1,error:0,name:null,path:null,object:null,parentExists:!1,parentPath:null,parentObject:null};try{var l=c.lookupPath(s,{parent:!0});a.parentExists=!0,a.parentPath=l.path,a.parentObject=l.node,a.name=ve.basename(s),l=c.lookupPath(s,{follow:!i}),a.exists=!0,a.path=l.path,a.object=l.node,a.name=l.node.name,a.isRoot=l.path==="/"}catch(u){a.error=u.errno}return a},createPath:(s,i,l,a)=>{s=typeof s=="string"?s:c.getPath(s);for(var u=i.split("/").reverse();u.length;){var d=u.pop();if(d){var N=ve.join2(s,d);try{c.mkdir(N)}catch{}s=N}}return N},createFile:(s,i,l,a,u)=>{var d=ve.join2(typeof s=="string"?s:c.getPath(s),i),N=c.getMode(a,u);return c.create(d,N)},createDataFile:(s,i,l,a,u,d)=>{var N=i;s&&(s=typeof s=="string"?s:c.getPath(s),N=i?ve.join2(s,i):s);var S=c.getMode(a,u),C=c.create(N,S);if(l){if(typeof l=="string"){for(var z=new Array(l.length),K=0,te=l.length;K<te;++K)z[K]=l.charCodeAt(K);l=z}c.chmod(C,S|146);var k=c.open(C,577);c.write(k,l,0,l.length,0,d),c.close(k),c.chmod(C,S)}return C},createDevice:(s,i,l,a)=>{var u=ve.join2(typeof s=="string"?s:c.getPath(s),i),d=c.getMode(!!l,!!a);c.createDevice.major||(c.createDevice.major=64);var N=c.makedev(c.createDevice.major++,0);return c.registerDevice(N,{open:S=>{S.seekable=!1},close:S=>{a&&a.buffer&&a.buffer.length&&a(10)},read:(S,C,z,K,te)=>{for(var k=0,m=0;m<K;m++){var y;try{y=l()}catch{throw new c.ErrnoError(29)}if(y===void 0&&k===0)throw new c.ErrnoError(6);if(y==null)break;k++,C[z+m]=y}return k&&(S.node.timestamp=Date.now()),k},write:(S,C,z,K,te)=>{for(var k=0;k<K;k++)try{a(C[z+k])}catch{throw new c.ErrnoError(29)}return K&&(S.node.timestamp=Date.now()),k}}),c.mkdev(u,d,N)},forceLoadFile:s=>{if(s.isDevice||s.isFolder||s.link||s.contents)return!0;if(typeof XMLHttpRequest<"u")throw new Error("Lazy loading should have been performed (contents set) in createLazyFile, but it was not. Lazy loading only works in web workers. Use --embed-file or --preload-file in emcc on the main thread.");if(Be)try{s.contents=mo(Be(s.url),!0),s.usedBytes=s.contents.length}catch{throw new c.ErrnoError(29)}else throw new Error("Cannot load without read() or XMLHttpRequest.")},createLazyFile:(s,i,l,a,u)=>{function d(){this.lengthKnown=!1,this.chunks=[]}if(d.prototype.get=function(m){if(!(m>this.length-1||m<0)){var y=m%this.chunkSize,x=m/this.chunkSize|0;return this.getter(x)[y]}},d.prototype.setDataGetter=function(m){this.getter=m},d.prototype.cacheLength=function(){var m=new XMLHttpRequest;if(m.open("HEAD",l,!1),m.send(null),!(m.status>=200&&m.status<300||m.status===304))throw new Error("Couldn't load "+l+". Status: "+m.status);var y=Number(m.getResponseHeader("Content-length")),x,E=(x=m.getResponseHeader("Accept-Ranges"))&&x==="bytes",q=(x=m.getResponseHeader("Content-Encoding"))&&x==="gzip",W=1024*1024;E||(W=y);var M=(L,ie)=>{if(L>ie)throw new Error("invalid range ("+L+", "+ie+") or no bytes requested!");if(ie>y-1)throw new Error("only "+y+" bytes available! programmer error!");var j=new XMLHttpRequest;if(j.open("GET",l,!1),y!==W&&j.setRequestHeader("Range","bytes="+L+"-"+ie),j.responseType="arraybuffer",j.overrideMimeType&&j.overrideMimeType("text/plain; charset=x-user-defined"),j.send(null),!(j.status>=200&&j.status<300||j.status===304))throw new Error("Couldn't load "+l+". Status: "+j.status);return j.response!==void 0?new Uint8Array(j.response||[]):mo(j.responseText||"",!0)},R=this;R.setDataGetter(L=>{var ie=L*W,j=(L+1)*W-1;if(j=Math.min(j,y-1),typeof R.chunks[L]>"u"&&(R.chunks[L]=M(ie,j)),typeof R.chunks[L]>"u")throw new Error("doXHR failed!");return R.chunks[L]}),(q||!y)&&(W=y=1,y=this.getter(0).length,W=y,dn("LazyFiles on gzip forces download of the whole file when length is accessed")),this._length=y,this._chunkSize=W,this.lengthKnown=!0},typeof XMLHttpRequest<"u"){if(!et)throw"Cannot do synchronous binary XHRs outside webworkers in modern browsers. Use --embed-file or --preload-file in emcc";var N=new d;Object.defineProperties(N,{length:{get:function(){return this.lengthKnown||this.cacheLength(),this._length}},chunkSize:{get:function(){return this.lengthKnown||this.cacheLength(),this._chunkSize}}});var S={isDevice:!1,contents:N}}else var S={isDevice:!1,url:l};var C=c.createFile(s,i,S,a,u);S.contents?C.contents=S.contents:S.url&&(C.contents=null,C.url=S.url),Object.defineProperties(C,{usedBytes:{get:function(){return this.contents.length}}});var z={},K=Object.keys(C.stream_ops);K.forEach(k=>{var m=C.stream_ops[k];z[k]=function(){return c.forceLoadFile(C),m.apply(null,arguments)}});function te(k,m,y,x,E){var q=k.node.contents;if(E>=q.length)return 0;var W=Math.min(q.length-E,x);if(q.slice)for(var M=0;M<W;M++)m[y+M]=q[E+M];else for(var M=0;M<W;M++)m[y+M]=q.get(E+M);return W}return z.read=(k,m,y,x,E)=>(c.forceLoadFile(C),te(k,m,y,x,E)),z.mmap=(k,m,y,x,E)=>{c.forceLoadFile(C);var q=Da();if(!q)throw new c.ErrnoError(48);return te(k,It,q,m,y),{ptr:q,allocated:!0}},C.stream_ops=z,C},createPreloadedFile:(s,i,l,a,u,d,N,S,C,z)=>{var K=i?fn.resolve(ve.join2(s,i)):s;function te(k){function m(y){z&&z(),S||c.createDataFile(s,i,y,a,u,C),d&&d(),As()}Browser.handledByPreloadPlugin(k,K,m,()=>{N&&N(),As()})||m(k)}po(),typeof l=="string"?Nc(l,k=>te(k),N):te(l)},indexedDB:()=>window.indexedDB||window.mozIndexedDB||window.webkitIndexedDB||window.msIndexedDB,DB_NAME:()=>"EM_FS_"+window.location.pathname,DB_VERSION:20,DB_STORE_NAME:"FILE_DATA",saveFilesToDB:(s,i,l)=>{i=i||(()=>{}),l=l||(()=>{});var a=c.indexedDB();try{var u=a.open(c.DB_NAME(),c.DB_VERSION)}catch(d){return l(d)}u.onupgradeneeded=()=>{dn("creating db");var d=u.result;d.createObjectStore(c.DB_STORE_NAME)},u.onsuccess=()=>{var d=u.result,N=d.transaction([c.DB_STORE_NAME],"readwrite"),S=N.objectStore(c.DB_STORE_NAME),C=0,z=0,K=s.length;function te(){z==0?i():l()}s.forEach(k=>{var m=S.put(c.analyzePath(k).object.contents,k);m.onsuccess=()=>{C++,C+z==K&&te()},m.onerror=()=>{z++,C+z==K&&te()}}),N.onerror=l},u.onerror=l},loadFilesFromDB:(s,i,l)=>{i=i||(()=>{}),l=l||(()=>{});var a=c.indexedDB();try{var u=a.open(c.DB_NAME(),c.DB_VERSION)}catch(d){return l(d)}u.onupgradeneeded=l,u.onsuccess=()=>{var d=u.result;try{var N=d.transaction([c.DB_STORE_NAME],"readonly")}catch(k){l(k);return}var S=N.objectStore(c.DB_STORE_NAME),C=0,z=0,K=s.length;function te(){z==0?i():l()}s.forEach(k=>{var m=S.get(k);m.onsuccess=()=>{c.analyzePath(k).exists&&c.unlink(k),c.createDataFile(ve.dirname(k),ve.basename(k),m.result,!0,!0,!0),C++,C+z==K&&te()},m.onerror=()=>{z++,C+z==K&&te()}}),N.onerror=l},u.onerror=l}},de={DEFAULT_POLLMASK:5,calculateAt:function(s,i,l){if(ve.isAbs(i))return i;var a;if(s===-100)a=c.cwd();else{var u=de.getStreamFromFD(s);a=u.path}if(i.length==0){if(!l)throw new c.ErrnoError(44);return a}return ve.join2(a,i)},doStat:function(s,i,l){try{var a=s(i)}catch(S){if(S&&S.node&&ve.normalize(i)!==ve.normalize(c.getPath(S.node)))return-54;throw S}me[l>>2]=a.dev,me[l+8>>2]=a.ino,me[l+12>>2]=a.mode,tt[l+16>>2]=a.nlink,me[l+20>>2]=a.uid,me[l+24>>2]=a.gid,me[l+28>>2]=a.rdev,st=[a.size>>>0,(ge=a.size,+Math.abs(ge)>=1?ge>0?(Math.min(+Math.floor(ge/4294967296),4294967295)|0)>>>0:~~+Math.ceil((ge-+(~~ge>>>0))/4294967296)>>>0:0)],me[l+40>>2]=st[0],me[l+44>>2]=st[1],me[l+48>>2]=4096,me[l+52>>2]=a.blocks;var u=a.atime.getTime(),d=a.mtime.getTime(),N=a.ctime.getTime();return st=[Math.floor(u/1e3)>>>0,(ge=Math.floor(u/1e3),+Math.abs(ge)>=1?ge>0?(Math.min(+Math.floor(ge/4294967296),4294967295)|0)>>>0:~~+Math.ceil((ge-+(~~ge>>>0))/4294967296)>>>0:0)],me[l+56>>2]=st[0],me[l+60>>2]=st[1],tt[l+64>>2]=u%1e3*1e3,st=[Math.floor(d/1e3)>>>0,(ge=Math.floor(d/1e3),+Math.abs(ge)>=1?ge>0?(Math.min(+Math.floor(ge/4294967296),4294967295)|0)>>>0:~~+Math.ceil((ge-+(~~ge>>>0))/4294967296)>>>0:0)],me[l+72>>2]=st[0],me[l+76>>2]=st[1],tt[l+80>>2]=d%1e3*1e3,st=[Math.floor(N/1e3)>>>0,(ge=Math.floor(N/1e3),+Math.abs(ge)>=1?ge>0?(Math.min(+Math.floor(ge/4294967296),4294967295)|0)>>>0:~~+Math.ceil((ge-+(~~ge>>>0))/4294967296)>>>0:0)],me[l+88>>2]=st[0],me[l+92>>2]=st[1],tt[l+96>>2]=N%1e3*1e3,st=[a.ino>>>0,(ge=a.ino,+Math.abs(ge)>=1?ge>0?(Math.min(+Math.floor(ge/4294967296),4294967295)|0)>>>0:~~+Math.ceil((ge-+(~~ge>>>0))/4294967296)>>>0:0)],me[l+104>>2]=st[0],me[l+108>>2]=st[1],0},doMsync:function(s,i,l,a,u){if(!c.isFile(i.node.mode))throw new c.ErrnoError(43);if(a&2)return 0;var d=bi.slice(s,s+l);c.msync(i,d,u,l,a)},varargs:void 0,get:function(){de.varargs+=4;var s=me[de.varargs-4>>2];return s},getStr:function(s){var i=dc(s);return i},getStreamFromFD:function(s){var i=c.getStream(s);if(!i)throw new c.ErrnoError(8);return i}};function vc(s,i){try{return s=de.getStr(s),c.chmod(s,i),0}catch(l){if(typeof c>"u"||!(l instanceof c.ErrnoError))throw l;return-l.errno}}function xc(s,i,l,a){try{if(i=de.getStr(i),i=de.calculateAt(s,i),l&-8)return-28;var u=c.lookupPath(i,{follow:!0}),d=u.node;if(!d)return-44;var N="";return l&4&&(N+="r"),l&2&&(N+="w"),l&1&&(N+="x"),N&&c.nodePermissions(d,N)?-2:0}catch(S){if(typeof c>"u"||!(S instanceof c.ErrnoError))throw S;return-S.errno}}function Ec(s,i){try{return c.fchmod(s,i),0}catch(l){if(typeof c>"u"||!(l instanceof c.ErrnoError))throw l;return-l.errno}}function Sc(s,i,l){try{return c.fchown(s,i,l),0}catch(a){if(typeof c>"u"||!(a instanceof c.ErrnoError))throw a;return-a.errno}}function kc(s){return me[ja()>>2]=s,s}function Oc(s,i,l){de.varargs=l;try{var a=de.getStreamFromFD(s);switch(i){case 0:{var u=de.get();if(u<0)return-28;var d;return d=c.createStream(a,u),d.fd}case 1:case 2:return 0;case 3:return a.flags;case 4:{var u=de.get();return a.flags|=u,0}case 5:{var u=de.get(),N=0;return Aa[u+N>>1]=2,0}case 6:case 7:return 0;case 16:case 8:return-28;case 9:return kc(28),-1;default:return-28}}catch(S){if(typeof c>"u"||!(S instanceof c.ErrnoError))throw S;return-S.errno}}function Ac(s,i){try{var l=de.getStreamFromFD(s);return de.doStat(c.stat,l.path,i)}catch(a){if(typeof c>"u"||!(a instanceof c.ErrnoError))throw a;return-a.errno}}var Ic=9007199254740992,Tc=-9007199254740992;function Ra(s){return s<Tc||s>Ic?NaN:Number(s)}function Cc(s,i){try{return i=Ra(i),isNaN(i)?-61:(c.ftruncate(s,i),0)}catch(l){if(typeof c>"u"||!(l instanceof c.ErrnoError))throw l;return-l.errno}}function Pc(s,i){try{if(i===0)return-28;var l=c.cwd(),a=wi(l)+1;return i<a?-68:(Oa(l,s,i),a)}catch(u){if(typeof c>"u"||!(u instanceof c.ErrnoError))throw u;return-u.errno}}function Wc(s,i,l){de.varargs=l;try{var a=de.getStreamFromFD(s);switch(i){case 21509:case 21505:return a.tty?0:-59;case 21510:case 21511:case 21512:case 21506:case 21507:case 21508:return a.tty?0:-59;case 21519:{if(!a.tty)return-59;var u=de.get();return me[u>>2]=0,0}case 21520:return a.tty?-28:-59;case 21531:{var u=de.get();return c.ioctl(a,i,u)}case 21523:return a.tty?0:-59;case 21524:return a.tty?0:-59;default:return-28}}catch(d){if(typeof c>"u"||!(d instanceof c.ErrnoError))throw d;return-d.errno}}function Fc(s,i){try{return s=de.getStr(s),de.doStat(c.lstat,s,i)}catch(l){if(typeof c>"u"||!(l instanceof c.ErrnoError))throw l;return-l.errno}}function Lc(s,i,l){try{return i=de.getStr(i),i=de.calculateAt(s,i),i=ve.normalize(i),i[i.length-1]==="/"&&(i=i.substr(0,i.length-1)),c.mkdir(i,l,0),0}catch(a){if(typeof c>"u"||!(a instanceof c.ErrnoError))throw a;return-a.errno}}function Dc(s,i,l,a){try{i=de.getStr(i);var u=a&256,d=a&4096;return a=a&-6401,i=de.calculateAt(s,i,d),de.doStat(u?c.lstat:c.stat,i,l)}catch(N){if(typeof c>"u"||!(N instanceof c.ErrnoError))throw N;return-N.errno}}function Rc(s,i,l,a){de.varargs=a;try{i=de.getStr(i),i=de.calculateAt(s,i);var u=a?de.get():0;return c.open(i,l,u).fd}catch(d){if(typeof c>"u"||!(d instanceof c.ErrnoError))throw d;return-d.errno}}function Mc(s,i,l,a){try{if(i=de.getStr(i),i=de.calculateAt(s,i),a<=0)return-28;var u=c.readlink(i),d=Math.min(a,wi(u)),N=It[l+d];return Oa(u,l,a+1),It[l+d]=N,d}catch(S){if(typeof c>"u"||!(S instanceof c.ErrnoError))throw S;return-S.errno}}function Bc(s){try{return s=de.getStr(s),c.rmdir(s),0}catch(i){if(typeof c>"u"||!(i instanceof c.ErrnoError))throw i;return-i.errno}}function Uc(s,i){try{return s=de.getStr(s),de.doStat(c.stat,s,i)}catch(l){if(typeof c>"u"||!(l instanceof c.ErrnoError))throw l;return-l.errno}}function Qc(s,i,l){try{return i=de.getStr(i),i=de.calculateAt(s,i),l===0?c.unlink(i):l===512?c.rmdir(i):Kn("Invalid flags passed to unlinkat"),0}catch(a){if(typeof c>"u"||!(a instanceof c.ErrnoError))throw a;return-a.errno}}function yo(s){return tt[s>>2]+me[s+4>>2]*4294967296}function jc(s,i,l,a){try{if(i=de.getStr(i),i=de.calculateAt(s,i,!0),l){var N=yo(l),S=me[l+8>>2];u=N*1e3+S/(1e3*1e3),l+=16,N=yo(l),S=me[l+8>>2],d=N*1e3+S/(1e3*1e3)}else var u=Date.now(),d=u;return c.utime(i,u,d),0}catch(C){if(typeof c>"u"||!(C instanceof c.ErrnoError))throw C;return-C.errno}}var zc=!0;function Vc(){return zc}function Jc(s){return s%4===0&&(s%100!==0||s%400===0)}var Gc=[0,31,60,91,121,152,182,213,244,274,305,335],$c=[0,31,59,90,120,151,181,212,243,273,304,334];function Hc(s){var i=Jc(s.getFullYear()),l=i?Gc:$c,a=l[s.getMonth()]+s.getDate()-1;return a}function Kc(s,i){var l=new Date(yo(s)*1e3);me[i>>2]=l.getSeconds(),me[i+4>>2]=l.getMinutes(),me[i+8>>2]=l.getHours(),me[i+12>>2]=l.getDate(),me[i+16>>2]=l.getMonth(),me[i+20>>2]=l.getFullYear()-1900,me[i+24>>2]=l.getDay();var a=Hc(l)|0;me[i+28>>2]=a,me[i+36>>2]=-(l.getTimezoneOffset()*60);var u=new Date(l.getFullYear(),0,1),d=new Date(l.getFullYear(),6,1).getTimezoneOffset(),N=u.getTimezoneOffset(),S=(d!=N&&l.getTimezoneOffset()==Math.min(N,d))|0;me[i+32>>2]=S}function Ma(s){var i=wi(s)+1,l=za(i);return l&&Os(s,It,l,i),l}function Xc(s,i,l){var a=new Date().getFullYear(),u=new Date(a,0,1),d=new Date(a,6,1),N=u.getTimezoneOffset(),S=d.getTimezoneOffset(),C=Math.max(N,S);tt[s>>2]=C*60,me[i>>2]=+(N!=S);function z(y){var x=y.toTimeString().match(/\(([A-Za-z ]+)\)$/);return x?x[1]:"GMT"}var K=z(u),te=z(d),k=Ma(K),m=Ma(te);S<N?(tt[l>>2]=k,tt[l+4>>2]=m):(tt[l>>2]=m,tt[l+4>>2]=k)}function Yc(){return Date.now()}var Ba;Ba=()=>performance.now();function Zc(){return 2147483648}function ed(s){var i=In.buffer;try{return In.grow(s-i.byteLength+65535>>>16),Ia(),1}catch{}}function td(s){var i=bi.length;s=s>>>0;var l=Zc();if(s>l)return!1;let a=(C,z)=>C+(z-C%z)%z;for(var u=1;u<=4;u*=2){var d=i*(1+.2/u);d=Math.min(d,s+100663296);var N=Math.min(l,a(Math.max(s,d),65536)),S=ed(N);if(S)return!0}return!1}var go={};function nd(){return ct||"./this.program"}function Ni(){if(!Ni.strings){var s=(typeof navigator=="object"&&navigator.languages&&navigator.languages[0]||"C").replace("-","_")+".UTF-8",i={USER:"web_user",LOGNAME:"web_user",PATH:"/",PWD:"/",HOME:"/home/web_user",LANG:s,_:nd()};for(var l in go)go[l]===void 0?delete i[l]:i[l]=go[l];var a=[];for(var l in i)a.push(l+"="+i[l]);Ni.strings=a}return Ni.strings}function rd(s,i,l){for(var a=0;a<s.length;++a)It[i++>>0]=s.charCodeAt(a);l||(It[i>>0]=0)}function id(s,i){var l=0;return Ni().forEach(function(a,u){var d=i+l;tt[s+u*4>>2]=d,rd(a,d),l+=a.length+1}),0}function sd(s,i){var l=Ni();tt[s>>2]=l.length;var a=0;return l.forEach(function(u){a+=u.length+1}),tt[i>>2]=a,0}function od(s){try{var i=de.getStreamFromFD(s);return c.close(i),0}catch(l){if(typeof c>"u"||!(l instanceof c.ErrnoError))throw l;return l.errno}}function ad(s,i){try{var l=de.getStreamFromFD(s),a=l.tty?2:c.isDir(l.mode)?3:c.isLink(l.mode)?7:4;return It[i>>0]=a,0}catch(u){if(typeof c>"u"||!(u instanceof c.ErrnoError))throw u;return u.errno}}function ld(s,i,l,a){for(var u=0,d=0;d<l;d++){var N=tt[i>>2],S=tt[i+4>>2];i+=8;var C=c.read(s,It,N,S,a);if(C<0)return-1;if(u+=C,C<S)break;typeof a<"u"&&(a+=C)}return u}function ud(s,i,l,a){try{var u=de.getStreamFromFD(s),d=ld(u,i,l);return tt[a>>2]=d,0}catch(N){if(typeof c>"u"||!(N instanceof c.ErrnoError))throw N;return N.errno}}function cd(s,i,l,a){try{if(i=Ra(i),isNaN(i))return 61;var u=de.getStreamFromFD(s);return c.llseek(u,i,l),st=[u.position>>>0,(ge=u.position,+Math.abs(ge)>=1?ge>0?(Math.min(+Math.floor(ge/4294967296),4294967295)|0)>>>0:~~+Math.ceil((ge-+(~~ge>>>0))/4294967296)>>>0:0)],me[a>>2]=st[0],me[a+4>>2]=st[1],u.getdents&&i===0&&l===0&&(u.getdents=null),0}catch(d){if(typeof c>"u"||!(d instanceof c.ErrnoError))throw d;return d.errno}}function dd(s){try{var i=de.getStreamFromFD(s);return i.stream_ops&&i.stream_ops.fsync?i.stream_ops.fsync(i):0}catch(l){if(typeof c>"u"||!(l instanceof c.ErrnoError))throw l;return l.errno}}function fd(s,i,l,a){for(var u=0,d=0;d<l;d++){var N=tt[i>>2],S=tt[i+4>>2];i+=8;var C=c.write(s,It,N,S,a);if(C<0)return-1;u+=C,typeof a<"u"&&(a+=C)}return u}function hd(s,i,l,a){try{var u=de.getStreamFromFD(s),d=fd(u,i,l);return tt[a>>2]=d,0}catch(N){if(typeof c>"u"||!(N instanceof c.ErrnoError))throw N;return N.errno}}var Ua=function(s,i,l,a){s||(s=this),this.parent=s,this.mount=s.mount,this.mounted=null,this.id=c.nextInode++,this.name=i,this.mode=l,this.node_ops={},this.stream_ops={},this.rdev=a},Is=365,Ts=146;Object.defineProperties(Ua.prototype,{read:{get:function(){return(this.mode&Is)===Is},set:function(s){s?this.mode|=Is:this.mode&=~Is}},write:{get:function(){return(this.mode&Ts)===Ts},set:function(s){s?this.mode|=Ts:this.mode&=~Ts}},isFolder:{get:function(){return c.isDir(this.mode)}},isDevice:{get:function(){return c.isChrdev(this.mode)}}}),c.FSNode=Ua,c.staticInit();var Qa={__syscall_chmod:vc,__syscall_faccessat:xc,__syscall_fchmod:Ec,__syscall_fchown32:Sc,__syscall_fcntl64:Oc,__syscall_fstat64:Ac,__syscall_ftruncate64:Cc,__syscall_getcwd:Pc,__syscall_ioctl:Wc,__syscall_lstat64:Fc,__syscall_mkdirat:Lc,__syscall_newfstatat:Dc,__syscall_openat:Rc,__syscall_readlinkat:Mc,__syscall_rmdir:Bc,__syscall_stat64:Uc,__syscall_unlinkat:Qc,__syscall_utimensat:jc,_emscripten_get_now_is_monotonic:Vc,_localtime_js:Kc,_tzset_js:Xc,emscripten_date_now:Yc,emscripten_get_now:Ba,emscripten_resize_heap:td,environ_get:id,environ_sizes_get:sd,fd_close:od,fd_fdstat_get:ad,fd_read:ud,fd_seek:cd,fd_sync:dd,fd_write:hd,memory:In};bc(),n.___wasm_call_ctors=function(){return(n.___wasm_call_ctors=n.asm.__wasm_call_ctors).apply(null,arguments)},n._sqlite3_status64=function(){return(n._sqlite3_status64=n.asm.sqlite3_status64).apply(null,arguments)},n._sqlite3_status=function(){return(n._sqlite3_status=n.asm.sqlite3_status).apply(null,arguments)},n._sqlite3_db_status=function(){return(n._sqlite3_db_status=n.asm.sqlite3_db_status).apply(null,arguments)},n._sqlite3_msize=function(){return(n._sqlite3_msize=n.asm.sqlite3_msize).apply(null,arguments)},n._sqlite3_vfs_find=function(){return(n._sqlite3_vfs_find=n.asm.sqlite3_vfs_find).apply(null,arguments)},n._sqlite3_initialize=function(){return(n._sqlite3_initialize=n.asm.sqlite3_initialize).apply(null,arguments)},n._sqlite3_malloc=function(){return(n._sqlite3_malloc=n.asm.sqlite3_malloc).apply(null,arguments)},n._sqlite3_free=function(){return(n._sqlite3_free=n.asm.sqlite3_free).apply(null,arguments)},n._sqlite3_vfs_register=function(){return(n._sqlite3_vfs_register=n.asm.sqlite3_vfs_register).apply(null,arguments)},n._sqlite3_vfs_unregister=function(){return(n._sqlite3_vfs_unregister=n.asm.sqlite3_vfs_unregister).apply(null,arguments)},n._sqlite3_malloc64=function(){return(n._sqlite3_malloc64=n.asm.sqlite3_malloc64).apply(null,arguments)},n._sqlite3_realloc=function(){return(n._sqlite3_realloc=n.asm.sqlite3_realloc).apply(null,arguments)},n._sqlite3_realloc64=function(){return(n._sqlite3_realloc64=n.asm.sqlite3_realloc64).apply(null,arguments)},n._sqlite3_value_text=function(){return(n._sqlite3_value_text=n.asm.sqlite3_value_text).apply(null,arguments)},n._sqlite3_randomness=function(){return(n._sqlite3_randomness=n.asm.sqlite3_randomness).apply(null,arguments)},n._sqlite3_stricmp=function(){return(n._sqlite3_stricmp=n.asm.sqlite3_stricmp).apply(null,arguments)},n._sqlite3_strnicmp=function(){return(n._sqlite3_strnicmp=n.asm.sqlite3_strnicmp).apply(null,arguments)},n._sqlite3_uri_parameter=function(){return(n._sqlite3_uri_parameter=n.asm.sqlite3_uri_parameter).apply(null,arguments)};var ja=n.___errno_location=function(){return(ja=n.___errno_location=n.asm.__errno_location).apply(null,arguments)};n._sqlite3_uri_boolean=function(){return(n._sqlite3_uri_boolean=n.asm.sqlite3_uri_boolean).apply(null,arguments)},n._sqlite3_serialize=function(){return(n._sqlite3_serialize=n.asm.sqlite3_serialize).apply(null,arguments)},n._sqlite3_prepare_v2=function(){return(n._sqlite3_prepare_v2=n.asm.sqlite3_prepare_v2).apply(null,arguments)},n._sqlite3_step=function(){return(n._sqlite3_step=n.asm.sqlite3_step).apply(null,arguments)},n._sqlite3_column_int64=function(){return(n._sqlite3_column_int64=n.asm.sqlite3_column_int64).apply(null,arguments)},n._sqlite3_column_int=function(){return(n._sqlite3_column_int=n.asm.sqlite3_column_int).apply(null,arguments)},n._sqlite3_finalize=function(){return(n._sqlite3_finalize=n.asm.sqlite3_finalize).apply(null,arguments)},n._sqlite3_file_control=function(){return(n._sqlite3_file_control=n.asm.sqlite3_file_control).apply(null,arguments)},n._sqlite3_reset=function(){return(n._sqlite3_reset=n.asm.sqlite3_reset).apply(null,arguments)},n._sqlite3_deserialize=function(){return(n._sqlite3_deserialize=n.asm.sqlite3_deserialize).apply(null,arguments)},n._sqlite3_clear_bindings=function(){return(n._sqlite3_clear_bindings=n.asm.sqlite3_clear_bindings).apply(null,arguments)},n._sqlite3_value_blob=function(){return(n._sqlite3_value_blob=n.asm.sqlite3_value_blob).apply(null,arguments)},n._sqlite3_value_bytes=function(){return(n._sqlite3_value_bytes=n.asm.sqlite3_value_bytes).apply(null,arguments)},n._sqlite3_value_double=function(){return(n._sqlite3_value_double=n.asm.sqlite3_value_double).apply(null,arguments)},n._sqlite3_value_int=function(){return(n._sqlite3_value_int=n.asm.sqlite3_value_int).apply(null,arguments)},n._sqlite3_value_int64=function(){return(n._sqlite3_value_int64=n.asm.sqlite3_value_int64).apply(null,arguments)},n._sqlite3_value_subtype=function(){return(n._sqlite3_value_subtype=n.asm.sqlite3_value_subtype).apply(null,arguments)},n._sqlite3_value_pointer=function(){return(n._sqlite3_value_pointer=n.asm.sqlite3_value_pointer).apply(null,arguments)},n._sqlite3_value_type=function(){return(n._sqlite3_value_type=n.asm.sqlite3_value_type).apply(null,arguments)},n._sqlite3_value_nochange=function(){return(n._sqlite3_value_nochange=n.asm.sqlite3_value_nochange).apply(null,arguments)},n._sqlite3_value_frombind=function(){return(n._sqlite3_value_frombind=n.asm.sqlite3_value_frombind).apply(null,arguments)},n._sqlite3_value_dup=function(){return(n._sqlite3_value_dup=n.asm.sqlite3_value_dup).apply(null,arguments)},n._sqlite3_value_free=function(){return(n._sqlite3_value_free=n.asm.sqlite3_value_free).apply(null,arguments)},n._sqlite3_result_blob=function(){return(n._sqlite3_result_blob=n.asm.sqlite3_result_blob).apply(null,arguments)},n._sqlite3_result_error_nomem=function(){return(n._sqlite3_result_error_nomem=n.asm.sqlite3_result_error_nomem).apply(null,arguments)},n._sqlite3_result_error_toobig=function(){return(n._sqlite3_result_error_toobig=n.asm.sqlite3_result_error_toobig).apply(null,arguments)},n._sqlite3_result_double=function(){return(n._sqlite3_result_double=n.asm.sqlite3_result_double).apply(null,arguments)},n._sqlite3_result_error=function(){return(n._sqlite3_result_error=n.asm.sqlite3_result_error).apply(null,arguments)},n._sqlite3_result_int=function(){return(n._sqlite3_result_int=n.asm.sqlite3_result_int).apply(null,arguments)},n._sqlite3_result_int64=function(){return(n._sqlite3_result_int64=n.asm.sqlite3_result_int64).apply(null,arguments)},n._sqlite3_result_null=function(){return(n._sqlite3_result_null=n.asm.sqlite3_result_null).apply(null,arguments)},n._sqlite3_result_pointer=function(){return(n._sqlite3_result_pointer=n.asm.sqlite3_result_pointer).apply(null,arguments)},n._sqlite3_result_subtype=function(){return(n._sqlite3_result_subtype=n.asm.sqlite3_result_subtype).apply(null,arguments)},n._sqlite3_result_text=function(){return(n._sqlite3_result_text=n.asm.sqlite3_result_text).apply(null,arguments)},n._sqlite3_result_zeroblob=function(){return(n._sqlite3_result_zeroblob=n.asm.sqlite3_result_zeroblob).apply(null,arguments)},n._sqlite3_result_zeroblob64=function(){return(n._sqlite3_result_zeroblob64=n.asm.sqlite3_result_zeroblob64).apply(null,arguments)},n._sqlite3_result_error_code=function(){return(n._sqlite3_result_error_code=n.asm.sqlite3_result_error_code).apply(null,arguments)},n._sqlite3_user_data=function(){return(n._sqlite3_user_data=n.asm.sqlite3_user_data).apply(null,arguments)},n._sqlite3_context_db_handle=function(){return(n._sqlite3_context_db_handle=n.asm.sqlite3_context_db_handle).apply(null,arguments)},n._sqlite3_vtab_nochange=function(){return(n._sqlite3_vtab_nochange=n.asm.sqlite3_vtab_nochange).apply(null,arguments)},n._sqlite3_vtab_in_first=function(){return(n._sqlite3_vtab_in_first=n.asm.sqlite3_vtab_in_first).apply(null,arguments)},n._sqlite3_vtab_in_next=function(){return(n._sqlite3_vtab_in_next=n.asm.sqlite3_vtab_in_next).apply(null,arguments)},n._sqlite3_aggregate_context=function(){return(n._sqlite3_aggregate_context=n.asm.sqlite3_aggregate_context).apply(null,arguments)},n._sqlite3_get_auxdata=function(){return(n._sqlite3_get_auxdata=n.asm.sqlite3_get_auxdata).apply(null,arguments)},n._sqlite3_set_auxdata=function(){return(n._sqlite3_set_auxdata=n.asm.sqlite3_set_auxdata).apply(null,arguments)},n._sqlite3_column_count=function(){return(n._sqlite3_column_count=n.asm.sqlite3_column_count).apply(null,arguments)},n._sqlite3_data_count=function(){return(n._sqlite3_data_count=n.asm.sqlite3_data_count).apply(null,arguments)},n._sqlite3_column_blob=function(){return(n._sqlite3_column_blob=n.asm.sqlite3_column_blob).apply(null,arguments)},n._sqlite3_column_bytes=function(){return(n._sqlite3_column_bytes=n.asm.sqlite3_column_bytes).apply(null,arguments)},n._sqlite3_column_double=function(){return(n._sqlite3_column_double=n.asm.sqlite3_column_double).apply(null,arguments)},n._sqlite3_column_text=function(){return(n._sqlite3_column_text=n.asm.sqlite3_column_text).apply(null,arguments)},n._sqlite3_column_value=function(){return(n._sqlite3_column_value=n.asm.sqlite3_column_value).apply(null,arguments)},n._sqlite3_column_type=function(){return(n._sqlite3_column_type=n.asm.sqlite3_column_type).apply(null,arguments)},n._sqlite3_column_name=function(){return(n._sqlite3_column_name=n.asm.sqlite3_column_name).apply(null,arguments)},n._sqlite3_bind_blob=function(){return(n._sqlite3_bind_blob=n.asm.sqlite3_bind_blob).apply(null,arguments)},n._sqlite3_bind_double=function(){return(n._sqlite3_bind_double=n.asm.sqlite3_bind_double).apply(null,arguments)},n._sqlite3_bind_int=function(){return(n._sqlite3_bind_int=n.asm.sqlite3_bind_int).apply(null,arguments)},n._sqlite3_bind_int64=function(){return(n._sqlite3_bind_int64=n.asm.sqlite3_bind_int64).apply(null,arguments)},n._sqlite3_bind_null=function(){return(n._sqlite3_bind_null=n.asm.sqlite3_bind_null).apply(null,arguments)},n._sqlite3_bind_pointer=function(){return(n._sqlite3_bind_pointer=n.asm.sqlite3_bind_pointer).apply(null,arguments)},n._sqlite3_bind_text=function(){return(n._sqlite3_bind_text=n.asm.sqlite3_bind_text).apply(null,arguments)},n._sqlite3_bind_parameter_count=function(){return(n._sqlite3_bind_parameter_count=n.asm.sqlite3_bind_parameter_count).apply(null,arguments)},n._sqlite3_bind_parameter_index=function(){return(n._sqlite3_bind_parameter_index=n.asm.sqlite3_bind_parameter_index).apply(null,arguments)},n._sqlite3_db_handle=function(){return(n._sqlite3_db_handle=n.asm.sqlite3_db_handle).apply(null,arguments)},n._sqlite3_stmt_readonly=function(){return(n._sqlite3_stmt_readonly=n.asm.sqlite3_stmt_readonly).apply(null,arguments)},n._sqlite3_stmt_isexplain=function(){return(n._sqlite3_stmt_isexplain=n.asm.sqlite3_stmt_isexplain).apply(null,arguments)},n._sqlite3_stmt_status=function(){return(n._sqlite3_stmt_status=n.asm.sqlite3_stmt_status).apply(null,arguments)},n._sqlite3_sql=function(){return(n._sqlite3_sql=n.asm.sqlite3_sql).apply(null,arguments)},n._sqlite3_expanded_sql=function(){return(n._sqlite3_expanded_sql=n.asm.sqlite3_expanded_sql).apply(null,arguments)},n._sqlite3_preupdate_old=function(){return(n._sqlite3_preupdate_old=n.asm.sqlite3_preupdate_old).apply(null,arguments)},n._sqlite3_preupdate_count=function(){return(n._sqlite3_preupdate_count=n.asm.sqlite3_preupdate_count).apply(null,arguments)},n._sqlite3_preupdate_depth=function(){return(n._sqlite3_preupdate_depth=n.asm.sqlite3_preupdate_depth).apply(null,arguments)},n._sqlite3_preupdate_blobwrite=function(){return(n._sqlite3_preupdate_blobwrite=n.asm.sqlite3_preupdate_blobwrite).apply(null,arguments)},n._sqlite3_preupdate_new=function(){return(n._sqlite3_preupdate_new=n.asm.sqlite3_preupdate_new).apply(null,arguments)},n._sqlite3_value_numeric_type=function(){return(n._sqlite3_value_numeric_type=n.asm.sqlite3_value_numeric_type).apply(null,arguments)},n._sqlite3_errmsg=function(){return(n._sqlite3_errmsg=n.asm.sqlite3_errmsg).apply(null,arguments)},n._sqlite3_set_authorizer=function(){return(n._sqlite3_set_authorizer=n.asm.sqlite3_set_authorizer).apply(null,arguments)},n._sqlite3_strglob=function(){return(n._sqlite3_strglob=n.asm.sqlite3_strglob).apply(null,arguments)},n._sqlite3_strlike=function(){return(n._sqlite3_strlike=n.asm.sqlite3_strlike).apply(null,arguments)},n._sqlite3_exec=function(){return(n._sqlite3_exec=n.asm.sqlite3_exec).apply(null,arguments)},n._sqlite3_auto_extension=function(){return(n._sqlite3_auto_extension=n.asm.sqlite3_auto_extension).apply(null,arguments)},n._sqlite3_cancel_auto_extension=function(){return(n._sqlite3_cancel_auto_extension=n.asm.sqlite3_cancel_auto_extension).apply(null,arguments)},n._sqlite3_reset_auto_extension=function(){return(n._sqlite3_reset_auto_extension=n.asm.sqlite3_reset_auto_extension).apply(null,arguments)},n._sqlite3_prepare_v3=function(){return(n._sqlite3_prepare_v3=n.asm.sqlite3_prepare_v3).apply(null,arguments)},n._sqlite3_create_module=function(){return(n._sqlite3_create_module=n.asm.sqlite3_create_module).apply(null,arguments)},n._sqlite3_create_module_v2=function(){return(n._sqlite3_create_module_v2=n.asm.sqlite3_create_module_v2).apply(null,arguments)},n._sqlite3_drop_modules=function(){return(n._sqlite3_drop_modules=n.asm.sqlite3_drop_modules).apply(null,arguments)},n._sqlite3_declare_vtab=function(){return(n._sqlite3_declare_vtab=n.asm.sqlite3_declare_vtab).apply(null,arguments)},n._sqlite3_vtab_on_conflict=function(){return(n._sqlite3_vtab_on_conflict=n.asm.sqlite3_vtab_on_conflict).apply(null,arguments)},n._sqlite3_vtab_collation=function(){return(n._sqlite3_vtab_collation=n.asm.sqlite3_vtab_collation).apply(null,arguments)},n._sqlite3_vtab_in=function(){return(n._sqlite3_vtab_in=n.asm.sqlite3_vtab_in).apply(null,arguments)},n._sqlite3_vtab_rhs_value=function(){return(n._sqlite3_vtab_rhs_value=n.asm.sqlite3_vtab_rhs_value).apply(null,arguments)},n._sqlite3_vtab_distinct=function(){return(n._sqlite3_vtab_distinct=n.asm.sqlite3_vtab_distinct).apply(null,arguments)},n._sqlite3_keyword_name=function(){return(n._sqlite3_keyword_name=n.asm.sqlite3_keyword_name).apply(null,arguments)},n._sqlite3_keyword_count=function(){return(n._sqlite3_keyword_count=n.asm.sqlite3_keyword_count).apply(null,arguments)},n._sqlite3_keyword_check=function(){return(n._sqlite3_keyword_check=n.asm.sqlite3_keyword_check).apply(null,arguments)},n._sqlite3_complete=function(){return(n._sqlite3_complete=n.asm.sqlite3_complete).apply(null,arguments)},n._sqlite3_libversion=function(){return(n._sqlite3_libversion=n.asm.sqlite3_libversion).apply(null,arguments)},n._sqlite3_libversion_number=function(){return(n._sqlite3_libversion_number=n.asm.sqlite3_libversion_number).apply(null,arguments)},n._sqlite3_shutdown=function(){return(n._sqlite3_shutdown=n.asm.sqlite3_shutdown).apply(null,arguments)},n._sqlite3_last_insert_rowid=function(){return(n._sqlite3_last_insert_rowid=n.asm.sqlite3_last_insert_rowid).apply(null,arguments)},n._sqlite3_set_last_insert_rowid=function(){return(n._sqlite3_set_last_insert_rowid=n.asm.sqlite3_set_last_insert_rowid).apply(null,arguments)},n._sqlite3_changes64=function(){return(n._sqlite3_changes64=n.asm.sqlite3_changes64).apply(null,arguments)},n._sqlite3_changes=function(){return(n._sqlite3_changes=n.asm.sqlite3_changes).apply(null,arguments)},n._sqlite3_total_changes64=function(){return(n._sqlite3_total_changes64=n.asm.sqlite3_total_changes64).apply(null,arguments)},n._sqlite3_total_changes=function(){return(n._sqlite3_total_changes=n.asm.sqlite3_total_changes).apply(null,arguments)},n._sqlite3_txn_state=function(){return(n._sqlite3_txn_state=n.asm.sqlite3_txn_state).apply(null,arguments)},n._sqlite3_close_v2=function(){return(n._sqlite3_close_v2=n.asm.sqlite3_close_v2).apply(null,arguments)},n._sqlite3_busy_handler=function(){return(n._sqlite3_busy_handler=n.asm.sqlite3_busy_handler).apply(null,arguments)},n._sqlite3_progress_handler=function(){return(n._sqlite3_progress_handler=n.asm.sqlite3_progress_handler).apply(null,arguments)},n._sqlite3_busy_timeout=function(){return(n._sqlite3_busy_timeout=n.asm.sqlite3_busy_timeout).apply(null,arguments)},n._sqlite3_create_function=function(){return(n._sqlite3_create_function=n.asm.sqlite3_create_function).apply(null,arguments)},n._sqlite3_create_function_v2=function(){return(n._sqlite3_create_function_v2=n.asm.sqlite3_create_function_v2).apply(null,arguments)},n._sqlite3_create_window_function=function(){return(n._sqlite3_create_window_function=n.asm.sqlite3_create_window_function).apply(null,arguments)},n._sqlite3_overload_function=function(){return(n._sqlite3_overload_function=n.asm.sqlite3_overload_function).apply(null,arguments)},n._sqlite3_trace_v2=function(){return(n._sqlite3_trace_v2=n.asm.sqlite3_trace_v2).apply(null,arguments)},n._sqlite3_commit_hook=function(){return(n._sqlite3_commit_hook=n.asm.sqlite3_commit_hook).apply(null,arguments)},n._sqlite3_update_hook=function(){return(n._sqlite3_update_hook=n.asm.sqlite3_update_hook).apply(null,arguments)},n._sqlite3_rollback_hook=function(){return(n._sqlite3_rollback_hook=n.asm.sqlite3_rollback_hook).apply(null,arguments)},n._sqlite3_preupdate_hook=function(){return(n._sqlite3_preupdate_hook=n.asm.sqlite3_preupdate_hook).apply(null,arguments)},n._sqlite3_error_offset=function(){return(n._sqlite3_error_offset=n.asm.sqlite3_error_offset).apply(null,arguments)},n._sqlite3_errcode=function(){return(n._sqlite3_errcode=n.asm.sqlite3_errcode).apply(null,arguments)},n._sqlite3_extended_errcode=function(){return(n._sqlite3_extended_errcode=n.asm.sqlite3_extended_errcode).apply(null,arguments)},n._sqlite3_errstr=function(){return(n._sqlite3_errstr=n.asm.sqlite3_errstr).apply(null,arguments)},n._sqlite3_limit=function(){return(n._sqlite3_limit=n.asm.sqlite3_limit).apply(null,arguments)},n._sqlite3_open=function(){return(n._sqlite3_open=n.asm.sqlite3_open).apply(null,arguments)},n._sqlite3_open_v2=function(){return(n._sqlite3_open_v2=n.asm.sqlite3_open_v2).apply(null,arguments)},n._sqlite3_create_collation=function(){return(n._sqlite3_create_collation=n.asm.sqlite3_create_collation).apply(null,arguments)},n._sqlite3_create_collation_v2=function(){return(n._sqlite3_create_collation_v2=n.asm.sqlite3_create_collation_v2).apply(null,arguments)},n._sqlite3_collation_needed=function(){return(n._sqlite3_collation_needed=n.asm.sqlite3_collation_needed).apply(null,arguments)},n._sqlite3_table_column_metadata=function(){return(n._sqlite3_table_column_metadata=n.asm.sqlite3_table_column_metadata).apply(null,arguments)},n._sqlite3_extended_result_codes=function(){return(n._sqlite3_extended_result_codes=n.asm.sqlite3_extended_result_codes).apply(null,arguments)},n._sqlite3_uri_key=function(){return(n._sqlite3_uri_key=n.asm.sqlite3_uri_key).apply(null,arguments)},n._sqlite3_uri_int64=function(){return(n._sqlite3_uri_int64=n.asm.sqlite3_uri_int64).apply(null,arguments)},n._sqlite3_db_name=function(){return(n._sqlite3_db_name=n.asm.sqlite3_db_name).apply(null,arguments)},n._sqlite3_db_filename=function(){return(n._sqlite3_db_filename=n.asm.sqlite3_db_filename).apply(null,arguments)},n._sqlite3_compileoption_used=function(){return(n._sqlite3_compileoption_used=n.asm.sqlite3_compileoption_used).apply(null,arguments)},n._sqlite3_compileoption_get=function(){return(n._sqlite3_compileoption_get=n.asm.sqlite3_compileoption_get).apply(null,arguments)},n._sqlite3session_diff=function(){return(n._sqlite3session_diff=n.asm.sqlite3session_diff).apply(null,arguments)},n._sqlite3session_attach=function(){return(n._sqlite3session_attach=n.asm.sqlite3session_attach).apply(null,arguments)},n._sqlite3session_create=function(){return(n._sqlite3session_create=n.asm.sqlite3session_create).apply(null,arguments)},n._sqlite3session_delete=function(){return(n._sqlite3session_delete=n.asm.sqlite3session_delete).apply(null,arguments)},n._sqlite3session_table_filter=function(){return(n._sqlite3session_table_filter=n.asm.sqlite3session_table_filter).apply(null,arguments)},n._sqlite3session_changeset=function(){return(n._sqlite3session_changeset=n.asm.sqlite3session_changeset).apply(null,arguments)},n._sqlite3session_changeset_strm=function(){return(n._sqlite3session_changeset_strm=n.asm.sqlite3session_changeset_strm).apply(null,arguments)},n._sqlite3session_patchset_strm=function(){return(n._sqlite3session_patchset_strm=n.asm.sqlite3session_patchset_strm).apply(null,arguments)},n._sqlite3session_patchset=function(){return(n._sqlite3session_patchset=n.asm.sqlite3session_patchset).apply(null,arguments)},n._sqlite3session_enable=function(){return(n._sqlite3session_enable=n.asm.sqlite3session_enable).apply(null,arguments)},n._sqlite3session_indirect=function(){return(n._sqlite3session_indirect=n.asm.sqlite3session_indirect).apply(null,arguments)},n._sqlite3session_isempty=function(){return(n._sqlite3session_isempty=n.asm.sqlite3session_isempty).apply(null,arguments)},n._sqlite3session_memory_used=function(){return(n._sqlite3session_memory_used=n.asm.sqlite3session_memory_used).apply(null,arguments)},n._sqlite3session_object_config=function(){return(n._sqlite3session_object_config=n.asm.sqlite3session_object_config).apply(null,arguments)},n._sqlite3session_changeset_size=function(){return(n._sqlite3session_changeset_size=n.asm.sqlite3session_changeset_size).apply(null,arguments)},n._sqlite3changeset_start=function(){return(n._sqlite3changeset_start=n.asm.sqlite3changeset_start).apply(null,arguments)},n._sqlite3changeset_start_v2=function(){return(n._sqlite3changeset_start_v2=n.asm.sqlite3changeset_start_v2).apply(null,arguments)},n._sqlite3changeset_start_strm=function(){return(n._sqlite3changeset_start_strm=n.asm.sqlite3changeset_start_strm).apply(null,arguments)},n._sqlite3changeset_start_v2_strm=function(){return(n._sqlite3changeset_start_v2_strm=n.asm.sqlite3changeset_start_v2_strm).apply(null,arguments)},n._sqlite3changeset_next=function(){return(n._sqlite3changeset_next=n.asm.sqlite3changeset_next).apply(null,arguments)},n._sqlite3changeset_op=function(){return(n._sqlite3changeset_op=n.asm.sqlite3changeset_op).apply(null,arguments)},n._sqlite3changeset_pk=function(){return(n._sqlite3changeset_pk=n.asm.sqlite3changeset_pk).apply(null,arguments)},n._sqlite3changeset_old=function(){return(n._sqlite3changeset_old=n.asm.sqlite3changeset_old).apply(null,arguments)},n._sqlite3changeset_new=function(){return(n._sqlite3changeset_new=n.asm.sqlite3changeset_new).apply(null,arguments)},n._sqlite3changeset_conflict=function(){return(n._sqlite3changeset_conflict=n.asm.sqlite3changeset_conflict).apply(null,arguments)},n._sqlite3changeset_fk_conflicts=function(){return(n._sqlite3changeset_fk_conflicts=n.asm.sqlite3changeset_fk_conflicts).apply(null,arguments)},n._sqlite3changeset_finalize=function(){return(n._sqlite3changeset_finalize=n.asm.sqlite3changeset_finalize).apply(null,arguments)},n._sqlite3changeset_invert=function(){return(n._sqlite3changeset_invert=n.asm.sqlite3changeset_invert).apply(null,arguments)},n._sqlite3changeset_invert_strm=function(){return(n._sqlite3changeset_invert_strm=n.asm.sqlite3changeset_invert_strm).apply(null,arguments)},n._sqlite3changeset_apply_v2=function(){return(n._sqlite3changeset_apply_v2=n.asm.sqlite3changeset_apply_v2).apply(null,arguments)},n._sqlite3changeset_apply=function(){return(n._sqlite3changeset_apply=n.asm.sqlite3changeset_apply).apply(null,arguments)},n._sqlite3changeset_apply_v2_strm=function(){return(n._sqlite3changeset_apply_v2_strm=n.asm.sqlite3changeset_apply_v2_strm).apply(null,arguments)},n._sqlite3changeset_apply_strm=function(){return(n._sqlite3changeset_apply_strm=n.asm.sqlite3changeset_apply_strm).apply(null,arguments)},n._sqlite3changegroup_new=function(){return(n._sqlite3changegroup_new=n.asm.sqlite3changegroup_new).apply(null,arguments)},n._sqlite3changegroup_add=function(){return(n._sqlite3changegroup_add=n.asm.sqlite3changegroup_add).apply(null,arguments)},n._sqlite3changegroup_output=function(){return(n._sqlite3changegroup_output=n.asm.sqlite3changegroup_output).apply(null,arguments)},n._sqlite3changegroup_add_strm=function(){return(n._sqlite3changegroup_add_strm=n.asm.sqlite3changegroup_add_strm).apply(null,arguments)},n._sqlite3changegroup_output_strm=function(){return(n._sqlite3changegroup_output_strm=n.asm.sqlite3changegroup_output_strm).apply(null,arguments)},n._sqlite3changegroup_delete=function(){return(n._sqlite3changegroup_delete=n.asm.sqlite3changegroup_delete).apply(null,arguments)},n._sqlite3changeset_concat=function(){return(n._sqlite3changeset_concat=n.asm.sqlite3changeset_concat).apply(null,arguments)},n._sqlite3changeset_concat_strm=function(){return(n._sqlite3changeset_concat_strm=n.asm.sqlite3changeset_concat_strm).apply(null,arguments)},n._sqlite3session_config=function(){return(n._sqlite3session_config=n.asm.sqlite3session_config).apply(null,arguments)},n._sqlite3_sourceid=function(){return(n._sqlite3_sourceid=n.asm.sqlite3_sourceid).apply(null,arguments)},n._sqlite3_wasm_pstack_ptr=function(){return(n._sqlite3_wasm_pstack_ptr=n.asm.sqlite3_wasm_pstack_ptr).apply(null,arguments)},n._sqlite3_wasm_pstack_restore=function(){return(n._sqlite3_wasm_pstack_restore=n.asm.sqlite3_wasm_pstack_restore).apply(null,arguments)},n._sqlite3_wasm_pstack_alloc=function(){return(n._sqlite3_wasm_pstack_alloc=n.asm.sqlite3_wasm_pstack_alloc).apply(null,arguments)},n._sqlite3_wasm_pstack_remaining=function(){return(n._sqlite3_wasm_pstack_remaining=n.asm.sqlite3_wasm_pstack_remaining).apply(null,arguments)},n._sqlite3_wasm_pstack_quota=function(){return(n._sqlite3_wasm_pstack_quota=n.asm.sqlite3_wasm_pstack_quota).apply(null,arguments)},n._sqlite3_wasm_db_error=function(){return(n._sqlite3_wasm_db_error=n.asm.sqlite3_wasm_db_error).apply(null,arguments)},n._sqlite3_wasm_test_struct=function(){return(n._sqlite3_wasm_test_struct=n.asm.sqlite3_wasm_test_struct).apply(null,arguments)},n._sqlite3_wasm_enum_json=function(){return(n._sqlite3_wasm_enum_json=n.asm.sqlite3_wasm_enum_json).apply(null,arguments)},n._sqlite3_wasm_vfs_unlink=function(){return(n._sqlite3_wasm_vfs_unlink=n.asm.sqlite3_wasm_vfs_unlink).apply(null,arguments)},n._sqlite3_wasm_db_vfs=function(){return(n._sqlite3_wasm_db_vfs=n.asm.sqlite3_wasm_db_vfs).apply(null,arguments)},n._sqlite3_wasm_db_reset=function(){return(n._sqlite3_wasm_db_reset=n.asm.sqlite3_wasm_db_reset).apply(null,arguments)},n._sqlite3_wasm_db_export_chunked=function(){return(n._sqlite3_wasm_db_export_chunked=n.asm.sqlite3_wasm_db_export_chunked).apply(null,arguments)},n._sqlite3_wasm_db_serialize=function(){return(n._sqlite3_wasm_db_serialize=n.asm.sqlite3_wasm_db_serialize).apply(null,arguments)},n._sqlite3_wasm_vfs_create_file=function(){return(n._sqlite3_wasm_vfs_create_file=n.asm.sqlite3_wasm_vfs_create_file).apply(null,arguments)},n._sqlite3_wasm_kvvfsMakeKeyOnPstack=function(){return(n._sqlite3_wasm_kvvfsMakeKeyOnPstack=n.asm.sqlite3_wasm_kvvfsMakeKeyOnPstack).apply(null,arguments)},n._sqlite3_wasm_kvvfs_methods=function(){return(n._sqlite3_wasm_kvvfs_methods=n.asm.sqlite3_wasm_kvvfs_methods).apply(null,arguments)},n._sqlite3_wasm_vtab_config=function(){return(n._sqlite3_wasm_vtab_config=n.asm.sqlite3_wasm_vtab_config).apply(null,arguments)},n._sqlite3_wasm_db_config_ip=function(){return(n._sqlite3_wasm_db_config_ip=n.asm.sqlite3_wasm_db_config_ip).apply(null,arguments)},n._sqlite3_wasm_db_config_pii=function(){return(n._sqlite3_wasm_db_config_pii=n.asm.sqlite3_wasm_db_config_pii).apply(null,arguments)},n._sqlite3_wasm_db_config_s=function(){return(n._sqlite3_wasm_db_config_s=n.asm.sqlite3_wasm_db_config_s).apply(null,arguments)},n._sqlite3_wasm_config_i=function(){return(n._sqlite3_wasm_config_i=n.asm.sqlite3_wasm_config_i).apply(null,arguments)},n._sqlite3_wasm_config_ii=function(){return(n._sqlite3_wasm_config_ii=n.asm.sqlite3_wasm_config_ii).apply(null,arguments)},n._sqlite3_wasm_config_j=function(){return(n._sqlite3_wasm_config_j=n.asm.sqlite3_wasm_config_j).apply(null,arguments)},n._sqlite3_wasm_init_wasmfs=function(){return(n._sqlite3_wasm_init_wasmfs=n.asm.sqlite3_wasm_init_wasmfs).apply(null,arguments)},n._sqlite3_wasm_test_intptr=function(){return(n._sqlite3_wasm_test_intptr=n.asm.sqlite3_wasm_test_intptr).apply(null,arguments)},n._sqlite3_wasm_test_voidptr=function(){return(n._sqlite3_wasm_test_voidptr=n.asm.sqlite3_wasm_test_voidptr).apply(null,arguments)},n._sqlite3_wasm_test_int64_max=function(){return(n._sqlite3_wasm_test_int64_max=n.asm.sqlite3_wasm_test_int64_max).apply(null,arguments)},n._sqlite3_wasm_test_int64_min=function(){return(n._sqlite3_wasm_test_int64_min=n.asm.sqlite3_wasm_test_int64_min).apply(null,arguments)},n._sqlite3_wasm_test_int64_times2=function(){return(n._sqlite3_wasm_test_int64_times2=n.asm.sqlite3_wasm_test_int64_times2).apply(null,arguments)},n._sqlite3_wasm_test_int64_minmax=function(){return(n._sqlite3_wasm_test_int64_minmax=n.asm.sqlite3_wasm_test_int64_minmax).apply(null,arguments)},n._sqlite3_wasm_test_int64ptr=function(){return(n._sqlite3_wasm_test_int64ptr=n.asm.sqlite3_wasm_test_int64ptr).apply(null,arguments)},n._sqlite3_wasm_test_stack_overflow=function(){return(n._sqlite3_wasm_test_stack_overflow=n.asm.sqlite3_wasm_test_stack_overflow).apply(null,arguments)},n._sqlite3_wasm_test_str_hello=function(){return(n._sqlite3_wasm_test_str_hello=n.asm.sqlite3_wasm_test_str_hello).apply(null,arguments)};var za=n._malloc=function(){return(za=n._malloc=n.asm.malloc).apply(null,arguments)};n._free=function(){return(n._free=n.asm.free).apply(null,arguments)},n._realloc=function(){return(n._realloc=n.asm.realloc).apply(null,arguments)},n.stackSave=function(){return(n.stackSave=n.asm.stackSave).apply(null,arguments)},n.stackRestore=function(){return(n.stackRestore=n.asm.stackRestore).apply(null,arguments)},n.stackAlloc=function(){return(n.stackAlloc=n.asm.stackAlloc).apply(null,arguments)},n.wasmMemory=In;var Cs;qi=function s(){Cs||Va(),Cs||(qi=s)};function Va(s){if(Hn>0||(fc(),Hn>0))return;function i(){Cs||(Cs=!0,n.calledRun=!0,!Sa&&(hc(),A(n),n.onRuntimeInitialized&&n.onRuntimeInitialized(),pc()))}n.setStatus?(n.setStatus("Running..."),setTimeout(function(){setTimeout(function(){n.setStatus("")},1),i()},1)):i()}if(n.preInit)for(typeof n.preInit=="function"&&(n.preInit=[n.preInit]);n.preInit.length>0;)n.preInit.pop()();return Va(),n.postRun||(n.postRun=[]),n.postRun.push(function(s){if(globalThis.sqlite3ApiBootstrap=function i(l=globalThis.sqlite3ApiConfig||i.defaultConfig){if(i.sqlite3)return console.warn("sqlite3ApiBootstrap() called multiple times.","Config and external initializers are ignored on calls after the first."),i.sqlite3;const a=Object.assign(Object.create(null),{exports:void 0,memory:void 0,bigIntEnabled:(()=>typeof s<"u"?!!s.HEAPU64:!!globalThis.BigInt64Array)(),debug:console.debug.bind(console),warn:console.warn.bind(console),error:console.error.bind(console),log:console.log.bind(console),wasmfsOpfsDir:"/opfs",useStdAlloc:!1},l||{});Object.assign(a,{allocExportName:a.useStdAlloc?"malloc":"sqlite3_malloc",deallocExportName:a.useStdAlloc?"free":"sqlite3_free",reallocExportName:a.useStdAlloc?"realloc":"sqlite3_realloc"},a),["exports","memory","wasmfsOpfsDir"].forEach(f=>{typeof a[f]=="function"&&(a[f]=a[f]())}),a.wasmOpfsDir=!1;const u=Object.create(null),d=Object.create(null),N=f=>u.sqlite3_js_rc_str&&u.sqlite3_js_rc_str(f)||"Unknown result code #"+f,S=f=>typeof f=="number"&&f===(f|0);class C extends Error{constructor(...p){let _;if(p.length)if(S(p[0]))if(_=p[0],p.length===1)super(N(p[0]));else{const P=N(_);typeof p[1]=="object"?super(P,p[1]):(p[0]=P+":",super(p.join(" ")))}else p.length===2&&typeof p[1]=="object"?super(...p):super(p.join(" "));this.resultCode=_||u.SQLITE_ERROR,this.name="SQLite3Error"}}C.toss=(...f)=>{throw new C(...f)};const z=C.toss;a.wasmfsOpfsDir&&!/^\/[^/]+$/.test(a.wasmfsOpfsDir)&&z("config.wasmfsOpfsDir must be falsy or in the form '/dir-name'.");const K=f=>typeof f!="bigint"&&f===(f|0)&&f<=2147483647&&f>=-2147483648,te=function f(p){return f._max||(f._max=BigInt("0x7fffffffffffffff"),f._min=~f._max),p>=f._min&&p<=f._max},k=f=>f>=-0x7fffffffn-1n&&f<=0x7fffffffn,m=function f(p){return f._min||(f._min=Number.MIN_SAFE_INTEGER,f._max=Number.MAX_SAFE_INTEGER),p>=f._min&&p<=f._max},y=f=>f&&f.constructor&&K(f.constructor.BYTES_PER_ELEMENT)?f:!1,x=typeof SharedArrayBuffer>"u"?function(){}:SharedArrayBuffer,E=f=>f.buffer instanceof x,q=(f,p,_)=>E(f)?f.slice(p,_):f.subarray(p,_),W=f=>f&&(f instanceof Uint8Array||f instanceof Int8Array||f instanceof ArrayBuffer),M=f=>f&&(f instanceof Uint8Array||f instanceof Int8Array||f instanceof ArrayBuffer),R=f=>W(f)||z("Value is not of a supported TypedArray type."),L=new TextDecoder("utf-8"),ie=function(f,p,_){return L.decode(q(f,p,_))},j=function(f){return M(f)?ie(f instanceof ArrayBuffer?new Uint8Array(f):f):Array.isArray(f)?f.join(""):(d.isPtr(f)&&(f=d.cstrToJs(f)),f)};class g extends Error{constructor(...p){p.length===2&&typeof p[1]=="object"?super(...p):p.length?super(p.join(" ")):super("Allocation failed."),this.resultCode=u.SQLITE_NOMEM,this.name="WasmAllocError"}}g.toss=(...f)=>{throw new g(...f)},Object.assign(u,{sqlite3_bind_blob:void 0,sqlite3_bind_text:void 0,sqlite3_create_function_v2:(f,p,_,P,F,ne,re,oe,he)=>{},sqlite3_create_function:(f,p,_,P,F,ne,re,oe)=>{},sqlite3_create_window_function:(f,p,_,P,F,ne,re,oe,he,ue)=>{},sqlite3_prepare_v3:(f,p,_,P,F,ne)=>{},sqlite3_prepare_v2:(f,p,_,P,F)=>{},sqlite3_exec:(f,p,_,P,F)=>{},sqlite3_randomness:(f,p)=>{}});const v={affirmBindableTypedArray:R,flexibleString:j,bigIntFits32:k,bigIntFits64:te,bigIntFitsDouble:m,isBindableTypedArray:W,isInt32:K,isSQLableTypedArray:M,isTypedArray:y,typedArrayToString:ie,isUIThread:()=>globalThis.window===globalThis&&!!globalThis.document,isSharedTypedArray:E,toss:function(...f){throw new Error(f.join(" "))},toss3:z,typedArrayPart:q};Object.assign(d,{ptrSizeof:a.wasmPtrSizeof||4,ptrIR:a.wasmPtrIR||"i32",bigIntEnabled:!!a.bigIntEnabled,exports:a.exports||z("Missing API config.exports (WASM module exports)."),memory:a.memory||a.exports.memory||z("API config object requires a WebAssembly.Memory object","in either config.exports.memory (exported)","or config.memory (imported)."),alloc:void 0,realloc:void 0,dealloc:void 0}),d.allocFromTypedArray=function(f){f instanceof ArrayBuffer&&(f=new Uint8Array(f)),R(f);const p=d.alloc(f.byteLength||1);return d.heapForSize(f.constructor).set(f.byteLength?f:[0],p),p};{const f=a.allocExportName,p=a.deallocExportName,_=a.reallocExportName;for(const P of[f,p,_])d.exports[P]instanceof Function||z("Missing required exports[",P,"] function.");d.alloc=function P(F){return P.impl(F)||g.toss("Failed to allocate",F," bytes.")},d.alloc.impl=d.exports[f],d.realloc=function P(F,ne){const re=P.impl(F,ne);return ne?re||g.toss("Failed to reallocate",ne," bytes."):0},d.realloc.impl=d.exports[_],d.dealloc=d.exports[p]}d.compileOptionUsed=function f(p){if(arguments.length){if(Array.isArray(p)){const _={};return p.forEach(P=>{_[P]=u.sqlite3_compileoption_used(P)}),_}else if(typeof p=="object")return Object.keys(p).forEach(_=>{p[_]=u.sqlite3_compileoption_used(_)}),p}else{if(f._result)return f._result;f._opt||(f._rx=/^([^=]+)=(.+)/,f._rxInt=/^-?\d+$/,f._opt=function(re,oe){const he=f._rx.exec(re);oe[0]=he?he[1]:re,oe[1]=he?f._rxInt.test(he[2])?+he[2]:he[2]:!0});const _={},P=[0,0];let F=0,ne;for(;ne=u.sqlite3_compileoption_get(F++);)f._opt(ne,P),_[P[0]]=P[1];return f._result=_}return typeof p=="string"?!!u.sqlite3_compileoption_used(p):!1},d.pstack=Object.assign(Object.create(null),{restore:d.exports.sqlite3_wasm_pstack_restore,alloc:function(f){return typeof f=="string"&&!(f=d.sizeofIR(f))&&g.toss("Invalid value for pstack.alloc(",arguments[0],")"),d.exports.sqlite3_wasm_pstack_alloc(f)||g.toss("Could not allocate",f,"bytes from the pstack.")},allocChunks:function(f,p){typeof p=="string"&&!(p=d.sizeofIR(p))&&g.toss("Invalid size value for allocChunks(",arguments[1],")");const _=d.pstack.alloc(f*p),P=[];let F=0,ne=0;for(;F<f;++F,ne+=p)P.push(_+ne);return P},allocPtr:(f=1,p=!0)=>f===1?d.pstack.alloc(p?8:d.ptrSizeof):d.pstack.allocChunks(f,p?8:d.ptrSizeof)}),Object.defineProperties(d.pstack,{pointer:{configurable:!1,iterable:!0,writeable:!1,get:d.exports.sqlite3_wasm_pstack_ptr},quota:{configurable:!1,iterable:!0,writeable:!1,get:d.exports.sqlite3_wasm_pstack_quota},remaining:{configurable:!1,iterable:!0,writeable:!1,get:d.exports.sqlite3_wasm_pstack_remaining}}),u.sqlite3_randomness=(...f)=>{if(f.length===1&&v.isTypedArray(f[0])&&f[0].BYTES_PER_ELEMENT===1){const p=f[0];if(p.byteLength===0)return d.exports.sqlite3_randomness(0,0),p;const _=d.pstack.pointer;try{let P=p.byteLength,F=0;const ne=d.exports.sqlite3_randomness,re=d.heap8u(),oe=P<512?P:512,he=d.pstack.alloc(oe);do{const ue=P>oe?oe:P;ne(ue,he),p.set(q(re,he,he+ue),F),P-=ue,F+=ue}while(P>0)}catch(P){console.error("Highly unexpected (and ignored!) exception in sqlite3_randomness():",P)}finally{d.pstack.restore(_)}return p}d.exports.sqlite3_randomness(...f)};let O;if(u.sqlite3_wasmfs_opfs_dir=function(){if(O!==void 0)return O;const f=a.wasmfsOpfsDir;if(console.error("sqlite3_wasmfs_opfs_dir() can no longer work due to incompatible WASMFS changes. It will be removed."),!f||!globalThis.FileSystemHandle||!globalThis.FileSystemDirectoryHandle||!globalThis.FileSystemFileHandle)return O="";try{return f&&d.xCallWrapped("sqlite3_wasm_init_wasmfs","i32",["string"],f)===0?O=f:O=""}catch{return O=""}},u.sqlite3_wasmfs_filename_is_persistent=function(f){const p=u.sqlite3_wasmfs_opfs_dir();return p&&f?f.startsWith(p+"/"):!1},u.sqlite3_js_db_uses_vfs=function(f,p,_=0){try{const P=u.sqlite3_vfs_find(p);return P?f?P===u.sqlite3_js_db_vfs(f,_)?P:!1:P===u.sqlite3_vfs_find(0)?P:!1:!1}catch{return!1}},u.sqlite3_js_vfs_list=function(){const f=[];let p=u.sqlite3_vfs_find(0);for(;p;){const _=new u.sqlite3_vfs(p);f.push(d.cstrToJs(_.$zName)),p=_.$pNext,_.dispose()}return f},u.sqlite3_js_db_export=function(f,p=0){f=d.xWrap.testConvertArg("sqlite3*",f),f||z("Invalid sqlite3* argument."),d.bigIntEnabled||z("BigInt64 support is not enabled.");const _=d.scopedAllocPush();let P;try{const F=d.scopedAlloc(8+d.ptrSizeof),ne=F+8,re=p?d.isPtr(p)?p:d.scopedAllocCString(""+p):0;let oe=d.exports.sqlite3_wasm_db_serialize(f,re,ne,F,0);oe&&z("Database serialization failed with code",w.capi.sqlite3_js_rc_str(oe)),P=d.peekPtr(ne);const he=d.peek(F,"i64");return oe=he?d.heap8u().slice(P,P+Number(he)):new Uint8Array,oe}finally{P&&d.exports.sqlite3_free(P),d.scopedAllocPop(_)}},u.sqlite3_js_db_vfs=(f,p=0)=>d.sqlite3_wasm_db_vfs(f,p),u.sqlite3_js_aggregate_context=(f,p)=>u.sqlite3_aggregate_context(f,p)||(p?g.toss("Cannot allocate",p,"bytes for sqlite3_aggregate_context()"):0),u.sqlite3_js_vfs_create_file=function(f,p,_,P){let F;_?(d.isPtr(_)?F=_:_ instanceof ArrayBuffer&&(_=new Uint8Array(_)),_ instanceof Uint8Array?(F=d.allocFromTypedArray(_),(arguments.length<4||!v.isInt32(P)||P<0)&&(P=_.byteLength)):C.toss("Invalid 3rd argument type for sqlite3_js_vfs_create_file().")):F=0,(!v.isInt32(P)||P<0)&&(d.dealloc(F),C.toss("Invalid 4th argument for sqlite3_js_vfs_create_file()."));try{const ne=d.sqlite3_wasm_vfs_create_file(f,p,F,P);ne&&C.toss("Creation of file failed with sqlite3 result code",u.sqlite3_js_rc_str(ne))}finally{d.dealloc(F)}},v.isUIThread()){const f=function(p){const _=Object.create(null);return _.prefix="kvvfs-"+p,_.stores=[],(p==="session"||p==="")&&_.stores.push(globalThis.sessionStorage),(p==="local"||p==="")&&_.stores.push(globalThis.localStorage),_};u.sqlite3_js_kvvfs_clear=function(p=""){let _=0;const P=f(p);return P.stores.forEach(F=>{const ne=[];let re;for(re=0;re<F.length;++re){const oe=F.key(re);oe.startsWith(P.prefix)&&ne.push(oe)}ne.forEach(oe=>F.removeItem(oe)),_+=ne.length}),_},u.sqlite3_js_kvvfs_size=function(p=""){let _=0;const P=f(p);return P.stores.forEach(F=>{let ne;for(ne=0;ne<F.length;++ne){const re=F.key(ne);re.startsWith(P.prefix)&&(_+=re.length,_+=F.getItem(re).length)}}),_*2}}u.sqlite3_db_config=(function(f,p,..._){switch(this.s||(this.s=d.xWrap("sqlite3_wasm_db_config_s","int",["sqlite3*","int","string:static"]),this.pii=d.xWrap("sqlite3_wasm_db_config_pii","int",["sqlite3*","int","*","int","int"]),this.ip=d.xWrap("sqlite3_wasm_db_config_ip","int",["sqlite3*","int","int","*"])),p){case u.SQLITE_DBCONFIG_ENABLE_FKEY:case u.SQLITE_DBCONFIG_ENABLE_TRIGGER:case u.SQLITE_DBCONFIG_ENABLE_FTS3_TOKENIZER:case u.SQLITE_DBCONFIG_ENABLE_LOAD_EXTENSION:case u.SQLITE_DBCONFIG_NO_CKPT_ON_CLOSE:case u.SQLITE_DBCONFIG_ENABLE_QPSG:case u.SQLITE_DBCONFIG_TRIGGER_EQP:case u.SQLITE_DBCONFIG_RESET_DATABASE:case u.SQLITE_DBCONFIG_DEFENSIVE:case u.SQLITE_DBCONFIG_WRITABLE_SCHEMA:case u.SQLITE_DBCONFIG_LEGACY_ALTER_TABLE:case u.SQLITE_DBCONFIG_DQS_DML:case u.SQLITE_DBCONFIG_DQS_DDL:case u.SQLITE_DBCONFIG_ENABLE_VIEW:case u.SQLITE_DBCONFIG_LEGACY_FILE_FORMAT:case u.SQLITE_DBCONFIG_TRUSTED_SCHEMA:case u.SQLITE_DBCONFIG_STMT_SCANSTATUS:case u.SQLITE_DBCONFIG_REVERSE_SCANORDER:return this.ip(f,p,_[0],_[1]||0);case u.SQLITE_DBCONFIG_LOOKASIDE:return this.pii(f,p,_[0],_[1],_[2]);case u.SQLITE_DBCONFIG_MAINDBNAME:return this.s(f,p,_[0]);default:return u.SQLITE_MISUSE}}).bind(Object.create(null)),u.sqlite3_value_to_js=function(f,p=!0){let _;const P=u.sqlite3_value_type(f);switch(P){case u.SQLITE_INTEGER:d.bigIntEnabled?(_=u.sqlite3_value_int64(f),v.bigIntFitsDouble(_)&&(_=Number(_))):_=u.sqlite3_value_double(f);break;case u.SQLITE_FLOAT:_=u.sqlite3_value_double(f);break;case u.SQLITE_TEXT:_=u.sqlite3_value_text(f);break;case u.SQLITE_BLOB:{const F=u.sqlite3_value_bytes(f),ne=u.sqlite3_value_blob(f);F&&!ne&&w.WasmAllocError.toss("Cannot allocate memory for blob argument of",F,"byte(s)"),_=F?d.heap8u().slice(ne,ne+Number(F)):null;break}case u.SQLITE_NULL:_=null;break;default:p&&z(u.SQLITE_MISMATCH,"Unhandled sqlite3_value_type():",P),_=void 0}return _},u.sqlite3_values_to_js=function(f,p,_=!0){let P;const F=[];for(P=0;P<f;++P)F.push(u.sqlite3_value_to_js(d.peekPtr(p+d.ptrSizeof*P)));return F},u.sqlite3_result_error_js=function(f,p){p instanceof g?u.sqlite3_result_error_nomem(f):u.sqlite3_result_error(f,""+p,-1)},u.sqlite3_result_js=function(f,p){if(p instanceof Error){u.sqlite3_result_error_js(f,p);return}try{switch(typeof p){case"undefined":break;case"boolean":u.sqlite3_result_int(f,p?1:0);break;case"bigint":v.bigIntFits32(p)?u.sqlite3_result_int(f,Number(p)):v.bigIntFitsDouble(p)?u.sqlite3_result_double(f,Number(p)):d.bigIntEnabled?v.bigIntFits64(p)?u.sqlite3_result_int64(f,p):z("BigInt value",p.toString(),"is too BigInt for int64."):z("BigInt value",p.toString(),"is too BigInt.");break;case"number":{let _;v.isInt32(p)?_=u.sqlite3_result_int:d.bigIntEnabled&&Number.isInteger(p)&&v.bigIntFits64(BigInt(p))?_=u.sqlite3_result_int64:_=u.sqlite3_result_double,_(f,p);break}case"string":{const[_,P]=d.allocCString(p,!0);u.sqlite3_result_text(f,_,P,u.SQLITE_WASM_DEALLOC);break}case"object":if(p===null){u.sqlite3_result_null(f);break}else if(v.isBindableTypedArray(p)){const _=d.allocFromTypedArray(p);u.sqlite3_result_blob(f,_,p.byteLength,u.SQLITE_WASM_DEALLOC);break}default:z("Don't not how to handle this UDF result value:",typeof p,p)}}catch(_){u.sqlite3_result_error_js(f,_)}},u.sqlite3_column_js=function(f,p,_=!0){const P=u.sqlite3_column_value(f,p);return P===0?void 0:u.sqlite3_value_to_js(P,_)};const b=(function(f,p,_){_=u[_],this.ptr?d.pokePtr(this.ptr,0):this.ptr=d.allocPtr();const P=_(f,p,this.ptr);if(P)return C.toss(P,arguments[2]+"() failed with code "+P);const F=d.peekPtr(this.ptr);return F?u.sqlite3_value_to_js(F,!0):void 0}).bind(Object.create(null));u.sqlite3_preupdate_new_js=(f,p)=>b(f,p,"sqlite3_preupdate_new"),u.sqlite3_preupdate_old_js=(f,p)=>b(f,p,"sqlite3_preupdate_old"),u.sqlite3changeset_new_js=(f,p)=>b(f,p,"sqlite3changeset_new"),u.sqlite3changeset_old_js=(f,p)=>b(f,p,"sqlite3changeset_old");const w={WasmAllocError:g,SQLite3Error:C,capi:u,util:v,wasm:d,config:a,version:Object.create(null),client:void 0,asyncPostInit:async function(){let f=i.initializersAsync;if(delete i.initializersAsync,!f||!f.length)return Promise.resolve(w);f=f.map(_=>(_ instanceof Promise?_:_(w)).catch(F=>{throw console.error("an async sqlite3 initializer failed:",F),F}));const p=()=>(w.__isUnderTest||(delete w.util,delete w.StructBinder),w);{let _=f.shift();for(;f.length;)_=_.then(f.shift());return _.then(p)}},scriptInfo:void 0};try{i.initializers.forEach(f=>{f(w)})}catch(f){throw console.error("sqlite3 bootstrap initializer threw:",f),f}return delete i.initializers,i.sqlite3=w,w},globalThis.sqlite3ApiBootstrap.initializers=[],globalThis.sqlite3ApiBootstrap.initializersAsync=[],globalThis.sqlite3ApiBootstrap.defaultConfig=Object.create(null),globalThis.sqlite3ApiBootstrap.sqlite3=void 0,globalThis.WhWasmUtilInstaller=function(i){var j;i.bigIntEnabled===void 0&&(i.bigIntEnabled=!!self.BigInt64Array);const l=(...g)=>{throw new Error(g.join(" "))};i.exports||Object.defineProperty(i,"exports",{enumerable:!0,configurable:!0,get:()=>i.instance&&i.instance.exports});const a=i.pointerIR||"i32",u=i.ptrSizeof=a==="i32"?4:a==="i64"?8:l("Unhandled ptrSizeof:",a),d=Object.create(null);d.heapSize=0,d.memory=null,d.freeFuncIndexes=[],d.scopedAlloc=[],d.utf8Decoder=new TextDecoder,d.utf8Encoder=new TextEncoder("utf-8"),i.sizeofIR=g=>{switch(g){case"i8":return 1;case"i16":return 2;case"i32":case"f32":case"float":return 4;case"i64":case"f64":case"double":return 8;case"*":return u;default:return(""+g).endsWith("*")?u:void 0}};const N=function(){if(!d.memory)d.memory=i.memory instanceof WebAssembly.Memory?i.memory:i.exports.memory;else if(d.heapSize===d.memory.buffer.byteLength)return d;const g=d.memory.buffer;return d.HEAP8=new Int8Array(g),d.HEAP8U=new Uint8Array(g),d.HEAP16=new Int16Array(g),d.HEAP16U=new Uint16Array(g),d.HEAP32=new Int32Array(g),d.HEAP32U=new Uint32Array(g),i.bigIntEnabled&&(d.HEAP64=new BigInt64Array(g),d.HEAP64U=new BigUint64Array(g)),d.HEAP32F=new Float32Array(g),d.HEAP64F=new Float64Array(g),d.heapSize=g.byteLength,d};i.heap8=()=>N().HEAP8,i.heap8u=()=>N().HEAP8U,i.heap16=()=>N().HEAP16,i.heap16u=()=>N().HEAP16U,i.heap32=()=>N().HEAP32,i.heap32u=()=>N().HEAP32U,i.heapForSize=function(g,v=!0){const O=d.memory&&d.heapSize===d.memory.buffer.byteLength?d:N();switch(g){case Int8Array:return O.HEAP8;case Uint8Array:return O.HEAP8U;case Int16Array:return O.HEAP16;case Uint16Array:return O.HEAP16U;case Int32Array:return O.HEAP32;case Uint32Array:return O.HEAP32U;case 8:return v?O.HEAP8U:O.HEAP8;case 16:return v?O.HEAP16U:O.HEAP16;case 32:return v?O.HEAP32U:O.HEAP32;case 64:if(O.HEAP64)return v?O.HEAP64U:O.HEAP64;break;default:if(i.bigIntEnabled){if(g===self.BigUint64Array)return O.HEAP64U;if(g===self.BigInt64Array)return O.HEAP64;break}}l("Invalid heapForSize() size: expecting 8, 16, 32,","or (if BigInt is enabled) 64.")},i.functionTable=function(){return i.exports.__indirect_function_table},i.functionEntry=function(g){const v=i.functionTable();return g<v.length?v.get(g):void 0},i.jsFuncToWasm=function g(v,O){if(g._||(g._={sigTypes:Object.assign(Object.create(null),{i:"i32",p:"i32",P:"i32",s:"i32",j:"i64",f:"f32",d:"f64"}),typeCodes:Object.assign(Object.create(null),{f64:124,f32:125,i64:126,i32:127}),uleb128Encode:function(f,p,_){_<128?f[p](_):f[p](_%128|128,_>>7)},rxJSig:/^(\w)\((\w*)\)$/,sigParams:function(f){const p=g._.rxJSig.exec(f);return p?p[2]:f.substr(1)},letterType:f=>g._.sigTypes[f]||l("Invalid signature letter:",f),pushSigType:(f,p)=>f.push(g._.typeCodes[g._.letterType(p)])}),typeof v=="string"){const f=O;O=v,v=f}const b=g._.sigParams(O),w=[1,96];g._.uleb128Encode(w,"push",b.length);for(const f of b)g._.pushSigType(w,f);return O[0]==="v"?w.push(0):(w.push(1),g._.pushSigType(w,O[0])),g._.uleb128Encode(w,"unshift",w.length),w.unshift(0,97,115,109,1,0,0,0,1),w.push(2,7,1,1,101,1,102,0,0,7,5,1,1,102,0,0),new WebAssembly.Instance(new WebAssembly.Module(new Uint8Array(w)),{e:{f:v}}).exports.f};const S=function(v,O,b){if(b&&!d.scopedAlloc.length&&l("No scopedAllocPush() scope is active."),typeof v=="string"){const _=O;O=v,v=_}(typeof O!="string"||!(v instanceof Function))&&l("Invalid arguments: expecting (function,signature) or (signature,function).");const w=i.functionTable(),f=w.length;let p;for(;d.freeFuncIndexes.length&&(p=d.freeFuncIndexes.pop(),w.get(p));){p=null;continue}p||(p=f,w.grow(1));try{return w.set(p,v),b&&d.scopedAlloc[d.scopedAlloc.length-1].push(p),p}catch(_){if(!(_ instanceof TypeError))throw p===f&&d.freeFuncIndexes.push(f),_}try{const _=i.jsFuncToWasm(v,O);w.set(p,_),b&&d.scopedAlloc[d.scopedAlloc.length-1].push(p)}catch(_){throw p===f&&d.freeFuncIndexes.push(f),_}return p};i.installFunction=(g,v)=>S(g,v,!1),i.scopedInstallFunction=(g,v)=>S(g,v,!0),i.uninstallFunction=function(g){if(!g&&g!==0)return;const v=d.freeFuncIndexes,O=i.functionTable();v.push(g);const b=O.get(g);return O.set(g,null),b},i.peek=function(v,O="i8"){O.endsWith("*")&&(O=a);const b=d.memory&&d.heapSize===d.memory.buffer.byteLength?d:N(),w=Array.isArray(v)?[]:void 0;let f;do{switch(w&&(v=arguments[0].shift()),O){case"i1":case"i8":f=b.HEAP8[v>>0];break;case"i16":f=b.HEAP16[v>>1];break;case"i32":f=b.HEAP32[v>>2];break;case"float":case"f32":f=b.HEAP32F[v>>2];break;case"double":case"f64":f=Number(b.HEAP64F[v>>3]);break;case"i64":if(i.bigIntEnabled){f=BigInt(b.HEAP64[v>>3]);break}default:l("Invalid type for peek():",O)}w&&w.push(f)}while(w&&arguments[0].length);return w||f},i.poke=function(g,v,O="i8"){O.endsWith("*")&&(O=a);const b=d.memory&&d.heapSize===d.memory.buffer.byteLength?d:N();for(const w of Array.isArray(g)?g:[g])switch(O){case"i1":case"i8":b.HEAP8[w>>0]=v;continue;case"i16":b.HEAP16[w>>1]=v;continue;case"i32":b.HEAP32[w>>2]=v;continue;case"float":case"f32":b.HEAP32F[w>>2]=v;continue;case"double":case"f64":b.HEAP64F[w>>3]=v;continue;case"i64":if(b.HEAP64){b.HEAP64[w>>3]=BigInt(v);continue}default:l("Invalid type for poke(): "+O)}return this},i.peekPtr=(...g)=>i.peek(g.length===1?g[0]:g,a),i.pokePtr=(g,v=0)=>i.poke(g,v,a),i.peek8=(...g)=>i.peek(g.length===1?g[0]:g,"i8"),i.poke8=(g,v)=>i.poke(g,v,"i8"),i.peek16=(...g)=>i.peek(g.length===1?g[0]:g,"i16"),i.poke16=(g,v)=>i.poke(g,v,"i16"),i.peek32=(...g)=>i.peek(g.length===1?g[0]:g,"i32"),i.poke32=(g,v)=>i.poke(g,v,"i32"),i.peek64=(...g)=>i.peek(g.length===1?g[0]:g,"i64"),i.poke64=(g,v)=>i.poke(g,v,"i64"),i.peek32f=(...g)=>i.peek(g.length===1?g[0]:g,"f32"),i.poke32f=(g,v)=>i.poke(g,v,"f32"),i.peek64f=(...g)=>i.peek(g.length===1?g[0]:g,"f64"),i.poke64f=(g,v)=>i.poke(g,v,"f64"),i.getMemValue=i.peek,i.getPtrValue=i.peekPtr,i.setMemValue=i.poke,i.setPtrValue=i.pokePtr,i.isPtr32=g=>typeof g=="number"&&g===(g|0)&&g>=0,i.isPtr=i.isPtr32,i.cstrlen=function(g){if(!g||!i.isPtr(g))return null;const v=N().HEAP8U;let O=g;for(;v[O]!==0;++O);return O-g};const C=typeof SharedArrayBuffer>"u"?function(){}:SharedArrayBuffer,z=function(g,v,O){return d.utf8Decoder.decode(g.buffer instanceof C?g.slice(v,O):g.subarray(v,O))};i.cstrToJs=function(g){const v=i.cstrlen(g);return v?z(N().HEAP8U,g,g+v):v===null?v:""},i.jstrlen=function(g){if(typeof g!="string")return null;const v=g.length;let O=0;for(let b=0;b<v;++b){let w=g.charCodeAt(b);w>=55296&&w<=57343&&(w=65536+((w&1023)<<10)|g.charCodeAt(++b)&1023),w<=127?++O:w<=2047?O+=2:w<=65535?O+=3:O+=4}return O},i.jstrcpy=function(g,v,O=0,b=-1,w=!0){if((!v||!(v instanceof Int8Array)&&!(v instanceof Uint8Array))&&l("jstrcpy() target must be an Int8Array or Uint8Array."),b<0&&(b=v.length-O),!(b>0)||!(O>=0))return 0;let f=0,p=g.length;const _=O,P=O+b-(w?1:0);for(;f<p&&O<P;++f){let F=g.charCodeAt(f);if(F>=55296&&F<=57343&&(F=65536+((F&1023)<<10)|g.charCodeAt(++f)&1023),F<=127){if(O>=P)break;v[O++]=F}else if(F<=2047){if(O+1>=P)break;v[O++]=192|F>>6,v[O++]=128|F&63}else if(F<=65535){if(O+2>=P)break;v[O++]=224|F>>12,v[O++]=128|F>>6&63,v[O++]=128|F&63}else{if(O+3>=P)break;v[O++]=240|F>>18,v[O++]=128|F>>12&63,v[O++]=128|F>>6&63,v[O++]=128|F&63}}return w&&(v[O++]=0),O-_},i.cstrncpy=function(g,v,O){if((!g||!v)&&l("cstrncpy() does not accept NULL strings."),O<0)O=i.cstrlen(strPtr)+1;else if(!(O>0))return 0;const b=i.heap8u();let w=0,f;for(;w<O&&(f=b[v+w]);++w)b[g+w]=f;return w<O&&(b[g+w++]=0),w},i.jstrToUintArray=(g,v=!1)=>d.utf8Encoder.encode(v?g+"\0":g);const K=(g,v)=>{(!(g.alloc instanceof Function)||!(g.dealloc instanceof Function))&&l("Object is missing alloc() and/or dealloc() function(s)","required by",v+"().")},te=function(g,v,O,b){if(K(i,b),typeof g!="string")return null;{const w=d.utf8Encoder.encode(g),f=O(w.length+1),p=N().HEAP8U;return p.set(w,f),p[f+w.length]=0,v?[f,w.length]:f}};i.allocCString=(g,v=!1)=>te(g,v,i.alloc,"allocCString()"),i.scopedAllocPush=function(){K(i,"scopedAllocPush");const g=[];return d.scopedAlloc.push(g),g},i.scopedAllocPop=function(g){K(i,"scopedAllocPop");const v=arguments.length?d.scopedAlloc.indexOf(g):d.scopedAlloc.length-1;v<0&&l("Invalid state object for scopedAllocPop()."),arguments.length===0&&(g=d.scopedAlloc[v]),d.scopedAlloc.splice(v,1);for(let O;O=g.pop();)i.functionEntry(O)?i.uninstallFunction(O):i.dealloc(O)},i.scopedAlloc=function(g){d.scopedAlloc.length||l("No scopedAllocPush() scope is active.");const v=i.alloc(g);return d.scopedAlloc[d.scopedAlloc.length-1].push(v),v},Object.defineProperty(i.scopedAlloc,"level",{configurable:!1,enumerable:!1,get:()=>d.scopedAlloc.length,set:()=>l("The 'active' property is read-only.")}),i.scopedAllocCString=(g,v=!1)=>te(g,v,i.scopedAlloc,"scopedAllocCString()");const k=function(g,v){const O=i[g?"scopedAlloc":"alloc"]((v.length+1)*i.ptrSizeof);let b=0;return v.forEach(w=>{i.pokePtr(O+i.ptrSizeof*b++,i[g?"scopedAllocCString":"allocCString"](""+w))}),i.pokePtr(O+i.ptrSizeof*b,0),O};i.scopedAllocMainArgv=g=>k(!0,g),i.allocMainArgv=g=>k(!1,g),i.cArgvToJs=(g,v)=>{const O=[];for(let b=0;b<g;++b){const w=i.peekPtr(v+i.ptrSizeof*b);O.push(w?i.cstrToJs(w):null)}return O},i.scopedAllocCall=function(g){i.scopedAllocPush();try{return g()}finally{i.scopedAllocPop()}};const m=function(g,v,O){K(i,O);const b=v?"i64":a;let w=i[O](g*(v?8:u));if(i.poke(w,0,b),g===1)return w;const f=[w];for(let p=1;p<g;++p)w+=v?8:u,f[p]=w,i.poke(w,0,b);return f};i.allocPtr=(g=1,v=!0)=>m(g,v,"alloc"),i.scopedAllocPtr=(g=1,v=!0)=>m(g,v,"scopedAlloc"),i.xGet=function(g){return i.exports[g]||l("Cannot find exported symbol:",g)};const y=(g,v)=>l(g+"() requires",v,"argument(s).");i.xCall=function(g,...v){const O=i.xGet(g);return O instanceof Function||l("Exported symbol",g,"is not a function."),O.length!==v.length&&y(g,O.length),arguments.length===2&&Array.isArray(arguments[1])?O.apply(null,arguments[1]):O.apply(null,v)},d.xWrap=Object.create(null),d.xWrap.convert=Object.create(null),d.xWrap.convert.arg=new Map,d.xWrap.convert.result=new Map;const x=d.xWrap.convert.arg,E=d.xWrap.convert.result;i.bigIntEnabled&&x.set("i64",g=>BigInt(g));const q=a==="i32"?g=>g|0:g=>BigInt(g)|BigInt(0);x.set("i32",q).set("i16",g=>(g|0)&65535).set("i8",g=>(g|0)&255).set("f32",g=>Number(g).valueOf()).set("float",x.get("f32")).set("f64",x.get("f32")).set("double",x.get("f64")).set("int",x.get("i32")).set("null",g=>g).set(null,x.get("null")).set("**",q).set("*",q),E.set("*",q).set("pointer",q).set("number",g=>Number(g)).set("void",g=>{}).set("null",g=>g).set(null,E.get("null"));{const g=["i8","i16","i32","int","f32","float","f64","double"];i.bigIntEnabled&&g.push("i64");const v=x.get(a);for(const O of g)x.set(O+"*",v),E.set(O+"*",v),E.set(O,x.get(O)||l("Missing arg converter:",O))}const W=function(g){return typeof g=="string"?i.scopedAllocCString(g):g?q(g):null};x.set("string",W).set("utf8",W).set("pointer",W),E.set("string",g=>i.cstrToJs(g)).set("utf8",E.get("string")).set("string:dealloc",g=>{try{return g?i.cstrToJs(g):null}finally{i.dealloc(g)}}).set("utf8:dealloc",E.get("string:dealloc")).set("json",g=>JSON.parse(i.cstrToJs(g))).set("json:dealloc",g=>{try{return g?JSON.parse(i.cstrToJs(g)):null}finally{i.dealloc(g)}});const M=class{constructor(g){this.name=g.name||"unnamed adapter"}convertArg(g,v,O){l("AbstractArgAdapter must be subclassed.")}};x.FuncPtrAdapter=(j=class extends M{constructor(v){super(v),x.FuncPtrAdapter.warnOnUse&&console.warn("xArg.FuncPtrAdapter is an internal-only API","and is not intended to be invoked from","client-level code. Invoked with:",v),this.signature=v.signature,v.contextKey instanceof Function&&(this.contextKey=v.contextKey,v.bindScope||(v.bindScope="context")),this.bindScope=v.bindScope||l("FuncPtrAdapter options requires a bindScope (explicit or implied)."),j.bindScopes.indexOf(v.bindScope)<0&&l("Invalid options.bindScope ("+v.bindMod+") for FuncPtrAdapter. Expecting one of: ("+j.bindScopes.join(", ")+")"),this.isTransient=this.bindScope==="transient",this.isContext=this.bindScope==="context",this.isPermanent=this.bindScope==="permanent",this.singleton=this.bindScope==="singleton"?[]:void 0,this.callProxy=v.callProxy instanceof Function?v.callProxy:void 0}contextKey(v,O){return this}contextMap(v){const O=this.__cmap||(this.__cmap=new Map);let b=O.get(v);return b===void 0&&O.set(v,b=[]),b}convertArg(v,O,b){let w=this.singleton;if(!w&&this.isContext&&(w=this.contextMap(this.contextKey(O,b))),w&&w[0]===v)return w[1];if(v instanceof Function){this.callProxy&&(v=this.callProxy(v));const f=S(v,this.signature,this.isTransient);if(j.debugFuncInstall&&j.debugOut("FuncPtrAdapter installed",this,this.contextKey(O,b),"@"+f,v),w){if(w[1]){j.debugFuncInstall&&j.debugOut("FuncPtrAdapter uninstalling",this,this.contextKey(O,b),"@"+w[1],v);try{i.uninstallFunction(w[1])}catch{}}w[0]=v,w[1]=f}return f}else if(i.isPtr(v)||v===null||v===void 0){if(w&&w[1]&&w[1]!==v){j.debugFuncInstall&&j.debugOut("FuncPtrAdapter uninstalling",this,this.contextKey(O,b),"@"+w[1],v);try{i.uninstallFunction(w[1])}catch{}w[0]=w[1]=v|0}return v||0}else throw new TypeError("Invalid FuncPtrAdapter argument type. Expecting a function pointer or a "+(this.name?this.name+" ":"")+"function matching signature "+this.signature+".")}},Oe(j,"warnOnUse",!1),Oe(j,"debugFuncInstall",!1),Oe(j,"debugOut",console.debug.bind(console)),Oe(j,"bindScopes",["transient","context","singleton","permanent"]),j);const R=g=>x.get(g)||l("Argument adapter not found:",g),L=g=>E.get(g)||l("Result adapter not found:",g);d.xWrap.convertArg=(g,...v)=>R(g)(...v),d.xWrap.convertArgNoCheck=(g,...v)=>x.get(g)(...v),d.xWrap.convertResult=(g,v)=>g===null?v:g?L(g)(v):void 0,d.xWrap.convertResultNoCheck=(g,v)=>g===null?v:g?E.get(g)(v):void 0,i.xWrap=function(g,v,...O){arguments.length===3&&Array.isArray(arguments[2])&&(O=arguments[2]),i.isPtr(g)&&(g=i.functionEntry(g)||l("Function pointer not found in WASM function table."));const b=g instanceof Function,w=b?g:i.xGet(g);if(b&&(g=w.name||"unnamed function"),O.length!==w.length&&y(g,w.length),v===null&&w.length===0)return w;v!=null&&L(v);for(const p of O)p instanceof M?x.set(p,(..._)=>p.convertArg(..._)):R(p);const f=d.xWrap;return w.length===0?(...p)=>p.length?y(g,w.length):f.convertResult(v,w.call(null)):function(...p){p.length!==w.length&&y(g,w.length);const _=i.scopedAllocPush();try{for(const P in p)p[P]=f.convertArgNoCheck(O[P],p[P],p,P);return f.convertResultNoCheck(v,w.apply(null,p))}finally{i.scopedAllocPop(_)}}};const ie=function(g,v,O,b,w,f){if(typeof O=="string"){if(v===1)return f.get(O);if(v===2){if(b)b instanceof Function||l(w,"requires a function argument.");else return delete f.get(O),g;return f.set(O,b),g}}l("Invalid arguments to",w)};return i.xWrap.resultAdapter=function g(v,O){return ie(g,arguments.length,v,O,"resultAdapter()",E)},i.xWrap.argAdapter=function g(v,O){return ie(g,arguments.length,v,O,"argAdapter()",x)},i.xWrap.FuncPtrAdapter=x.FuncPtrAdapter,i.xCallWrapped=function(g,v,O,...b){return Array.isArray(arguments[3])&&(b=arguments[3]),i.xWrap(g,v,O||[]).apply(null,b||[])},i.xWrap.testConvertArg=d.xWrap.convertArg,i.xWrap.testConvertResult=d.xWrap.convertResult,i},globalThis.WhWasmUtilInstaller.yawl=(function(i){const l=()=>fetch(i.uri,{credentials:"same-origin"}),a=this,u=function(N){if(i.wasmUtilTarget){const S=(...z)=>{throw new Error(z.join(" "))},C=i.wasmUtilTarget;if(C.module=N.module,C.instance=N.instance,C.instance.exports.memory||(C.memory=i.imports&&i.imports.env&&i.imports.env.memory||S("Missing 'memory' object!")),!C.alloc&&N.instance.exports.malloc){const z=N.instance.exports;C.alloc=function(K){return z.malloc(K)||S("Allocation of",K,"bytes failed.")},C.dealloc=function(K){z.free(K)}}a(C)}return i.onload&&i.onload(N,i),N};return WebAssembly.instantiateStreaming?function(){return WebAssembly.instantiateStreaming(l(),i.imports||{}).then(u)}:function(){return l().then(S=>S.arrayBuffer()).then(S=>WebAssembly.instantiate(S,i.imports||{})).then(u)}}).bind(globalThis.WhWasmUtilInstaller),globalThis.Jaccwabyt=function i(l){const a=(...T)=>{throw new Error(T.join(" "))};!(l.heap instanceof WebAssembly.Memory)&&!(l.heap instanceof Function)&&a("config.heap must be WebAssembly.Memory instance or a function."),["alloc","dealloc"].forEach(function(T){l[T]instanceof Function||a("Config option '"+T+"' must be a function.")});const u=i,d=l.heap instanceof Function?l.heap:()=>new Uint8Array(l.heap.buffer),N=l.alloc,S=l.dealloc,C=l.log||console.log.bind(console),z=l.memberPrefix||"",K=l.memberSuffix||"",te=l.bigIntEnabled===void 0?!!self.BigInt64Array:!!l.bigIntEnabled,k=self.BigInt,m=self.BigInt64Array,y=l.ptrSizeof||4,x=l.ptrIR||"i32";u.debugFlags||(u.__makeDebugFlags=function(T=null){T&&T.__flags&&(T=T.__flags);const J=function $(X){return arguments.length===0?$.__flags:(X<0?(delete $.__flags.getter,delete $.__flags.setter,delete $.__flags.alloc,delete $.__flags.dealloc):($.__flags.getter=(1&X)!==0,$.__flags.setter=(2&X)!==0,$.__flags.alloc=(4&X)!==0,$.__flags.dealloc=(8&X)!==0),$._flags)};return Object.defineProperty(J,"__flags",{iterable:!1,writable:!1,value:Object.create(T)}),T||J(0),J},u.debugFlags=u.__makeDebugFlags());const E=function(){const T=new ArrayBuffer(2);return new DataView(T).setInt16(0,256,!0),new Int16Array(T)[0]===256}(),q=T=>T[1]==="(",W=T=>T==="P",M=T=>q(T)?"p":T[0],R=function(T){switch(M(T)){case"c":case"C":return"i8";case"i":return"i32";case"p":case"P":case"s":return x;case"j":return"i64";case"f":return"float";case"d":return"double"}a("Unhandled signature IR:",T)},L=m?()=>!0:()=>a("BigInt64Array is not available."),ie=function(T){switch(M(T)){case"p":case"P":case"s":{switch(y){case 4:return"getInt32";case 8:return L()&&"getBigInt64"}break}case"i":return"getInt32";case"c":return"getInt8";case"C":return"getUint8";case"j":return L()&&"getBigInt64";case"f":return"getFloat32";case"d":return"getFloat64"}a("Unhandled DataView getter for signature:",T)},j=function(T){switch(M(T)){case"p":case"P":case"s":{switch(y){case 4:return"setInt32";case 8:return L()&&"setBigInt64"}break}case"i":return"setInt32";case"c":return"setInt8";case"C":return"setUint8";case"j":return L()&&"setBigInt64";case"f":return"setFloat32";case"d":return"setFloat64"}a("Unhandled DataView setter for signature:",T)},g=function(T){switch(M(T)){case"i":case"f":case"c":case"C":case"d":return Number;case"j":return L()&&k;case"p":case"P":case"s":switch(y){case 4:return Number;case 8:return L()&&k}break}a("Unhandled DataView set wrapper for signature:",T)},v=(T,J)=>T+"::"+J,O=function(T,J){return()=>a(v(T,J),"is read-only.")},b=new WeakMap,w="(pointer-is-external)",f=function(T,J,$){if($||($=b.get(J)),$){if(b.delete(J),Array.isArray(J.ondispose)){let X;for(;X=J.ondispose.shift();)try{X instanceof Function?X.call(J):X instanceof be?X.dispose():typeof X=="number"&&S(X)}catch(ke){console.warn("ondispose() for",T.structName,"@",$,"threw. NOT propagating it.",ke)}}else if(J.ondispose instanceof Function)try{J.ondispose()}catch(X){console.warn("ondispose() for",T.structName,"@",$,"threw. NOT propagating it.",X)}delete J.ondispose,T.debugFlags.__flags.dealloc&&C("debug.dealloc:",J[w]?"EXTERNAL":"",T.structName,"instance:",T.structInfo.sizeof,"bytes @"+$),J[w]||S($)}},p=T=>({configurable:!1,writable:!1,iterable:!1,value:T}),_=function(T,J,$){let X=!$;$?Object.defineProperty(J,w,p($)):($=N(T.structInfo.sizeof),$||a("Allocation of",T.structName,"structure failed."));try{T.debugFlags.__flags.alloc&&C("debug.alloc:",X?"":"EXTERNAL",T.structName,"instance:",T.structInfo.sizeof,"bytes @"+$),X&&d().fill(0,$,$+T.structInfo.sizeof),b.set(J,$)}catch(ke){throw f(T,J,$),ke}},P=function(){const T=this.pointer;return T?new Uint8Array(d().slice(T,T+this.structInfo.sizeof)):null},ne=p(T=>z+T+K),re=function(T,J,$=!0){let X=T.members[J];if(!X&&(z||K)){for(const ke of Object.values(T.members))if(ke.key===J){X=ke;break}!X&&$&&a(v(T.name,J),"is not a mapped struct member.")}return X},oe=function T(J,$,X=!1){T._||(T._=Re=>Re.replace(/[^vipPsjrdcC]/g,"").replace(/[pPscC]/g,"i"));const ke=re(J.structInfo,$,!0);return X?T._(ke.signature):ke.signature},he={configurable:!1,enumerable:!1,get:function(){return b.get(this)},set:()=>a("Cannot assign the 'pointer' property of a struct.")},ue=p(function(){const T=[];for(const J of Object.keys(this.structInfo.members))T.push(this.memberKey(J));return T}),qe=new TextDecoder("utf-8"),ze=new TextEncoder,dt=typeof SharedArrayBuffer>"u"?function(){}:SharedArrayBuffer,Zt=function(T,J,$){return qe.decode(T.buffer instanceof dt?T.slice(J,$):T.subarray(J,$))},I=function(T,J,$=!1){const X=re(T.structInfo,J,$);return X&&X.signature.length===1&&X.signature[0]==="s"?X:!1},B=function(T){T.signature!=="s"&&a("Invalid member type signature for C-string value:",JSON.stringify(T))},Q=function(J,$){const X=re(J.structInfo,$,!0);B(X);const ke=J[X.key];if(!ke)return null;let Re=ke;const Ce=d();for(;Ce[Re]!==0;++Re);return ke===Re?"":Zt(Ce,ke,Re)},Z=function(T,...J){T.ondispose?Array.isArray(T.ondispose)||(T.ondispose=[T.ondispose]):T.ondispose=[],T.ondispose.push(...J)},H=function(T){const J=ze.encode(T),$=N(J.length+1);$||a("Allocation error while duplicating string:",T);const X=d();return X.set(J,$),X[$+J.length]=0,$},Ne=function(T,J,$){const X=re(T.structInfo,J,!0);B(X);const ke=H($);return T[X.key]=ke,Z(T,ke),T},be=function(J,$){arguments[2]!==p&&a("Do not call the StructType constructor","from client-level code."),Object.defineProperties(this,{structName:p(J),structInfo:p($)})};be.prototype=Object.create(null,{dispose:p(function(){f(this.constructor,this)}),lookupMember:p(function(T,J=!0){return re(this.structInfo,T,J)}),memberToJsString:p(function(T){return Q(this,T)}),memberIsString:p(function(T,J=!0){return I(this,T,J)}),memberKey:ne,memberKeys:ue,memberSignature:p(function(T,J=!1){return oe(this,T,J)}),memoryDump:p(P),pointer:he,setMemberCString:p(function(T,J){return Ne(this,T,J)})}),Object.assign(be.prototype,{addOnDispose:function(...T){return Z(this,...T),this}}),Object.defineProperties(be,{allocCString:p(H),isA:p(T=>T instanceof be),hasExternalPointer:p(T=>T instanceof be&&!!T[w]),memberKey:ne});const ee=T=>Number.isFinite(T)||T instanceof(k||Number),Lt=function T(J,$,X){if(!T._){T._={getters:{},setters:{},sw:{}};const wt=["i","c","C","p","P","s","f","d","v()"];te&&wt.push("j"),wt.forEach(function(en){T._.getters[en]=ie(en),T._.setters[en]=j(en),T._.sw[en]=g(en)});const pd=/^[ipPsjfdcC]$/,_d=/^[vipPsjfdcC]\([ipPsjfdcC]*\)$/;T.sigCheck=function(en,md,Ja,wo){Object.prototype.hasOwnProperty.call(en,Ja)&&a(en.structName,"already has a property named",Ja+"."),pd.test(wo)||_d.test(wo)||a("Malformed signature for",v(en.structName,md)+":",wo)}}const ke=J.memberKey($);T.sigCheck(J.prototype,$,ke,X.signature),X.key=ke,X.name=$;const Re=M(X.signature),Ce=v(J.prototype.structName,ke),je=J.prototype.debugFlags.__flags,Ir=Object.create(null);Ir.configurable=!1,Ir.enumerable=!1,Ir.get=function(){je.getter&&C("debug.getter:",T._.getters[Re],"for",R(Re),Ce,"@",this.pointer,"+",X.offset,"sz",X.sizeof);let wt=new DataView(d().buffer,this.pointer+X.offset,X.sizeof)[T._.getters[Re]](0,E);return je.getter&&C("debug.getter:",Ce,"result =",wt),wt},X.readOnly?Ir.set=O(J.prototype.structName,ke):Ir.set=function(wt){if(je.setter&&C("debug.setter:",T._.setters[Re],"for",R(Re),Ce,"@",this.pointer,"+",X.offset,"sz",X.sizeof,wt),this.pointer||a("Cannot set struct property on disposed instance."),wt===null)wt=0;else for(;!ee(wt);){if(W(X.signature)&&wt instanceof be){wt=wt.pointer||0,je.setter&&C("debug.setter:",Ce,"resolved to",wt);break}a("Invalid value for pointer-type",Ce+".")}new DataView(d().buffer,this.pointer+X.offset,X.sizeof)[T._.setters[Re]](0,T._.sw[Re](wt),E)},Object.defineProperty(J.prototype,ke,Ir)},ot=function T(J,$){arguments.length===1?($=J,J=$.name):$.name||($.name=J),J||a("Struct name is required.");let X=!1;Object.keys($.members).forEach(Ce=>{const je=$.members[Ce];je.sizeof?je.sizeof===1?je.signature==="c"||je.signature==="C"||a("Unexpected sizeof==1 member",v($.name,Ce),"with signature",je.signature):(je.sizeof%4!==0&&(console.warn("Invalid struct member description =",je,"from",$),a(J,"member",Ce,"sizeof is not aligned. sizeof="+je.sizeof)),je.offset%4!==0&&(console.warn("Invalid struct member description =",je,"from",$),a(J,"member",Ce,"offset is not aligned. offset="+je.offset))):a(J,"member",Ce,"is missing sizeof."),(!X||X.offset<je.offset)&&(X=je)}),X?$.sizeof<X.offset+X.sizeof&&a("Invalid struct config:",J,"max member offset ("+X.offset+") ","extends past end of struct (sizeof="+$.sizeof+")."):a("No member property descriptions found.");const ke=p(u.__makeDebugFlags(T.debugFlags)),Re=function Ce(je){this instanceof Ce?arguments.length?((je!==(je|0)||je<=0)&&a("Invalid pointer value for",J,"constructor."),_(Ce,this,je)):_(Ce,this):a("The",J,"constructor may only be called via 'new'.")};return Object.defineProperties(Re,{debugFlags:ke,isA:p(Ce=>Ce instanceof Re),memberKey:ne,memberKeys:ue,methodInfoForKey:p(function(Ce){}),structInfo:p($),structName:p(J)}),Re.prototype=new be(J,$,p),Object.defineProperties(Re.prototype,{debugFlags:ke,constructor:p(Re)}),Object.keys($.members).forEach(Ce=>Lt(Re,Ce,$.members[Ce])),Re};return ot.StructType=be,ot.config=l,ot.allocCString=H,ot.debugFlags||(ot.debugFlags=u.__makeDebugFlags(u.debugFlags)),ot},globalThis.sqlite3ApiBootstrap.initializers.push(function(i){const l=(...k)=>{throw new Error(k.join(" "))};i.SQLite3Error.toss;const a=i.capi,u=i.wasm,d=i.util;if(globalThis.WhWasmUtilInstaller(u),delete globalThis.WhWasmUtilInstaller,u.bindingSignatures=[["sqlite3_aggregate_context","void*","sqlite3_context*","int"],["sqlite3_bind_double","int","sqlite3_stmt*","int","f64"],["sqlite3_bind_int","int","sqlite3_stmt*","int","int"],["sqlite3_bind_null",void 0,"sqlite3_stmt*","int"],["sqlite3_bind_parameter_count","int","sqlite3_stmt*"],["sqlite3_bind_parameter_index","int","sqlite3_stmt*","string"],["sqlite3_bind_pointer","int","sqlite3_stmt*","int","*","string:static","*"],["sqlite3_busy_handler","int",["sqlite3*",new u.xWrap.FuncPtrAdapter({signature:"i(pi)",contextKey:(k,m)=>k[0]}),"*"]],["sqlite3_busy_timeout","int","sqlite3*","int"],["sqlite3_changes","int","sqlite3*"],["sqlite3_clear_bindings","int","sqlite3_stmt*"],["sqlite3_collation_needed","int","sqlite3*","*","*"],["sqlite3_column_blob","*","sqlite3_stmt*","int"],["sqlite3_column_bytes","int","sqlite3_stmt*","int"],["sqlite3_column_count","int","sqlite3_stmt*"],["sqlite3_column_double","f64","sqlite3_stmt*","int"],["sqlite3_column_int","int","sqlite3_stmt*","int"],["sqlite3_column_name","string","sqlite3_stmt*","int"],["sqlite3_column_text","string","sqlite3_stmt*","int"],["sqlite3_column_type","int","sqlite3_stmt*","int"],["sqlite3_column_value","sqlite3_value*","sqlite3_stmt*","int"],["sqlite3_commit_hook","void*",["sqlite3*",new u.xWrap.FuncPtrAdapter({name:"sqlite3_commit_hook",signature:"i(p)",contextKey:k=>k[0]}),"*"]],["sqlite3_compileoption_get","string","int"],["sqlite3_compileoption_used","int","string"],["sqlite3_complete","int","string:flexible"],["sqlite3_context_db_handle","sqlite3*","sqlite3_context*"],["sqlite3_data_count","int","sqlite3_stmt*"],["sqlite3_db_filename","string","sqlite3*","string"],["sqlite3_db_handle","sqlite3*","sqlite3_stmt*"],["sqlite3_db_name","string","sqlite3*","int"],["sqlite3_db_status","int","sqlite3*","int","*","*","int"],["sqlite3_errcode","int","sqlite3*"],["sqlite3_errmsg","string","sqlite3*"],["sqlite3_error_offset","int","sqlite3*"],["sqlite3_errstr","string","int"],["sqlite3_exec","int",["sqlite3*","string:flexible",new u.xWrap.FuncPtrAdapter({signature:"i(pipp)",bindScope:"transient",callProxy:k=>{let m;return(y,x,E,q)=>{try{const W=u.cArgvToJs(x,E);return m||(m=u.cArgvToJs(x,q)),k(W,m)|0}catch(W){return W.resultCode||a.SQLITE_ERROR}}}}),"*","**"]],["sqlite3_expanded_sql","string","sqlite3_stmt*"],["sqlite3_extended_errcode","int","sqlite3*"],["sqlite3_extended_result_codes","int","sqlite3*","int"],["sqlite3_file_control","int","sqlite3*","string","int","*"],["sqlite3_finalize","int","sqlite3_stmt*"],["sqlite3_free",void 0,"*"],["sqlite3_get_auxdata","*","sqlite3_context*","int"],["sqlite3_initialize",void 0],["sqlite3_keyword_count","int"],["sqlite3_keyword_name","int",["int","**","*"]],["sqlite3_keyword_check","int",["string","int"]],["sqlite3_libversion","string"],["sqlite3_libversion_number","int"],["sqlite3_limit","int",["sqlite3*","int","int"]],["sqlite3_malloc","*","int"],["sqlite3_open","int","string","*"],["sqlite3_open_v2","int","string","*","int","string"],["sqlite3_progress_handler",void 0,["sqlite3*","int",new u.xWrap.FuncPtrAdapter({name:"xProgressHandler",signature:"i(p)",bindScope:"context",contextKey:(k,m)=>k[0]}),"*"]],["sqlite3_realloc","*","*","int"],["sqlite3_reset","int","sqlite3_stmt*"],["sqlite3_result_blob",void 0,"sqlite3_context*","*","int","*"],["sqlite3_result_double",void 0,"sqlite3_context*","f64"],["sqlite3_result_error",void 0,"sqlite3_context*","string","int"],["sqlite3_result_error_code",void 0,"sqlite3_context*","int"],["sqlite3_result_error_nomem",void 0,"sqlite3_context*"],["sqlite3_result_error_toobig",void 0,"sqlite3_context*"],["sqlite3_result_int",void 0,"sqlite3_context*","int"],["sqlite3_result_null",void 0,"sqlite3_context*"],["sqlite3_result_pointer",void 0,"sqlite3_context*","*","string:static","*"],["sqlite3_result_subtype",void 0,"sqlite3_value*","int"],["sqlite3_result_text",void 0,"sqlite3_context*","string","int","*"],["sqlite3_result_zeroblob",void 0,"sqlite3_context*","int"],["sqlite3_rollback_hook","void*",["sqlite3*",new u.xWrap.FuncPtrAdapter({name:"sqlite3_rollback_hook",signature:"v(p)",contextKey:k=>k[0]}),"*"]],["sqlite3_set_authorizer","int",["sqlite3*",new u.xWrap.FuncPtrAdapter({name:"sqlite3_set_authorizer::xAuth",signature:"i(pissss)",contextKey:(k,m)=>k[0],callProxy:k=>(m,y,x,E,q,W)=>{try{return x=x&&u.cstrToJs(x),E=E&&u.cstrToJs(E),q=q&&u.cstrToJs(q),W=W&&u.cstrToJs(W),k(m,y,x,E,q,W)||0}catch(M){return M.resultCode||a.SQLITE_ERROR}}}),"*"]],["sqlite3_set_auxdata",void 0,["sqlite3_context*","int","*",new u.xWrap.FuncPtrAdapter({name:"xDestroyAuxData",signature:"v(*)",contextKey:(k,m)=>k[0]})]],["sqlite3_shutdown",void 0],["sqlite3_sourceid","string"],["sqlite3_sql","string","sqlite3_stmt*"],["sqlite3_status","int","int","*","*","int"],["sqlite3_step","int","sqlite3_stmt*"],["sqlite3_stmt_isexplain","int",["sqlite3_stmt*"]],["sqlite3_stmt_readonly","int",["sqlite3_stmt*"]],["sqlite3_stmt_status","int","sqlite3_stmt*","int","int"],["sqlite3_strglob","int","string","string"],["sqlite3_stricmp","int","string","string"],["sqlite3_strlike","int","string","string","int"],["sqlite3_strnicmp","int","string","string","int"],["sqlite3_table_column_metadata","int","sqlite3*","string","string","string","**","**","*","*","*"],["sqlite3_total_changes","int","sqlite3*"],["sqlite3_trace_v2","int",["sqlite3*","int",new u.xWrap.FuncPtrAdapter({name:"sqlite3_trace_v2::callback",signature:"i(ippp)",contextKey:(k,m)=>k[0]}),"*"]],["sqlite3_txn_state","int",["sqlite3*","string"]],["sqlite3_uri_boolean","int","sqlite3_filename","string","int"],["sqlite3_uri_key","string","sqlite3_filename","int"],["sqlite3_uri_parameter","string","sqlite3_filename","string"],["sqlite3_user_data","void*","sqlite3_context*"],["sqlite3_value_blob","*","sqlite3_value*"],["sqlite3_value_bytes","int","sqlite3_value*"],["sqlite3_value_double","f64","sqlite3_value*"],["sqlite3_value_dup","sqlite3_value*","sqlite3_value*"],["sqlite3_value_free",void 0,"sqlite3_value*"],["sqlite3_value_frombind","int","sqlite3_value*"],["sqlite3_value_int","int","sqlite3_value*"],["sqlite3_value_nochange","int","sqlite3_value*"],["sqlite3_value_numeric_type","int","sqlite3_value*"],["sqlite3_value_pointer","*","sqlite3_value*","string:static"],["sqlite3_value_subtype","int","sqlite3_value*"],["sqlite3_value_text","string","sqlite3_value*"],["sqlite3_value_type","int","sqlite3_value*"],["sqlite3_vfs_find","*","string"],["sqlite3_vfs_register","int","sqlite3_vfs*","int"],["sqlite3_vfs_unregister","int","sqlite3_vfs*"]],u.exports.sqlite3_activate_see instanceof Function&&u.bindingSignatures.push(["sqlite3_key","int","sqlite3*","string","int"],["sqlite3_key_v2","int","sqlite3*","string","*","int"],["sqlite3_rekey","int","sqlite3*","string","int"],["sqlite3_rekey_v2","int","sqlite3*","string","*","int"],["sqlite3_activate_see",void 0,"string"]),u.bindingSignatures.int64=[["sqlite3_bind_int64","int",["sqlite3_stmt*","int","i64"]],["sqlite3_changes64","i64",["sqlite3*"]],["sqlite3_column_int64","i64",["sqlite3_stmt*","int"]],["sqlite3_create_module","int",["sqlite3*","string","sqlite3_module*","*"]],["sqlite3_create_module_v2","int",["sqlite3*","string","sqlite3_module*","*","*"]],["sqlite3_declare_vtab","int",["sqlite3*","string:flexible"]],["sqlite3_deserialize","int","sqlite3*","string","*","i64","i64","int"],["sqlite3_drop_modules","int",["sqlite3*","**"]],["sqlite3_last_insert_rowid","i64",["sqlite3*"]],["sqlite3_malloc64","*","i64"],["sqlite3_msize","i64","*"],["sqlite3_overload_function","int",["sqlite3*","string","int"]],["sqlite3_preupdate_blobwrite","int","sqlite3*"],["sqlite3_preupdate_count","int","sqlite3*"],["sqlite3_preupdate_depth","int","sqlite3*"],["sqlite3_preupdate_hook","*",["sqlite3*",new u.xWrap.FuncPtrAdapter({name:"sqlite3_preupdate_hook",signature:"v(ppippjj)",contextKey:k=>k[0],callProxy:k=>(m,y,x,E,q,W,M)=>{k(m,y,x,u.cstrToJs(E),u.cstrToJs(q),W,M)}}),"*"]],["sqlite3_preupdate_new","int",["sqlite3*","int","**"]],["sqlite3_preupdate_old","int",["sqlite3*","int","**"]],["sqlite3_realloc64","*","*","i64"],["sqlite3_result_int64",void 0,"*","i64"],["sqlite3_result_zeroblob64","int","*","i64"],["sqlite3_serialize","*","sqlite3*","string","*","int"],["sqlite3_set_last_insert_rowid",void 0,["sqlite3*","i64"]],["sqlite3_status64","int","int","*","*","int"],["sqlite3_total_changes64","i64",["sqlite3*"]],["sqlite3_update_hook","*",["sqlite3*",new u.xWrap.FuncPtrAdapter({name:"sqlite3_update_hook",signature:"v(iippj)",contextKey:k=>k[0],callProxy:k=>(m,y,x,E,q)=>{k(m,y,u.cstrToJs(x),u.cstrToJs(E),q)}}),"*"]],["sqlite3_uri_int64","i64",["sqlite3_filename","string","i64"]],["sqlite3_value_int64","i64","sqlite3_value*"],["sqlite3_vtab_collation","string","sqlite3_index_info*","int"],["sqlite3_vtab_distinct","int","sqlite3_index_info*"],["sqlite3_vtab_in","int","sqlite3_index_info*","int","int"],["sqlite3_vtab_in_first","int","sqlite3_value*","**"],["sqlite3_vtab_in_next","int","sqlite3_value*","**"],["sqlite3_vtab_nochange","int","sqlite3_context*"],["sqlite3_vtab_on_conflict","int","sqlite3*"],["sqlite3_vtab_rhs_value","int","sqlite3_index_info*","int","**"]],u.bigIntEnabled&&u.exports.sqlite3changegroup_add){const k={signature:"i(ps)",callProxy:m=>(y,x)=>{try{return m(y,u.cstrToJs(x))|0}catch(E){return E.resultCode||a.SQLITE_ERROR}}};u.bindingSignatures.int64.push(["sqlite3changegroup_add","int",["sqlite3_changegroup*","int","void*"]],["sqlite3changegroup_add_strm","int",["sqlite3_changegroup*",new u.xWrap.FuncPtrAdapter({name:"xInput",signature:"i(ppp)",bindScope:"transient"}),"void*"]],["sqlite3changegroup_delete",void 0,["sqlite3_changegroup*"]],["sqlite3changegroup_new","int",["**"]],["sqlite3changegroup_output","int",["sqlite3_changegroup*","int*","**"]],["sqlite3changegroup_output_strm","int",["sqlite3_changegroup*",new u.xWrap.FuncPtrAdapter({name:"xOutput",signature:"i(ppi)",bindScope:"transient"}),"void*"]],["sqlite3changeset_apply","int",["sqlite3*","int","void*",new u.xWrap.FuncPtrAdapter({name:"xFilter",bindScope:"transient",...k}),new u.xWrap.FuncPtrAdapter({name:"xConflict",signature:"i(pip)",bindScope:"transient"}),"void*"]],["sqlite3changeset_apply_strm","int",["sqlite3*",new u.xWrap.FuncPtrAdapter({name:"xInput",signature:"i(ppp)",bindScope:"transient"}),"void*",new u.xWrap.FuncPtrAdapter({name:"xFilter",bindScope:"transient",...k}),new u.xWrap.FuncPtrAdapter({name:"xConflict",signature:"i(pip)",bindScope:"transient"}),"void*"]],["sqlite3changeset_apply_v2","int",["sqlite3*","int","void*",new u.xWrap.FuncPtrAdapter({name:"xFilter",bindScope:"transient",...k}),new u.xWrap.FuncPtrAdapter({name:"xConflict",signature:"i(pip)",bindScope:"transient"}),"void*","**","int*","int"]],["sqlite3changeset_apply_v2_strm","int",["sqlite3*",new u.xWrap.FuncPtrAdapter({name:"xInput",signature:"i(ppp)",bindScope:"transient"}),"void*",new u.xWrap.FuncPtrAdapter({name:"xFilter",bindScope:"transient",...k}),new u.xWrap.FuncPtrAdapter({name:"xConflict",signature:"i(pip)",bindScope:"transient"}),"void*","**","int*","int"]],["sqlite3changeset_concat","int",["int","void*","int","void*","int*","**"]],["sqlite3changeset_concat_strm","int",[new u.xWrap.FuncPtrAdapter({name:"xInputA",signature:"i(ppp)",bindScope:"transient"}),"void*",new u.xWrap.FuncPtrAdapter({name:"xInputB",signature:"i(ppp)",bindScope:"transient"}),"void*",new u.xWrap.FuncPtrAdapter({name:"xOutput",signature:"i(ppi)",bindScope:"transient"}),"void*"]],["sqlite3changeset_conflict","int",["sqlite3_changeset_iter*","int","**"]],["sqlite3changeset_finalize","int",["sqlite3_changeset_iter*"]],["sqlite3changeset_fk_conflicts","int",["sqlite3_changeset_iter*","int*"]],["sqlite3changeset_invert","int",["int","void*","int*","**"]],["sqlite3changeset_invert_strm","int",[new u.xWrap.FuncPtrAdapter({name:"xInput",signature:"i(ppp)",bindScope:"transient"}),"void*",new u.xWrap.FuncPtrAdapter({name:"xOutput",signature:"i(ppi)",bindScope:"transient"}),"void*"]],["sqlite3changeset_new","int",["sqlite3_changeset_iter*","int","**"]],["sqlite3changeset_next","int",["sqlite3_changeset_iter*"]],["sqlite3changeset_old","int",["sqlite3_changeset_iter*","int","**"]],["sqlite3changeset_op","int",["sqlite3_changeset_iter*","**","int*","int*","int*"]],["sqlite3changeset_pk","int",["sqlite3_changeset_iter*","**","int*"]],["sqlite3changeset_start","int",["**","int","*"]],["sqlite3changeset_start_strm","int",["**",new u.xWrap.FuncPtrAdapter({name:"xInput",signature:"i(ppp)",bindScope:"transient"}),"void*"]],["sqlite3changeset_start_v2","int",["**","int","*","int"]],["sqlite3changeset_start_v2_strm","int",["**",new u.xWrap.FuncPtrAdapter({name:"xInput",signature:"i(ppp)",bindScope:"transient"}),"void*","int"]],["sqlite3session_attach","int",["sqlite3_session*","string"]],["sqlite3session_changeset","int",["sqlite3_session*","int*","**"]],["sqlite3session_changeset_size","i64",["sqlite3_session*"]],["sqlite3session_changeset_strm","int",["sqlite3_session*",new u.xWrap.FuncPtrAdapter({name:"xOutput",signature:"i(ppp)",bindScope:"transient"}),"void*"]],["sqlite3session_config","int",["int","void*"]],["sqlite3session_create","int",["sqlite3*","string","**"]],["sqlite3session_diff","int",["sqlite3_session*","string","string","**"]],["sqlite3session_enable","int",["sqlite3_session*","int"]],["sqlite3session_indirect","int",["sqlite3_session*","int"]],["sqlite3session_isempty","int",["sqlite3_session*"]],["sqlite3session_memory_used","i64",["sqlite3_session*"]],["sqlite3session_object_config","int",["sqlite3_session*","int","void*"]],["sqlite3session_patchset","int",["sqlite3_session*","*","**"]],["sqlite3session_patchset_strm","int",["sqlite3_session*",new u.xWrap.FuncPtrAdapter({name:"xOutput",signature:"i(ppp)",bindScope:"transient"}),"void*"]],["sqlite3session_table_filter",void 0,["sqlite3_session*",new u.xWrap.FuncPtrAdapter({name:"xFilter",...k,contextKey:(m,y)=>m[0]}),"*"]])}u.bindingSignatures.wasm=[["sqlite3_wasm_db_reset","int","sqlite3*"],["sqlite3_wasm_db_vfs","sqlite3_vfs*","sqlite3*","string"],["sqlite3_wasm_vfs_create_file","int","sqlite3_vfs*","string","*","int"],["sqlite3_wasm_vfs_unlink","int","sqlite3_vfs*","string"]],i.StructBinder=globalThis.Jaccwabyt({heap:u.heap8u,alloc:u.alloc,dealloc:u.dealloc,bigIntEnabled:u.bigIntEnabled,memberPrefix:"$"}),delete globalThis.Jaccwabyt;{const k=u.xWrap.argAdapter("string");u.xWrap.argAdapter("string:flexible",q=>k(d.flexibleString(q))),u.xWrap.argAdapter("string:static",(function(q){return u.isPtr(q)?q:(q=""+q,this[q]||(this[q]=u.allocCString(q)))}).bind(Object.create(null)));const m=u.xWrap.argAdapter("*"),y=function(){};u.xWrap.argAdapter("sqlite3_filename",m)("sqlite3_context*",m)("sqlite3_value*",m)("void*",m)("sqlite3_changegroup*",m)("sqlite3_changeset_iter*",m)("sqlite3_session*",m)("sqlite3_stmt*",q=>{var W;return m(q instanceof(((W=i==null?void 0:i.oo1)==null?void 0:W.Stmt)||y)?q.pointer:q)})("sqlite3*",q=>{var W;return m(q instanceof(((W=i==null?void 0:i.oo1)==null?void 0:W.DB)||y)?q.pointer:q)})("sqlite3_index_info*",q=>m(q instanceof(a.sqlite3_index_info||y)?q.pointer:q))("sqlite3_module*",q=>m(q instanceof(a.sqlite3_module||y)?q.pointer:q))("sqlite3_vfs*",q=>typeof q=="string"?a.sqlite3_vfs_find(q)||i.SQLite3Error.toss(a.SQLITE_NOTFOUND,"Unknown sqlite3_vfs name:",q):m(q instanceof(a.sqlite3_vfs||y)?q.pointer:q));const x=u.xWrap.resultAdapter("*");u.xWrap.resultAdapter("sqlite3*",x)("sqlite3_context*",x)("sqlite3_stmt*",x)("sqlite3_value*",x)("sqlite3_vfs*",x)("void*",x);for(const q of u.bindingSignatures)a[q[0]]=u.xWrap.apply(null,q);for(const q of u.bindingSignatures.wasm)u[q[0]]=u.xWrap.apply(null,q);const E=function(q){return()=>l(q+"() is unavailable due to lack","of BigInt support in this build.")};for(const q of u.bindingSignatures.int64)a[q[0]]=u.bigIntEnabled?u.xWrap.apply(null,q):E(q[0]);if(delete u.bindingSignatures,u.exports.sqlite3_wasm_db_error){const q=u.xWrap("sqlite3_wasm_db_error","int","sqlite3*","int","string");d.sqlite3_wasm_db_error=function(W,M,R){return M instanceof i.WasmAllocError?(M=a.SQLITE_NOMEM,R=0):M instanceof Error&&(R=R||""+M,M=M.resultCode||a.SQLITE_ERROR),W?q(W,M,R):M}}else d.sqlite3_wasm_db_error=function(q,W,M){return console.warn("sqlite3_wasm_db_error() is not exported.",arguments),W}}{const k=u.xCall("sqlite3_wasm_enum_json");k||l("Maintenance required: increase sqlite3_wasm_enum_json()'s","static buffer size!"),u.ctype=JSON.parse(u.cstrToJs(k));const m=["access","authorizer","blobFinalizers","changeset","config","dataTypes","dbConfig","dbStatus","encodings","fcntl","flock","ioCap","limits","openFlags","prepareFlags","resultCodes","sqlite3Status","stmtStatus","syncFlags","trace","txnState","udfFlags","version"];u.bigIntEnabled&&m.push("serialize","session","vtab");for(const E of m)for(const q of Object.entries(u.ctype[E]))a[q[0]]=q[1];u.functionEntry(a.SQLITE_WASM_DEALLOC)||l("Internal error: cannot resolve exported function","entry SQLITE_WASM_DEALLOC (=="+a.SQLITE_WASM_DEALLOC+").");const y=Object.create(null);for(const E of["resultCodes"])for(const q of Object.entries(u.ctype[E]))y[q[1]]=q[0];a.sqlite3_js_rc_str=E=>y[E];const x=Object.assign(Object.create(null),{WasmTestStruct:!0,sqlite3_kvvfs_methods:!d.isUIThread(),sqlite3_index_info:!u.bigIntEnabled,sqlite3_index_constraint:!u.bigIntEnabled,sqlite3_index_orderby:!u.bigIntEnabled,sqlite3_index_constraint_usage:!u.bigIntEnabled});for(const E of u.ctype.structs)x[E.name]||(a[E.name]=i.StructBinder(E));if(a.sqlite3_index_info){for(const E of["sqlite3_index_constraint","sqlite3_index_orderby","sqlite3_index_constraint_usage"])a.sqlite3_index_info[E]=a[E],delete a[E];a.sqlite3_vtab_config=u.xWrap("sqlite3_wasm_vtab_config","int",["sqlite3*","int","int"])}}const N=(k,m,y)=>i.util.sqlite3_wasm_db_error(k,a.SQLITE_MISUSE,m+"() requires "+y+" argument"+(y===1?"":"s")+"."),S=k=>d.sqlite3_wasm_db_error(k,a.SQLITE_FORMAT,"SQLITE_UTF8 is the only supported encoding."),C=k=>u.xWrap.argAdapter("sqlite3*")(k),z=k=>u.isPtr(k)?u.cstrToJs(k):k,K=(function(k,m){k=C(k);let y=this.dbMap.get(k);if(m)!y&&m>0&&this.dbMap.set(k,y=Object.create(null));else return this.dbMap.delete(k),y;return y}).bind(Object.assign(Object.create(null),{dbMap:new Map}));K.addCollation=function(k,m){const y=K(k,1);y.collation||(y.collation=new Set),y.collation.add(z(m).toLowerCase())},K._addUDF=function(k,m,y,x){m=z(m).toLowerCase();let E=x.get(m);E||x.set(m,E=new Set),E.add(y<0?-1:y)},K.addFunction=function(k,m,y){const x=K(k,1);x.udf||(x.udf=new Map),this._addUDF(k,m,y,x.udf)},K.addWindowFunc=function(k,m,y){const x=K(k,1);x.wudf||(x.wudf=new Map),this._addUDF(k,m,y,x.wudf)},K.cleanup=function(k){k=C(k);const m=[k];for(const E of["sqlite3_busy_handler","sqlite3_commit_hook","sqlite3_preupdate_hook","sqlite3_progress_handler","sqlite3_rollback_hook","sqlite3_set_authorizer","sqlite3_trace_v2","sqlite3_update_hook"]){const q=u.exports[E];m.length=q.length;try{a[E](...m)}catch(W){console.warn("close-time call of",E+"(",m,") threw:",W)}}const y=K(k,0);if(!y)return;if(y.collation){for(const E of y.collation)try{a.sqlite3_create_collation_v2(k,E,a.SQLITE_UTF8,0,0,0)}catch{}delete y.collation}let x;for(x=0;x<2;++x){const E=x?y.wudf:y.udf;if(!E)continue;const q=x?a.sqlite3_create_window_function:a.sqlite3_create_function_v2;for(const W of E){const M=W[0],R=W[1],L=[k,M,0,a.SQLITE_UTF8,0,0,0,0,0];x&&L.push(0);for(const ie of R)try{L[2]=ie,q.apply(null,L)}catch{}R.clear()}E.clear()}delete y.udf,delete y.wudf};{const k=u.xWrap("sqlite3_close_v2","int","sqlite3*");a.sqlite3_close_v2=function(m){if(arguments.length!==1)return N(m,"sqlite3_close_v2",1);if(m)try{K.cleanup(m)}catch{}return k(m)}}if(a.sqlite3session_table_filter){const k=u.xWrap("sqlite3session_delete",void 0,["sqlite3_session*"]);a.sqlite3session_delete=function(m){if(arguments.length!==1)return N(pDb,"sqlite3session_delete",1);m&&a.sqlite3session_table_filter(m,0,0),k(m)}}{const k=(y,x)=>"argv["+x+"]:"+y[0]+":"+u.cstrToJs(y[1]).toLowerCase(),m=u.xWrap("sqlite3_create_collation_v2","int",["sqlite3*","string","int","*",new u.xWrap.FuncPtrAdapter({name:"xCompare",signature:"i(pipip)",contextKey:k}),new u.xWrap.FuncPtrAdapter({name:"xDestroy",signature:"v(p)",contextKey:k})]);a.sqlite3_create_collation_v2=function(y,x,E,q,W,M){if(arguments.length!==6)return N(y,"sqlite3_create_collation_v2",6);if(!(E&15))E|=a.SQLITE_UTF8;else if(a.SQLITE_UTF8!==(E&15))return S(y);try{const R=m(y,x,E,q,W,M);return R===0&&W instanceof Function&&K.addCollation(y,x),R}catch(R){return d.sqlite3_wasm_db_error(y,R)}},a.sqlite3_create_collation=(y,x,E,q,W)=>arguments.length===5?a.sqlite3_create_collation_v2(y,x,E,q,W,0):N(y,"sqlite3_create_collation",5)}{const k=function(E,q){return E[0]+":"+(E[2]<0?-1:E[2])+":"+q+":"+u.cstrToJs(E[1]).toLowerCase()},m=Object.assign(Object.create(null),{xInverseAndStep:{signature:"v(pip)",contextKey:k,callProxy:E=>(q,W,M)=>{try{E(q,...a.sqlite3_values_to_js(W,M))}catch(R){a.sqlite3_result_error_js(q,R)}}},xFinalAndValue:{signature:"v(p)",contextKey:k,callProxy:E=>q=>{try{a.sqlite3_result_js(q,E(q))}catch(W){a.sqlite3_result_error_js(q,W)}}},xFunc:{signature:"v(pip)",contextKey:k,callProxy:E=>(q,W,M)=>{try{a.sqlite3_result_js(q,E(q,...a.sqlite3_values_to_js(W,M)))}catch(R){a.sqlite3_result_error_js(q,R)}}},xDestroy:{signature:"v(p)",contextKey:k,callProxy:E=>q=>{try{E(q)}catch(W){console.error("UDF xDestroy method threw:",W)}}}}),y=u.xWrap("sqlite3_create_function_v2","int",["sqlite3*","string","int","int","*",new u.xWrap.FuncPtrAdapter({name:"xFunc",...m.xFunc}),new u.xWrap.FuncPtrAdapter({name:"xStep",...m.xInverseAndStep}),new u.xWrap.FuncPtrAdapter({name:"xFinal",...m.xFinalAndValue}),new u.xWrap.FuncPtrAdapter({name:"xDestroy",...m.xDestroy})]),x=u.xWrap("sqlite3_create_window_function","int",["sqlite3*","string","int","int","*",new u.xWrap.FuncPtrAdapter({name:"xStep",...m.xInverseAndStep}),new u.xWrap.FuncPtrAdapter({name:"xFinal",...m.xFinalAndValue}),new u.xWrap.FuncPtrAdapter({name:"xValue",...m.xFinalAndValue}),new u.xWrap.FuncPtrAdapter({name:"xInverse",...m.xInverseAndStep}),new u.xWrap.FuncPtrAdapter({name:"xDestroy",...m.xDestroy})]);a.sqlite3_create_function_v2=function E(q,W,M,R,L,ie,j,g,v){if(E.length!==arguments.length)return N(q,"sqlite3_create_function_v2",E.length);if(!(R&15))R|=a.SQLITE_UTF8;else if(a.SQLITE_UTF8!==(R&15))return S(q);try{const O=y(q,W,M,R,L,ie,j,g,v);return O===0&&(ie instanceof Function||j instanceof Function||g instanceof Function||v instanceof Function)&&K.addFunction(q,W,M),O}catch(O){return console.error("sqlite3_create_function_v2() setup threw:",O),d.sqlite3_wasm_db_error(q,O,"Creation of UDF threw: "+O)}},a.sqlite3_create_function=function E(q,W,M,R,L,ie,j,g){return E.length===arguments.length?a.sqlite3_create_function_v2(q,W,M,R,L,ie,j,g,0):N(q,"sqlite3_create_function",E.length)},a.sqlite3_create_window_function=function E(q,W,M,R,L,ie,j,g,v,O){if(E.length!==arguments.length)return N(q,"sqlite3_create_window_function",E.length);if(!(R&15))R|=a.SQLITE_UTF8;else if(a.SQLITE_UTF8!==(R&15))return S(q);try{const b=x(q,W,M,R,L,ie,j,g,v,O);return b===0&&(ie instanceof Function||j instanceof Function||g instanceof Function||v instanceof Function||O instanceof Function)&&K.addWindowFunc(q,W,M),b}catch(b){return console.error("sqlite3_create_window_function() setup threw:",b),d.sqlite3_wasm_db_error(q,b,"Creation of UDF threw: "+b)}},a.sqlite3_create_function_v2.udfSetResult=a.sqlite3_create_function.udfSetResult=a.sqlite3_create_window_function.udfSetResult=a.sqlite3_result_js,a.sqlite3_create_function_v2.udfConvertArgs=a.sqlite3_create_function.udfConvertArgs=a.sqlite3_create_window_function.udfConvertArgs=a.sqlite3_values_to_js,a.sqlite3_create_function_v2.udfSetError=a.sqlite3_create_function.udfSetError=a.sqlite3_create_window_function.udfSetError=a.sqlite3_result_error_js}{const k=(y,x)=>(typeof y=="string"?x=-1:d.isSQLableTypedArray(y)?(x=y.byteLength,y=d.typedArrayToString(y instanceof ArrayBuffer?new Uint8Array(y):y)):Array.isArray(y)&&(y=y.join(""),x=-1),[y,x]),m={basic:u.xWrap("sqlite3_prepare_v3","int",["sqlite3*","string","int","int","**","**"]),full:u.xWrap("sqlite3_prepare_v3","int",["sqlite3*","*","int","int","**","**"])};a.sqlite3_prepare_v3=function y(x,E,q,W,M,R){if(y.length!==arguments.length)return N(x,"sqlite3_prepare_v3",y.length);const[L,ie]=k(E,q);switch(typeof L){case"string":return m.basic(x,L,ie,W,M,null);case"number":return m.full(x,L,ie,W,M,R);default:return d.sqlite3_wasm_db_error(x,a.SQLITE_MISUSE,"Invalid SQL argument type for sqlite3_prepare_v2/v3().")}},a.sqlite3_prepare_v2=function y(x,E,q,W,M){return y.length===arguments.length?a.sqlite3_prepare_v3(x,E,q,0,W,M):N(x,"sqlite3_prepare_v2",y.length)}}{const k=u.xWrap("sqlite3_bind_text","int",["sqlite3_stmt*","int","string","int","*"]),m=u.xWrap("sqlite3_bind_blob","int",["sqlite3_stmt*","int","*","int","*"]);a.sqlite3_bind_text=function y(x,E,q,W,M){if(y.length!==arguments.length)return N(a.sqlite3_db_handle(x),"sqlite3_bind_text",y.length);if(u.isPtr(q)||q===null)return k(x,E,q,W,M);q instanceof ArrayBuffer?q=new Uint8Array(q):Array.isArray(pMem)&&(q=pMem.join(""));let R,L;try{if(d.isSQLableTypedArray(q))R=u.allocFromTypedArray(q),L=q.byteLength;else if(typeof q=="string")[R,L]=u.allocCString(q);else return d.sqlite3_wasm_db_error(a.sqlite3_db_handle(x),a.SQLITE_MISUSE,"Invalid 3rd argument type for sqlite3_bind_text().");return k(x,E,R,L,a.SQLITE_WASM_DEALLOC)}catch(ie){return u.dealloc(R),d.sqlite3_wasm_db_error(a.sqlite3_db_handle(x),ie)}},a.sqlite3_bind_blob=function y(x,E,q,W,M){if(y.length!==arguments.length)return N(a.sqlite3_db_handle(x),"sqlite3_bind_blob",y.length);if(u.isPtr(q)||q===null)return m(x,E,q,W,M);q instanceof ArrayBuffer?q=new Uint8Array(q):Array.isArray(q)&&(q=q.join(""));let R,L;try{if(d.isBindableTypedArray(q))R=u.allocFromTypedArray(q),L=W>=0?W:q.byteLength;else if(typeof q=="string")[R,L]=u.allocCString(q);else return d.sqlite3_wasm_db_error(a.sqlite3_db_handle(x),a.SQLITE_MISUSE,"Invalid 3rd argument type for sqlite3_bind_blob().");return m(x,E,R,L,a.SQLITE_WASM_DEALLOC)}catch(ie){return u.dealloc(R),d.sqlite3_wasm_db_error(a.sqlite3_db_handle(x),ie)}}}a.sqlite3_config=function(k,...m){if(arguments.length<2)return a.SQLITE_MISUSE;switch(k){case a.SQLITE_CONFIG_COVERING_INDEX_SCAN:case a.SQLITE_CONFIG_MEMSTATUS:case a.SQLITE_CONFIG_SMALL_MALLOC:case a.SQLITE_CONFIG_SORTERREF_SIZE:case a.SQLITE_CONFIG_STMTJRNL_SPILL:case a.SQLITE_CONFIG_URI:return u.exports.sqlite3_wasm_config_i(k,m[0]);case a.SQLITE_CONFIG_LOOKASIDE:return u.exports.sqlite3_wasm_config_ii(k,m[0],m[1]);case a.SQLITE_CONFIG_MEMDB_MAXSIZE:return u.exports.sqlite3_wasm_config_j(k,m[0]);case a.SQLITE_CONFIG_GETMALLOC:case a.SQLITE_CONFIG_GETMUTEX:case a.SQLITE_CONFIG_GETPCACHE2:case a.SQLITE_CONFIG_GETPCACHE:case a.SQLITE_CONFIG_HEAP:case a.SQLITE_CONFIG_LOG:case a.SQLITE_CONFIG_MALLOC:case a.SQLITE_CONFIG_MMAP_SIZE:case a.SQLITE_CONFIG_MULTITHREAD:case a.SQLITE_CONFIG_MUTEX:case a.SQLITE_CONFIG_PAGECACHE:case a.SQLITE_CONFIG_PCACHE2:case a.SQLITE_CONFIG_PCACHE:case a.SQLITE_CONFIG_PCACHE_HDRSZ:case a.SQLITE_CONFIG_PMASZ:case a.SQLITE_CONFIG_SERIALIZED:case a.SQLITE_CONFIG_SINGLETHREAD:case a.SQLITE_CONFIG_SQLLOG:case a.SQLITE_CONFIG_WIN32_HEAPSIZE:default:return a.SQLITE_NOTFOUND}};{const k=new Set;a.sqlite3_auto_extension=function(m){if(m instanceof Function)m=u.installFunction("i(ppp)",m);else if(arguments.length!==1||!u.isPtr(m))return a.SQLITE_MISUSE;const y=u.exports.sqlite3_auto_extension(m);return m!==arguments[0]&&(y===0?k.add(m):u.uninstallFunction(m)),y},a.sqlite3_cancel_auto_extension=function(m){return!m||arguments.length!==1||!u.isPtr(m)?0:u.exports.sqlite3_cancel_auto_extension(m)},a.sqlite3_reset_auto_extension=function(){u.exports.sqlite3_reset_auto_extension();for(const m of k)u.uninstallFunction(m);k.clear()}}const te=a.sqlite3_vfs_find("kvvfs");if(te)if(d.isUIThread()){const k=new a.sqlite3_kvvfs_methods(u.exports.sqlite3_wasm_kvvfs_methods());delete a.sqlite3_kvvfs_methods;const m=u.exports.sqlite3_wasm_kvvfsMakeKeyOnPstack,y=u.pstack,x=q=>u.peek(q)===115?sessionStorage:localStorage,E={xRead:(q,W,M,R)=>{const L=y.pointer,ie=u.scopedAllocPush();try{const j=m(q,W);if(!j)return-3;const g=u.cstrToJs(j),v=x(q).getItem(g);if(!v)return-1;const O=v.length;if(R<=0)return O;if(R===1)return u.poke(M,0),O;const b=u.scopedAllocCString(v);return R>O+1&&(R=O+1),u.heap8u().copyWithin(M,b,b+R-1),u.poke(M+R-1,0),R-1}catch(j){return console.error("kvstorageRead()",j),-2}finally{y.restore(L),u.scopedAllocPop(ie)}},xWrite:(q,W,M)=>{const R=y.pointer;try{const L=m(q,W);if(!L)return 1;const ie=u.cstrToJs(L);return x(q).setItem(ie,u.cstrToJs(M)),0}catch(L){return console.error("kvstorageWrite()",L),a.SQLITE_IOERR}finally{y.restore(R)}},xDelete:(q,W)=>{const M=y.pointer;try{const R=m(q,W);return R?(x(q).removeItem(u.cstrToJs(R)),0):1}catch(R){return console.error("kvstorageDelete()",R),a.SQLITE_IOERR}finally{y.restore(M)}}};for(const q of Object.keys(E))k[k.memberKey(q)]=u.installFunction(k.memberSignature(q),E[q])}else a.sqlite3_vfs_unregister(te);u.xWrap.FuncPtrAdapter.warnOnUse=!0}),globalThis.sqlite3ApiBootstrap.initializers.push(function(i){i.version={libVersion:"3.42.0",libVersionNumber:3042e3,sourceId:"2023-05-16 12:36:15 831d0fb2836b71c9bc51067c49fee4b8f18047814f2ff22d817d25195cf350b0",downloadVersion:342e4}}),globalThis.sqlite3ApiBootstrap.initializers.push(function(i){const l=(...b)=>{throw new i.SQLite3Error(...b)},a=i.capi,u=i.wasm,d=i.util,N=new WeakMap,S=new WeakMap,C=(b,w,f)=>{const p=Object.getOwnPropertyDescriptor(b,w);return p?p.value:f},z=function(b,w){return w&&(b instanceof m&&(b=b.pointer),l("sqlite3 result code",w+":",b?a.sqlite3_errmsg(b):a.sqlite3_errstr(w))),arguments[0]},K=u.installFunction("i(ippp)",(function(b,w,f,p){a.SQLITE_TRACE_STMT===b&&console.log("SQL TRACE #"+ ++this.counter+" via sqlite3@"+w+":",u.cstrToJs(p))}).bind({counter:0})),te=Object.create(null),k=function b(...w){if(!b._name2vfs){b._name2vfs=Object.create(null);const ue=typeof importScripts=="function"?qe=>l("The VFS for",qe,"is only available in the main window thread."):!1;b._name2vfs[":localStorage:"]={vfs:"kvvfs",filename:ue||(()=>"local")},b._name2vfs[":sessionStorage:"]={vfs:"kvvfs",filename:ue||(()=>"session")}}const f=b.normalizeArgs(...w);let p=f.filename,_=f.vfs,P=f.flags;(typeof p!="string"&&typeof p!="number"||typeof P!="string"||_&&typeof _!="string"&&typeof _!="number")&&(i.config.error("Invalid DB ctor args",f,arguments),l("Invalid arguments for DB constructor."));let F=typeof p=="number"?u.cstrToJs(p):p;const ne=b._name2vfs[F];ne&&(_=ne.vfs,p=F=ne.filename(F));let re,oe=0;P.indexOf("c")>=0&&(oe|=a.SQLITE_OPEN_CREATE|a.SQLITE_OPEN_READWRITE),P.indexOf("w")>=0&&(oe|=a.SQLITE_OPEN_READWRITE),oe===0&&(oe|=a.SQLITE_OPEN_READONLY),oe|=a.SQLITE_OPEN_EXRESCODE;const he=u.pstack.pointer;try{const ue=u.pstack.allocPtr();let qe=a.sqlite3_open_v2(p,ue,oe,_||0);re=u.peekPtr(ue),z(re,qe),a.sqlite3_extended_result_codes(re,1),P.indexOf("t")>=0&&a.sqlite3_trace_v2(re,a.SQLITE_TRACE_STMT,K,re)}catch(ue){throw re&&a.sqlite3_close_v2(re),ue}finally{u.pstack.restore(he)}this.filename=F,N.set(this,re),S.set(this,Object.create(null));try{const ue=a.sqlite3_js_db_vfs(re);ue||l("Internal error: cannot get VFS for new db handle.");const qe=te[ue];qe instanceof Function?qe(this,i):qe&&z(re,a.sqlite3_exec(re,qe,0,0,0))}catch(ue){throw this.close(),ue}};k.setVfsPostOpenSql=function(b,w){te[b]=w},k.normalizeArgs=function(b=":memory:",w="c",f=null){const p={};return arguments.length===1&&arguments[0]&&typeof arguments[0]=="object"?(Object.assign(p,arguments[0]),p.flags===void 0&&(p.flags="c"),p.vfs===void 0&&(p.vfs=null),p.filename===void 0&&(p.filename=":memory:")):(p.filename=b,p.flags=w,p.vfs=f),p};const m=function(...b){k.apply(this,b)};m.dbCtorHelper=k;const y={null:1,number:2,string:3,boolean:4,blob:5};y.undefined==y.null,u.bigIntEnabled&&(y.bigint=y.number);const x=function(){y!==arguments[2]&&l(a.SQLITE_MISUSE,"Do not call the Stmt constructor directly. Use DB.prepare()."),this.db=arguments[0],N.set(this,arguments[1]),this.columnCount=a.sqlite3_column_count(this.pointer),this.parameterCount=a.sqlite3_bind_parameter_count(this.pointer)},E=function(b){return b.pointer||l("DB has been closed."),b},q=function(b,w){return(w!==(w|0)||w<0||w>=b.columnCount)&&l("Column index",w,"is out of range."),b},W=function(b,w){const f=Object.create(null);switch(f.opt=Object.create(null),w.length){case 1:typeof w[0]=="string"||d.isSQLableTypedArray(w[0])||Array.isArray(w[0])?f.sql=w[0]:w[0]&&typeof w[0]=="object"&&(f.opt=w[0],f.sql=f.opt.sql);break;case 2:f.sql=w[0],f.opt=w[1];break;default:l("Invalid argument count for exec().")}f.sql=d.flexibleString(f.sql),typeof f.sql!="string"&&l("Missing SQL argument or unsupported SQL value type.");const p=f.opt;switch(p.returnValue){case"resultRows":p.resultRows||(p.resultRows=[]),f.returnVal=()=>p.resultRows;break;case"saveSql":p.saveSql||(p.saveSql=[]),f.returnVal=()=>p.saveSql;break;case void 0:case"this":f.returnVal=()=>b;break;default:l("Invalid returnValue value:",p.returnValue)}if(!p.callback&&!p.returnValue&&p.rowMode!==void 0&&(p.resultRows||(p.resultRows=[]),f.returnVal=()=>p.resultRows),p.callback||p.resultRows)switch(p.rowMode===void 0?"array":p.rowMode){case"object":f.cbArg=_=>_.get(Object.create(null));break;case"array":f.cbArg=_=>_.get([]);break;case"stmt":Array.isArray(p.resultRows)&&l("exec(): invalid rowMode for a resultRows array: must","be one of 'array', 'object',","a result column number, or column name reference."),f.cbArg=_=>_;break;default:if(d.isInt32(p.rowMode)){f.cbArg=_=>_.get(p.rowMode);break}else if(typeof p.rowMode=="string"&&p.rowMode.length>1&&p.rowMode[0]==="$"){const _=p.rowMode.substr(1);f.cbArg=P=>{const F=P.get(Object.create(null))[_];return F===void 0?l(a.SQLITE_NOTFOUND,"exec(): unknown result column:",_):F};break}l("Invalid rowMode:",p.rowMode)}return f},M=(b,w,f,...p)=>{const _=b.prepare(w);try{return _.bind(f).step()?_.get(...p):void 0}finally{_.finalize()}},R=(b,w,f,p)=>b.exec({sql:w,bind:f,rowMode:p,returnValue:"resultRows"});m.checkRc=(b,w)=>z(b,w),m.prototype={isOpen:function(){return!!this.pointer},affirmOpen:function(){return E(this)},close:function(){if(this.pointer){if(this.onclose&&this.onclose.before instanceof Function)try{this.onclose.before(this)}catch{}const b=this.pointer;if(Object.keys(S.get(this)).forEach((w,f)=>{f&&f.pointer&&f.finalize()}),N.delete(this),S.delete(this),a.sqlite3_close_v2(b),this.onclose&&this.onclose.after instanceof Function)try{this.onclose.after(this)}catch{}delete this.filename}},changes:function(b=!1,w=!1){const f=E(this).pointer;return b?w?a.sqlite3_total_changes64(f):a.sqlite3_total_changes(f):w?a.sqlite3_changes64(f):a.sqlite3_changes(f)},dbFilename:function(b="main"){return a.sqlite3_db_filename(E(this).pointer,b)},dbName:function(b=0){return a.sqlite3_db_name(E(this).pointer,b)},dbVfsName:function(b=0){let w;const f=a.sqlite3_js_db_vfs(E(this).pointer,b);if(f){const p=new a.sqlite3_vfs(f);try{w=u.cstrToJs(p.$zName)}finally{p.dispose()}}return w},prepare:function(b){E(this);const w=u.pstack.pointer;let f,p;try{f=u.pstack.alloc(8),m.checkRc(this,a.sqlite3_prepare_v2(this.pointer,b,-1,f,null)),p=u.peekPtr(f)}finally{u.pstack.restore(w)}p||l("Cannot prepare empty SQL.");const _=new x(this,p,y);return S.get(this)[p]=_,_},exec:function(){E(this);const b=W(this,arguments);if(!b.sql)return l("exec() requires an SQL string.");const w=b.opt,f=w.callback,p=Array.isArray(w.resultRows)?w.resultRows:void 0;let _,P=w.bind,F=!!(b.cbArg||w.columnNames||p);const ne=u.scopedAllocPush(),re=Array.isArray(w.saveSql)?w.saveSql:void 0;try{const oe=d.isSQLableTypedArray(b.sql);let he=oe?b.sql.byteLength:u.jstrlen(b.sql);const ue=u.scopedAlloc(2*u.ptrSizeof+(he+1)),qe=ue+u.ptrSizeof;let ze=qe+u.ptrSizeof;const dt=ze+he;for(oe?u.heap8().set(b.sql,ze):u.jstrcpy(b.sql,u.heap8(),ze,he,!1),u.poke(ze+he,0);ze&&u.peek(ze,"i8");){u.pokePtr([ue,qe],0),m.checkRc(this,a.sqlite3_prepare_v3(this.pointer,ze,he,0,ue,qe));const Zt=u.peekPtr(ue);if(ze=u.peekPtr(qe),he=dt-ze,!!Zt){if(re&&re.push(a.sqlite3_sql(Zt).trim()),_=new x(this,Zt,y),P&&_.parameterCount&&(_.bind(P),P=null),F&&_.columnCount){if(F=!1,Array.isArray(w.columnNames)&&_.getColumnNames(w.columnNames),b.cbArg||p){for(;_.step();_._isLocked=!1){_._isLocked=!0;const I=b.cbArg(_);if(p&&p.push(I),f&&f.call(w,I,_)===!1)break}_._isLocked=!1}}else _.step();_.finalize(),_=null}}}finally{_&&(delete _._isLocked,_.finalize()),u.scopedAllocPop(ne)}return b.returnVal()},createFunction:function(w,f,p){const _=B=>B instanceof Function;switch(arguments.length){case 1:p=w,w=p.name,f=p.xFunc||0;break;case 2:_(f)||(p=f,f=p.xFunc||0);break}p||(p={}),typeof w!="string"&&l("Invalid arguments: missing function name.");let P=p.xStep||0,F=p.xFinal||0;const ne=p.xValue||0,re=p.xInverse||0;let oe;_(f)?(oe=!1,(_(P)||_(F))&&l("Ambiguous arguments: scalar or aggregate?"),P=F=null):_(P)?(_(F)||l("Missing xFinal() callback for aggregate or window UDF."),f=null):_(F)?l("Missing xStep() callback for aggregate or window UDF."):l("Missing function-type properties."),oe===!1?(_(ne)||_(re))&&l("xValue and xInverse are not permitted for non-window UDFs."):_(ne)?(_(re)||l("xInverse must be provided if xValue is."),oe=!0):_(re)&&l("xValue must be provided if xInverse is.");const he=p.pApp;he!=null&&(typeof he!="number"||!d.isInt32(he))&&l("Invalid value for pApp property. Must be a legal WASM pointer value.");const ue=p.xDestroy||0;ue&&!_(ue)&&l("xDestroy property must be a function.");let qe=0;C(p,"deterministic")&&(qe|=a.SQLITE_DETERMINISTIC),C(p,"directOnly")&&(qe|=a.SQLITE_DIRECTONLY),C(p,"innocuous")&&(qe|=a.SQLITE_INNOCUOUS),w=w.toLowerCase();const ze=f||P,dt=C(p,"arity"),Zt=typeof dt=="number"?dt:ze.length?ze.length-1:0;let I;return oe?I=a.sqlite3_create_window_function(this.pointer,w,Zt,a.SQLITE_UTF8|qe,he||0,P,F,ne,re,ue):I=a.sqlite3_create_function_v2(this.pointer,w,Zt,a.SQLITE_UTF8|qe,he||0,f,P,F,ue),m.checkRc(this,I),this},selectValue:function(b,w,f){return M(this,b,w,0,f)},selectValues:function(b,w,f){const p=this.prepare(b),_=[];try{for(p.bind(w);p.step();)_.push(p.get(0,f))}finally{p.finalize()}return _},selectArray:function(b,w){return M(this,b,w,[])},selectObject:function(b,w){return M(this,b,w,{})},selectArrays:function(b,w){return R(this,b,w,"array")},selectObjects:function(b,w){return R(this,b,w,"object")},openStatementCount:function(){return this.pointer?Object.keys(S.get(this)).length:0},transaction:function(b){let w="BEGIN";arguments.length>1&&(/[^a-zA-Z]/.test(arguments[0])&&l(a.SQLITE_MISUSE,"Invalid argument for BEGIN qualifier."),w+=" "+arguments[0],b=arguments[1]),E(this).exec(w);try{const f=b(this);return this.exec("COMMIT"),f}catch(f){throw this.exec("ROLLBACK"),f}},savepoint:function(b){E(this).exec("SAVEPOINT oo1");try{const w=b(this);return this.exec("RELEASE oo1"),w}catch(w){throw this.exec("ROLLBACK to SAVEPOINT oo1; RELEASE SAVEPOINT oo1"),w}},checkRc:function(b){return m.checkRc(this,b)}};const L=function(b){return b.pointer||l("Stmt has been closed."),b},ie=function(b){let w=y[b==null?"null":typeof b];switch(w){case y.boolean:case y.null:case y.number:case y.string:return w;case y.bigint:if(u.bigIntEnabled)return w;default:return d.isBindableTypedArray(b)?y.blob:void 0}},j=function(b){return ie(b)||l("Unsupported bind() argument type:",typeof b)},g=function(b,w){const f=typeof w=="number"?w:a.sqlite3_bind_parameter_index(b.pointer,w);return f===0||!d.isInt32(f)?l("Invalid bind() parameter name: "+w):(f<1||f>b.parameterCount)&&l("Bind index",w,"is out of range."),f},v=function(b,w){return b._isLocked&&l("Operation is illegal when statement is locked:",w),b},O=function b(w,f,p,_){v(L(w),"bind()"),b._||(b._tooBigInt=F=>l("BigInt value is too big to store without precision loss:",F),b._={string:function(F,ne,re,oe){const[he,ue]=u.allocCString(re,!0);return(oe?a.sqlite3_bind_blob:a.sqlite3_bind_text)(F.pointer,ne,he,ue,a.SQLITE_WASM_DEALLOC)}}),j(_),f=g(w,f);let P=0;switch(_==null?y.null:p){case y.null:P=a.sqlite3_bind_null(w.pointer,f);break;case y.string:P=b._.string(w,f,_,!1);break;case y.number:{let F;d.isInt32(_)?F=a.sqlite3_bind_int:typeof _=="bigint"?d.bigIntFits64(_)?u.bigIntEnabled?F=a.sqlite3_bind_int64:d.bigIntFitsDouble(_)?(_=Number(_),F=a.sqlite3_bind_double):b._tooBigInt(_):b._tooBigInt(_):(_=Number(_),u.bigIntEnabled&&Number.isInteger(_)?F=a.sqlite3_bind_int64:F=a.sqlite3_bind_double),P=F(w.pointer,f,_);break}case y.boolean:P=a.sqlite3_bind_int(w.pointer,f,_?1:0);break;case y.blob:{if(typeof _=="string"){P=b._.string(w,f,_,!0);break}else _ instanceof ArrayBuffer?_=new Uint8Array(_):d.isBindableTypedArray(_)||l("Binding a value as a blob requires","that it be a string, Uint8Array, Int8Array, or ArrayBuffer.");const F=u.alloc(_.byteLength||1);u.heap8().set(_.byteLength?_:[0],F),P=a.sqlite3_bind_blob(w.pointer,f,F,_.byteLength,a.SQLITE_WASM_DEALLOC);break}default:i.config.warn("Unsupported bind() argument type:",_),l("Unsupported bind() argument type: "+typeof _)}return P&&m.checkRc(w.db.pointer,P),w._mayGet=!1,w};x.prototype={finalize:function(){this.pointer&&(v(this,"finalize()"),delete S.get(this.db)[this.pointer],a.sqlite3_finalize(this.pointer),N.delete(this),delete this._mayGet,delete this.columnCount,delete this.parameterCount,delete this.db,delete this._isLocked)},clearBindings:function(){return v(L(this),"clearBindings()"),a.sqlite3_clear_bindings(this.pointer),this._mayGet=!1,this},reset:function(b){return v(this,"reset()"),b&&this.clearBindings(),a.sqlite3_reset(L(this).pointer),this._mayGet=!1,this},bind:function(){L(this);let b,w;switch(arguments.length){case 1:b=1,w=arguments[0];break;case 2:b=arguments[0],w=arguments[1];break;default:l("Invalid bind() arguments.")}return w===void 0?this:(this.parameterCount||l("This statement has no bindable parameters."),this._mayGet=!1,w===null?O(this,b,y.null,w):Array.isArray(w)?(arguments.length!==1&&l("When binding an array, an index argument is not permitted."),w.forEach((f,p)=>O(this,p+1,j(f),f)),this):(w instanceof ArrayBuffer&&(w=new Uint8Array(w)),typeof w=="object"&&!d.isBindableTypedArray(w)?(arguments.length!==1&&l("When binding an object, an index argument is not permitted."),Object.keys(w).forEach(f=>O(this,f,j(w[f]),w[f])),this):O(this,b,j(w),w)))},bindAsBlob:function(b,w){L(this),arguments.length===1&&(w=b,b=1);const f=j(w);return y.string!==f&&y.blob!==f&&y.null!==f&&l("Invalid value type for bindAsBlob()"),O(this,b,y.blob,w)},step:function(){v(this,"step()");const b=a.sqlite3_step(L(this).pointer);switch(b){case a.SQLITE_DONE:return this._mayGet=!1;case a.SQLITE_ROW:return this._mayGet=!0;default:this._mayGet=!1,i.config.warn("sqlite3_step() rc=",b,a.sqlite3_js_rc_str(b),"SQL =",a.sqlite3_sql(this.pointer)),m.checkRc(this.db.pointer,b)}},stepReset:function(){return this.step(),this.reset()},stepFinalize:function(){const b=this.step();return this.finalize(),b},get:function(b,w){if(L(this)._mayGet||l("Stmt.step() has not (recently) returned true."),Array.isArray(b)){let f=0;for(;f<this.columnCount;)b[f]=this.get(f++);return b}else if(b&&typeof b=="object"){let f=0;for(;f<this.columnCount;)b[a.sqlite3_column_name(this.pointer,f)]=this.get(f++);return b}switch(q(this,b),w===void 0?a.sqlite3_column_type(this.pointer,b):w){case a.SQLITE_NULL:return null;case a.SQLITE_INTEGER:if(u.bigIntEnabled){const f=a.sqlite3_column_int64(this.pointer,b);return f>=Number.MIN_SAFE_INTEGER&&f<=Number.MAX_SAFE_INTEGER?Number(f).valueOf():f}else{const f=a.sqlite3_column_double(this.pointer,b);return(f>Number.MAX_SAFE_INTEGER||f<Number.MIN_SAFE_INTEGER)&&l("Integer is out of range for JS integer range: "+f),d.isInt32(f)?f|0:f}case a.SQLITE_FLOAT:return a.sqlite3_column_double(this.pointer,b);case a.SQLITE_TEXT:return a.sqlite3_column_text(this.pointer,b);case a.SQLITE_BLOB:{const f=a.sqlite3_column_bytes(this.pointer,b),p=a.sqlite3_column_blob(this.pointer,b),_=new Uint8Array(f);return f&&_.set(u.heap8u().slice(p,p+f),0),f&&this.db._blobXfer instanceof Array&&this.db._blobXfer.push(_.buffer),_}default:l("Don't know how to translate","type of result column #"+b+".")}l("Not reached.")},getInt:function(b){return this.get(b,a.SQLITE_INTEGER)},getFloat:function(b){return this.get(b,a.SQLITE_FLOAT)},getString:function(b){return this.get(b,a.SQLITE_TEXT)},getBlob:function(b){return this.get(b,a.SQLITE_BLOB)},getJSON:function(b){const w=this.get(b,a.SQLITE_STRING);return w===null?w:JSON.parse(w)},getColumnName:function(b){return a.sqlite3_column_name(q(L(this),b).pointer,b)},getColumnNames:function(b=[]){q(L(this),0);for(let w=0;w<this.columnCount;++w)b.push(a.sqlite3_column_name(this.pointer,w));return b},getParamIndex:function(b){return L(this).parameterCount?a.sqlite3_bind_parameter_index(this.pointer,b):void 0}};{const b={enumerable:!0,get:function(){return N.get(this)},set:()=>l("The pointer property is read-only.")};Object.defineProperty(x.prototype,"pointer",b),Object.defineProperty(m.prototype,"pointer",b)}if(i.oo1={DB:m,Stmt:x},d.isUIThread()){i.oo1.JsStorageDb=function(w="session"){w!=="session"&&w!=="local"&&l("JsStorageDb db name must be one of 'session' or 'local'."),k.call(this,{filename:w,flags:"c",vfs:"kvvfs"})};const b=i.oo1.JsStorageDb;b.prototype=Object.create(m.prototype),b.clearStorage=a.sqlite3_js_kvvfs_clear,b.prototype.clearStorage=function(){return b.clearStorage(E(this).filename)},b.storageSize=a.sqlite3_js_kvvfs_size,b.prototype.storageSize=function(){return b.storageSize(E(this).filename)}}}),globalThis.sqlite3ApiBootstrap.initializers.push(function(i){i.initWorker1API=(function(){const l=(...m)=>{throw new Error(m.join(" "))};globalThis.WorkerGlobalScope instanceof Function||l("initWorker1API() must be run from a Worker thread."),this.self;const a=this.sqlite3||l("Missing this.sqlite3 object."),u=a.oo1.DB,d=function(m){let y=N.idMap.get(m);return y||(y="db#"+ ++N.idSeq+"@"+m.pointer,N.idMap.set(m,y),y)},N={dbList:[],idSeq:0,idMap:new WeakMap,xfer:[],open:function(m){const y=new u(m);return this.dbs[d(y)]=y,this.dbList.indexOf(y)<0&&this.dbList.push(y),y},close:function(m,y){if(m){delete this.dbs[d(m)];const x=m.filename,E=a.wasm.sqlite3_wasm_db_vfs(m.pointer,0);m.close();const q=this.dbList.indexOf(m);q>=0&&this.dbList.splice(q,1),y&&x&&E&&a.wasm.sqlite3_wasm_vfs_unlink(E,x)}},post:function(m,y){y&&y.length?(globalThis.postMessage(m,Array.from(y)),y.length=0):globalThis.postMessage(m)},dbs:Object.create(null),getDb:function(m,y=!0){return this.dbs[m]||(y?l("Unknown (or closed) DB ID:",m):void 0)}},S=function(m=N.dbList[0]){return m&&m.pointer?m:l("DB is not opened.")},C=function(m,y=!0){const x=N.getDb(m.dbId,!1)||N.dbList[0];return y?S(x):x},z=function(){return N.dbList[0]&&d(N.dbList[0])},K=function(m){const y=/^file:.+(vfs=(\w+))/.exec(m);return a.capi.sqlite3_vfs_find(y?y[2]:0)},te=m=>m===""||m[0]===":",k={open:function(m){const y=Object.create(null),x=m.args||Object.create(null);x.simulateError&&l("Throwing because of simulateError flag.");const E=Object.create(null);let q,W;if(y.vfs=x.vfs,te(x.filename)?y.filename=x.filename||"":(y.filename=x.filename,q=x.byteArray,q&&(W=K(x.filename))),W){let R;try{R=a.wasm.allocFromTypedArray(q);const L=a.wasm.sqlite3_wasm_vfs_create_file(W,y.filename,R,q.byteLength);L&&a.SQLite3Error.toss(L)}catch(L){throw new a.SQLite3Error(L.name+" creating "+x.filename+": "+L.message,{cause:L})}finally{R&&a.wasm.dealloc(R)}}const M=N.open(y);return E.filename=M.filename,E.persistent=!!a.capi.sqlite3_js_db_uses_vfs(M.pointer,"opfs"),E.dbId=d(M),E.vfs=M.dbVfsName(),E},close:function(m){const y=C(m,!1),x={filename:y&&y.filename};if(y){const E=m.args&&typeof m.args=="object"?!!m.args.unlink:!1;N.close(y,E)}return x},exec:function(m){const y=typeof m.args=="string"?{sql:m.args}:m.args||Object.create(null);y.rowMode==="stmt"?l("Invalid rowMode for 'exec': stmt mode","does not work in the Worker API."):y.sql||l("'exec' requires input SQL.");const x=C(m);(y.callback||Array.isArray(y.resultRows))&&(x._blobXfer=N.xfer);const E=y.callback;let q=0;const W=!!y.columnNames;typeof E=="string"&&(W||(y.columnNames=[]),y.callback=function(M,R){N.post({type:E,columnNames:y.columnNames,rowNumber:++q,row:M},N.xfer)});try{x.exec(y),y.callback instanceof Function&&(y.callback=E,N.post({type:E,columnNames:y.columnNames,rowNumber:null,row:void 0}))}finally{delete x._blobXfer,y.callback&&(y.callback=E)}return y},"config-get":function(){const m=Object.create(null),y=a.config;return["bigIntEnabled"].forEach(function(x){Object.getOwnPropertyDescriptor(y,x)&&(m[x]=y[x])}),m.version=a.version,m.vfsList=a.capi.sqlite3_js_vfs_list(),m.opfsEnabled=!!a.opfs,m},export:function(m){const y=C(m),x={byteArray:a.capi.sqlite3_js_db_export(y.pointer),filename:y.filename,mimetype:"application/x-sqlite3"};return N.xfer.push(x.byteArray.buffer),x},toss:function(m){l("Testing worker exception")},"opfs-tree":async function(m){return a.opfs||l("OPFS support is unavailable."),await a.opfs.treeList()}};globalThis.onmessage=async function(m){m=m.data;let y,x=m.dbId,E=m.type;const q=performance.now();try{k.hasOwnProperty(E)&&k[E]instanceof Function?y=await k[E](m):l("Unknown db worker message type:",m.type)}catch(W){E="error",y={operation:m.type,message:W.message,errorClass:W.name,input:m},W.stack&&(y.stack=typeof W.stack=="string"?W.stack.split(/\n\s*/):W.stack)}x||(x=y.dbId||z()),N.post({type:E,dbId:x,messageId:m.messageId,workerReceivedTime:q,workerRespondTime:performance.now(),departureTime:m.departureTime,result:y},N.xfer)},globalThis.postMessage({type:"sqlite3-api",result:"worker1-ready"})}).bind({self,sqlite3:i})}),globalThis.sqlite3ApiBootstrap.initializers.push(function(i){const l=i.wasm,a=i.capi,u=i.util.toss3,d=Object.create(null),N=Object.create(null),S=i.StructBinder;i.vfs=d,i.vtab=N;const C=a.sqlite3_index_info;C.prototype.nthConstraint=function(m,y=!1){if(m<0||m>=this.$nConstraint)return!1;const x=this.$aConstraint+C.sqlite3_index_constraint.structInfo.sizeof*m;return y?x:new C.sqlite3_index_constraint(x)},C.prototype.nthConstraintUsage=function(m,y=!1){if(m<0||m>=this.$nConstraint)return!1;const x=this.$aConstraintUsage+C.sqlite3_index_constraint_usage.structInfo.sizeof*m;return y?x:new C.sqlite3_index_constraint_usage(x)},C.prototype.nthOrderBy=function(m,y=!1){if(m<0||m>=this.$nOrderBy)return!1;const x=this.$aOrderBy+C.sqlite3_index_orderby.structInfo.sizeof*m;return y?x:new C.sqlite3_index_orderby(x)};const z=function m(y,x,E,q=m.installMethodArgcCheck){if(y instanceof S.StructType?!(E instanceof Function)&&!l.isPtr(E)&&u("Usage errror: expecting a Function or WASM pointer to one."):u("Usage error: target object is-not-a StructType."),arguments.length===1)return(L,ie)=>m(y,L,ie,q);m.argcProxy||(m.argcProxy=function(L,ie,j,g){return function(...v){return j.length!==arguments.length&&u("Argument mismatch for",L.structInfo.name+"::"+ie+": Native signature is:",g),j.apply(this,v)}},m.removeFuncList=function(){this.ondispose.__removeFuncList&&(this.ondispose.__removeFuncList.forEach((L,ie)=>{if(typeof L=="number")try{l.uninstallFunction(L)}catch{}}),delete this.ondispose.__removeFuncList)});const W=y.memberSignature(x);W.length<2&&u("Member",x,"does not have a function pointer signature:",W);const M=y.memberKey(x),R=q&&!l.isPtr(E)?m.argcProxy(y,M,E,W):E;if(l.isPtr(R))R&&!l.functionEntry(R)&&u("Pointer",R,"is not a WASM function table entry."),y[M]=R;else{const L=l.installFunction(R,y.memberSignature(x,!0));y[M]=L,(!y.ondispose||!y.ondispose.__removeFuncList)&&(y.addOnDispose("ondispose.__removeFuncList handler",m.removeFuncList),y.ondispose.__removeFuncList=[]),y.ondispose.__removeFuncList.push(M,L)}return(L,ie)=>m(y,L,ie,q)};z.installMethodArgcCheck=!1;const K=function(m,y,x=z.installMethodArgcCheck){const E=new Map;for(const q of Object.keys(y)){const W=y[q],M=E.get(W);if(M){const R=m.memberKey(q);m[R]=m[m.memberKey(M)]}else z(m,q,W,x),E.set(W,q)}return m};S.StructType.prototype.installMethod=function(y,x,E=z.installMethodArgcCheck){return arguments.length<3&&y&&typeof y=="object"?K(this,...arguments):z(this,...arguments)},S.StructType.prototype.installMethods=function(m,y=z.installMethodArgcCheck){return K(this,m,y)},a.sqlite3_vfs.prototype.registerVfs=function(m=!1){this instanceof i.capi.sqlite3_vfs||u("Expecting a sqlite3_vfs-type argument.");const y=a.sqlite3_vfs_register(this,m?1:0);return y&&u("sqlite3_vfs_register(",this,") failed with rc",y),this.pointer!==a.sqlite3_vfs_find(this.$zName)&&u("BUG: sqlite3_vfs_find(vfs.$zName) failed for just-installed VFS",this),this},d.installVfs=function(m){let y=0;const x=["io","vfs"];for(const E of x){const q=m[E];q&&(++y,K(q.struct,q.methods,!!q.applyArgcCheck),E==="vfs"&&(!q.struct.$zName&&typeof q.name=="string"&&q.struct.addOnDispose(q.struct.$zName=l.allocCString(q.name)),q.struct.registerVfs(!!q.asDefault)))}return y||u("Misuse: installVfs() options object requires at least","one of:",x),this};const te=function(m,y){return(function(x,E=!1){if(arguments.length===0&&(x=new y),x instanceof y)return this.set(x.pointer,x),x;l.isPtr(x)||i.SQLite3Error.toss("Invalid argument to",m+"()");let q=this.get(x);return E&&this.delete(x),q}).bind(new Map)},k=function(m,y){const x=te(m,y);return Object.assign(Object.create(null),{StructType:y,create:E=>{const q=x();return l.pokePtr(E,q.pointer),q},get:E=>x(E),unget:E=>x(E,!0),dispose:E=>{const q=x(E,!0);q&&q.dispose()}})};N.xVtab=k("xVtab",a.sqlite3_vtab),N.xCursor=k("xCursor",a.sqlite3_vtab_cursor),N.xIndexInfo=m=>new a.sqlite3_index_info(m),N.xError=function m(y,x,E){if(m.errorReporter instanceof Function)try{m.errorReporter("sqlite3_module::"+y+"(): "+x.message)}catch{}let q;return x instanceof i.WasmAllocError?q=a.SQLITE_NOMEM:arguments.length>2?q=E:x instanceof i.SQLite3Error&&(q=x.resultCode),q||a.SQLITE_ERROR},N.xError.errorReporter=console.error.bind(console),N.xRowid=(m,y)=>l.poke(m,y,"i64"),N.setupModule=function(m){let y=!1;const x=this instanceof a.sqlite3_module?this:m.struct||(y=new a.sqlite3_module);try{const E=m.methods||u("Missing 'methods' object.");for(const q of Object.entries({xConnect:"xCreate",xDisconnect:"xDestroy"})){const W=q[0],M=q[1];E[W]===!0?E[W]=E[M]:E[M]===!0&&(E[M]=E[W])}if(m.catchExceptions){const q=function(R,L){return["xConnect","xCreate"].indexOf(R)>=0?function(ie,j,g,v,O,b){try{return L(...arguments)||0}catch(w){return w instanceof i.WasmAllocError||(l.dealloc(l.peekPtr(b)),l.pokePtr(b,l.allocCString(w.message))),N.xError(R,w)}}:function(...ie){try{return L(...ie)||0}catch(j){return N.xError(R,j)}}},W=["xCreate","xConnect","xBestIndex","xDisconnect","xDestroy","xOpen","xClose","xFilter","xNext","xEof","xColumn","xRowid","xUpdate","xBegin","xSync","xCommit","xRollback","xFindFunction","xRename","xSavepoint","xRelease","xRollbackTo","xShadowName"],M=Object.create(null);for(const R of W){const L=E[R];if(L instanceof Function)R==="xConnect"&&E.xCreate===L?M[R]=E.xCreate:R==="xCreate"&&E.xConnect===L?M[R]=E.xConnect:M[R]=q(R,L);else continue}K(x,M,!1)}else K(x,E,!!m.applyArgcCheck);if(x.$iVersion===0){let q;typeof m.iVersion=="number"?q=m.iVersion:x.$xShadowName?q=3:x.$xSavePoint||x.$xRelease||x.$xRollbackTo?q=2:q=1,x.$iVersion=q}}catch(E){throw y&&y.dispose(),E}return x},a.sqlite3_module.prototype.setupModule=function(m){return N.setupModule.call(this,m)}}),globalThis.sqlite3ApiBootstrap.initializers.push(function(i){const l=function a(u){var S;if(!globalThis.SharedArrayBuffer||!globalThis.Atomics)return Promise.reject(new Error("Cannot install OPFS: Missing SharedArrayBuffer and/or Atomics. The server must emit the COOP/COEP response headers to enable those. See https://sqlite.org/wasm/doc/trunk/persistence.md#coop-coep"));if(typeof WorkerGlobalScope>"u")return Promise.reject(new Error("The OPFS sqlite3_vfs cannot run in the main thread because it requires Atomics.wait()."));if(!globalThis.FileSystemHandle||!globalThis.FileSystemDirectoryHandle||!globalThis.FileSystemFileHandle||!globalThis.FileSystemFileHandle.prototype.createSyncAccessHandle||!((S=navigator==null?void 0:navigator.storage)!=null&&S.getDirectory))return Promise.reject(new Error("Missing required OPFS APIs."));(!u||typeof u!="object")&&(u=Object.create(null));const d=new URL(globalThis.location.href).searchParams;return u.verbose===void 0&&(u.verbose=d.has("opfs-verbose")?+d.get("opfs-verbose")||2:1),u.sanityChecks===void 0&&(u.sanityChecks=d.has("opfs-sanity-check")),u.proxyUri===void 0&&(u.proxyUri=a.defaultProxyUri),typeof u.proxyUri=="function"&&(u.proxyUri=u.proxyUri()),new Promise(function(C,z){const K={0:i.config.error,1:i.config.warn,2:i.config.log},te=(I,...B)=>{u.verbose>I&&K[I]("OPFS syncer:",...B)},k=(...I)=>te(2,...I),m=(...I)=>te(1,...I),y=(...I)=>te(0,...I),x=i.util.toss,E=i.capi,q=i.wasm,W=E.sqlite3_vfs,M=E.sqlite3_file,R=E.sqlite3_io_methods,L=Object.create(null),ie=()=>{var I;return globalThis.FileSystemHandle&&globalThis.FileSystemDirectoryHandle&&globalThis.FileSystemFileHandle&&globalThis.FileSystemFileHandle.prototype.createSyncAccessHandle&&((I=navigator==null?void 0:navigator.storage)==null?void 0:I.getDirectory)};L.metrics={dump:function(){let I,B=0,Q=0,Z=0;for(I in _.opIds){const H=P[I];B+=H.count,Q+=H.time,Z+=H.wait,H.avgTime=H.count&&H.time?H.time/H.count:0,H.avgWait=H.count&&H.wait?H.wait/H.count:0}i.config.log(globalThis.location.href,"metrics for",globalThis.location.href,":",P,`
Total of`,B,"op(s) for",Q,"ms (incl. "+Z+" ms of waiting on the async side)"),i.config.log("Serialization metrics:",P.s11n),w.postMessage({type:"opfs-async-metrics"})},reset:function(){let I;const B=Z=>Z.count=Z.time=Z.wait=0;for(I in _.opIds)B(P[I]=Object.create(null));let Q=P.s11n=Object.create(null);Q=Q.serialize=Object.create(null),Q.count=Q.time=0,Q=P.s11n.deserialize=Object.create(null),Q.count=Q.time=0}};const j=new W,g=new R;let v;const O=I=>(v=!0,j.dispose(),z(I)),b=I=>(v=!1,C(I)),w=new Worker(new URL(""+new URL("sqlite3-opfs-async-proxy-9f074d6f.js",self.location.href).href,self.location));setTimeout(()=>{v===void 0&&O(new Error("Timeout while waiting for OPFS async proxy worker."))},4e3),w._originalOnError=w.onerror,w.onerror=function(I){y("Error initializing OPFS asyncer:",I),O(new Error("Loading OPFS async Worker failed for unknown reasons."))};const f=E.sqlite3_vfs_find(null),p=f?new W(f):null;j.$iVersion=2,j.$szOsFile=E.sqlite3_file.structInfo.sizeof,j.$mxPathname=1024,j.$zName=q.allocCString("opfs"),j.$xDlOpen=j.$xDlError=j.$xDlSym=j.$xDlClose=null,j.ondispose=["$zName",j.$zName,"cleanup default VFS wrapper",()=>p?p.dispose():null,"cleanup opfsIoMethods",()=>g.dispose()];const _=Object.create(null);_.verbose=u.verbose,_.littleEndian=(()=>{const I=new ArrayBuffer(2);return new DataView(I).setInt16(0,256,!0),new Int16Array(I)[0]===256})(),_.asyncIdleWaitTime=150,_.asyncS11nExceptions=1,_.fileBufferSize=1024*64,_.sabS11nOffset=_.fileBufferSize,_.sabS11nSize=j.$mxPathname*2,_.sabIO=new SharedArrayBuffer(_.fileBufferSize+_.sabS11nSize),_.opIds=Object.create(null);const P=Object.create(null);{let I=0;_.opIds.whichOp=I++,_.opIds.rc=I++,_.opIds.xAccess=I++,_.opIds.xClose=I++,_.opIds.xDelete=I++,_.opIds.xDeleteNoWait=I++,_.opIds.xFileSize=I++,_.opIds.xLock=I++,_.opIds.xOpen=I++,_.opIds.xRead=I++,_.opIds.xSleep=I++,_.opIds.xSync=I++,_.opIds.xTruncate=I++,_.opIds.xUnlock=I++,_.opIds.xWrite=I++,_.opIds.mkdir=I++,_.opIds["opfs-async-metrics"]=I++,_.opIds["opfs-async-shutdown"]=I++,_.opIds.retry=I++,_.sabOP=new SharedArrayBuffer(I*4),L.metrics.reset()}_.sq3Codes=Object.create(null),["SQLITE_ACCESS_EXISTS","SQLITE_ACCESS_READWRITE","SQLITE_BUSY","SQLITE_ERROR","SQLITE_IOERR","SQLITE_IOERR_ACCESS","SQLITE_IOERR_CLOSE","SQLITE_IOERR_DELETE","SQLITE_IOERR_FSYNC","SQLITE_IOERR_LOCK","SQLITE_IOERR_READ","SQLITE_IOERR_SHORT_READ","SQLITE_IOERR_TRUNCATE","SQLITE_IOERR_UNLOCK","SQLITE_IOERR_WRITE","SQLITE_LOCK_EXCLUSIVE","SQLITE_LOCK_NONE","SQLITE_LOCK_PENDING","SQLITE_LOCK_RESERVED","SQLITE_LOCK_SHARED","SQLITE_LOCKED","SQLITE_MISUSE","SQLITE_NOTFOUND","SQLITE_OPEN_CREATE","SQLITE_OPEN_DELETEONCLOSE","SQLITE_OPEN_MAIN_DB","SQLITE_OPEN_READONLY"].forEach(I=>{(_.sq3Codes[I]=E[I])===void 0&&x("Maintenance required: not found:",I)}),_.opfsFlags=Object.assign(Object.create(null),{OPFS_UNLOCK_ASAP:1,defaultUnlockAsap:!1});const F=(I,...B)=>{const Q=_.opIds[I]||x("Invalid op ID:",I);_.s11n.serialize(...B),Atomics.store(_.sabOPView,_.opIds.rc,-1),Atomics.store(_.sabOPView,_.opIds.whichOp,Q),Atomics.notify(_.sabOPView,_.opIds.whichOp);const Z=performance.now();Atomics.wait(_.sabOPView,_.opIds.rc,-1);const H=Atomics.load(_.sabOPView,_.opIds.rc);if(P[I].wait+=performance.now()-Z,H&&_.asyncS11nExceptions){const Ne=_.s11n.deserialize();Ne&&y(I+"() async error:",...Ne)}return H};L.debug={asyncShutdown:()=>{m("Shutting down OPFS async listener. The OPFS VFS will no longer work."),F("opfs-async-shutdown")},asyncRestart:()=>{m("Attempting to restart OPFS VFS async listener. Might work, might not."),w.postMessage({type:"opfs-async-restart"})}};const ne=()=>{if(_.s11n)return _.s11n;const I=new TextDecoder,B=new TextEncoder("utf-8"),Q=new Uint8Array(_.sabIO,_.sabS11nOffset,_.sabS11nSize),Z=new DataView(_.sabIO,_.sabS11nOffset,_.sabS11nSize);_.s11n=Object.create(null);const H=Object.create(null);H.number={id:1,size:8,getter:"getFloat64",setter:"setFloat64"},H.bigint={id:2,size:8,getter:"getBigInt64",setter:"setBigInt64"},H.boolean={id:3,size:4,getter:"getInt32",setter:"setInt32"},H.string={id:4};const Ne=ee=>H[typeof ee]||x("Maintenance required: this value type cannot be serialized.",ee),be=ee=>{switch(ee){case H.number.id:return H.number;case H.bigint.id:return H.bigint;case H.boolean.id:return H.boolean;case H.string.id:return H.string;default:x("Invalid type ID:",ee)}};return _.s11n.deserialize=function(ee=!1){++P.s11n.deserialize.count;const Lt=performance.now(),ot=Q[0],T=ot?[]:null;if(ot){const J=[];let $=1,X,ke,Re;for(X=0;X<ot;++X,++$)J.push(be(Q[$]));for(X=0;X<ot;++X){const Ce=J[X];Ce.getter?(Re=Z[Ce.getter]($,_.littleEndian),$+=Ce.size):(ke=Z.getInt32($,_.littleEndian),$+=4,Re=I.decode(Q.slice($,$+ke)),$+=ke),T.push(Re)}}return ee&&(Q[0]=0),P.s11n.deserialize.time+=performance.now()-Lt,T},_.s11n.serialize=function(...ee){const Lt=performance.now();if(++P.s11n.serialize.count,ee.length){const ot=[];let T=0,J=1;for(Q[0]=ee.length&255;T<ee.length;++T,++J)ot.push(Ne(ee[T])),Q[J]=ot[T].id;for(T=0;T<ee.length;++T){const $=ot[T];if($.setter)Z[$.setter](J,ee[T],_.littleEndian),J+=$.size;else{const X=B.encode(ee[T]);Z.setInt32(J,X.byteLength,_.littleEndian),J+=4,Q.set(X,J),J+=X.byteLength}}}else Q[0]=0;P.s11n.serialize.time+=performance.now()-Lt},_.s11n},re=function I(B=16){I._chars||(I._chars="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ012346789",I._n=I._chars.length);const Q=[];let Z=0;for(;Z<B;++Z){const H=Math.random()*(I._n*64)%I._n|0;Q[Z]=I._chars[H]}return Q.join("")},oe=Object.create(null),he=Object.create(null);he.op=void 0,he.start=void 0;const ue=I=>{he.start=performance.now(),he.op=I,++P[I].count},qe=()=>P[he.op].time+=performance.now()-he.start,ze={xCheckReservedLock:function(I,B){const Q=oe[I];return q.poke(B,Q.lockType?1:0,"i32"),0},xClose:function(I){ue("xClose");let B=0;const Q=oe[I];return Q&&(delete oe[I],B=F("xClose",I),Q.sq3File&&Q.sq3File.dispose()),qe(),B},xDeviceCharacteristics:function(I){return E.SQLITE_IOCAP_UNDELETABLE_WHEN_OPEN},xFileControl:function(I,B,Q){return E.SQLITE_NOTFOUND},xFileSize:function(I,B){ue("xFileSize");let Q=F("xFileSize",I);if(Q==0)try{const Z=_.s11n.deserialize()[0];q.poke(B,Z,"i64")}catch(Z){y("Unexpected error reading xFileSize() result:",Z),Q=_.sq3Codes.SQLITE_IOERR}return qe(),Q},xLock:function(I,B){ue("xLock");const Q=oe[I];let Z=0;return Q.lockType?Q.lockType=B:(Z=F("xLock",I,B),Z===0&&(Q.lockType=B)),qe(),Z},xRead:function(I,B,Q,Z){ue("xRead");const H=oe[I];let Ne;try{Ne=F("xRead",I,Q,Number(Z)),(Ne===0||E.SQLITE_IOERR_SHORT_READ===Ne)&&q.heap8u().set(H.sabView.subarray(0,Q),B)}catch(be){y("xRead(",arguments,") failed:",be,H),Ne=E.SQLITE_IOERR_READ}return qe(),Ne},xSync:function(I,B){ue("xSync"),++P.xSync.count;const Q=F("xSync",I,B);return qe(),Q},xTruncate:function(I,B){ue("xTruncate");const Q=F("xTruncate",I,Number(B));return qe(),Q},xUnlock:function(I,B){ue("xUnlock");const Q=oe[I];let Z=0;return E.SQLITE_LOCK_NONE===B&&Q.lockType&&(Z=F("xUnlock",I,B)),Z===0&&(Q.lockType=B),qe(),Z},xWrite:function(I,B,Q,Z){ue("xWrite");const H=oe[I];let Ne;try{H.sabView.set(q.heap8u().subarray(B,B+Q)),Ne=F("xWrite",I,Q,Number(Z))}catch(be){y("xWrite(",arguments,") failed:",be,H),Ne=E.SQLITE_IOERR_WRITE}return qe(),Ne}},dt={xAccess:function(I,B,Q,Z){ue("xAccess");const H=F("xAccess",q.cstrToJs(B));return q.poke(Z,H?0:1,"i32"),qe(),0},xCurrentTime:function(I,B){return q.poke(B,24405875e-1+new Date().getTime()/864e5,"double"),0},xCurrentTimeInt64:function(I,B){return q.poke(B,24405875e-1*864e5+new Date().getTime(),"i64"),0},xDelete:function(I,B,Q){return ue("xDelete"),F("xDelete",q.cstrToJs(B),Q,!1),qe(),0},xFullPathname:function(I,B,Q,Z){return q.cstrncpy(Z,B,Q)<Q?0:E.SQLITE_CANTOPEN},xGetLastError:function(I,B,Q){return m("OPFS xGetLastError() has nothing sensible to return."),0},xOpen:function(B,Q,Z,H,Ne){ue("xOpen");let be=0;Q===0?Q=re():typeof Q=="number"&&(E.sqlite3_uri_boolean(Q,"opfs-unlock-asap",0)&&(be|=_.opfsFlags.OPFS_UNLOCK_ASAP),Q=q.cstrToJs(Q));const ee=Object.create(null);ee.fid=Z,ee.filename=Q,ee.sab=new SharedArrayBuffer(_.fileBufferSize),ee.flags=H;const Lt=F("xOpen",Z,Q,H,be);return Lt||(ee.readOnly&&q.poke(Ne,E.SQLITE_OPEN_READONLY,"i32"),oe[Z]=ee,ee.sabView=_.sabFileBufView,ee.sq3File=new M(Z),ee.sq3File.$pMethods=g.pointer,ee.lockType=E.SQLITE_LOCK_NONE),qe(),Lt}};if(p&&(j.$xRandomness=p.$xRandomness,j.$xSleep=p.$xSleep),j.$xRandomness||(dt.xRandomness=function(I,B,Q){const Z=q.heap8u();let H=0;for(;H<B;++H)Z[Q+H]=Math.random()*255e3&255;return H}),j.$xSleep||(dt.xSleep=function(I,B){return Atomics.wait(_.sabOPView,_.opIds.xSleep,0,B),0}),L.getResolvedPath=function(I,B){const Q=new URL(I,"file://irrelevant").pathname;return B?Q.split("/").filter(Z=>!!Z):Q},L.getDirForFilename=async function(B,Q=!1){const Z=L.getResolvedPath(B,!0),H=Z.pop();let Ne=L.rootDirectory;for(const be of Z)be&&(Ne=await Ne.getDirectoryHandle(be,{create:!!Q}));return[Ne,H]},L.mkdir=async function(I){try{return await L.getDirForFilename(I+"/filepart",!0),!0}catch{return!1}},L.entryExists=async function(I){try{const[B,Q]=await L.getDirForFilename(I);return await B.getFileHandle(Q),!0}catch{return!1}},L.randomFilename=re,L.registerVfs=(I=!1)=>q.exports.sqlite3_vfs_register(j.pointer,I?1:0),L.treeList=async function(){const I=async function Q(Z,H){H.name=Z.name,H.dirs=[],H.files=[];for await(const Ne of Z.values())if(Ne.kind==="directory"){const be=Object.create(null);H.dirs.push(be),await Q(Ne,be)}else H.files.push(Ne.name)},B=Object.create(null);return await I(L.rootDirectory,B),B},L.rmfr=async function(){const I=L.rootDirectory,B={recurse:!0};for await(const Q of I.values())I.removeEntry(Q.name,B)},L.unlink=async function(I,B=!1,Q=!1){try{const[Z,H]=await L.getDirForFilename(I,!1);return await Z.removeEntry(H,{recursive:B}),!0}catch(Z){if(Q)throw new Error("unlink(",arguments[0],") failed: "+Z.message,{cause:Z});return!1}},L.traverse=async function(I){const B={recursive:!0,directory:L.rootDirectory};typeof I=="function"&&(I={callback:I}),I=Object.assign(B,I||{}),async function Z(H,Ne){for await(const be of H.values()){if(I.callback(be,H,Ne)===!1)return!1;if(I.recursive&&be.kind==="directory"&&await Z(be,Ne+1)===!1)break}}(I.directory,0)},i.oo1){const I=function(...B){const Q=i.oo1.DB.dbCtorHelper.normalizeArgs(...B);Q.vfs=j.$zName,i.oo1.DB.dbCtorHelper.call(this,Q)};I.prototype=Object.create(i.oo1.DB.prototype),i.oo1.OpfsDb=I,i.oo1.DB.dbCtorHelper.setVfsPostOpenSql(j.pointer,function(B,Q){Q.capi.sqlite3_busy_timeout(B,1e4),Q.capi.sqlite3_exec(B,["pragma journal_mode=persist;","pragma cache_size=-16384;"],0,0,0)})}const Zt=function(){const I=q.scopedAllocPush(),B=new M;try{const Q=B.pointer,Z=E.SQLITE_OPEN_CREATE|E.SQLITE_OPEN_READWRITE|E.SQLITE_OPEN_MAIN_DB,H=q.scopedAlloc(8),Ne="/sanity/check/file"+re(8),be=q.scopedAllocCString(Ne);let ee;if(_.s11n.serialize("This is ä string."),ee=_.s11n.deserialize(),k("deserialize() says:",ee),ee[0]!=="This is ä string."&&x("String d13n error."),dt.xAccess(j.pointer,be,0,H),ee=q.peek(H,"i32"),k("xAccess(",Ne,") exists ?=",ee),ee=dt.xOpen(j.pointer,be,Q,Z,H),k("open rc =",ee,"state.sabOPView[xOpen] =",_.sabOPView[_.opIds.xOpen]),ee!==0){y("open failed with code",ee);return}dt.xAccess(j.pointer,be,0,H),ee=q.peek(H,"i32"),ee||x("xAccess() failed to detect file."),ee=ze.xSync(B.pointer,0),ee&&x("sync failed w/ rc",ee),ee=ze.xTruncate(B.pointer,1024),ee&&x("truncate failed w/ rc",ee),q.poke(H,0,"i64"),ee=ze.xFileSize(B.pointer,H),ee&&x("xFileSize failed w/ rc",ee),k("xFileSize says:",q.peek(H,"i64")),ee=ze.xWrite(B.pointer,be,10,1),ee&&x("xWrite() failed!");const Lt=q.scopedAlloc(16);ee=ze.xRead(B.pointer,Lt,6,2),q.poke(Lt+6,0);let ot=q.cstrToJs(Lt);k("xRead() got:",ot),ot!=="sanity"&&x("Unexpected xRead() value."),dt.xSleep&&(k("xSleep()ing before close()ing..."),dt.xSleep(j.pointer,2e3),k("waking up from xSleep()")),ee=ze.xClose(Q),k("xClose rc =",ee,"sabOPView =",_.sabOPView),k("Deleting file:",Ne),dt.xDelete(j.pointer,be,4660),dt.xAccess(j.pointer,be,0,H),ee=q.peek(H,"i32"),ee&&x("Expecting 0 from xAccess(",Ne,") after xDelete()."),m("End of OPFS sanity checks.")}finally{B.dispose(),q.scopedAllocPop(I)}};w.onmessage=function({data:I}){switch(I.type){case"opfs-unavailable":O(new Error(I.payload.join(" ")));break;case"opfs-async-loaded":w.postMessage({type:"opfs-async-init",args:_});break;case"opfs-async-inited":{if(v===!0)break;try{i.vfs.installVfs({io:{struct:g,methods:ze},vfs:{struct:j,methods:dt}}),_.sabOPView=new Int32Array(_.sabOP),_.sabFileBufView=new Uint8Array(_.sabIO,0,_.fileBufferSize),_.sabS11nView=new Uint8Array(_.sabIO,_.sabS11nOffset,_.sabS11nSize),ne(),u.sanityChecks&&(m("Running sanity checks because of opfs-sanity-check URL arg..."),Zt()),ie()?navigator.storage.getDirectory().then(B=>{w.onerror=w._originalOnError,delete w._originalOnError,i.opfs=L,L.rootDirectory=B,k("End of OPFS sqlite3_vfs setup.",j),b(i)}).catch(O):b(i)}catch(B){y(B),O(B)}break}default:{const B="Unexpected message from the OPFS async worker: "+JSON.stringify(I);y(B),O(new Error(B));break}}}})};l.defaultProxyUri="sqlite3-opfs-async-proxy.js",globalThis.sqlite3ApiBootstrap.initializersAsync.push(async a=>{try{let u=l.defaultProxyUri;return a.scriptInfo.sqlite3Dir&&(l.defaultProxyUri=a.scriptInfo.sqlite3Dir+u),l().catch(d=>{a.config.warn("Ignoring inability to install OPFS sqlite3_vfs:",d.message)})}catch(u){throw a.config.error("installOpfsVfs() exception:",u),u}})}),typeof s<"u"){const i=Object.assign(Object.create(null),{exports:s.asm,memory:s.wasmMemory},globalThis.sqlite3ApiConfig||{});globalThis.sqlite3ApiConfig=i;let l;try{l=globalThis.sqlite3ApiBootstrap()}catch(a){throw console.error("sqlite3ApiBootstrap() error:",a),a}finally{delete globalThis.sqlite3ApiBootstrap,delete globalThis.sqlite3ApiConfig}s.sqlite3=l}else console.warn("This is not running in an Emscripten module context, so","globalThis.sqlite3ApiBootstrap() is _not_ being called due to lack","of config info for the WASM environment.","It must be called manually.")}),r.ready}})();const Zu=function(){var r,n;const t=Yu;if(!t)throw new Error("Expecting globalThis.sqlite3InitModule to be defined by the Emscripten build.");const e=globalThis.sqlite3InitModuleState=Object.assign(Object.create(null),{moduleScript:(r=globalThis==null?void 0:globalThis.document)==null?void 0:r.currentScript,isWorker:typeof WorkerGlobalScope<"u",location:globalThis.location,urlParams:(n=globalThis==null?void 0:globalThis.location)!=null&&n.href?new URL(globalThis.location.href).searchParams:new URLSearchParams});if(e.debugModule=e.urlParams.has("sqlite3.debugModule")?(...A)=>console.warn("sqlite3.debugModule:",...A):()=>{},e.urlParams.has("sqlite3.dir"))e.sqlite3Dir=e.urlParams.get("sqlite3.dir")+"/";else if(e.moduleScript){const A=e.moduleScript.src.split("/");A.pop(),e.sqlite3Dir=A.join("/")+"/"}if(globalThis.sqlite3InitModule=function A(...V){return t(...V).then(Y=>{var ct,Ze,et;if(typeof WorkerGlobalScope<"u"&&(Y.ENVIRONMENT_IS_PTHREAD||Y._pthread_self||typeof threadAlert=="function"||(et=(Ze=(ct=globalThis==null?void 0:globalThis.location)==null?void 0:ct.pathname)==null?void 0:Ze.endsWith)!=null&&et.call(Ze,".worker.js")))return Y;const pe=Y.sqlite3;pe.scriptInfo=e,A.__isUnderTest&&(pe.__isUnderTest=!0);const Ie=pe.asyncPostInit;return delete pe.asyncPostInit,Ie()}).catch(Y=>{throw console.error("Exception loading sqlite3 module:",Y),Y})},globalThis.sqlite3InitModule.ready=t.ready,globalThis.sqlite3InitModuleState.moduleScript){const A=globalThis.sqlite3InitModuleState;let V=A.moduleScript.src.split("/");V.pop(),A.scriptDir=V.join("/")+"/"}return e.debugModule("sqlite3InitModuleState =",e),globalThis.sqlite3InitModule}();var ec=t=>t==null||typeof t=="bigint"||typeof t=="number"||typeof t=="object"&&"buffer"in t?t:typeof t=="boolean"?`${t}`:t instanceof Date?t.toISOString():JSON.stringify(t),tc=t=>{if(t==null||typeof t=="bigint"||typeof t=="number"||typeof t=="object"&&"buffer"in t)return t;if(typeof t=="string"){const e=/^\d{4}-\d{2}-\d{2}[T ]\d{2}:\d{2}:\d{2}(?:\.\d+)?Z?$/;if(/^(true|false)$/.test(t))return t==="true";if(e.test(t))return new Date(t);try{return JSON.parse(t,(r,n)=>typeof n=="string"&&e.exec(n)?new Date(n):n)}catch{}}return t},nc=class extends Gs{constructor(e){super();Oe(this,"serializer");this.serializer=e||ec}transformPrimitiveValueList(e){return{...e,values:e.values.map(this.serializer)}}transformColumnUpdate(e){const{value:r}=e;if(r.kind!=="ValueNode")return super.transformColumnUpdate(e);const{value:n,...A}=r,V=this.serializer(n);return n===V?super.transformColumnUpdate(e):super.transformColumnUpdate({...e,value:{...A,value:V}})}transformValue(e){return{...e,value:this.serializer(e.value)}}},rc=class{constructor({deserializer:t,serializer:e}={}){Oe(this,"serializeParametersTransformer");Oe(this,"deserializer");Oe(this,"ctx");this.serializeParametersTransformer=new nc(e),this.deserializer=t||tc,this.ctx=new WeakMap}transformQuery({node:t,queryId:e}){return t.kind==="SelectQueryNode"&&this.ctx.set(e,t.kind),this.serializeParametersTransformer.transformNode(t)}async parseResult(t){return await Promise.all(t.map(async e=>{const r={...e};for(const n in r)r[n]=await this.deserializer(r[n]);return r}))}async transformResult({result:t,queryId:e}){const{rows:r}=t,n=this.ctx.get(e);return this.ctx.delete(e),r&&n==="SelectQueryNode"?{...t,rows:await this.parseResult(r)}:t}};function ao(t){return typeof t=="string"}function ic(t){return typeof t=="boolean"}async function va(t,e,r,n,A="rowid"){await Et`
      create trigger if not exists ${Et.raw(e)}_${Et.raw(n)}
      after ${Et.raw(r)}
      on ${Et.table(e)}
      begin
        update ${Et.table(e)}
        set ${Et.ref(n)} = datetime('now','localtime')
        where ${Et.ref(A)} = NEW.${Et.ref(A)};
      end
    `.execute(t).catch(V=>{console.error(V)})}function sc(t){const e=new Map;for(const r in t){if(!Object.prototype.hasOwnProperty.call(t,r))continue;const n=t[r];e.set(r,n)}return e}async function oc(t,e,r=!1){for(const[n,A]of e){const{columns:V,property:Y}=A;r&&await t.schema.dropTable(n).ifExists().execute().catch();let pe=t.schema.createTable(n),Ie="rowid",ct=!1,Ze="createAt",et="updateAt";if(Y!=null&&Y.timestamp&&!ic(Y.timestamp)){const{create:se,update:Wt}=Y.timestamp;Ze=se??"createAt",et=Wt??"updateAt"}for(const se in V){if(!Object.prototype.hasOwnProperty.call(V,se))continue;const Wt=V[se];let Be="text";const{type:cn,notNull:yi,defaultTo:dn}=Wt;switch(cn){case"boolean":case"date":case"object":case"string":Be="text";break;case"increments":Ie=se;case"number":Be="integer";break;case"blob":Be="blob"}[Ze,et].includes(se)||(pe=pe.addColumn(se,Be,gt=>cn==="increments"?(ct=!0,gt.autoIncrement().primaryKey()):(yi&&(gt=gt.notNull()),dn!==void 0&&(gt=gt.defaultTo(dn instanceof Function?dn(Et):dn)),gt)))}if(Y){const se=Y.primary,Wt=Y.unique;if(Y.timestamp&&(Ze&&(pe=pe.addColumn(Ze,"text")),et&&(pe=pe.addColumn(et,"text"))),!ct&&se){const Be=ao(se);Ie=Be?se:se[0],pe=pe.addPrimaryKeyConstraint(`pk_${Be?se:se.join("_")}`,Be?[se]:se)}Wt==null||Wt.forEach(Be=>{const cn=ao(Be);Ie=!se&&!ct?cn?Be:Be[0]:Ie,pe=pe.addUniqueConstraint(`un_${cn?Be:Be.join("_")}`,cn?[Be]:Be)})}if(await pe.ifNotExists().execute(),Y!=null&&Y.index)for(const se of Y.index){const Wt=ao(se);let Be=t.schema.createIndex(`idx_${Wt?se:se.join("_")}`).on(n);Be=Wt?Be.column(se):Be.columns(se),await Be.ifNotExists().execute()}Y!=null&&Y.timestamp&&(Ze&&await va(t,n,"insert",Ze,Ie),et&&await va(t,n,"update",et,Ie))}}var ac=class{constructor(t){Oe(this,"kysely");Oe(this,"status");Oe(this,"tableMap");Oe(this,"logger");const{dialect:e,tables:r,dropTableBeforeInit:n,onQuery:A,plugins:V,logger:Y}=t;this.logger=Y;const pe=V??[];pe.push(new rc),this.kysely=new Kr({dialect:e,log:Ie=>{var ct;Ie.level==="error"?(ct=this.logger)==null||ct.error("Uncaught DB Error",Ie.error):A==null||A(Ie.query,Ie.queryDurationMillis)},plugins:pe}),this.status=n?0:1,this.tableMap=sc(r)}async init(t=!1){const e=t||this.status===0;return await oc(this.kysely,this.tableMap,e),this.status=2,this}async isEmptyTable(){var t;return this.status!==2&&await this.init(),this.status===2?!1:((t=this.logger)==null||t.error("fail to init table"),!0)}async transaction(t,e){if(!await this.isEmptyTable())return await this.kysely.transaction().execute(t).catch(r=>{var n;e&&((n=this.logger)==null||n.error(e,r))})}async exec(t,e){if(!await this.isEmptyTable())return t(this.kysely).catch(r=>{var n;e&&((n=this.logger)==null||n.error(e,r))})}async execOne(t,e){if(!await this.isEmptyTable())return t(this.kysely).executeTakeFirstOrThrow().catch(r=>{var n;e&&((n=this.logger)==null||n.error(e,r))})}async execList(t,e){if(!await this.isEmptyTable())return t(this.kysely).execute().catch(r=>{var n;e&&((n=this.logger)==null||n.error(e,r))})}async toSQL(t){return t(this.kysely).compile()}async raw(t){if(!await this.isEmptyTable())return t(Et).execute(this.kysely)}};async function lc(t){const e=await new ac({dialect:t,tables:{test:{columns:{id:{type:"increments"},name:{type:"string"},blobtest:{type:"blob"},createAt:{type:"date"},updateAt:{type:"date"}},property:{timestamp:!0}}}}).init();console.log("test"),console.log(await e.raw(r=>r`PRAGMA table_info(${r.table("test")});`)),console.log(await e.raw(r=>r`select last_insert_rowid()`));for(let r=0;r<100;r++)await e.transaction(n=>n.insertInto("test").values({name:`test at ${Date.now()}`,blobtest:Uint8Array.from([2,3,4,5,6,7,8])}).execute());return e.exec(r=>r.selectFrom("test").selectAll().execute())}const uc=new Ku({database:async()=>{const t=(await Zu()).oo1;if(!t)return Promise.reject("fail to load sqlite");const e="/test.db";return t.OpfsDb?(console.log("support OPFS"),new t.OpfsDb(e)):(console.log("doesn't support OPFS"),new t.DB(e))},async onCreateConnection(t){await Xu(t)}});onmessage=()=>{console.log("start official wasm test"),lc(uc).then(t=>{t==null||t.forEach(e=>console.log("[official wasm]",e))})}})();
