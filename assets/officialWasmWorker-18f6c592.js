var vd=Object.defineProperty;var xd=(Ie,ge,Ke)=>ge in Ie?vd(Ie,ge,{enumerable:!0,configurable:!0,writable:!0,value:Ke}):Ie[ge]=Ke;var ve=(Ie,ge,Ke)=>(xd(Ie,typeof ge!="symbol"?ge+"":ge,Ke),Ke),qo=(Ie,ge,Ke)=>{if(!ge.has(Ie))throw TypeError("Cannot "+Ke)};var o=(Ie,ge,Ke)=>(qo(Ie,ge,"read from private field"),Ke?Ke.call(Ie):ge.get(Ie)),D=(Ie,ge,Ke)=>{if(ge.has(Ie))throw TypeError("Cannot add the same private member more than once");ge instanceof WeakSet?ge.add(Ie):ge.set(Ie,Ke)},G=(Ie,ge,Ke,Wr)=>(qo(Ie,ge,"write to private field"),Wr?Wr.call(Ie,Ke):ge.set(Ie,Ke),Ke);var Oe=(Ie,ge,Ke)=>(qo(Ie,ge,"access private method"),Ke);(function(){var Bt,Wn,lr,Le,ti,Ut,pe,oe,ue,ur,cs,cr,Fn,Ln,ds,$a,fs,Ka,hs,Xa,Dn,Ei,ri,No,ps,Ya,ii,De,si,dr,fr,Mn,oi,vo,U,hr,pr,bn,_r,qn,Bn,Un,Et,yr,gr,wr,br,$t,qr,Nn,ai,xo,Nr,vr,vn,Pe,Qn,ln,li,Qt,ht,Ze,Me,$e,We,St,Se,at,mt,yt,qs,Qe,lt,kt,At,it,xr,Xt,Yt,un,jt,En,cn,Vn,hi,Ns,Za,vs,el,xs,tl,Es,nl,pi,Eo,_i,Sn,Ss,rl,kn,Jn,ut,zt,Gn,Vt,Nt,kr,Fs,mi,So,yi,ko,Ar,An,As,Or,Hn,Ir,Os,il,gi,ka,wi,Aa;"use strict";function Ie(t){return typeof t>"u"||t===void 0}function ge(t){return typeof t=="string"}function Ke(t){return typeof t=="number"}function Wr(t){return typeof t=="boolean"}function Ao(t){return t===null}function sl(t){return t instanceof Date}function ol(t){return typeof t=="bigint"}function Ct(t){return typeof t=="function"}function Jt(t){return typeof t=="object"&&t!==null}function h(t){return Object.freeze(t)}function Fr(t){return Array.isArray(t)}function er(t){return t}const Xe=h({is(t){return t.kind==="AlterTableNode"},create(t){return h({kind:"AlterTableNode",table:t})},cloneWithTableProps(t,e){return h({...t,...e})},cloneWithColumnAlteration(t,e){return h({...t,columnAlterations:t.columnAlterations?[...t.columnAlterations,e]:[e]})}}),Ue=h({is(t){return t.kind==="IdentifierNode"},create(t){return h({kind:"IdentifierNode",name:t})}}),fn=h({is(t){return t.kind==="CreateIndexNode"},create(t){return h({kind:"CreateIndexNode",name:Ue.create(t)})},cloneWith(t,e){return h({...t,...e})},cloneWithColumns(t,e){return h({...t,columns:[...t.columns||[],...e]})}}),Oo=h({is(t){return t.kind==="CreateSchemaNode"},create(t,e){return h({kind:"CreateSchemaNode",schema:Ue.create(t),...e})},cloneWith(t,e){return h({...t,...e})}}),al=["preserve rows","delete rows","drop"],Dt=h({is(t){return t.kind==="CreateTableNode"},create(t){return h({kind:"CreateTableNode",table:t,columns:h([])})},cloneWithColumn(t,e){return h({...t,columns:h([...t.columns,e])})},cloneWithConstraint(t,e){return h({...t,constraints:t.constraints?h([...t.constraints,e]):h([e])})},cloneWithFrontModifier(t,e){return h({...t,frontModifiers:t.frontModifiers?h([...t.frontModifiers,e]):h([e])})},cloneWithEndModifier(t,e){return h({...t,endModifiers:t.endModifiers?h([...t.endModifiers,e]):h([e])})},cloneWith(t,e){return h({...t,...e})}}),hn=h({is(t){return t.kind==="SchemableIdentifierNode"},create(t){return h({kind:"SchemableIdentifierNode",identifier:Ue.create(t)})},createWithSchema(t,e){return h({kind:"SchemableIdentifierNode",schema:Ue.create(t),identifier:Ue.create(e)})}}),Si=h({is(t){return t.kind==="DropIndexNode"},create(t,e){return h({kind:"DropIndexNode",name:hn.create(t),...e})},cloneWith(t,e){return h({...t,...e})}}),Ls=h({is(t){return t.kind==="DropSchemaNode"},create(t,e){return h({kind:"DropSchemaNode",schema:Ue.create(t),...e})},cloneWith(t,e){return h({...t,...e})}}),Ds=h({is(t){return t.kind==="DropTableNode"},create(t,e){return h({kind:"DropTableNode",table:t,...e})},cloneWith(t,e){return h({...t,...e})}}),pn=h({is(t){return t.kind==="AliasNode"},create(t,e){return h({kind:"AliasNode",node:t,alias:e})}}),_n=h({is(t){return t.kind==="TableNode"},create(t){return h({kind:"TableNode",table:hn.create(t)})},createWithSchema(t,e){return h({kind:"TableNode",table:hn.createWithSchema(t,e)})}});function Pt(t){return Jt(t)&&Ct(t.toOperationNode)}function Rs(t){return Jt(t)&&"expressionType"in t&&Pt(t)}function ll(t){return Jt(t)&&"expression"in t&&ge(t.alias)&&Pt(t)}const nn=h({is(t){return t.kind==="SelectModifierNode"},create(t){return h({kind:"SelectModifierNode",modifier:t})},createWithExpression(t){return h({kind:"SelectModifierNode",rawModifier:t})}}),Tn=h({is(t){return t.kind==="AndNode"},create(t,e){return h({kind:"AndNode",left:t,right:e})}}),Cn=h({is(t){return t.kind==="OrNode"},create(t,e){return h({kind:"OrNode",left:t,right:e})}}),Ms=h({is(t){return t.kind==="OnNode"},create(t){return h({kind:"OnNode",on:t})},cloneWithOperation(t,e,r){return h({...t,on:e==="And"?Tn.create(t.on,r):Cn.create(t.on,r)})}}),Lr=h({is(t){return t.kind==="JoinNode"},create(t,e){return h({kind:"JoinNode",joinType:t,table:e,on:void 0})},createWithOn(t,e,r){return h({kind:"JoinNode",joinType:t,table:e,on:Ms.create(r)})},cloneWithOn(t,e){return h({...t,on:t.on?Ms.cloneWithOperation(t.on,"And",e):Ms.create(e)})}}),Bs=h({is(t){return t.kind==="BinaryOperationNode"},create(t,e,r){return h({kind:"BinaryOperationNode",leftOperand:t,operator:e,rightOperand:r})}}),Io=["=","==","!=","<>",">",">=","<","<=","in","not in","is","is not","like","not like","match","ilike","not ilike","@>","<@","?","?&","!<","!>","<=>","!~","~","~*","!~*","@@","@@@","!!","<->","regexp"],ul=["+","-","*","/","%","^","&","|","#","<<",">>"],To=["->","->>"],Co=[...Io,...ul,"&&","||"],cl=["not","-",...["exists","not exists"]],dl=[...Co,...To,...cl],Dr=h({is(t){return t.kind==="OperatorNode"},create(t){return h({kind:"OperatorNode",operator:t})}});function fl(t){return ge(t)&&Co.includes(t)}function hl(t){return ge(t)&&Io.includes(t)}function Po(t){return ge(t)&&To.includes(t)}const Je=h({is(t){return t.kind==="ColumnNode"},create(t){return h({kind:"ColumnNode",column:Ue.create(t)})}}),Us=h({is(t){return t.kind==="SelectAllNode"},create(){return h({kind:"SelectAllNode"})}}),ki=h({is(t){return t.kind==="ReferenceNode"},create(t,e){return h({kind:"ReferenceNode",table:e,column:t})},createSelectAll(t){return h({kind:"ReferenceNode",table:t,column:Us.create()})}}),pl=h({is(t){return t.kind==="OrderByItemNode"},create(t,e){return h({kind:"OrderByItemNode",orderBy:t,direction:e})}}),pt=h({is(t){return t.kind==="RawNode"},create(t,e){return h({kind:"RawNode",sqlFragments:h(t),parameters:h(e)})},createWithSql(t){return pt.create([t],[])},createWithChild(t){return pt.create(["",""],[t])},createWithChildren(t){return pt.create(new Array(t.length+1).fill(""),t)}});function _l(t){return t==="asc"||t==="desc"}function Ai(t,e){return pl.create(ml(t),yl(e))}function ml(t){return rn(t)}function yl(t){if(t)return t==="asc"||t==="desc"?pt.createWithSql(t):t.toOperationNode()}const Qs=h({is(t){return t.kind==="JSONReferenceNode"},create(t,e){return h({kind:"JSONReferenceNode",reference:t,traversal:e})},cloneWithTraversal(t,e){return h({...t,traversal:e})}}),Wo=h({is(t){return t.kind==="JSONOperatorChainNode"},create(t){return h({kind:"JSONOperatorChainNode",operator:t,values:h([])})},cloneWithValue(t,e){return h({...t,values:h([...t.values,e])})}}),js=h({is(t){return t.kind==="JSONPathNode"},create(t){return h({kind:"JSONPathNode",inOperator:t,pathLegs:h([])})},cloneWithLeg(t,e){return h({...t,pathLegs:h([...t.pathLegs,e])})}});function Fo(t){return ge(t)?Pn(t):t.toOperationNode()}function Rr(t){return Fr(t)?t.map(e=>rn(e)):[rn(t)]}function rn(t){return ji(t)?Qi(t):Fo(t)}function gl(t,e){const r=Pn(t);if(Po(e))return Qs.create(r,Wo.create(Dr.create(e)));const n=e.slice(0,-1);if(Po(n))return Qs.create(r,js.create(Dr.create(n)));throw new Error(`Invalid JSON operator: ${e}`)}function Pn(t){const e=".";if(!t.includes(e))return ki.create(Je.create(t));const r=t.split(e).map(zs);if(r.length===3)return bl(r);if(r.length===2)return ql(r);throw new Error(`invalid column reference ${t}`)}function wl(t){const e=" as ";if(t.includes(e)){const[r,n]=t.split(e).map(zs);return pn.create(Pn(r),Ue.create(n))}else return Pn(t)}function Lo(t){return Je.create(t)}function Do(t){const e=" ";if(t.includes(e)){const[r,n]=t.split(e).map(zs);if(!_l(n))throw new Error(`invalid order direction "${n}" next to "${r}"`);return Ai(r,n)}else return Lo(t)}function bl(t){const[e,r,n]=t;return ki.create(Je.create(n),_n.createWithSchema(e,r))}function ql(t){const[e,r]=t;return ki.create(Je.create(r),_n.create(e))}function zs(t){return t.trim()}const Ro=h({is(t){return t.kind==="PrimitiveValueListNode"},create(t){return h({kind:"PrimitiveValueListNode",values:h([...t])})}}),Vs=h({is(t){return t.kind==="ValueListNode"},create(t){return h({kind:"ValueListNode",values:h(t)})}}),Rt=h({is(t){return t.kind==="ValueNode"},create(t){return h({kind:"ValueNode",value:t})},createImmediate(t){return h({kind:"ValueNode",value:t,immediate:!0})}});function Mo(t){return Fr(t)?Nl(t):sn(t)}function sn(t){return ji(t)?Qi(t):Rt.create(t)}function Nl(t){return t.some(ji)?Vs.create(t.map(e=>sn(e))):Ro.create(t)}function _t(t){if(t.length>1&&!Qo(t[1]))throw new Error(`invalid comparison operator ${JSON.stringify(t[1])}`);return Bo(t)}function Bo(t){if(t.length===3)return Oi(t[0],t[1],t[2]);if(t.length===1)return kl(t[0]);throw new Error(`invalid arguments: ${JSON.stringify(t)}`)}function Oi(t,e,r){if(!Uo(e))throw new Error(`invalid binary operator ${JSON.stringify(e)}`);return xl(e)&&El(r)?Sl(t,e,r):Bs.create(rn(t),Js(e),Mo(r))}function on(t,e,r){if(!Qo(e))throw new Error(`invalid comparison operator ${JSON.stringify(e)}`);return vl(t,e,r)}function vl(t,e,r){if(!Uo(e))throw new Error(`invalid binary operator ${JSON.stringify(e)}`);return Bs.create(rn(t),Js(e),rn(r))}function Uo(t){return fl(t)||Rs(t)}function Qo(t){return hl(t)||Rs(t)}function xl(t){return t==="is"||t==="is not"}function El(t){return Ao(t)||Wr(t)}function Sl(t,e,r){return Bs.create(rn(t),Js(e),Rt.createImmediate(r))}function Js(t){if(ge(t)&&dl.includes(t))return Dr.create(t);if(Pt(t))return t.toOperationNode();throw new Error(`invalid operator ${JSON.stringify(t)}`)}function kl(t){return Ct(t)?t(no()).toOperationNode():Pt(t)?t.toOperationNode():Rt.create(t)}const tr=h({is(t){return t.kind==="OrderByNode"},create(t){return h({kind:"OrderByNode",items:h([t])})},cloneWithItem(t,e){return h({...t,items:h([...t.items,e])})}}),jo=h({is(t){return t.kind==="PartitionByNode"},create(t){return h({kind:"PartitionByNode",items:h(t)})},cloneWithItems(t,e){return h({...t,items:h([...t.items,...e])})}}),Gs=h({is(t){return t.kind==="OverNode"},create(){return h({kind:"OverNode"})},cloneWithOrderByItem(t,e){return h({...t,orderBy:t.orderBy?tr.cloneWithItem(t.orderBy,e):tr.create(e)})},cloneWithPartitionByItems(t,e){return h({...t,partitionBy:t.partitionBy?jo.cloneWithItems(t.partitionBy,e):jo.create(e)})}}),Ii=h({is(t){return t.kind==="FromNode"},create(t){return h({kind:"FromNode",froms:h(t)})},cloneWithFroms(t,e){return h({...t,froms:h([...t.froms,...e])})}}),zo=h({is(t){return t.kind==="GroupByNode"},create(t){return h({kind:"GroupByNode",items:h(t)})},cloneWithItems(t,e){return h({...t,items:h([...t.items,...e])})}}),Vo=h({is(t){return t.kind==="HavingNode"},create(t){return h({kind:"HavingNode",having:t})},cloneWithOperation(t,e,r){return h({...t,having:e==="And"?Tn.create(t.having,r):Cn.create(t.having,r)})}}),xe=h({is(t){return t.kind==="SelectQueryNode"},create(t,e){return h({kind:"SelectQueryNode",from:Ii.create(t),...e&&{with:e}})},cloneWithSelections(t,e){return h({...t,selections:t.selections?h([...t.selections,...e]):h(e)})},cloneWithDistinctOn(t,e){return h({...t,distinctOn:t.distinctOn?h([...t.distinctOn,...e]):h(e)})},cloneWithFrontModifier(t,e){return h({...t,frontModifiers:t.frontModifiers?h([...t.frontModifiers,e]):h([e])})},cloneWithEndModifier(t,e){return h({...t,endModifiers:t.endModifiers?h([...t.endModifiers,e]):h([e])})},cloneWithOrderByItem(t,e){return h({...t,orderBy:t.orderBy?tr.cloneWithItem(t.orderBy,e):tr.create(e)})},cloneWithGroupByItems(t,e){return h({...t,groupBy:t.groupBy?zo.cloneWithItems(t.groupBy,e):zo.create(e)})},cloneWithLimit(t,e){return h({...t,limit:e})},cloneWithOffset(t,e){return h({...t,offset:e})},cloneWithHaving(t,e){return h({...t,having:t.having?Vo.cloneWithOperation(t.having,"And",e):Vo.create(e)})},cloneWithSetOperation(t,e){return h({...t,setOperations:t.setOperations?h([...t.setOperations,e]):h([e])})},cloneWithoutSelections(t){return h({...t,selections:[]})},cloneWithoutLimit(t){return h({...t,limit:void 0})},cloneWithoutOffset(t){return h({...t,offset:void 0})},cloneWithoutOrderBy(t){return h({...t,orderBy:void 0})}});function Ee(t,e){Object.defineProperties(t.prototype,{then:{enumerable:!1,value:()=>{throw new Error(e)}}})}const ei=class ei{constructor(e){D(this,Bt,void 0);G(this,Bt,h(e))}on(...e){return new ei({...o(this,Bt),joinNode:Lr.cloneWithOn(o(this,Bt).joinNode,_t(e))})}onRef(e,r,n){return new ei({...o(this,Bt),joinNode:Lr.cloneWithOn(o(this,Bt).joinNode,on(e,r,n))})}onTrue(){return new ei({...o(this,Bt),joinNode:Lr.cloneWithOn(o(this,Bt).joinNode,pt.createWithSql("true"))})}$call(e){return e(this)}toOperationNode(){return o(this,Bt).joinNode}};Bt=new WeakMap;let Ti=ei;Ee(Ti,"don't await JoinBuilder instances. They are never executed directly and are always just a part of a query.");const Al=h({is(t){return t.kind==="PartitionByItemNode"},create(t){return h({kind:"PartitionByItemNode",partitionBy:t})}});function Ol(t){return Rr(t).map(Al.create)}const us=class us{constructor(e){D(this,Wn,void 0);G(this,Wn,h(e))}orderBy(e,r){return new us({overNode:Gs.cloneWithOrderByItem(o(this,Wn).overNode,Ai(e,r))})}partitionBy(e){return new us({overNode:Gs.cloneWithPartitionByItems(o(this,Wn).overNode,Ol(e))})}$call(e){return e(this)}toOperationNode(){return o(this,Wn).overNode}};Wn=new WeakMap;let Ci=us;Ee(Ci,"don't await OverBuilder instances. They are never executed directly and are always just a part of a query.");const Mr=h({is(t){return t.kind==="SelectionNode"},create(t){return h({kind:"SelectionNode",selection:t})},createSelectAll(){return h({kind:"SelectionNode",selection:Us.create()})},createSelectAllFromTable(t){return h({kind:"SelectionNode",selection:ki.createSelectAll(t)})}});class Il{constructor(e){D(this,lr,void 0);G(this,lr,e)}get dynamicReference(){return o(this,lr)}get refType(){}toOperationNode(){return Fo(o(this,lr))}}lr=new WeakMap;function Tl(t){return Jt(t)&&Pt(t)&&ge(t.dynamicReference)}function Br(t){return Ct(t)?Br(t(or())):Fr(t)?t.map(e=>Jo(e)):[Jo(t)]}function Jo(t){return ge(t)?Mr.create(wl(t)):Tl(t)?Mr.create(t.toOperationNode()):Mr.create(la(t))}function Ur(t){return t?Array.isArray(t)?t.map(Go):[Go(t)]:[Mr.createSelectAll()]}function Go(t){if(ge(t))return Mr.createSelectAllFromTable(qt(t));throw new Error(`invalid value selectAll expression: ${JSON.stringify(t)}`)}const Cl=h({is(t){return t.kind==="ValuesNode"},create(t){return h({kind:"ValuesNode",values:h(t)})}}),Pl=h({is(t){return t.kind==="DefaultInsertValueNode"},create(){return h({kind:"DefaultInsertValueNode"})}});function Wl(t){const e=Ct(t)?t(or()):t,r=Fr(e)?e:h([e]);return Fl(r)}function Fl(t){const e=Ll(t);return[h([...e.keys()].map(Je.create)),Cl.create(t.map(r=>Dl(r,e)))]}function Ll(t){const e=new Map;for(const r of t){const n=Object.keys(r);for(const O of n)!e.has(O)&&r[O]!==void 0&&e.set(O,e.size)}return e}function Dl(t,e){const r=Object.keys(t),n=Array.from({length:e.size});let O=!1;for(const Y of r){const he=e.get(Y);if(Ie(he))continue;const Te=t[Y];(Ie(Te)||ji(Te))&&(O=!0),n[he]=Te}if(r.length<e.size||O){const Y=Pl.create();return Vs.create(n.map(he=>Ie(he)?Y:sn(he)))}return Ro.create(n)}const Gt=h({is(t){return t.kind==="InsertQueryNode"},create(t,e,r){return h({kind:"InsertQueryNode",into:t,...e&&{with:e},replace:r})},cloneWith(t,e){return h({...t,...e})}}),Pi=h({is(t){return t.kind==="UpdateQueryNode"},create(t,e){return h({kind:"UpdateQueryNode",table:t,...e&&{with:e}})},cloneWithFromItems(t,e){return h({...t,from:t.from?Ii.cloneWithFroms(t.from,e):Ii.create(e)})},cloneWithUpdates(t,e){return h({...t,updates:t.updates?h([...t.updates,...e]):e})}}),Ho=h({is(t){return t.kind==="UsingNode"},create(t){return h({kind:"UsingNode",tables:h(t)})},cloneWithTables(t,e){return h({...t,tables:h([...t.tables,...e])})}}),Qr=h({is(t){return t.kind==="DeleteQueryNode"},create(t,e){return h({kind:"DeleteQueryNode",from:Ii.create(t),...e&&{with:e}})},cloneWithOrderByItem(t,e){return h({...t,orderBy:t.orderBy?tr.cloneWithItem(t.orderBy,e):tr.create(e)})},cloneWithLimit(t,e){return h({...t,limit:e})},cloneWithUsing(t,e){return h({...t,using:t.using!==void 0?Ho.cloneWithTables(t.using,e):Ho.create(e)})}}),wt=h({is(t){return t.kind==="WhereNode"},create(t){return h({kind:"WhereNode",where:t})},cloneWithOperation(t,e,r){return h({...t,where:e==="And"?Tn.create(t.where,r):Cn.create(t.where,r)})}}),$o=h({is(t){return t.kind==="ReturningNode"},create(t){return h({kind:"ReturningNode",selections:h(t)})},cloneWithSelections(t,e){return h({...t,selections:t.selections?h([...t.selections,...e]):h(e)})}}),Rl=h({is(t){return t.kind==="ExplainNode"},create(t,e){return h({kind:"ExplainNode",format:t,options:e})}}),me=h({is(t){return xe.is(t)||Gt.is(t)||Pi.is(t)||Qr.is(t)},cloneWithWhere(t,e){return h({...t,where:t.where?wt.cloneWithOperation(t.where,"And",e):wt.create(e)})},cloneWithJoin(t,e){return h({...t,joins:t.joins?h([...t.joins,e]):h([e])})},cloneWithReturning(t,e){return h({...t,returning:t.returning?$o.cloneWithSelections(t.returning,e):$o.create(e)})},cloneWithoutWhere(t){return h({...t,where:void 0})},cloneWithExplain(t,e,r){return h({...t,explain:Rl.create(e,r==null?void 0:r.toOperationNode())})}}),Ml=h({is(t){return t.kind==="ColumnUpdateNode"},create(t,e){return h({kind:"ColumnUpdateNode",column:t,value:e})}});function Hs(t){const e=Ct(t)?t(or()):t;return Object.entries(e).filter(([r,n])=>n!==void 0).map(([r,n])=>Ml.create(Je.create(r),sn(n)))}const Bl=h({is(t){return t.kind==="OnDuplicateKeyNode"},create(t){return h({kind:"OnDuplicateKeyNode",updates:t})}});class Ul{constructor(e,r){ve(this,"insertId");ve(this,"numInsertedOrUpdatedRows");this.insertId=e,this.numInsertedOrUpdatedRows=r}}class Wi extends Error{constructor(r){super("no result");ve(this,"node");this.node=r}}function Fi(t){return Object.prototype.hasOwnProperty.call(t,"prototype")}const vt=h({is(t){return t.kind==="OnConflictNode"},create(){return h({kind:"OnConflictNode"})},cloneWith(t,e){return h({...t,...e})},cloneWithIndexWhere(t,e){return h({...t,indexWhere:t.indexWhere?wt.cloneWithOperation(t.indexWhere,"And",e):wt.create(e)})},cloneWithIndexOrWhere(t,e){return h({...t,indexWhere:t.indexWhere?wt.cloneWithOperation(t.indexWhere,"Or",e):wt.create(e)})},cloneWithUpdateWhere(t,e){return h({...t,updateWhere:t.updateWhere?wt.cloneWithOperation(t.updateWhere,"And",e):wt.create(e)})},cloneWithUpdateOrWhere(t,e){return h({...t,updateWhere:t.updateWhere?wt.cloneWithOperation(t.updateWhere,"Or",e):wt.create(e)})},cloneWithoutIndexWhere(t){return h({...t,indexWhere:void 0})},cloneWithoutUpdateWhere(t){return h({...t,updateWhere:void 0})}}),an=class an{constructor(e){D(this,Le,void 0);G(this,Le,h(e))}column(e){const r=Je.create(e);return new an({...o(this,Le),onConflictNode:vt.cloneWith(o(this,Le).onConflictNode,{columns:o(this,Le).onConflictNode.columns?h([...o(this,Le).onConflictNode.columns,r]):h([r])})})}columns(e){const r=e.map(Je.create);return new an({...o(this,Le),onConflictNode:vt.cloneWith(o(this,Le).onConflictNode,{columns:o(this,Le).onConflictNode.columns?h([...o(this,Le).onConflictNode.columns,...r]):h(r)})})}constraint(e){return new an({...o(this,Le),onConflictNode:vt.cloneWith(o(this,Le).onConflictNode,{constraint:Ue.create(e)})})}expression(e){return new an({...o(this,Le),onConflictNode:vt.cloneWith(o(this,Le).onConflictNode,{indexExpression:e.toOperationNode()})})}where(...e){return new an({...o(this,Le),onConflictNode:vt.cloneWithIndexWhere(o(this,Le).onConflictNode,_t(e))})}whereRef(e,r,n){return new an({...o(this,Le),onConflictNode:vt.cloneWithIndexWhere(o(this,Le).onConflictNode,on(e,r,n))})}clearWhere(){return new an({...o(this,Le),onConflictNode:vt.cloneWithoutIndexWhere(o(this,Le).onConflictNode)})}doNothing(){return new Ko({...o(this,Le),onConflictNode:vt.cloneWith(o(this,Le).onConflictNode,{doNothing:!0})})}doUpdateSet(e){return new Di({...o(this,Le),onConflictNode:vt.cloneWith(o(this,Le).onConflictNode,{updates:Hs(e)})})}$call(e){return e(this)}};Le=new WeakMap;let Li=an;Ee(Li,"don't await OnConflictBuilder instances.");class Ko{constructor(e){D(this,ti,void 0);G(this,ti,h(e))}toOperationNode(){return o(this,ti).onConflictNode}}ti=new WeakMap,Ee(Ko,"don't await OnConflictDoNothingBuilder instances.");const ni=class ni{constructor(e){D(this,Ut,void 0);G(this,Ut,h(e))}where(...e){return new ni({...o(this,Ut),onConflictNode:vt.cloneWithUpdateWhere(o(this,Ut).onConflictNode,_t(e))})}whereRef(e,r,n){return new ni({...o(this,Ut),onConflictNode:vt.cloneWithUpdateWhere(o(this,Ut).onConflictNode,on(e,r,n))})}clearWhere(){return new ni({...o(this,Ut),onConflictNode:vt.cloneWithoutUpdateWhere(o(this,Ut).onConflictNode)})}$call(e){return e(this)}toOperationNode(){return o(this,Ut).onConflictNode}};Ut=new WeakMap;let Di=ni;Ee(Di,"don't await OnConflictUpdateBuilder instances.");const ft=class ft{constructor(e){D(this,pe,void 0);G(this,pe,h(e))}values(e){const[r,n]=Wl(e);return new ft({...o(this,pe),queryNode:Gt.cloneWith(o(this,pe).queryNode,{columns:r,values:n})})}columns(e){return new ft({...o(this,pe),queryNode:Gt.cloneWith(o(this,pe).queryNode,{columns:h(e.map(Je.create))})})}expression(e){return new ft({...o(this,pe),queryNode:Gt.cloneWith(o(this,pe).queryNode,{values:Qi(e)})})}ignore(){return new ft({...o(this,pe),queryNode:Gt.cloneWith(o(this,pe).queryNode,{ignore:!0})})}onConflict(e){return new ft({...o(this,pe),queryNode:Gt.cloneWith(o(this,pe).queryNode,{onConflict:e(new Li({onConflictNode:vt.create()})).toOperationNode()})})}onDuplicateKeyUpdate(e){return new ft({...o(this,pe),queryNode:Gt.cloneWith(o(this,pe).queryNode,{onDuplicateKey:Bl.create(Hs(e))})})}returning(e){return new ft({...o(this,pe),queryNode:me.cloneWithReturning(o(this,pe).queryNode,Br(e))})}returningAll(){return new ft({...o(this,pe),queryNode:me.cloneWithReturning(o(this,pe).queryNode,Ur())})}$call(e){return e(this)}$if(e,r){return e?r(this):new ft({...o(this,pe)})}$castTo(){return new ft(o(this,pe))}$narrowType(){return new ft(o(this,pe))}$assertType(){return new ft(o(this,pe))}withPlugin(e){return new ft({...o(this,pe),executor:o(this,pe).executor.withPlugin(e)})}toOperationNode(){return o(this,pe).executor.transformQuery(o(this,pe).queryNode,o(this,pe).queryId)}compile(){return o(this,pe).executor.compileQuery(this.toOperationNode(),o(this,pe).queryId)}async execute(){const e=this.compile(),r=e.query,n=await o(this,pe).executor.executeQuery(e,o(this,pe).queryId);return o(this,pe).executor.adapter.supportsReturning&&r.returning?n.rows:[new Ul(n.insertId,n.numAffectedRows??n.numUpdatedOrDeletedRows)]}async executeTakeFirst(){const[e]=await this.execute();return e}async executeTakeFirstOrThrow(e=Wi){const r=await this.executeTakeFirst();if(r===void 0)throw Fi(e)?new e(this.toOperationNode()):e(this.toOperationNode());return r}async*stream(e=100){const r=this.compile(),n=o(this,pe).executor.stream(r,e,o(this,pe).queryId);for await(const O of n)yield*O.rows}async explain(e,r){return await new ft({...o(this,pe),queryNode:me.cloneWithExplain(o(this,pe).queryNode,e,r)}).execute()}};pe=new WeakMap;let jr=ft;Ee(jr,"don't await InsertQueryBuilder instances directly. To execute the query you need to call `execute` or `executeTakeFirst`.");class Ql{constructor(e){ve(this,"numDeletedRows");this.numDeletedRows=e}}const Xo=h({is(t){return t.kind==="LimitNode"},create(t){return h({kind:"LimitNode",limit:Rt.create(t)})}}),Ye=class Ye{constructor(e){D(this,oe,void 0);G(this,oe,h(e))}where(...e){return new Ye({...o(this,oe),queryNode:me.cloneWithWhere(o(this,oe).queryNode,_t(e))})}whereRef(e,r,n){return new Ye({...o(this,oe),queryNode:me.cloneWithWhere(o(this,oe).queryNode,on(e,r,n))})}clearWhere(){return new Ye({...o(this,oe),queryNode:me.cloneWithoutWhere(o(this,oe).queryNode)})}using(e){return new Ye({...o(this,oe),queryNode:Qr.cloneWithUsing(o(this,oe).queryNode,Gr(e))})}innerJoin(...e){return new Ye({...o(this,oe),queryNode:me.cloneWithJoin(o(this,oe).queryNode,bt("InnerJoin",e))})}leftJoin(...e){return new Ye({...o(this,oe),queryNode:me.cloneWithJoin(o(this,oe).queryNode,bt("LeftJoin",e))})}rightJoin(...e){return new Ye({...o(this,oe),queryNode:me.cloneWithJoin(o(this,oe).queryNode,bt("RightJoin",e))})}fullJoin(...e){return new Ye({...o(this,oe),queryNode:me.cloneWithJoin(o(this,oe).queryNode,bt("FullJoin",e))})}returning(e){return new Ye({...o(this,oe),queryNode:me.cloneWithReturning(o(this,oe).queryNode,Br(e))})}returningAll(e){return new Ye({...o(this,oe),queryNode:me.cloneWithReturning(o(this,oe).queryNode,Ur(e))})}orderBy(e,r){return new Ye({...o(this,oe),queryNode:Qr.cloneWithOrderByItem(o(this,oe).queryNode,Ai(e,r))})}limit(e){return new Ye({...o(this,oe),queryNode:Qr.cloneWithLimit(o(this,oe).queryNode,Xo.create(e))})}$call(e){return e(this)}$if(e,r){return e?r(this):new Ye({...o(this,oe)})}$castTo(){return new Ye(o(this,oe))}$narrowType(){return new Ye(o(this,oe))}$assertType(){return new Ye(o(this,oe))}withPlugin(e){return new Ye({...o(this,oe),executor:o(this,oe).executor.withPlugin(e)})}toOperationNode(){return o(this,oe).executor.transformQuery(o(this,oe).queryNode,o(this,oe).queryId)}compile(){return o(this,oe).executor.compileQuery(this.toOperationNode(),o(this,oe).queryId)}async execute(){const e=this.compile(),r=e.query,n=await o(this,oe).executor.executeQuery(e,o(this,oe).queryId);return o(this,oe).executor.adapter.supportsReturning&&r.returning?n.rows:[new Ql(n.numAffectedRows??n.numUpdatedOrDeletedRows??BigInt(0))]}async executeTakeFirst(){const[e]=await this.execute();return e}async executeTakeFirstOrThrow(e=Wi){const r=await this.executeTakeFirst();if(r===void 0)throw Fi(e)?new e(this.toOperationNode()):e(this.toOperationNode());return r}async*stream(e=100){const r=this.compile(),n=o(this,oe).executor.stream(r,e,o(this,oe).queryId);for await(const O of n)yield*O.rows}async explain(e,r){return await new Ye({...o(this,oe),queryNode:me.cloneWithExplain(o(this,oe).queryNode,e,r)}).execute()}};oe=new WeakMap;let Ri=Ye;Ee(Ri,"don't await DeleteQueryBuilder instances directly. To execute the query you need to call `execute` or `executeTakeFirst`.");class jl{constructor(e,r){ve(this,"numUpdatedRows");ve(this,"numChangedRows");this.numUpdatedRows=e,this.numChangedRows=r}}const nt=class nt{constructor(e){D(this,ue,void 0);G(this,ue,h(e))}where(...e){return new nt({...o(this,ue),queryNode:me.cloneWithWhere(o(this,ue).queryNode,_t(e))})}whereRef(e,r,n){return new nt({...o(this,ue),queryNode:me.cloneWithWhere(o(this,ue).queryNode,on(e,r,n))})}clearWhere(){return new nt({...o(this,ue),queryNode:me.cloneWithoutWhere(o(this,ue).queryNode)})}from(e){return new nt({...o(this,ue),queryNode:Pi.cloneWithFromItems(o(this,ue).queryNode,Gr(e))})}innerJoin(...e){return new nt({...o(this,ue),queryNode:me.cloneWithJoin(o(this,ue).queryNode,bt("InnerJoin",e))})}leftJoin(...e){return new nt({...o(this,ue),queryNode:me.cloneWithJoin(o(this,ue).queryNode,bt("LeftJoin",e))})}rightJoin(...e){return new nt({...o(this,ue),queryNode:me.cloneWithJoin(o(this,ue).queryNode,bt("RightJoin",e))})}fullJoin(...e){return new nt({...o(this,ue),queryNode:me.cloneWithJoin(o(this,ue).queryNode,bt("FullJoin",e))})}set(e){return new nt({...o(this,ue),queryNode:Pi.cloneWithUpdates(o(this,ue).queryNode,Hs(e))})}returning(e){return new nt({...o(this,ue),queryNode:me.cloneWithReturning(o(this,ue).queryNode,Br(e))})}returningAll(){return new nt({...o(this,ue),queryNode:me.cloneWithReturning(o(this,ue).queryNode,Ur())})}$call(e){return e(this)}$if(e,r){return e?r(this):new nt({...o(this,ue)})}$castTo(){return new nt(o(this,ue))}$narrowType(){return new nt(o(this,ue))}$assertType(){return new nt(o(this,ue))}withPlugin(e){return new nt({...o(this,ue),executor:o(this,ue).executor.withPlugin(e)})}toOperationNode(){return o(this,ue).executor.transformQuery(o(this,ue).queryNode,o(this,ue).queryId)}compile(){return o(this,ue).executor.compileQuery(this.toOperationNode(),o(this,ue).queryId)}async execute(){const e=this.compile(),r=e.query,n=await o(this,ue).executor.executeQuery(e,o(this,ue).queryId);return o(this,ue).executor.adapter.supportsReturning&&r.returning?n.rows:[new jl(n.numAffectedRows??n.numUpdatedOrDeletedRows??BigInt(0),n.numChangedRows)]}async executeTakeFirst(){const[e]=await this.execute();return e}async executeTakeFirstOrThrow(e=Wi){const r=await this.executeTakeFirst();if(r===void 0)throw Fi(e)?new e(this.toOperationNode()):e(this.toOperationNode());return r}async*stream(e=100){const r=this.compile(),n=o(this,ue).executor.stream(r,e,o(this,ue).queryId);for await(const O of n)yield*O.rows}async explain(e,r){return await new nt({...o(this,ue),queryNode:me.cloneWithExplain(o(this,ue).queryNode,e,r)}).execute()}};ue=new WeakMap;let Mi=nt;Ee(Mi,"don't await UpdateQueryBuilder instances directly. To execute the query you need to call `execute` or `executeTakeFirst`.");const zl=h({is(t){return t.kind==="CommonTableExpressionNode"},create(t,e){return h({kind:"CommonTableExpressionNode",name:t,expression:e})}}),Yo=h({is(t){return t.kind==="CommonTableExpressionNameNode"},create(t,e){return h({kind:"CommonTableExpressionNameNode",table:_n.create(t),columns:e?h(e.map(Je.create)):void 0})}});function Zo(t,e){const r=e(eu());return zl.create(Vl(t),r.toOperationNode())}function Vl(t){if(t.includes("(")){const e=t.split(/[\(\)]/),r=e[0],n=e[1].split(",").map(O=>O.trim());return Yo.create(r,n)}else return Yo.create(t)}const Bi=h({is(t){return t.kind==="WithNode"},create(t,e){return h({kind:"WithNode",expressions:h([t]),...e})},cloneWithExpression(t,e){return h({...t,expressions:h([...t.expressions,e])})}}),ea=["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","0","1","2","3","4","5","6","7","8","9"];function Jl(t){let e="";for(let r=0;r<t;++r)e+=Gl();return e}function Gl(){return ea[~~(Math.random()*ea.length)]}function Fe(){return new Hl}class Hl{constructor(){D(this,ur,void 0)}get queryId(){return o(this,ur)===void 0&&G(this,ur,Jl(8)),o(this,ur)}}ur=new WeakMap;function Sd(t){return t}class $s{constructor(){ve(this,"nodeStack",[]);D(this,cs,h({AliasNode:this.transformAlias.bind(this),ColumnNode:this.transformColumn.bind(this),IdentifierNode:this.transformIdentifier.bind(this),SchemableIdentifierNode:this.transformSchemableIdentifier.bind(this),RawNode:this.transformRaw.bind(this),ReferenceNode:this.transformReference.bind(this),SelectQueryNode:this.transformSelectQuery.bind(this),SelectionNode:this.transformSelection.bind(this),TableNode:this.transformTable.bind(this),FromNode:this.transformFrom.bind(this),SelectAllNode:this.transformSelectAll.bind(this),AndNode:this.transformAnd.bind(this),OrNode:this.transformOr.bind(this),ValueNode:this.transformValue.bind(this),ValueListNode:this.transformValueList.bind(this),PrimitiveValueListNode:this.transformPrimitiveValueList.bind(this),ParensNode:this.transformParens.bind(this),JoinNode:this.transformJoin.bind(this),OperatorNode:this.transformOperator.bind(this),WhereNode:this.transformWhere.bind(this),InsertQueryNode:this.transformInsertQuery.bind(this),DeleteQueryNode:this.transformDeleteQuery.bind(this),ReturningNode:this.transformReturning.bind(this),CreateTableNode:this.transformCreateTable.bind(this),AddColumnNode:this.transformAddColumn.bind(this),ColumnDefinitionNode:this.transformColumnDefinition.bind(this),DropTableNode:this.transformDropTable.bind(this),DataTypeNode:this.transformDataType.bind(this),OrderByNode:this.transformOrderBy.bind(this),OrderByItemNode:this.transformOrderByItem.bind(this),GroupByNode:this.transformGroupBy.bind(this),GroupByItemNode:this.transformGroupByItem.bind(this),UpdateQueryNode:this.transformUpdateQuery.bind(this),ColumnUpdateNode:this.transformColumnUpdate.bind(this),LimitNode:this.transformLimit.bind(this),OffsetNode:this.transformOffset.bind(this),OnConflictNode:this.transformOnConflict.bind(this),OnDuplicateKeyNode:this.transformOnDuplicateKey.bind(this),CreateIndexNode:this.transformCreateIndex.bind(this),DropIndexNode:this.transformDropIndex.bind(this),ListNode:this.transformList.bind(this),PrimaryKeyConstraintNode:this.transformPrimaryKeyConstraint.bind(this),UniqueConstraintNode:this.transformUniqueConstraint.bind(this),ReferencesNode:this.transformReferences.bind(this),CheckConstraintNode:this.transformCheckConstraint.bind(this),WithNode:this.transformWith.bind(this),CommonTableExpressionNode:this.transformCommonTableExpression.bind(this),CommonTableExpressionNameNode:this.transformCommonTableExpressionName.bind(this),HavingNode:this.transformHaving.bind(this),CreateSchemaNode:this.transformCreateSchema.bind(this),DropSchemaNode:this.transformDropSchema.bind(this),AlterTableNode:this.transformAlterTable.bind(this),DropColumnNode:this.transformDropColumn.bind(this),RenameColumnNode:this.transformRenameColumn.bind(this),AlterColumnNode:this.transformAlterColumn.bind(this),ModifyColumnNode:this.transformModifyColumn.bind(this),AddConstraintNode:this.transformAddConstraint.bind(this),DropConstraintNode:this.transformDropConstraint.bind(this),ForeignKeyConstraintNode:this.transformForeignKeyConstraint.bind(this),CreateViewNode:this.transformCreateView.bind(this),DropViewNode:this.transformDropView.bind(this),GeneratedNode:this.transformGenerated.bind(this),DefaultValueNode:this.transformDefaultValue.bind(this),OnNode:this.transformOn.bind(this),ValuesNode:this.transformValues.bind(this),SelectModifierNode:this.transformSelectModifier.bind(this),CreateTypeNode:this.transformCreateType.bind(this),DropTypeNode:this.transformDropType.bind(this),ExplainNode:this.transformExplain.bind(this),DefaultInsertValueNode:this.transformDefaultInsertValue.bind(this),AggregateFunctionNode:this.transformAggregateFunction.bind(this),OverNode:this.transformOver.bind(this),PartitionByNode:this.transformPartitionBy.bind(this),PartitionByItemNode:this.transformPartitionByItem.bind(this),SetOperationNode:this.transformSetOperation.bind(this),BinaryOperationNode:this.transformBinaryOperation.bind(this),UnaryOperationNode:this.transformUnaryOperation.bind(this),UsingNode:this.transformUsing.bind(this),FunctionNode:this.transformFunction.bind(this),CaseNode:this.transformCase.bind(this),WhenNode:this.transformWhen.bind(this),JSONReferenceNode:this.transformJSONReference.bind(this),JSONPathNode:this.transformJSONPath.bind(this),JSONPathLegNode:this.transformJSONPathLeg.bind(this),JSONOperatorChainNode:this.transformJSONOperatorChain.bind(this)}))}transformNode(e){if(!e)return e;this.nodeStack.push(e);const r=this.transformNodeImpl(e);return this.nodeStack.pop(),h(r)}transformNodeImpl(e){return o(this,cs)[e.kind](e)}transformNodeList(e){return e&&h(e.map(r=>this.transformNode(r)))}transformSelectQuery(e){return{kind:"SelectQueryNode",from:this.transformNode(e.from),selections:this.transformNodeList(e.selections),distinctOn:this.transformNodeList(e.distinctOn),joins:this.transformNodeList(e.joins),groupBy:this.transformNode(e.groupBy),orderBy:this.transformNode(e.orderBy),where:this.transformNode(e.where),frontModifiers:this.transformNodeList(e.frontModifiers),endModifiers:this.transformNodeList(e.endModifiers),limit:this.transformNode(e.limit),offset:this.transformNode(e.offset),with:this.transformNode(e.with),having:this.transformNode(e.having),explain:this.transformNode(e.explain),setOperations:this.transformNodeList(e.setOperations)}}transformSelection(e){return{kind:"SelectionNode",selection:this.transformNode(e.selection)}}transformColumn(e){return{kind:"ColumnNode",column:this.transformNode(e.column)}}transformAlias(e){return{kind:"AliasNode",node:this.transformNode(e.node),alias:this.transformNode(e.alias)}}transformTable(e){return{kind:"TableNode",table:this.transformNode(e.table)}}transformFrom(e){return{kind:"FromNode",froms:this.transformNodeList(e.froms)}}transformReference(e){return{kind:"ReferenceNode",column:this.transformNode(e.column),table:this.transformNode(e.table)}}transformAnd(e){return{kind:"AndNode",left:this.transformNode(e.left),right:this.transformNode(e.right)}}transformOr(e){return{kind:"OrNode",left:this.transformNode(e.left),right:this.transformNode(e.right)}}transformValueList(e){return{kind:"ValueListNode",values:this.transformNodeList(e.values)}}transformParens(e){return{kind:"ParensNode",node:this.transformNode(e.node)}}transformJoin(e){return{kind:"JoinNode",joinType:e.joinType,table:this.transformNode(e.table),on:this.transformNode(e.on)}}transformRaw(e){return{kind:"RawNode",sqlFragments:h([...e.sqlFragments]),parameters:this.transformNodeList(e.parameters)}}transformWhere(e){return{kind:"WhereNode",where:this.transformNode(e.where)}}transformInsertQuery(e){return{kind:"InsertQueryNode",into:this.transformNode(e.into),columns:this.transformNodeList(e.columns),values:this.transformNode(e.values),returning:this.transformNode(e.returning),onConflict:this.transformNode(e.onConflict),onDuplicateKey:this.transformNode(e.onDuplicateKey),with:this.transformNode(e.with),ignore:e.ignore,replace:e.replace,explain:this.transformNode(e.explain)}}transformValues(e){return{kind:"ValuesNode",values:this.transformNodeList(e.values)}}transformDeleteQuery(e){return{kind:"DeleteQueryNode",from:this.transformNode(e.from),using:this.transformNode(e.using),joins:this.transformNodeList(e.joins),where:this.transformNode(e.where),returning:this.transformNode(e.returning),with:this.transformNode(e.with),orderBy:this.transformNode(e.orderBy),limit:this.transformNode(e.limit),explain:this.transformNode(e.explain)}}transformReturning(e){return{kind:"ReturningNode",selections:this.transformNodeList(e.selections)}}transformCreateTable(e){return{kind:"CreateTableNode",table:this.transformNode(e.table),columns:this.transformNodeList(e.columns),constraints:this.transformNodeList(e.constraints),temporary:e.temporary,ifNotExists:e.ifNotExists,onCommit:e.onCommit,frontModifiers:this.transformNodeList(e.frontModifiers),endModifiers:this.transformNodeList(e.endModifiers)}}transformColumnDefinition(e){return{kind:"ColumnDefinitionNode",column:this.transformNode(e.column),dataType:this.transformNode(e.dataType),references:this.transformNode(e.references),primaryKey:e.primaryKey,autoIncrement:e.autoIncrement,unique:e.unique,notNull:e.notNull,unsigned:e.unsigned,defaultTo:this.transformNode(e.defaultTo),check:this.transformNode(e.check),generated:this.transformNode(e.generated),frontModifiers:this.transformNodeList(e.frontModifiers),endModifiers:this.transformNodeList(e.endModifiers)}}transformAddColumn(e){return{kind:"AddColumnNode",column:this.transformNode(e.column)}}transformDropTable(e){return{kind:"DropTableNode",table:this.transformNode(e.table),ifExists:e.ifExists,cascade:e.cascade}}transformOrderBy(e){return{kind:"OrderByNode",items:this.transformNodeList(e.items)}}transformOrderByItem(e){return{kind:"OrderByItemNode",orderBy:this.transformNode(e.orderBy),direction:this.transformNode(e.direction)}}transformGroupBy(e){return{kind:"GroupByNode",items:this.transformNodeList(e.items)}}transformGroupByItem(e){return{kind:"GroupByItemNode",groupBy:this.transformNode(e.groupBy)}}transformUpdateQuery(e){return{kind:"UpdateQueryNode",table:this.transformNode(e.table),from:this.transformNode(e.from),joins:this.transformNodeList(e.joins),where:this.transformNode(e.where),updates:this.transformNodeList(e.updates),returning:this.transformNode(e.returning),with:this.transformNode(e.with),explain:this.transformNode(e.explain)}}transformColumnUpdate(e){return{kind:"ColumnUpdateNode",column:this.transformNode(e.column),value:this.transformNode(e.value)}}transformLimit(e){return{kind:"LimitNode",limit:this.transformNode(e.limit)}}transformOffset(e){return{kind:"OffsetNode",offset:this.transformNode(e.offset)}}transformOnConflict(e){return{kind:"OnConflictNode",columns:this.transformNodeList(e.columns),constraint:this.transformNode(e.constraint),indexExpression:this.transformNode(e.indexExpression),indexWhere:this.transformNode(e.indexWhere),updates:this.transformNodeList(e.updates),updateWhere:this.transformNode(e.updateWhere),doNothing:e.doNothing}}transformOnDuplicateKey(e){return{kind:"OnDuplicateKeyNode",updates:this.transformNodeList(e.updates)}}transformCreateIndex(e){return{kind:"CreateIndexNode",name:this.transformNode(e.name),table:this.transformNode(e.table),columns:this.transformNodeList(e.columns),unique:e.unique,using:this.transformNode(e.using),ifNotExists:e.ifNotExists,where:this.transformNode(e.where)}}transformList(e){return{kind:"ListNode",items:this.transformNodeList(e.items)}}transformDropIndex(e){return{kind:"DropIndexNode",name:this.transformNode(e.name),table:this.transformNode(e.table),ifExists:e.ifExists,cascade:e.cascade}}transformPrimaryKeyConstraint(e){return{kind:"PrimaryKeyConstraintNode",columns:this.transformNodeList(e.columns),name:this.transformNode(e.name)}}transformUniqueConstraint(e){return{kind:"UniqueConstraintNode",columns:this.transformNodeList(e.columns),name:this.transformNode(e.name)}}transformForeignKeyConstraint(e){return{kind:"ForeignKeyConstraintNode",columns:this.transformNodeList(e.columns),references:this.transformNode(e.references),name:this.transformNode(e.name),onDelete:e.onDelete,onUpdate:e.onUpdate}}transformSetOperation(e){return{kind:"SetOperationNode",operator:e.operator,expression:this.transformNode(e.expression),all:e.all}}transformReferences(e){return{kind:"ReferencesNode",table:this.transformNode(e.table),columns:this.transformNodeList(e.columns),onDelete:e.onDelete,onUpdate:e.onUpdate}}transformCheckConstraint(e){return{kind:"CheckConstraintNode",expression:this.transformNode(e.expression),name:this.transformNode(e.name)}}transformWith(e){return{kind:"WithNode",expressions:this.transformNodeList(e.expressions),recursive:e.recursive}}transformCommonTableExpression(e){return{kind:"CommonTableExpressionNode",name:this.transformNode(e.name),expression:this.transformNode(e.expression)}}transformCommonTableExpressionName(e){return{kind:"CommonTableExpressionNameNode",table:this.transformNode(e.table),columns:this.transformNodeList(e.columns)}}transformHaving(e){return{kind:"HavingNode",having:this.transformNode(e.having)}}transformCreateSchema(e){return{kind:"CreateSchemaNode",schema:this.transformNode(e.schema),ifNotExists:e.ifNotExists}}transformDropSchema(e){return{kind:"DropSchemaNode",schema:this.transformNode(e.schema),ifExists:e.ifExists,cascade:e.cascade}}transformAlterTable(e){return{kind:"AlterTableNode",table:this.transformNode(e.table),renameTo:this.transformNode(e.renameTo),setSchema:this.transformNode(e.setSchema),columnAlterations:this.transformNodeList(e.columnAlterations),addConstraint:this.transformNode(e.addConstraint),dropConstraint:this.transformNode(e.dropConstraint)}}transformDropColumn(e){return{kind:"DropColumnNode",column:this.transformNode(e.column)}}transformRenameColumn(e){return{kind:"RenameColumnNode",column:this.transformNode(e.column),renameTo:this.transformNode(e.renameTo)}}transformAlterColumn(e){return{kind:"AlterColumnNode",column:this.transformNode(e.column),dataType:this.transformNode(e.dataType),dataTypeExpression:this.transformNode(e.dataTypeExpression),setDefault:this.transformNode(e.setDefault),dropDefault:e.dropDefault,setNotNull:e.setNotNull,dropNotNull:e.dropNotNull}}transformModifyColumn(e){return{kind:"ModifyColumnNode",column:this.transformNode(e.column)}}transformAddConstraint(e){return{kind:"AddConstraintNode",constraint:this.transformNode(e.constraint)}}transformDropConstraint(e){return{kind:"DropConstraintNode",constraintName:this.transformNode(e.constraintName),ifExists:e.ifExists,modifier:e.modifier}}transformCreateView(e){return{kind:"CreateViewNode",name:this.transformNode(e.name),temporary:e.temporary,orReplace:e.orReplace,ifNotExists:e.ifNotExists,materialized:e.materialized,columns:this.transformNodeList(e.columns),as:this.transformNode(e.as)}}transformDropView(e){return{kind:"DropViewNode",name:this.transformNode(e.name),ifExists:e.ifExists,materialized:e.materialized,cascade:e.cascade}}transformGenerated(e){return{kind:"GeneratedNode",byDefault:e.byDefault,always:e.always,identity:e.identity,stored:e.stored,expression:this.transformNode(e.expression)}}transformDefaultValue(e){return{kind:"DefaultValueNode",defaultValue:this.transformNode(e.defaultValue)}}transformOn(e){return{kind:"OnNode",on:this.transformNode(e.on)}}transformSelectModifier(e){return{kind:"SelectModifierNode",modifier:e.modifier,rawModifier:this.transformNode(e.rawModifier)}}transformCreateType(e){return{kind:"CreateTypeNode",name:this.transformNode(e.name),enum:this.transformNode(e.enum)}}transformDropType(e){return{kind:"DropTypeNode",name:this.transformNode(e.name),ifExists:e.ifExists}}transformExplain(e){return{kind:"ExplainNode",format:e.format,options:this.transformNode(e.options)}}transformSchemableIdentifier(e){return{kind:"SchemableIdentifierNode",schema:this.transformNode(e.schema),identifier:this.transformNode(e.identifier)}}transformAggregateFunction(e){return{kind:"AggregateFunctionNode",aggregated:this.transformNodeList(e.aggregated),distinct:e.distinct,filter:this.transformNode(e.filter),func:e.func,over:this.transformNode(e.over)}}transformOver(e){return{kind:"OverNode",orderBy:this.transformNode(e.orderBy),partitionBy:this.transformNode(e.partitionBy)}}transformPartitionBy(e){return{kind:"PartitionByNode",items:this.transformNodeList(e.items)}}transformPartitionByItem(e){return{kind:"PartitionByItemNode",partitionBy:this.transformNode(e.partitionBy)}}transformBinaryOperation(e){return{kind:"BinaryOperationNode",leftOperand:this.transformNode(e.leftOperand),operator:this.transformNode(e.operator),rightOperand:this.transformNode(e.rightOperand)}}transformUnaryOperation(e){return{kind:"UnaryOperationNode",operator:this.transformNode(e.operator),operand:this.transformNode(e.operand)}}transformUsing(e){return{kind:"UsingNode",tables:this.transformNodeList(e.tables)}}transformFunction(e){return{kind:"FunctionNode",func:e.func,arguments:this.transformNodeList(e.arguments)}}transformCase(e){return{kind:"CaseNode",value:this.transformNode(e.value),when:this.transformNodeList(e.when),else:this.transformNode(e.else),isStatement:e.isStatement}}transformWhen(e){return{kind:"WhenNode",condition:this.transformNode(e.condition),result:this.transformNode(e.result)}}transformJSONReference(e){return{kind:"JSONReferenceNode",reference:this.transformNode(e.reference),traversal:this.transformNode(e.traversal)}}transformJSONPath(e){return{kind:"JSONPathNode",inOperator:this.transformNode(e.inOperator),pathLegs:this.transformNodeList(e.pathLegs)}}transformJSONPathLeg(e){return{kind:"JSONPathLegNode",type:e.type,value:e.value}}transformJSONOperatorChain(e){return{kind:"JSONOperatorChainNode",operator:this.transformNode(e.operator),values:this.transformNodeList(e.values)}}transformDataType(e){return e}transformSelectAll(e){return e}transformIdentifier(e){return e}transformValue(e){return e}transformPrimitiveValueList(e){return e}transformOperator(e){return e}transformDefaultInsertValue(e){return e}}cs=new WeakMap;const $l=h({AlterTableNode:!0,CreateIndexNode:!0,CreateSchemaNode:!0,CreateTableNode:!0,CreateTypeNode:!0,CreateViewNode:!0,DeleteQueryNode:!0,DropIndexNode:!0,DropSchemaNode:!0,DropTableNode:!0,DropTypeNode:!0,DropViewNode:!0,InsertQueryNode:!0,RawNode:!0,SelectQueryNode:!0,UpdateQueryNode:!0});class Kl extends $s{constructor(r){super();D(this,ds);D(this,fs);D(this,hs);D(this,Dn);D(this,ri);D(this,ps);D(this,cr,void 0);D(this,Fn,new Set);D(this,Ln,new Set);G(this,cr,r)}transformNodeImpl(r){if(!Oe(this,ds,$a).call(this,r))return super.transformNodeImpl(r);const n=Oe(this,hs,Xa).call(this,r);for(const Y of n)o(this,Ln).add(Y);const O=Oe(this,fs,Ka).call(this,r);for(const Y of O)o(this,Fn).add(Y);const j=super.transformNodeImpl(r);for(const Y of O)o(this,Fn).delete(Y);for(const Y of n)o(this,Ln).delete(Y);return j}transformSchemableIdentifier(r){const n=super.transformSchemableIdentifier(r);return n.schema||!o(this,Fn).has(r.identifier.name)?n:{...n,schema:Ue.create(o(this,cr))}}transformReferences(r){const n=super.transformReferences(r);return n.table.table.schema?n:{...n,table:_n.createWithSchema(o(this,cr),n.table.table.identifier.name)}}}cr=new WeakMap,Fn=new WeakMap,Ln=new WeakMap,ds=new WeakSet,$a=function(r){return r.kind in $l},fs=new WeakSet,Ka=function(r){const n=new Set;if("name"in r&&r.name&&hn.is(r.name)&&Oe(this,ri,No).call(this,r.name,n),"from"in r&&r.from)for(const O of r.from.froms)Oe(this,Dn,Ei).call(this,O,n);if("into"in r&&r.into&&Oe(this,Dn,Ei).call(this,r.into,n),"table"in r&&r.table&&Oe(this,Dn,Ei).call(this,r.table,n),"joins"in r&&r.joins)for(const O of r.joins)Oe(this,Dn,Ei).call(this,O.table,n);return n},hs=new WeakSet,Xa=function(r){const n=new Set;return"with"in r&&r.with&&Oe(this,ps,Ya).call(this,r.with,n),n},Dn=new WeakSet,Ei=function(r,n){const O=_n.is(r)?r:pn.is(r)&&_n.is(r.node)?r.node:null;O&&Oe(this,ri,No).call(this,O.table,n)},ri=new WeakSet,No=function(r,n){const O=r.identifier.name;!o(this,Fn).has(O)&&!o(this,Ln).has(O)&&n.add(O)},ps=new WeakSet,Ya=function(r,n){for(const O of r.expressions){const j=O.name.table.table.identifier.name;o(this,Ln).has(j)||n.add(j)}};class zr{constructor(e){D(this,ii,void 0);G(this,ii,new Kl(e))}transformQuery(e){return o(this,ii).transformNode(e.node)}async transformResult(e){return e.result}}ii=new WeakMap;const Rn=class Rn{constructor(e){D(this,De,void 0);G(this,De,h(e))}selectFrom(e){return new Vr({queryId:Fe(),executor:o(this,De).executor,queryNode:xe.create(Gr(e),o(this,De).withNode)})}insertInto(e){return new jr({queryId:Fe(),executor:o(this,De).executor,queryNode:Gt.create(qt(e),o(this,De).withNode)})}replaceInto(e){return new jr({queryId:Fe(),executor:o(this,De).executor,queryNode:Gt.create(qt(e),o(this,De).withNode,!0)})}deleteFrom(e){return new Ri({queryId:Fe(),executor:o(this,De).executor,queryNode:Qr.create(Gr(e),o(this,De).withNode)})}updateTable(e){return new Mi({queryId:Fe(),executor:o(this,De).executor,queryNode:Pi.create(Hr(e),o(this,De).withNode)})}with(e,r){const n=Zo(e,r);return new Rn({...o(this,De),withNode:o(this,De).withNode?Bi.cloneWithExpression(o(this,De).withNode,n):Bi.create(n)})}withRecursive(e,r){const n=Zo(e,r);return new Rn({...o(this,De),withNode:o(this,De).withNode?Bi.cloneWithExpression(o(this,De).withNode,n):Bi.create(n,{recursive:!0})})}withPlugin(e){return new Rn({...o(this,De),executor:o(this,De).executor.withPlugin(e)})}withoutPlugins(){return new Rn({...o(this,De),executor:o(this,De).executor.withoutPlugins()})}withSchema(e){return new Rn({...o(this,De),executor:o(this,De).executor.withPluginAtFront(new zr(e))})}};De=new WeakMap;let Ui=Rn;class ta{constructor(){D(this,si,void 0);D(this,dr,void 0);D(this,fr,void 0);ve(this,"resolve",e=>{o(this,dr)&&o(this,dr).call(this,e)});ve(this,"reject",e=>{o(this,fr)&&o(this,fr).call(this,e)});G(this,si,new Promise((e,r)=>{G(this,fr,r),G(this,dr,e)}))}get promise(){return o(this,si)}}si=new WeakMap,dr=new WeakMap,fr=new WeakMap;const na=new Set;function Xl(t){na.has(t)||(na.add(t),console.log(t))}const Yl=h([]);class ra{constructor(e=Yl){D(this,oi);D(this,Mn,void 0);G(this,Mn,e)}get plugins(){return o(this,Mn)}transformQuery(e,r){for(const n of o(this,Mn)){const O=n.transformQuery({node:e,queryId:r});if(O.kind===e.kind)e=O;else throw new Error(["KyselyPlugin.transformQuery must return a node","of the same kind that was given to it.",`The plugin was given a ${e.kind}`,`but it returned a ${O.kind}`].join(" "))}return e}async executeQuery(e,r){return await this.provideConnection(async n=>{const O=await n.executeQuery(e),j=await Oe(this,oi,vo).call(this,O,r);return Zl(O,j),j})}async*stream(e,r,n){const O=new ta,j=new ta;this.provideConnection(async he=>(O.resolve(he),await j.promise)).catch(he=>O.reject(he));const Y=await O.promise;try{for await(const he of Y.streamQuery(e,r))yield await Oe(this,oi,vo).call(this,he,n)}finally{j.resolve()}}}Mn=new WeakMap,oi=new WeakSet,vo=async function(e,r){for(const n of o(this,Mn))e=await n.transformResult({result:e,queryId:r});return e};function Zl(t,e){const{numAffectedRows:r}=t;r===void 0&&t.numUpdatedOrDeletedRows===void 0||r!==void 0&&e.numAffectedRows!==void 0||Xl("kysely:warning: outdated driver/plugin detected! QueryResult.numUpdatedOrDeletedRows is deprecated and will be removed in a future release.")}class nr extends ra{get adapter(){throw new Error("this query cannot be compiled to SQL")}compileQuery(){throw new Error("this query cannot be compiled to SQL")}provideConnection(){throw new Error("this query cannot be executed")}withConnectionProvider(){throw new Error("this query cannot have a connection provider")}withPlugin(e){return new nr([...this.plugins,e])}withPlugins(e){return new nr([...this.plugins,...e])}withPluginAtFront(e){return new nr([e,...this.plugins])}withoutPlugins(){return new nr([])}}const Ks=new nr;function eu(){return new Ui({executor:Ks})}function tu(t,e){return new Ti({joinNode:Lr.create(t,Hr(e))})}function nu(){return new Ci({overNode:Gs.create()})}function bt(t,e){if(e.length===3)return iu(t,e[0],e[1],e[2]);if(e.length===2)return ru(t,e[0],e[1]);throw new Error("not implemented")}function ru(t,e,r){return r(tu(t,e)).toOperationNode()}function iu(t,e,r,n){return Lr.createWithOn(t,Hr(e),on(r,"=",n))}const su=h({is(t){return t.kind==="OffsetNode"},create(t){return h({kind:"OffsetNode",offset:Rt.create(t)})}}),ou=h({is(t){return t.kind==="GroupByItemNode"},create(t){return h({kind:"GroupByItemNode",groupBy:t})}});function au(t){return t=Ct(t)?t(or()):t,Rr(t).map(ou.create)}const ia=h({is(t){return t.kind==="SetOperationNode"},create(t,e,r){return h({kind:"SetOperationNode",operator:t,expression:e,all:r})}});function rr(t,e,r){return ia.create(t,e.toOperationNode(),r)}const ae=class ae{constructor(e){D(this,U,void 0);G(this,U,h(e))}get expressionType(){}where(...e){return new ae({...o(this,U),queryNode:me.cloneWithWhere(o(this,U).queryNode,_t(e))})}whereRef(e,r,n){return new ae({...o(this,U),queryNode:me.cloneWithWhere(o(this,U).queryNode,on(e,r,n))})}having(...e){return new ae({...o(this,U),queryNode:xe.cloneWithHaving(o(this,U).queryNode,_t(e))})}havingRef(e,r,n){return new ae({...o(this,U),queryNode:xe.cloneWithHaving(o(this,U).queryNode,on(e,r,n))})}select(e){return new ae({...o(this,U),queryNode:xe.cloneWithSelections(o(this,U).queryNode,Br(e))})}distinctOn(e){return new ae({...o(this,U),queryNode:xe.cloneWithDistinctOn(o(this,U).queryNode,Rr(e))})}modifyFront(e){return new ae({...o(this,U),queryNode:xe.cloneWithFrontModifier(o(this,U).queryNode,nn.createWithExpression(e.toOperationNode()))})}modifyEnd(e){return new ae({...o(this,U),queryNode:xe.cloneWithEndModifier(o(this,U).queryNode,nn.createWithExpression(e.toOperationNode()))})}distinct(){return new ae({...o(this,U),queryNode:xe.cloneWithFrontModifier(o(this,U).queryNode,nn.create("Distinct"))})}forUpdate(){return new ae({...o(this,U),queryNode:xe.cloneWithEndModifier(o(this,U).queryNode,nn.create("ForUpdate"))})}forShare(){return new ae({...o(this,U),queryNode:xe.cloneWithEndModifier(o(this,U).queryNode,nn.create("ForShare"))})}forKeyShare(){return new ae({...o(this,U),queryNode:xe.cloneWithEndModifier(o(this,U).queryNode,nn.create("ForKeyShare"))})}forNoKeyUpdate(){return new ae({...o(this,U),queryNode:xe.cloneWithEndModifier(o(this,U).queryNode,nn.create("ForNoKeyUpdate"))})}skipLocked(){return new ae({...o(this,U),queryNode:xe.cloneWithEndModifier(o(this,U).queryNode,nn.create("SkipLocked"))})}noWait(){return new ae({...o(this,U),queryNode:xe.cloneWithEndModifier(o(this,U).queryNode,nn.create("NoWait"))})}selectAll(e){return new ae({...o(this,U),queryNode:xe.cloneWithSelections(o(this,U).queryNode,Ur(e))})}innerJoin(...e){return new ae({...o(this,U),queryNode:me.cloneWithJoin(o(this,U).queryNode,bt("InnerJoin",e))})}leftJoin(...e){return new ae({...o(this,U),queryNode:me.cloneWithJoin(o(this,U).queryNode,bt("LeftJoin",e))})}rightJoin(...e){return new ae({...o(this,U),queryNode:me.cloneWithJoin(o(this,U).queryNode,bt("RightJoin",e))})}fullJoin(...e){return new ae({...o(this,U),queryNode:me.cloneWithJoin(o(this,U).queryNode,bt("FullJoin",e))})}innerJoinLateral(...e){return new ae({...o(this,U),queryNode:me.cloneWithJoin(o(this,U).queryNode,bt("LateralInnerJoin",e))})}leftJoinLateral(...e){return new ae({...o(this,U),queryNode:me.cloneWithJoin(o(this,U).queryNode,bt("LateralLeftJoin",e))})}orderBy(e,r){return new ae({...o(this,U),queryNode:xe.cloneWithOrderByItem(o(this,U).queryNode,Ai(e,r))})}groupBy(e){return new ae({...o(this,U),queryNode:xe.cloneWithGroupByItems(o(this,U).queryNode,au(e))})}limit(e){return new ae({...o(this,U),queryNode:xe.cloneWithLimit(o(this,U).queryNode,Xo.create(e))})}offset(e){return new ae({...o(this,U),queryNode:xe.cloneWithOffset(o(this,U).queryNode,su.create(e))})}union(e){return new ae({...o(this,U),queryNode:xe.cloneWithSetOperation(o(this,U).queryNode,rr("union",e,!1))})}unionAll(e){return new ae({...o(this,U),queryNode:xe.cloneWithSetOperation(o(this,U).queryNode,rr("union",e,!0))})}intersect(e){return new ae({...o(this,U),queryNode:xe.cloneWithSetOperation(o(this,U).queryNode,rr("intersect",e,!1))})}intersectAll(e){return new ae({...o(this,U),queryNode:xe.cloneWithSetOperation(o(this,U).queryNode,rr("intersect",e,!0))})}except(e){return new ae({...o(this,U),queryNode:xe.cloneWithSetOperation(o(this,U).queryNode,rr("except",e,!1))})}exceptAll(e){return new ae({...o(this,U),queryNode:xe.cloneWithSetOperation(o(this,U).queryNode,rr("except",e,!0))})}as(e){return new lu(this,e)}clearSelect(){return new ae({...o(this,U),queryNode:xe.cloneWithoutSelections(o(this,U).queryNode)})}clearWhere(){return new ae({...o(this,U),queryNode:me.cloneWithoutWhere(o(this,U).queryNode)})}clearLimit(){return new ae({...o(this,U),queryNode:xe.cloneWithoutLimit(o(this,U).queryNode)})}clearOffset(){return new ae({...o(this,U),queryNode:xe.cloneWithoutOffset(o(this,U).queryNode)})}clearOrderBy(){return new ae({...o(this,U),queryNode:xe.cloneWithoutOrderBy(o(this,U).queryNode)})}$call(e){return e(this)}$if(e,r){return e?r(this):new ae({...o(this,U)})}$castTo(){return new ae(o(this,U))}$narrowType(){return new ae(o(this,U))}$assertType(){return new ae(o(this,U))}withPlugin(e){return new ae({...o(this,U),executor:o(this,U).executor.withPlugin(e)})}toOperationNode(){return o(this,U).executor.transformQuery(o(this,U).queryNode,o(this,U).queryId)}compile(){return o(this,U).executor.compileQuery(this.toOperationNode(),o(this,U).queryId)}async execute(){const e=this.compile();return(await o(this,U).executor.executeQuery(e,o(this,U).queryId)).rows}async executeTakeFirst(){const[e]=await this.execute();return e}async executeTakeFirstOrThrow(e=Wi){const r=await this.executeTakeFirst();if(r===void 0)throw Fi(e)?new e(this.toOperationNode()):e(this.toOperationNode());return r}async*stream(e=100){const r=this.compile(),n=o(this,U).executor.stream(r,e,o(this,U).queryId);for await(const O of n)yield*O.rows}async explain(e,r){return await new ae({...o(this,U),queryNode:me.cloneWithExplain(o(this,U).queryNode,e,r)}).execute()}};U=new WeakMap;let Vr=ae;Ee(Vr,"don't await SelectQueryBuilder instances directly. To execute the query you need to call `execute` or `executeTakeFirst`.");class lu{constructor(e,r){D(this,hr,void 0);D(this,pr,void 0);G(this,hr,e),G(this,pr,r)}get expression(){return o(this,hr)}get alias(){return o(this,pr)}toOperationNode(){return pn.create(o(this,hr).toOperationNode(),Ue.create(o(this,pr)))}}hr=new WeakMap,pr=new WeakMap;const ir=h({is(t){return t.kind==="ParensNode"},create(t){return h({kind:"ParensNode",node:t})}}),uo=class uo{constructor(e){D(this,bn,void 0);G(this,bn,e)}get expressionType(){}as(e){return new Xs(this,e)}or(...e){return new Ys(Cn.create(o(this,bn),_t(e)))}and(...e){return new Zs(Tn.create(o(this,bn),_t(e)))}$castTo(){return new uo(o(this,bn))}toOperationNode(){return o(this,bn)}};bn=new WeakMap;let Ge=uo;class Xs{constructor(e,r){D(this,_r,void 0);D(this,qn,void 0);G(this,_r,e),G(this,qn,r)}get expression(){return o(this,_r)}get alias(){return o(this,qn)}toOperationNode(){return pn.create(o(this,_r).toOperationNode(),Pt(o(this,qn))?o(this,qn).toOperationNode():Ue.create(o(this,qn)))}}_r=new WeakMap,qn=new WeakMap;const _s=class _s{constructor(e){D(this,Bn,void 0);G(this,Bn,e)}get expressionType(){}as(e){return new Xs(this,e)}or(...e){return new _s(Cn.create(o(this,Bn),_t(e)))}$castTo(){return new _s(o(this,Bn))}toOperationNode(){return ir.create(o(this,Bn))}};Bn=new WeakMap;let Ys=_s;const ms=class ms{constructor(e){D(this,Un,void 0);G(this,Un,e)}get expressionType(){}as(e){return new Xs(this,e)}and(...e){return new ms(Tn.create(o(this,Un),_t(e)))}$castTo(){return new ms(o(this,Un))}toOperationNode(){return ir.create(o(this,Un))}};Un=new WeakMap;let Zs=ms;const sr=h({is(t){return t.kind==="AggregateFunctionNode"},create(t,e=[]){return h({kind:"AggregateFunctionNode",func:t,aggregated:e})},cloneWithDistinct(t){return h({...t,distinct:!0})},cloneWithFilter(t,e){return h({...t,filter:t.filter?wt.cloneWithOperation(t.filter,"And",e):wt.create(e)})},cloneWithOrFilter(t,e){return h({...t,filter:t.filter?wt.cloneWithOperation(t.filter,"Or",e):wt.create(e)})},cloneWithOver(t,e){return h({...t,over:e})}}),uu=h({is(t){return t.kind==="FunctionNode"},create(t,e){return h({kind:"FunctionNode",func:t,arguments:e})}}),mr=class mr{constructor(e){D(this,Et,void 0);G(this,Et,h(e))}get expressionType(){}as(e){return new cu(this,e)}distinct(){return new mr({...o(this,Et),aggregateFunctionNode:sr.cloneWithDistinct(o(this,Et).aggregateFunctionNode)})}filterWhere(...e){return new mr({...o(this,Et),aggregateFunctionNode:sr.cloneWithFilter(o(this,Et).aggregateFunctionNode,_t(e))})}filterWhereRef(e,r,n){return new mr({...o(this,Et),aggregateFunctionNode:sr.cloneWithFilter(o(this,Et).aggregateFunctionNode,on(e,r,n))})}over(e){const r=nu();return new mr({...o(this,Et),aggregateFunctionNode:sr.cloneWithOver(o(this,Et).aggregateFunctionNode,(e?e(r):r).toOperationNode())})}$call(e){return e(this)}toOperationNode(){return o(this,Et).aggregateFunctionNode}};Et=new WeakMap;let Jr=mr;Ee(Jr,"don't await AggregateFunctionBuilder instances. They are never executed directly and are always just a part of a query.");class cu{constructor(e,r){D(this,yr,void 0);D(this,gr,void 0);G(this,yr,e),G(this,gr,r)}get expression(){return o(this,yr)}get alias(){return o(this,gr)}toOperationNode(){return pn.create(o(this,yr).toOperationNode(),Ue.create(o(this,gr)))}}yr=new WeakMap,gr=new WeakMap;function sa(){const t=(r,n)=>new Ge(uu.create(r,Rr(n))),e=(r,n)=>new Jr({aggregateFunctionNode:sr.create(r,n?Rr(n):void 0)});return Object.assign(t,{agg:e,avg(r){return e("avg",[r])},coalesce(r,...n){return t("coalesce",[r,...n])},count(r){return e("count",[r])},countAll(r){return new Jr({aggregateFunctionNode:sr.create("count",Ur(r))})},max(r){return e("max",[r])},min(r){return e("min",[r])},sum(r){return e("sum",[r])}})}const du=h({is(t){return t.kind==="UnaryOperationNode"},create(t,e){return h({kind:"UnaryOperationNode",operator:t,operand:e})}});function fu(t,e){return du.create(Dr.create(t),rn(e))}const eo=h({is(t){return t.kind==="WhenNode"},create(t){return h({kind:"WhenNode",condition:t})},cloneWithResult(t,e){return h({...t,result:e})}}),Ht=h({is(t){return t.kind==="CaseNode"},create(t){return h({kind:"CaseNode",value:t})},cloneWithWhen(t,e){return h({...t,when:h(t.when?[...t.when,e]:[e])})},cloneWithThen(t,e){return h({...t,when:t.when?h([...t.when.slice(0,-1),eo.cloneWithResult(t.when[t.when.length-1],e)]):void 0})},cloneWith(t,e){return h({...t,...e})}});class oa{constructor(e){D(this,wr,void 0);G(this,wr,h(e))}when(...e){return new aa({...o(this,wr),node:Ht.cloneWithWhen(o(this,wr).node,eo.create(_t(e)))})}}wr=new WeakMap;class aa{constructor(e){D(this,br,void 0);G(this,br,h(e))}then(e){return new hu({...o(this,br),node:Ht.cloneWithThen(o(this,br).node,sn(e))})}}br=new WeakMap;class hu{constructor(e){D(this,$t,void 0);G(this,$t,h(e))}when(...e){return new aa({...o(this,$t),node:Ht.cloneWithWhen(o(this,$t).node,eo.create(_t(e)))})}else(e){return new pu({...o(this,$t),node:Ht.cloneWith(o(this,$t).node,{else:sn(e)})})}end(){return new Ge(Ht.cloneWith(o(this,$t).node,{isStatement:!1}))}endCase(){return new Ge(Ht.cloneWith(o(this,$t).node,{isStatement:!0}))}}$t=new WeakMap;class pu{constructor(e){D(this,qr,void 0);G(this,qr,h(e))}end(){return new Ge(Ht.cloneWith(o(this,qr).node,{isStatement:!1}))}endCase(){return new Ge(Ht.cloneWith(o(this,qr).node,{isStatement:!0}))}}qr=new WeakMap;const _u=h({is(t){return t.kind==="JSONPathLegNode"},create(t,e){return h({kind:"JSONPathLegNode",type:t,value:e})}});class to{constructor(e){D(this,ai);D(this,Nn,void 0);G(this,Nn,e)}at(e){return Oe(this,ai,xo).call(this,"ArrayLocation",e)}key(e){return Oe(this,ai,xo).call(this,"Member",e)}}Nn=new WeakMap,ai=new WeakSet,xo=function(e,r){return new mu(Qs.cloneWithTraversal(o(this,Nn),js.is(o(this,Nn).traversal)?js.cloneWithLeg(o(this,Nn).traversal,_u.create(e,r)):Wo.cloneWithValue(o(this,Nn).traversal,Rt.createImmediate(r))))};class mu extends to{constructor(r){super(r);D(this,Nr,void 0);G(this,Nr,r)}get expressionType(){}as(r){return new yu(this,r)}$castTo(){return new to(o(this,Nr))}toOperationNode(){return o(this,Nr)}}Nr=new WeakMap;class yu{constructor(e,r){D(this,vr,void 0);D(this,vn,void 0);G(this,vr,e),G(this,vn,r)}get expression(){return o(this,vr)}get alias(){return o(this,vn)}toOperationNode(){return pn.create(o(this,vr).toOperationNode(),Pt(o(this,vn))?o(this,vn).toOperationNode():Ue.create(o(this,vn)))}}vr=new WeakMap,vn=new WeakMap;function no(t=Ks){function e(O,j,Y){return new Ge(Oi(O,j,Y))}function r(O,j){return new Ge(fu(O,j))}const n=Object.assign(e,{fn:void 0,eb:void 0,selectFrom(O){return new Vr({queryId:Fe(),executor:t,queryNode:xe.create(Gr(O))})},case(O){return new oa({node:Ht.create(Ie(O)?void 0:rn(O))})},ref(O,j){return Ie(j)?new Ge(Pn(O)):new to(gl(O,j))},val(O){return new Ge(Mo(O))},cmpr(O,j,Y){return new Ge(Oi(O,j,Y))},bxp(O,j,Y){return new Ge(Oi(O,j,Y))},unary:r,not(O){return r("not",O)},exists(O){return r("exists",O)},neg(O){return r("-",O)},and(O){if(O.length===0)return new Ge(Rt.createImmediate(!0));if(O.length===1)return new Ge(O[0].toOperationNode());let j=Tn.create(O[0].toOperationNode(),O[1].toOperationNode());for(let Y=2;Y<O.length;++Y)j=Tn.create(j,O[Y].toOperationNode());return new Ge(ir.create(j))},or(O){if(O.length===0)return new Ge(Rt.createImmediate(!1));if(O.length===1)return new Ge(O[0].toOperationNode());let j=Cn.create(O[0].toOperationNode(),O[1].toOperationNode());for(let Y=2;Y<O.length;++Y)j=Cn.create(j,O[Y].toOperationNode());return new Ge(ir.create(j))},parens(...O){const j=Bo(O);return ir.is(j)?new Ge(j):new Ge(ir.create(j))},withSchema(O){return no(t.withPluginAtFront(new zr(O)))}});return n.fn=sa(),n.eb=n,n}function or(t){return no()}function Qi(t){if(Pt(t))return t.toOperationNode();if(Ct(t))return t(or()).toOperationNode();throw new Error(`invalid expression: ${JSON.stringify(t)}`)}function la(t){if(Pt(t))return t.toOperationNode();if(Ct(t))return t(or()).toOperationNode();throw new Error(`invalid aliased expression: ${JSON.stringify(t)}`)}function ji(t){return Rs(t)||ll(t)||Ct(t)}function Gr(t){return Fr(t)?t.map(e=>Hr(e)):[Hr(t)]}function Hr(t){return ge(t)?gu(t):la(t)}function gu(t){const e=" as ";if(t.includes(e)){const[r,n]=t.split(e).map(ua);return pn.create(qt(r),Ue.create(n))}else return qt(t)}function qt(t){const e=".";if(t.includes(e)){const[r,n]=t.split(e).map(ua);return _n.createWithSchema(r,n)}else return _n.create(t)}function ua(t){return t.trim()}const ca=h({is(t){return t.kind==="AddColumnNode"},create(t){return h({kind:"AddColumnNode",column:t})}}),He=h({is(t){return t.kind==="ColumnDefinitionNode"},create(t,e){return h({kind:"ColumnDefinitionNode",column:Je.create(t),dataType:e})},cloneWithFrontModifier(t,e){return h({...t,frontModifiers:t.frontModifiers?h([...t.frontModifiers,e]):[e]})},cloneWithEndModifier(t,e){return h({...t,endModifiers:t.endModifiers?h([...t.endModifiers,e]):[e]})},cloneWith(t,e){return h({...t,...e})}}),da=h({is(t){return t.kind==="DropColumnNode"},create(t){return h({kind:"DropColumnNode",column:Je.create(t)})}}),fa=h({is(t){return t.kind==="RenameColumnNode"},create(t,e){return h({kind:"RenameColumnNode",column:Je.create(t),renameTo:Je.create(e)})}}),ro=h({is(t){return t.kind==="CheckConstraintNode"},create(t,e){return h({kind:"CheckConstraintNode",expression:t,name:e?Ue.create(e):void 0})}}),wu=["no action","restrict","cascade","set null","set default"],zi=h({is(t){return t.kind==="ReferencesNode"},create(t,e){return h({kind:"ReferencesNode",table:t,columns:h([...e])})},cloneWithOnDelete(t,e){return h({...t,onDelete:e})},cloneWithOnUpdate(t,e){return h({...t,onUpdate:e})}});function ha(t){return Pt(t)?t.toOperationNode():Rt.createImmediate(t)}const Vi=h({is(t){return t.kind==="GeneratedNode"},create(t){return h({kind:"GeneratedNode",...t})},createWithExpression(t){return h({kind:"GeneratedNode",always:!0,expression:t})},cloneWith(t,e){return h({...t,...e})}}),bu=h({is(t){return t.kind==="DefaultValueNode"},create(t){return h({kind:"DefaultValueNode",defaultValue:t})}});function Ji(t){if(wu.includes(t))return t;throw new Error(`invalid OnModifyForeignAction ${t}`)}const rt=class rt{constructor(e){D(this,Pe,void 0);G(this,Pe,e)}autoIncrement(){return new rt(He.cloneWith(o(this,Pe),{autoIncrement:!0}))}primaryKey(){return new rt(He.cloneWith(o(this,Pe),{primaryKey:!0}))}references(e){const r=Pn(e);if(!r.table||Us.is(r.column))throw new Error(`invalid call references('${e}'). The reference must have format table.column or schema.table.column`);return new rt(He.cloneWith(o(this,Pe),{references:zi.create(r.table,[r.column])}))}onDelete(e){if(!o(this,Pe).references)throw new Error("on delete constraint can only be added for foreign keys");return new rt(He.cloneWith(o(this,Pe),{references:zi.cloneWithOnDelete(o(this,Pe).references,Ji(e))}))}onUpdate(e){if(!o(this,Pe).references)throw new Error("on update constraint can only be added for foreign keys");return new rt(He.cloneWith(o(this,Pe),{references:zi.cloneWithOnUpdate(o(this,Pe).references,Ji(e))}))}unique(){return new rt(He.cloneWith(o(this,Pe),{unique:!0}))}notNull(){return new rt(He.cloneWith(o(this,Pe),{notNull:!0}))}unsigned(){return new rt(He.cloneWith(o(this,Pe),{unsigned:!0}))}defaultTo(e){return new rt(He.cloneWith(o(this,Pe),{defaultTo:bu.create(ha(e))}))}check(e){return new rt(He.cloneWith(o(this,Pe),{check:ro.create(e.toOperationNode())}))}generatedAlwaysAs(e){return new rt(He.cloneWith(o(this,Pe),{generated:Vi.createWithExpression(e.toOperationNode())}))}generatedAlwaysAsIdentity(){return new rt(He.cloneWith(o(this,Pe),{generated:Vi.create({identity:!0,always:!0})}))}generatedByDefaultAsIdentity(){return new rt(He.cloneWith(o(this,Pe),{generated:Vi.create({identity:!0,byDefault:!0})}))}stored(){if(!o(this,Pe).generated)throw new Error("stored() can only be called after generatedAlwaysAs");return new rt(He.cloneWith(o(this,Pe),{generated:Vi.cloneWith(o(this,Pe).generated,{stored:!0})}))}modifyFront(e){return new rt(He.cloneWithFrontModifier(o(this,Pe),e.toOperationNode()))}modifyEnd(e){return new rt(He.cloneWithEndModifier(o(this,Pe),e.toOperationNode()))}$call(e){return e(this)}toOperationNode(){return o(this,Pe)}};Pe=new WeakMap;let mn=rt;Ee(mn,"don't await ColumnDefinitionBuilder instances directly.");const pa=h({is(t){return t.kind==="ModifyColumnNode"},create(t){return h({kind:"ModifyColumnNode",column:t})}}),qu=h({is(t){return t.kind==="DataTypeNode"},create(t){return h({kind:"DataTypeNode",dataType:t})}});function ar(t){return Pt(t)?t.toOperationNode():qu.create(t)}const Gi=h({is(t){return t.kind==="ForeignKeyConstraintNode"},create(t,e,r,n){return h({kind:"ForeignKeyConstraintNode",columns:t,references:zi.create(e,r),name:n?Ue.create(n):void 0})},cloneWith(t,e){return h({...t,...e})}}),ys=class ys{constructor(e){D(this,Qn,void 0);G(this,Qn,e)}onDelete(e){return new ys(Gi.cloneWith(o(this,Qn),{onDelete:Ji(e)}))}onUpdate(e){return new ys(Gi.cloneWith(o(this,Qn),{onUpdate:Ji(e)}))}$call(e){return e(this)}toOperationNode(){return o(this,Qn)}};Qn=new WeakMap;let $r=ys;Ee($r,"don't await ForeignKeyConstraintBuilder instances directly.");const io=h({is(t){return t.kind==="AddConstraintNode"},create(t){return h({kind:"AddConstraintNode",constraint:t})}}),_a=h({is(t){return t.kind==="UniqueConstraintNode"},create(t,e){return h({kind:"UniqueConstraintNode",columns:h(t.map(Je.create)),name:e?Ue.create(e):void 0})}}),Hi=h({is(t){return t.kind==="DropConstraintNode"},create(t){return h({kind:"DropConstraintNode",constraintName:Ue.create(t)})},cloneWith(t,e){return h({...t,...e})}}),Kr=h({is(t){return t.kind==="AlterColumnNode"},create(t,e,r){return h({kind:"AlterColumnNode",column:Je.create(t),[e]:r})}});class so{constructor(e){D(this,ln,void 0);G(this,ln,e)}setDataType(e){return new Xr(Kr.create(o(this,ln),"dataType",ar(e)))}setDefault(e){return new Xr(Kr.create(o(this,ln),"setDefault",ha(e)))}dropDefault(){return new Xr(Kr.create(o(this,ln),"dropDefault",!0))}setNotNull(){return new Xr(Kr.create(o(this,ln),"setNotNull",!0))}dropNotNull(){return new Xr(Kr.create(o(this,ln),"dropNotNull",!0))}$call(e){return e(this)}}ln=new WeakMap;class Xr{constructor(e){D(this,li,void 0);G(this,li,e)}toOperationNode(){return o(this,li)}}li=new WeakMap;class Yr{constructor(e){D(this,Qt,void 0);G(this,Qt,h(e))}toOperationNode(){return o(this,Qt).executor.transformQuery(o(this,Qt).node,o(this,Qt).queryId)}compile(){return o(this,Qt).executor.compileQuery(this.toOperationNode(),o(this,Qt).queryId)}async execute(){await o(this,Qt).executor.executeQuery(this.compile(),o(this,Qt).queryId)}}Qt=new WeakMap,Ee(Yr,"don't await AlterTableExecutor instances directly. To execute the query you need to call `execute`");const gs=class gs{constructor(e){D(this,ht,void 0);G(this,ht,h(e))}onDelete(e){return new gs({...o(this,ht),constraintBuilder:o(this,ht).constraintBuilder.onDelete(e)})}onUpdate(e){return new gs({...o(this,ht),constraintBuilder:o(this,ht).constraintBuilder.onUpdate(e)})}$call(e){return e(this)}toOperationNode(){return o(this,ht).executor.transformQuery(Xe.cloneWithTableProps(o(this,ht).node,{addConstraint:io.create(o(this,ht).constraintBuilder.toOperationNode())}),o(this,ht).queryId)}compile(){return o(this,ht).executor.compileQuery(this.toOperationNode(),o(this,ht).queryId)}async execute(){await o(this,ht).executor.executeQuery(this.compile(),o(this,ht).queryId)}};ht=new WeakMap;let $i=gs;Ee($i,"don't await AlterTableAddForeignKeyConstraintBuilder instances directly. To execute the query you need to call `execute`");const ui=class ui{constructor(e){D(this,Ze,void 0);G(this,Ze,h(e))}ifExists(){return new ui({...o(this,Ze),node:Xe.cloneWithTableProps(o(this,Ze).node,{dropConstraint:Hi.cloneWith(o(this,Ze).node.dropConstraint,{ifExists:!0})})})}cascade(){return new ui({...o(this,Ze),node:Xe.cloneWithTableProps(o(this,Ze).node,{dropConstraint:Hi.cloneWith(o(this,Ze).node.dropConstraint,{modifier:"cascade"})})})}restrict(){return new ui({...o(this,Ze),node:Xe.cloneWithTableProps(o(this,Ze).node,{dropConstraint:Hi.cloneWith(o(this,Ze).node.dropConstraint,{modifier:"restrict"})})})}$call(e){return e(this)}toOperationNode(){return o(this,Ze).executor.transformQuery(o(this,Ze).node,o(this,Ze).queryId)}compile(){return o(this,Ze).executor.compileQuery(this.toOperationNode(),o(this,Ze).queryId)}async execute(){await o(this,Ze).executor.executeQuery(this.compile(),o(this,Ze).queryId)}};Ze=new WeakMap;let Ki=ui;Ee(Ki,"don't await AlterTableDropConstraintBuilder instances directly. To execute the query you need to call `execute`");class ma{constructor(e){D(this,Me,void 0);G(this,Me,h(e))}renameTo(e){return new Yr({...o(this,Me),node:Xe.cloneWithTableProps(o(this,Me).node,{renameTo:qt(e)})})}setSchema(e){return new Yr({...o(this,Me),node:Xe.cloneWithTableProps(o(this,Me).node,{setSchema:Ue.create(e)})})}alterColumn(e,r){const n=r(new so(e));return new yn({...o(this,Me),node:Xe.cloneWithColumnAlteration(o(this,Me).node,n.toOperationNode())})}dropColumn(e){return new yn({...o(this,Me),node:Xe.cloneWithColumnAlteration(o(this,Me).node,da.create(e))})}renameColumn(e,r){return new yn({...o(this,Me),node:Xe.cloneWithColumnAlteration(o(this,Me).node,fa.create(e,r))})}addColumn(e,r,n=er){const O=n(new mn(He.create(e,ar(r))));return new yn({...o(this,Me),node:Xe.cloneWithColumnAlteration(o(this,Me).node,ca.create(O.toOperationNode()))})}modifyColumn(e,r,n=er){const O=n(new mn(He.create(e,ar(r))));return new yn({...o(this,Me),node:Xe.cloneWithColumnAlteration(o(this,Me).node,pa.create(O.toOperationNode()))})}addUniqueConstraint(e,r){return new Yr({...o(this,Me),node:Xe.cloneWithTableProps(o(this,Me).node,{addConstraint:io.create(_a.create(r,e))})})}addCheckConstraint(e,r){return new Yr({...o(this,Me),node:Xe.cloneWithTableProps(o(this,Me).node,{addConstraint:io.create(ro.create(r.toOperationNode(),e))})})}addForeignKeyConstraint(e,r,n,O){return new $i({...o(this,Me),constraintBuilder:new $r(Gi.create(r.map(Je.create),qt(n),O.map(Je.create),e))})}dropConstraint(e){return new Ki({...o(this,Me),node:Xe.cloneWithTableProps(o(this,Me).node,{dropConstraint:Hi.create(e)})})}$call(e){return e(this)}}Me=new WeakMap;const jn=class jn{constructor(e){D(this,$e,void 0);G(this,$e,h(e))}alterColumn(e,r){const n=r(new so(e));return new jn({...o(this,$e),node:Xe.cloneWithColumnAlteration(o(this,$e).node,n.toOperationNode())})}dropColumn(e){return new jn({...o(this,$e),node:Xe.cloneWithColumnAlteration(o(this,$e).node,da.create(e))})}renameColumn(e,r){return new jn({...o(this,$e),node:Xe.cloneWithColumnAlteration(o(this,$e).node,fa.create(e,r))})}addColumn(e,r,n=er){const O=n(new mn(He.create(e,ar(r))));return new jn({...o(this,$e),node:Xe.cloneWithColumnAlteration(o(this,$e).node,ca.create(O.toOperationNode()))})}modifyColumn(e,r,n=er){const O=n(new mn(He.create(e,ar(r))));return new jn({...o(this,$e),node:Xe.cloneWithColumnAlteration(o(this,$e).node,pa.create(O.toOperationNode()))})}toOperationNode(){return o(this,$e).executor.transformQuery(o(this,$e).node,o(this,$e).queryId)}compile(){return o(this,$e).executor.compileQuery(this.toOperationNode(),o(this,$e).queryId)}async execute(){await o(this,$e).executor.executeQuery(this.compile(),o(this,$e).queryId)}};$e=new WeakMap;let yn=jn;Ee(ma,"don't await AlterTableBuilder instances"),Ee(so,"don't await AlterColumnBuilder instances"),Ee(yn,"don't await AlterTableColumnAlteringBuilder instances directly. To execute the query you need to call `execute`");class ya extends $s{transformValue(e){return{...super.transformValue(e),immediate:!0}}}const Kt=class Kt{constructor(e){D(this,We,void 0);G(this,We,h(e))}ifNotExists(){return new Kt({...o(this,We),node:fn.cloneWith(o(this,We).node,{ifNotExists:!0})})}unique(){return new Kt({...o(this,We),node:fn.cloneWith(o(this,We).node,{unique:!0})})}on(e){return new Kt({...o(this,We),node:fn.cloneWith(o(this,We).node,{table:qt(e)})})}column(e){return new Kt({...o(this,We),node:fn.cloneWithColumns(o(this,We).node,[Do(e)])})}columns(e){return new Kt({...o(this,We),node:fn.cloneWithColumns(o(this,We).node,e.map(Do))})}expression(e){return new Kt({...o(this,We),node:fn.cloneWithColumns(o(this,We).node,[e.toOperationNode()])})}using(e){return new Kt({...o(this,We),node:fn.cloneWith(o(this,We).node,{using:pt.createWithSql(e)})})}where(...e){const r=new ya;return new Kt({...o(this,We),node:me.cloneWithWhere(o(this,We).node,r.transformNode(_t(e)))})}$call(e){return e(this)}toOperationNode(){return o(this,We).executor.transformQuery(o(this,We).node,o(this,We).queryId)}compile(){return o(this,We).executor.compileQuery(this.toOperationNode(),o(this,We).queryId)}async execute(){await o(this,We).executor.executeQuery(this.compile(),o(this,We).queryId)}};We=new WeakMap;let Xi=Kt;Ee(Xi,"don't await CreateIndexBuilder instances directly. To execute the query you need to call `execute`");const co=class co{constructor(e){D(this,St,void 0);G(this,St,h(e))}ifNotExists(){return new co({...o(this,St),node:Oo.cloneWith(o(this,St).node,{ifNotExists:!0})})}$call(e){return e(this)}toOperationNode(){return o(this,St).executor.transformQuery(o(this,St).node,o(this,St).queryId)}compile(){return o(this,St).executor.compileQuery(this.toOperationNode(),o(this,St).queryId)}async execute(){await o(this,St).executor.executeQuery(this.compile(),o(this,St).queryId)}};St=new WeakMap;let Yi=co;Ee(Yi,"don't await CreateSchemaBuilder instances directly. To execute the query you need to call `execute`");const Nu=h({is(t){return t.kind==="PrimaryKeyConstraintNode"},create(t,e){return h({kind:"PrimaryKeyConstraintNode",columns:h(t.map(Je.create)),name:e?Ue.create(e):void 0})}});function vu(t){if(al.includes(t))return t;throw new Error(`invalid OnCommitAction ${t}`)}const Wt=class Wt{constructor(e){D(this,Se,void 0);G(this,Se,h(e))}temporary(){return new Wt({...o(this,Se),node:Dt.cloneWith(o(this,Se).node,{temporary:!0})})}onCommit(e){return new Wt({...o(this,Se),node:Dt.cloneWith(o(this,Se).node,{onCommit:vu(e)})})}ifNotExists(){return new Wt({...o(this,Se),node:Dt.cloneWith(o(this,Se).node,{ifNotExists:!0})})}addColumn(e,r,n=er){const O=n(new mn(He.create(e,ar(r))));return new Wt({...o(this,Se),node:Dt.cloneWithColumn(o(this,Se).node,O.toOperationNode())})}addPrimaryKeyConstraint(e,r){return new Wt({...o(this,Se),node:Dt.cloneWithConstraint(o(this,Se).node,Nu.create(r,e))})}addUniqueConstraint(e,r){return new Wt({...o(this,Se),node:Dt.cloneWithConstraint(o(this,Se).node,_a.create(r,e))})}addCheckConstraint(e,r){return new Wt({...o(this,Se),node:Dt.cloneWithConstraint(o(this,Se).node,ro.create(r.toOperationNode(),e))})}addForeignKeyConstraint(e,r,n,O,j=er){const Y=j(new $r(Gi.create(r.map(Je.create),qt(n),O.map(Je.create),e)));return new Wt({...o(this,Se),node:Dt.cloneWithConstraint(o(this,Se).node,Y.toOperationNode())})}modifyFront(e){return new Wt({...o(this,Se),node:Dt.cloneWithFrontModifier(o(this,Se).node,e.toOperationNode())})}modifyEnd(e){return new Wt({...o(this,Se),node:Dt.cloneWithEndModifier(o(this,Se).node,e.toOperationNode())})}$call(e){return e(this)}toOperationNode(){return o(this,Se).executor.transformQuery(o(this,Se).node,o(this,Se).queryId)}compile(){return o(this,Se).executor.compileQuery(this.toOperationNode(),o(this,Se).queryId)}async execute(){await o(this,Se).executor.executeQuery(this.compile(),o(this,Se).queryId)}};Se=new WeakMap;let Zi=Wt;Ee(Zi,"don't await CreateTableBuilder instances directly. To execute the query you need to call `execute`");const ci=class ci{constructor(e){D(this,at,void 0);G(this,at,h(e))}on(e){return new ci({...o(this,at),node:Si.cloneWith(o(this,at).node,{table:qt(e)})})}ifExists(){return new ci({...o(this,at),node:Si.cloneWith(o(this,at).node,{ifExists:!0})})}cascade(){return new ci({...o(this,at),node:Si.cloneWith(o(this,at).node,{cascade:!0})})}$call(e){return e(this)}toOperationNode(){return o(this,at).executor.transformQuery(o(this,at).node,o(this,at).queryId)}compile(){return o(this,at).executor.compileQuery(this.toOperationNode(),o(this,at).queryId)}async execute(){await o(this,at).executor.executeQuery(this.compile(),o(this,at).queryId)}};at=new WeakMap;let es=ci;Ee(es,"don't await DropIndexBuilder instances directly. To execute the query you need to call `execute`");const ws=class ws{constructor(e){D(this,mt,void 0);G(this,mt,h(e))}ifExists(){return new ws({...o(this,mt),node:Ls.cloneWith(o(this,mt).node,{ifExists:!0})})}cascade(){return new ws({...o(this,mt),node:Ls.cloneWith(o(this,mt).node,{cascade:!0})})}$call(e){return e(this)}toOperationNode(){return o(this,mt).executor.transformQuery(o(this,mt).node,o(this,mt).queryId)}compile(){return o(this,mt).executor.compileQuery(this.toOperationNode(),o(this,mt).queryId)}async execute(){await o(this,mt).executor.executeQuery(this.compile(),o(this,mt).queryId)}};mt=new WeakMap;let ts=ws;Ee(ts,"don't await DropSchemaBuilder instances directly. To execute the query you need to call `execute`");const bs=class bs{constructor(e){D(this,yt,void 0);G(this,yt,h(e))}ifExists(){return new bs({...o(this,yt),node:Ds.cloneWith(o(this,yt).node,{ifExists:!0})})}cascade(){return new bs({...o(this,yt),node:Ds.cloneWith(o(this,yt).node,{cascade:!0})})}$call(e){return e(this)}toOperationNode(){return o(this,yt).executor.transformQuery(o(this,yt).node,o(this,yt).queryId)}compile(){return o(this,yt).executor.compileQuery(this.toOperationNode(),o(this,yt).queryId)}async execute(){await o(this,yt).executor.executeQuery(this.compile(),o(this,yt).queryId)}};yt=new WeakMap;let ns=bs;Ee(ns,"don't await DropTableBuilder instances directly. To execute the query you need to call `execute`");const gn=h({is(t){return t.kind==="CreateViewNode"},create(t){return h({kind:"CreateViewNode",name:hn.create(t)})},cloneWith(t,e){return h({...t,...e})}});class xu{constructor(){D(this,qs,new ya)}transformQuery(e){return o(this,qs).transformNode(e.node)}transformResult(e){return Promise.resolve(e.result)}}qs=new WeakMap;const xn=class xn{constructor(e){D(this,Qe,void 0);G(this,Qe,h(e))}temporary(){return new xn({...o(this,Qe),node:gn.cloneWith(o(this,Qe).node,{temporary:!0})})}materialized(){return new xn({...o(this,Qe),node:gn.cloneWith(o(this,Qe).node,{materialized:!0})})}ifNotExists(){return new xn({...o(this,Qe),node:gn.cloneWith(o(this,Qe).node,{ifNotExists:!0})})}orReplace(){return new xn({...o(this,Qe),node:gn.cloneWith(o(this,Qe).node,{orReplace:!0})})}columns(e){return new xn({...o(this,Qe),node:gn.cloneWith(o(this,Qe).node,{columns:e.map(Lo)})})}as(e){const r=e.withPlugin(new xu).toOperationNode();return new xn({...o(this,Qe),node:gn.cloneWith(o(this,Qe).node,{as:r})})}$call(e){return e(this)}toOperationNode(){return o(this,Qe).executor.transformQuery(o(this,Qe).node,o(this,Qe).queryId)}compile(){return o(this,Qe).executor.compileQuery(this.toOperationNode(),o(this,Qe).queryId)}async execute(){await o(this,Qe).executor.executeQuery(this.compile(),o(this,Qe).queryId)}};Qe=new WeakMap;let rs=xn;Ee(rs,"don't await CreateViewBuilder instances directly. To execute the query you need to call `execute`");const is=h({is(t){return t.kind==="DropViewNode"},create(t){return h({kind:"DropViewNode",name:hn.create(t)})},cloneWith(t,e){return h({...t,...e})}}),di=class di{constructor(e){D(this,lt,void 0);G(this,lt,h(e))}materialized(){return new di({...o(this,lt),node:is.cloneWith(o(this,lt).node,{materialized:!0})})}ifExists(){return new di({...o(this,lt),node:is.cloneWith(o(this,lt).node,{ifExists:!0})})}cascade(){return new di({...o(this,lt),node:is.cloneWith(o(this,lt).node,{cascade:!0})})}$call(e){return e(this)}toOperationNode(){return o(this,lt).executor.transformQuery(o(this,lt).node,o(this,lt).queryId)}compile(){return o(this,lt).executor.compileQuery(this.toOperationNode(),o(this,lt).queryId)}async execute(){await o(this,lt).executor.executeQuery(this.compile(),o(this,lt).queryId)}};lt=new WeakMap;let ss=di;Ee(ss,"don't await DropViewBuilder instances directly. To execute the query you need to call `execute`");const ga=h({is(t){return t.kind==="CreateTypeNode"},create(t){return h({kind:"CreateTypeNode",name:t})},cloneWithEnum(t,e){return h({...t,enum:Vs.create(e.map(r=>Rt.createImmediate(r)))})}}),fo=class fo{constructor(e){D(this,kt,void 0);G(this,kt,h(e))}toOperationNode(){return o(this,kt).executor.transformQuery(o(this,kt).node,o(this,kt).queryId)}asEnum(e){return new fo({...o(this,kt),node:ga.cloneWithEnum(o(this,kt).node,e)})}$call(e){return e(this)}compile(){return o(this,kt).executor.compileQuery(this.toOperationNode(),o(this,kt).queryId)}async execute(){await o(this,kt).executor.executeQuery(this.compile(),o(this,kt).queryId)}};kt=new WeakMap;let os=fo;Ee(os,"don't await CreateTypeBuilder instances directly. To execute the query you need to call `execute`");const wa=h({is(t){return t.kind==="DropTypeNode"},create(t){return h({kind:"DropTypeNode",name:t})},cloneWith(t,e){return h({...t,...e})}}),ho=class ho{constructor(e){D(this,At,void 0);G(this,At,h(e))}ifExists(){return new ho({...o(this,At),node:wa.cloneWith(o(this,At).node,{ifExists:!0})})}$call(e){return e(this)}toOperationNode(){return o(this,At).executor.transformQuery(o(this,At).node,o(this,At).queryId)}compile(){return o(this,At).executor.compileQuery(this.toOperationNode(),o(this,At).queryId)}async execute(){await o(this,At).executor.executeQuery(this.compile(),o(this,At).queryId)}};At=new WeakMap;let as=ho;Ee(as,"don't await DropTypeBuilder instances directly. To execute the query you need to call `execute`");function ba(t){const e=".";if(t.includes(e)){const r=t.split(e).map(Eu);if(r.length===2)return hn.createWithSchema(r[0],r[1]);throw new Error(`invalid schemable identifier ${t}`)}else return hn.create(t)}function Eu(t){return t.trim()}const fi=class fi{constructor(e){D(this,it,void 0);G(this,it,e)}createTable(e){return new Zi({queryId:Fe(),executor:o(this,it),node:Dt.create(qt(e))})}dropTable(e){return new ns({queryId:Fe(),executor:o(this,it),node:Ds.create(qt(e))})}createIndex(e){return new Xi({queryId:Fe(),executor:o(this,it),node:fn.create(e)})}dropIndex(e){return new es({queryId:Fe(),executor:o(this,it),node:Si.create(e)})}createSchema(e){return new Yi({queryId:Fe(),executor:o(this,it),node:Oo.create(e)})}dropSchema(e){return new ts({queryId:Fe(),executor:o(this,it),node:Ls.create(e)})}alterTable(e){return new ma({queryId:Fe(),executor:o(this,it),node:Xe.create(qt(e))})}createView(e){return new rs({queryId:Fe(),executor:o(this,it),node:gn.create(e)})}dropView(e){return new ss({queryId:Fe(),executor:o(this,it),node:is.create(e)})}createType(e){return new os({queryId:Fe(),executor:o(this,it),node:ga.create(ba(e))})}dropType(e){return new as({queryId:Fe(),executor:o(this,it),node:wa.create(ba(e))})}withPlugin(e){return new fi(o(this,it).withPlugin(e))}withoutPlugins(){return new fi(o(this,it).withoutPlugins())}withSchema(e){return new fi(o(this,it).withPluginAtFront(new zr(e)))}};it=new WeakMap;let oo=fi;class Su{ref(e){return new Il(e)}}class ku{constructor(e){D(this,xr,void 0);G(this,xr,e)}async provideConnection(e){const r=await o(this,xr).acquireConnection();try{return await e(r)}finally{await o(this,xr).releaseConnection(r)}}}xr=new WeakMap;const zn=class zn extends ra{constructor(r,n,O,j=[]){super(j);D(this,Xt,void 0);D(this,Yt,void 0);D(this,un,void 0);G(this,Xt,r),G(this,Yt,n),G(this,un,O)}get adapter(){return o(this,Yt)}compileQuery(r){return o(this,Xt).compileQuery(r)}provideConnection(r){return o(this,un).provideConnection(r)}withPlugins(r){return new zn(o(this,Xt),o(this,Yt),o(this,un),[...this.plugins,...r])}withPlugin(r){return new zn(o(this,Xt),o(this,Yt),o(this,un),[...this.plugins,r])}withPluginAtFront(r){return new zn(o(this,Xt),o(this,Yt),o(this,un),[r,...this.plugins])}withConnectionProvider(r){return new zn(o(this,Xt),o(this,Yt),r,[...this.plugins])}withoutPlugins(){return new zn(o(this,Xt),o(this,Yt),o(this,un),[])}};Xt=new WeakMap,Yt=new WeakMap,un=new WeakMap;let ao=zn;function qa(){return typeof performance<"u"&&Ct(performance.now)?performance.now():Date.now()}class Au{constructor(e,r){D(this,Ns);D(this,vs);D(this,xs);D(this,Es);D(this,pi);D(this,jt,void 0);D(this,En,void 0);D(this,cn,void 0);D(this,Vn,void 0);D(this,hi,new WeakSet);G(this,jt,e),G(this,En,r)}async init(){o(this,cn)||G(this,cn,o(this,jt).init().catch(e=>(G(this,cn,void 0),Promise.reject(e)))),await o(this,cn)}async acquireConnection(){await this.init();const e=await o(this,jt).acquireConnection();return o(this,hi).has(e)||(Oe(this,Ns,Za).call(this)&&Oe(this,vs,el).call(this,e),o(this,hi).add(e)),e}async releaseConnection(e){await o(this,jt).releaseConnection(e)}beginTransaction(e,r){return o(this,jt).beginTransaction(e,r)}commitTransaction(e){return o(this,jt).commitTransaction(e)}rollbackTransaction(e){return o(this,jt).rollbackTransaction(e)}async destroy(){o(this,cn)&&(await o(this,cn),o(this,Vn)||G(this,Vn,o(this,jt).destroy().catch(e=>(G(this,Vn,void 0),Promise.reject(e)))),await o(this,Vn))}}jt=new WeakMap,En=new WeakMap,cn=new WeakMap,Vn=new WeakMap,hi=new WeakMap,Ns=new WeakSet,Za=function(){return o(this,En).isLevelEnabled("query")||o(this,En).isLevelEnabled("error")},vs=new WeakSet,el=function(e){const r=e.executeQuery;e.executeQuery=async n=>{const O=qa();try{return await r.call(e,n)}catch(j){throw await Oe(this,xs,tl).call(this,j,n,O),j}finally{await Oe(this,Es,nl).call(this,n,O)}}},xs=new WeakSet,tl=async function(e,r,n){await o(this,En).error(()=>({level:"error",error:e,query:r,queryDurationMillis:Oe(this,pi,Eo).call(this,n)}))},Es=new WeakSet,nl=async function(e,r){await o(this,En).query(()=>({level:"query",query:e,queryDurationMillis:Oe(this,pi,Eo).call(this,r)}))},pi=new WeakSet,Eo=function(e){return qa()-e};class Na{constructor(e){D(this,Ss);D(this,_i,void 0);D(this,Sn,void 0);G(this,_i,e)}async provideConnection(e){for(;o(this,Sn);)await o(this,Sn);const r=Oe(this,Ss,rl).call(this,e);return G(this,Sn,r.then(()=>{G(this,Sn,void 0)}).catch(()=>{G(this,Sn,void 0)})),r}}_i=new WeakMap,Sn=new WeakMap,Ss=new WeakSet,rl=async function(e){return await e(o(this,_i))};const Ou=["read uncommitted","read committed","repeatable read","serializable"];h(["query","error"]);class Iu{constructor(e){D(this,kn,void 0);D(this,Jn,void 0);Ct(e)?(G(this,Jn,e),G(this,kn,h({query:!0,error:!0}))):(G(this,Jn,Tu),G(this,kn,h({query:e.includes("query"),error:e.includes("error")})))}isLevelEnabled(e){return o(this,kn)[e]}async query(e){o(this,kn).query&&await o(this,Jn).call(this,e())}async error(e){o(this,kn).error&&await o(this,Jn).call(this,e())}}kn=new WeakMap,Jn=new WeakMap;function Tu(t){t.level==="query"?(console.log(`kysely:query: ${t.query.sql}`),console.log(`kysely:query: duration: ${t.queryDurationMillis.toFixed(1)}ms`)):t.level==="error"&&(t.error instanceof Error?console.error(`kysely:error: ${t.error.stack??t.error.message}`):console.error(`kysely:error: ${t}`))}function Cu(t){return Jt(t)&&Ct(t.compile)}const Er=class Er extends Ui{constructor(r){let n,O;if(Pu(r))n={executor:r.executor},O={...r};else{const j=r.dialect,Y=j.createDriver(),he=j.createQueryCompiler(),Te=j.createAdapter(),je=new Iu(r.log??[]),et=new Au(Y,je),ct=new ku(et),ke=new ao(he,Te,ct,r.plugins??[]);n={executor:ke},O={config:r,executor:ke,dialect:j,driver:et}}super(n);D(this,ut,void 0);G(this,ut,h(O))}get schema(){return new oo(o(this,ut).executor)}get dynamic(){return new Su}get introspection(){return o(this,ut).dialect.createIntrospector(this.withoutPlugins())}case(r){return new oa({node:Ht.create(Ie(r)?void 0:Qi(r))})}get fn(){return sa()}transaction(){return new ls({...o(this,ut)})}connection(){return new va({...o(this,ut)})}withPlugin(r){return new Er({...o(this,ut),executor:o(this,ut).executor.withPlugin(r)})}withoutPlugins(){return new Er({...o(this,ut),executor:o(this,ut).executor.withoutPlugins()})}withSchema(r){return new Er({...o(this,ut),executor:o(this,ut).executor.withPluginAtFront(new zr(r))})}withTables(){return new Er({...o(this,ut)})}async destroy(){await o(this,ut).driver.destroy()}get isTransaction(){return!1}getExecutor(){return o(this,ut).executor}executeQuery(r,n=Fe()){const O=Cu(r)?r.compile():r;return this.getExecutor().executeQuery(O,n)}};ut=new WeakMap;let Zr=Er;const Sr=class Sr extends Zr{constructor(r){super(r);D(this,zt,void 0);G(this,zt,r)}get isTransaction(){return!0}transaction(){throw new Error("calling the transaction method for a Transaction is not supported")}connection(){throw new Error("calling the connection method for a Transaction is not supported")}async destroy(){throw new Error("calling the destroy method for a Transaction is not supported")}withPlugin(r){return new Sr({...o(this,zt),executor:o(this,zt).executor.withPlugin(r)})}withoutPlugins(){return new Sr({...o(this,zt),executor:o(this,zt).executor.withoutPlugins()})}withSchema(r){return new Sr({...o(this,zt),executor:o(this,zt).executor.withPluginAtFront(new zr(r))})}withTables(){return new Sr({...o(this,zt)})}};zt=new WeakMap;let lo=Sr;function Pu(t){return Jt(t)&&Jt(t.config)&&Jt(t.driver)&&Jt(t.executor)&&Jt(t.dialect)}class va{constructor(e){D(this,Gn,void 0);G(this,Gn,h(e))}async execute(e){return o(this,Gn).executor.provideConnection(async r=>{const n=o(this,Gn).executor.withConnectionProvider(new Na(r)),O=new Zr({...o(this,Gn),executor:n});return await e(O)})}}Gn=new WeakMap,Ee(va,"don't await ConnectionBuilder instances directly. To execute the query you need to call the `execute` method");const po=class po{constructor(e){D(this,Vt,void 0);G(this,Vt,h(e))}setIsolationLevel(e){return new po({...o(this,Vt),isolationLevel:e})}async execute(e){const{isolationLevel:r,...n}=o(this,Vt),O={isolationLevel:r};return Wu(O),o(this,Vt).executor.provideConnection(async j=>{const Y=o(this,Vt).executor.withConnectionProvider(new Na(j)),he=new lo({...n,executor:Y});try{await o(this,Vt).driver.beginTransaction(j,O);const Te=await e(he);return await o(this,Vt).driver.commitTransaction(j),Te}catch(Te){throw await o(this,Vt).driver.rollbackTransaction(j),Te}})}};Vt=new WeakMap;let ls=po;Ee(ls,"don't await TransactionBuilder instances directly. To execute the transaction you need to call the `execute` method");function Wu(t){if(t.isolationLevel&&!Ou.includes(t.isolationLevel))throw new Error(`invalid transaction isolation level ${t.isolationLevel}`)}const ks=class ks{constructor(e){D(this,kr);D(this,mi);D(this,yi);D(this,Nt,void 0);G(this,Nt,h(e))}get expressionType(){}as(e){return new Fu(this,e)}$castTo(){return new ks({...o(this,Nt)})}castTo(){return this.$castTo()}withPlugin(e){return new ks({...o(this,Nt),plugins:o(this,Nt).plugins!==void 0?h([...o(this,Nt).plugins,e]):h([e])})}toOperationNode(){return Oe(this,mi,So).call(this,Oe(this,kr,Fs).call(this))}compile(e){return Oe(this,yi,ko).call(this,Oe(this,kr,Fs).call(this,e))}async execute(e){const r=Oe(this,kr,Fs).call(this,e);return r.executeQuery(Oe(this,yi,ko).call(this,r),o(this,Nt).queryId)}};Nt=new WeakMap,kr=new WeakSet,Fs=function(e){const r=e!==void 0?e.getExecutor():Ks;return o(this,Nt).plugins!==void 0?r.withPlugins(o(this,Nt).plugins):r},mi=new WeakSet,So=function(e){return e.transformQuery(o(this,Nt).rawNode,o(this,Nt).queryId)},yi=new WeakSet,ko=function(e){return e.compileQuery(Oe(this,mi,So).call(this,e),o(this,Nt).queryId)};let Mt=ks;Ee(Mt,"don't await RawBuilder instances directly. To execute the query you need to call `execute`");class Fu{constructor(e,r){D(this,Ar,void 0);D(this,An,void 0);G(this,Ar,e),G(this,An,r)}get expression(){return o(this,Ar)}get alias(){return o(this,An)}toOperationNode(){return pn.create(o(this,Ar).toOperationNode(),Pt(o(this,An))?o(this,An).toOperationNode():Ue.create(o(this,An)))}}Ar=new WeakMap,An=new WeakMap;const xt=Object.assign((t,...e)=>new Mt({queryId:Fe(),rawNode:pt.create(t,(e==null?void 0:e.map(sn))??[])}),{ref(t){return new Mt({queryId:Fe(),rawNode:pt.createWithChild(Pn(t))})},val(t){return new Mt({queryId:Fe(),rawNode:pt.createWithChild(sn(t))})},value(t){return this.val(t)},table(t){return new Mt({queryId:Fe(),rawNode:pt.createWithChild(qt(t))})},id(...t){const e=new Array(t.length+1).fill(".");return e[0]="",e[e.length-1]="",new Mt({queryId:Fe(),rawNode:pt.create(e,t.map(Ue.create))})},lit(t){return new Mt({queryId:Fe(),rawNode:pt.createWithChild(Rt.createImmediate(t))})},literal(t){return this.lit(t)},raw(t){return new Mt({queryId:Fe(),rawNode:pt.createWithSql(t)})},join(t,e=xt`, `){const r=new Array(2*t.length-1),n=e.toOperationNode();for(let O=0;O<t.length;++O)r[2*O]=sn(t[O]),O!==t.length-1&&(r[2*O+1]=n);return new Mt({queryId:Fe(),rawNode:pt.createWithChildren(r)})}});class Lu{constructor(){ve(this,"nodeStack",[]);D(this,As,h({AliasNode:this.visitAlias.bind(this),ColumnNode:this.visitColumn.bind(this),IdentifierNode:this.visitIdentifier.bind(this),SchemableIdentifierNode:this.visitSchemableIdentifier.bind(this),RawNode:this.visitRaw.bind(this),ReferenceNode:this.visitReference.bind(this),SelectQueryNode:this.visitSelectQuery.bind(this),SelectionNode:this.visitSelection.bind(this),TableNode:this.visitTable.bind(this),FromNode:this.visitFrom.bind(this),SelectAllNode:this.visitSelectAll.bind(this),AndNode:this.visitAnd.bind(this),OrNode:this.visitOr.bind(this),ValueNode:this.visitValue.bind(this),ValueListNode:this.visitValueList.bind(this),PrimitiveValueListNode:this.visitPrimitiveValueList.bind(this),ParensNode:this.visitParens.bind(this),JoinNode:this.visitJoin.bind(this),OperatorNode:this.visitOperator.bind(this),WhereNode:this.visitWhere.bind(this),InsertQueryNode:this.visitInsertQuery.bind(this),DeleteQueryNode:this.visitDeleteQuery.bind(this),ReturningNode:this.visitReturning.bind(this),CreateTableNode:this.visitCreateTable.bind(this),AddColumnNode:this.visitAddColumn.bind(this),ColumnDefinitionNode:this.visitColumnDefinition.bind(this),DropTableNode:this.visitDropTable.bind(this),DataTypeNode:this.visitDataType.bind(this),OrderByNode:this.visitOrderBy.bind(this),OrderByItemNode:this.visitOrderByItem.bind(this),GroupByNode:this.visitGroupBy.bind(this),GroupByItemNode:this.visitGroupByItem.bind(this),UpdateQueryNode:this.visitUpdateQuery.bind(this),ColumnUpdateNode:this.visitColumnUpdate.bind(this),LimitNode:this.visitLimit.bind(this),OffsetNode:this.visitOffset.bind(this),OnConflictNode:this.visitOnConflict.bind(this),OnDuplicateKeyNode:this.visitOnDuplicateKey.bind(this),CreateIndexNode:this.visitCreateIndex.bind(this),DropIndexNode:this.visitDropIndex.bind(this),ListNode:this.visitList.bind(this),PrimaryKeyConstraintNode:this.visitPrimaryKeyConstraint.bind(this),UniqueConstraintNode:this.visitUniqueConstraint.bind(this),ReferencesNode:this.visitReferences.bind(this),CheckConstraintNode:this.visitCheckConstraint.bind(this),WithNode:this.visitWith.bind(this),CommonTableExpressionNode:this.visitCommonTableExpression.bind(this),CommonTableExpressionNameNode:this.visitCommonTableExpressionName.bind(this),HavingNode:this.visitHaving.bind(this),CreateSchemaNode:this.visitCreateSchema.bind(this),DropSchemaNode:this.visitDropSchema.bind(this),AlterTableNode:this.visitAlterTable.bind(this),DropColumnNode:this.visitDropColumn.bind(this),RenameColumnNode:this.visitRenameColumn.bind(this),AlterColumnNode:this.visitAlterColumn.bind(this),ModifyColumnNode:this.visitModifyColumn.bind(this),AddConstraintNode:this.visitAddConstraint.bind(this),DropConstraintNode:this.visitDropConstraint.bind(this),ForeignKeyConstraintNode:this.visitForeignKeyConstraint.bind(this),CreateViewNode:this.visitCreateView.bind(this),DropViewNode:this.visitDropView.bind(this),GeneratedNode:this.visitGenerated.bind(this),DefaultValueNode:this.visitDefaultValue.bind(this),OnNode:this.visitOn.bind(this),ValuesNode:this.visitValues.bind(this),SelectModifierNode:this.visitSelectModifier.bind(this),CreateTypeNode:this.visitCreateType.bind(this),DropTypeNode:this.visitDropType.bind(this),ExplainNode:this.visitExplain.bind(this),DefaultInsertValueNode:this.visitDefaultInsertValue.bind(this),AggregateFunctionNode:this.visitAggregateFunction.bind(this),OverNode:this.visitOver.bind(this),PartitionByNode:this.visitPartitionBy.bind(this),PartitionByItemNode:this.visitPartitionByItem.bind(this),SetOperationNode:this.visitSetOperation.bind(this),BinaryOperationNode:this.visitBinaryOperation.bind(this),UnaryOperationNode:this.visitUnaryOperation.bind(this),UsingNode:this.visitUsing.bind(this),FunctionNode:this.visitFunction.bind(this),CaseNode:this.visitCase.bind(this),WhenNode:this.visitWhen.bind(this),JSONReferenceNode:this.visitJSONReference.bind(this),JSONPathNode:this.visitJSONPath.bind(this),JSONPathLegNode:this.visitJSONPathLeg.bind(this),JSONOperatorChainNode:this.visitJSONOperatorChain.bind(this)}));ve(this,"visitNode",e=>{this.nodeStack.push(e),o(this,As)[e.kind](e),this.nodeStack.pop()})}get parentNode(){return this.nodeStack[this.nodeStack.length-2]}}As=new WeakMap;class Du extends Lu{constructor(){super(...arguments);D(this,Or,"");D(this,Hn,[])}get numParameters(){return o(this,Hn).length}compileQuery(r){return G(this,Or,""),G(this,Hn,[]),this.visitNode(r),h({query:r,sql:this.getSql(),parameters:[...o(this,Hn)]})}getSql(){return o(this,Or)}visitSelectQuery(r){const n=this.parentNode!==void 0&&!Gt.is(this.parentNode)&&!gn.is(this.parentNode)&&!ia.is(this.parentNode);this.parentNode===void 0&&r.explain&&(this.visitNode(r.explain),this.append(" ")),n&&this.append("("),r.with&&(this.visitNode(r.with),this.append(" ")),this.append("select "),r.distinctOn&&(this.compileDistinctOn(r.distinctOn),this.append(" ")),r.frontModifiers&&r.frontModifiers.length>0&&(this.compileList(r.frontModifiers," "),this.append(" ")),r.selections&&(this.compileList(r.selections),this.append(" ")),this.visitNode(r.from),r.joins&&(this.append(" "),this.compileList(r.joins," ")),r.where&&(this.append(" "),this.visitNode(r.where)),r.groupBy&&(this.append(" "),this.visitNode(r.groupBy)),r.having&&(this.append(" "),this.visitNode(r.having)),r.setOperations&&(this.append(" "),this.compileList(r.setOperations," ")),r.orderBy&&(this.append(" "),this.visitNode(r.orderBy)),r.limit&&(this.append(" "),this.visitNode(r.limit)),r.offset&&(this.append(" "),this.visitNode(r.offset)),r.endModifiers&&r.endModifiers.length>0&&(this.append(" "),this.compileList(r.endModifiers," ")),n&&this.append(")")}visitFrom(r){this.append("from "),this.compileList(r.froms)}visitSelection(r){this.visitNode(r.selection)}visitColumn(r){this.visitNode(r.column)}compileDistinctOn(r){this.append("distinct on ("),this.compileList(r),this.append(")")}compileList(r,n=", "){const O=r.length-1;for(let j=0;j<=O;j++)this.visitNode(r[j]),j<O&&this.append(n)}visitWhere(r){this.append("where "),this.visitNode(r.where)}visitHaving(r){this.append("having "),this.visitNode(r.having)}visitInsertQuery(r){const n=this.nodeStack.find(me.is)!==r;!n&&r.explain&&(this.visitNode(r.explain),this.append(" ")),n&&this.append("("),r.with&&(this.visitNode(r.with),this.append(" ")),this.append(r.replace?"replace":"insert"),r.ignore&&this.append(" ignore"),this.append(" into "),this.visitNode(r.into),r.columns&&(this.append(" ("),this.compileList(r.columns),this.append(")")),r.values&&(this.append(" "),this.visitNode(r.values)),r.onConflict&&(this.append(" "),this.visitNode(r.onConflict)),r.onDuplicateKey&&(this.append(" "),this.visitNode(r.onDuplicateKey)),r.returning&&(this.append(" "),this.visitNode(r.returning)),n&&this.append(")")}visitValues(r){this.append("values "),this.compileList(r.values)}visitDeleteQuery(r){const n=this.nodeStack.find(me.is)!==r;!n&&r.explain&&(this.visitNode(r.explain),this.append(" ")),n&&this.append("("),r.with&&(this.visitNode(r.with),this.append(" ")),this.append("delete "),this.visitNode(r.from),r.using&&(this.append(" "),this.visitNode(r.using)),r.joins&&(this.append(" "),this.compileList(r.joins," ")),r.where&&(this.append(" "),this.visitNode(r.where)),r.orderBy&&(this.append(" "),this.visitNode(r.orderBy)),r.limit&&(this.append(" "),this.visitNode(r.limit)),r.returning&&(this.append(" "),this.visitNode(r.returning)),n&&this.append(")")}visitReturning(r){this.append("returning "),this.compileList(r.selections)}visitAlias(r){this.visitNode(r.node),this.append(" as "),this.visitNode(r.alias)}visitReference(r){r.table&&(this.visitNode(r.table),this.append(".")),this.visitNode(r.column)}visitSelectAll(r){this.append("*")}visitIdentifier(r){this.append(this.getLeftIdentifierWrapper()),this.compileUnwrappedIdentifier(r),this.append(this.getRightIdentifierWrapper())}compileUnwrappedIdentifier(r){if(!ge(r.name))throw new Error("a non-string identifier was passed to compileUnwrappedIdentifier.");this.append(this.sanitizeIdentifier(r.name))}visitAnd(r){this.visitNode(r.left),this.append(" and "),this.visitNode(r.right)}visitOr(r){this.visitNode(r.left),this.append(" or "),this.visitNode(r.right)}visitValue(r){r.immediate?this.appendImmediateValue(r.value):this.appendValue(r.value)}visitValueList(r){this.append("("),this.compileList(r.values),this.append(")")}visitPrimitiveValueList(r){this.append("(");const{values:n}=r;for(let O=0;O<n.length;++O)this.appendValue(n[O]),O!==n.length-1&&this.append(", ");this.append(")")}visitParens(r){this.append("("),this.visitNode(r.node),this.append(")")}visitJoin(r){this.append(Mu[r.joinType]),this.append(" "),this.visitNode(r.table),r.on&&(this.append(" "),this.visitNode(r.on))}visitOn(r){this.append("on "),this.visitNode(r.on)}visitRaw(r){const{sqlFragments:n,parameters:O}=r;for(let j=0;j<n.length;++j)this.append(n[j]),O.length>j&&this.visitNode(O[j])}visitOperator(r){this.append(r.operator)}visitTable(r){this.visitNode(r.table)}visitSchemableIdentifier(r){r.schema&&(this.visitNode(r.schema),this.append(".")),this.visitNode(r.identifier)}visitCreateTable(r){this.append("create "),r.frontModifiers&&r.frontModifiers.length>0&&(this.compileList(r.frontModifiers," "),this.append(" ")),r.temporary&&this.append("temporary "),this.append("table "),r.ifNotExists&&this.append("if not exists "),this.visitNode(r.table),this.append(" ("),this.compileList([...r.columns,...r.constraints??[]]),this.append(")"),r.onCommit&&(this.append(" on commit "),this.append(r.onCommit)),r.endModifiers&&r.endModifiers.length>0&&(this.append(" "),this.compileList(r.endModifiers," "))}visitColumnDefinition(r){this.visitNode(r.column),this.append(" "),this.visitNode(r.dataType),r.unsigned&&this.append(" unsigned"),r.frontModifiers&&r.frontModifiers.length>0&&(this.append(" "),this.compileList(r.frontModifiers," ")),r.generated&&(this.append(" "),this.visitNode(r.generated)),r.defaultTo&&(this.append(" "),this.visitNode(r.defaultTo)),r.notNull&&this.append(" not null"),r.unique&&this.append(" unique"),r.primaryKey&&this.append(" primary key"),r.autoIncrement&&(this.append(" "),this.append(this.getAutoIncrement())),r.references&&(this.append(" "),this.visitNode(r.references)),r.check&&(this.append(" "),this.visitNode(r.check)),r.endModifiers&&r.endModifiers.length>0&&(this.append(" "),this.compileList(r.endModifiers," "))}getAutoIncrement(){return"auto_increment"}visitReferences(r){this.append("references "),this.visitNode(r.table),this.append(" ("),this.compileList(r.columns),this.append(")"),r.onDelete&&(this.append(" on delete "),this.append(r.onDelete)),r.onUpdate&&(this.append(" on update "),this.append(r.onUpdate))}visitDropTable(r){this.append("drop table "),r.ifExists&&this.append("if exists "),this.visitNode(r.table),r.cascade&&this.append(" cascade")}visitDataType(r){this.append(r.dataType)}visitOrderBy(r){this.append("order by "),this.compileList(r.items)}visitOrderByItem(r){this.visitNode(r.orderBy),r.direction&&(this.append(" "),this.visitNode(r.direction))}visitGroupBy(r){this.append("group by "),this.compileList(r.items)}visitGroupByItem(r){this.visitNode(r.groupBy)}visitUpdateQuery(r){const n=this.nodeStack.find(me.is)!==r;!n&&r.explain&&(this.visitNode(r.explain),this.append(" ")),n&&this.append("("),r.with&&(this.visitNode(r.with),this.append(" ")),this.append("update "),this.visitNode(r.table),this.append(" set "),r.updates&&this.compileList(r.updates),r.from&&(this.append(" "),this.visitNode(r.from)),r.joins&&(this.append(" "),this.compileList(r.joins," ")),r.where&&(this.append(" "),this.visitNode(r.where)),r.returning&&(this.append(" "),this.visitNode(r.returning)),n&&this.append(")")}visitColumnUpdate(r){this.visitNode(r.column),this.append(" = "),this.visitNode(r.value)}visitLimit(r){this.append("limit "),this.visitNode(r.limit)}visitOffset(r){this.append("offset "),this.visitNode(r.offset)}visitOnConflict(r){this.append("on conflict"),r.columns?(this.append(" ("),this.compileList(r.columns),this.append(")")):r.constraint?(this.append(" on constraint "),this.visitNode(r.constraint)):r.indexExpression&&(this.append(" ("),this.visitNode(r.indexExpression),this.append(")")),r.indexWhere&&(this.append(" "),this.visitNode(r.indexWhere)),r.doNothing===!0?this.append(" do nothing"):r.updates&&(this.append(" do update set "),this.compileList(r.updates),r.updateWhere&&(this.append(" "),this.visitNode(r.updateWhere)))}visitOnDuplicateKey(r){this.append("on duplicate key update "),this.compileList(r.updates)}visitCreateIndex(r){this.append("create "),r.unique&&this.append("unique "),this.append("index "),r.ifNotExists&&this.append("if not exists "),this.visitNode(r.name),r.table&&(this.append(" on "),this.visitNode(r.table)),r.using&&(this.append(" using "),this.visitNode(r.using)),r.columns&&(this.append(" ("),this.compileList(r.columns),this.append(")")),r.where&&(this.append(" "),this.visitNode(r.where))}visitDropIndex(r){this.append("drop index "),r.ifExists&&this.append("if exists "),this.visitNode(r.name),r.table&&(this.append(" on "),this.visitNode(r.table)),r.cascade&&this.append(" cascade")}visitCreateSchema(r){this.append("create schema "),r.ifNotExists&&this.append("if not exists "),this.visitNode(r.schema)}visitDropSchema(r){this.append("drop schema "),r.ifExists&&this.append("if exists "),this.visitNode(r.schema),r.cascade&&this.append(" cascade")}visitPrimaryKeyConstraint(r){r.name&&(this.append("constraint "),this.visitNode(r.name),this.append(" ")),this.append("primary key ("),this.compileList(r.columns),this.append(")")}visitUniqueConstraint(r){r.name&&(this.append("constraint "),this.visitNode(r.name),this.append(" ")),this.append("unique ("),this.compileList(r.columns),this.append(")")}visitCheckConstraint(r){r.name&&(this.append("constraint "),this.visitNode(r.name),this.append(" ")),this.append("check ("),this.visitNode(r.expression),this.append(")")}visitForeignKeyConstraint(r){r.name&&(this.append("constraint "),this.visitNode(r.name),this.append(" ")),this.append("foreign key ("),this.compileList(r.columns),this.append(") "),this.visitNode(r.references),r.onDelete&&(this.append(" on delete "),this.append(r.onDelete)),r.onUpdate&&(this.append(" on update "),this.append(r.onUpdate))}visitList(r){this.compileList(r.items)}visitWith(r){this.append("with "),r.recursive&&this.append("recursive "),this.compileList(r.expressions)}visitCommonTableExpression(r){this.visitNode(r.name),this.append(" as "),this.visitNode(r.expression)}visitCommonTableExpressionName(r){this.visitNode(r.table),r.columns&&(this.append("("),this.compileList(r.columns),this.append(")"))}visitAlterTable(r){this.append("alter table "),this.visitNode(r.table),this.append(" "),r.renameTo&&(this.append("rename to "),this.visitNode(r.renameTo)),r.setSchema&&(this.append("set schema "),this.visitNode(r.setSchema)),r.addConstraint&&this.visitNode(r.addConstraint),r.dropConstraint&&this.visitNode(r.dropConstraint),r.columnAlterations&&this.compileList(r.columnAlterations)}visitAddColumn(r){this.append("add column "),this.visitNode(r.column)}visitRenameColumn(r){this.append("rename column "),this.visitNode(r.column),this.append(" to "),this.visitNode(r.renameTo)}visitDropColumn(r){this.append("drop column "),this.visitNode(r.column)}visitAlterColumn(r){this.append("alter column "),this.visitNode(r.column),this.append(" "),r.dataType&&(this.append("type "),this.visitNode(r.dataType),r.dataTypeExpression&&(this.append("using "),this.visitNode(r.dataTypeExpression))),r.setDefault&&(this.append("set default "),this.visitNode(r.setDefault)),r.dropDefault&&this.append("drop default"),r.setNotNull&&this.append("set not null"),r.dropNotNull&&this.append("drop not null")}visitModifyColumn(r){this.append("modify column "),this.visitNode(r.column)}visitAddConstraint(r){this.append("add "),this.visitNode(r.constraint)}visitDropConstraint(r){this.append("drop constraint "),r.ifExists&&this.append("if exists "),this.visitNode(r.constraintName),r.modifier==="cascade"?this.append(" cascade"):r.modifier==="restrict"&&this.append(" restrict")}visitSetOperation(r){this.append(r.operator),this.append(" "),r.all&&this.append("all "),this.visitNode(r.expression)}visitCreateView(r){this.append("create "),r.orReplace&&this.append("or replace "),r.materialized&&this.append("materialized "),r.temporary&&this.append("temporary "),this.append("view "),r.ifNotExists&&this.append("if not exists "),this.visitNode(r.name),this.append(" "),r.columns&&(this.append("("),this.compileList(r.columns),this.append(") ")),r.as&&(this.append("as "),this.visitNode(r.as))}visitDropView(r){this.append("drop "),r.materialized&&this.append("materialized "),this.append("view "),r.ifExists&&this.append("if exists "),this.visitNode(r.name),r.cascade&&this.append(" cascade")}visitGenerated(r){this.append("generated "),r.always&&this.append("always "),r.byDefault&&this.append("by default "),this.append("as "),r.identity&&this.append("identity"),r.expression&&(this.append("("),this.visitNode(r.expression),this.append(")")),r.stored&&this.append(" stored")}visitDefaultValue(r){this.append("default "),this.visitNode(r.defaultValue)}visitSelectModifier(r){r.rawModifier?this.visitNode(r.rawModifier):this.append(Ru[r.modifier])}visitCreateType(r){this.append("create type "),this.visitNode(r.name),r.enum&&(this.append(" as enum "),this.visitNode(r.enum))}visitDropType(r){this.append("drop type "),r.ifExists&&this.append("if exists "),this.visitNode(r.name)}visitExplain(r){this.append("explain"),(r.options||r.format)&&(this.append(" "),this.append(this.getLeftExplainOptionsWrapper()),r.options&&(this.visitNode(r.options),r.format&&this.append(this.getExplainOptionsDelimiter())),r.format&&(this.append("format"),this.append(this.getExplainOptionAssignment()),this.append(r.format)),this.append(this.getRightExplainOptionsWrapper()))}visitDefaultInsertValue(r){this.append("default")}visitAggregateFunction(r){this.append(r.func),this.append("("),r.distinct&&this.append("distinct "),this.compileList(r.aggregated),this.append(")"),r.filter&&(this.append(" filter("),this.visitNode(r.filter),this.append(")")),r.over&&(this.append(" "),this.visitNode(r.over))}visitOver(r){this.append("over("),r.partitionBy&&(this.visitNode(r.partitionBy),r.orderBy&&this.append(" ")),r.orderBy&&this.visitNode(r.orderBy),this.append(")")}visitPartitionBy(r){this.append("partition by "),this.compileList(r.items)}visitPartitionByItem(r){this.visitNode(r.partitionBy)}visitBinaryOperation(r){this.visitNode(r.leftOperand),this.append(" "),this.visitNode(r.operator),this.append(" "),this.visitNode(r.rightOperand)}visitUnaryOperation(r){this.visitNode(r.operator),this.isMinusOperator(r.operator)||this.append(" "),this.visitNode(r.operand)}isMinusOperator(r){return Dr.is(r)&&r.operator==="-"}visitUsing(r){this.append("using "),this.compileList(r.tables)}visitFunction(r){this.append(r.func),this.append("("),this.compileList(r.arguments),this.append(")")}visitCase(r){this.append("case"),r.value&&(this.append(" "),this.visitNode(r.value)),r.when&&(this.append(" "),this.compileList(r.when," ")),r.else&&(this.append(" else "),this.visitNode(r.else)),this.append(" end"),r.isStatement&&this.append(" case")}visitWhen(r){this.append("when "),this.visitNode(r.condition),r.result&&(this.append(" then "),this.visitNode(r.result))}visitJSONReference(r){this.visitNode(r.reference),this.visitNode(r.traversal)}visitJSONPath(r){r.inOperator&&this.visitNode(r.inOperator),this.append("'$");for(const n of r.pathLegs)this.visitNode(n);this.append("'")}visitJSONPathLeg(r){const n=r.type==="ArrayLocation";this.append(n?"[":"."),this.append(String(r.value)),n&&this.append("]")}visitJSONOperatorChain(r){for(let n=0,O=r.values.length;n<O;n++)n===O-1?this.visitNode(r.operator):this.append("->"),this.visitNode(r.values[n])}append(r){G(this,Or,o(this,Or)+r)}appendValue(r){this.addParameter(r),this.append(this.getCurrentParameterPlaceholder())}getLeftIdentifierWrapper(){return'"'}getRightIdentifierWrapper(){return'"'}getCurrentParameterPlaceholder(){return"$"+this.numParameters}getLeftExplainOptionsWrapper(){return"("}getExplainOptionAssignment(){return" "}getExplainOptionsDelimiter(){return", "}getRightExplainOptionsWrapper(){return")"}sanitizeIdentifier(r){const n=this.getLeftIdentifierWrapper(),O=this.getRightIdentifierWrapper();let j="";for(const Y of r)j+=Y,Y===n?j+=n:Y===O&&(j+=O);return j}addParameter(r){o(this,Hn).push(r)}appendImmediateValue(r){if(ge(r))this.append(`'${r}'`);else if(Ke(r)||Wr(r))this.append(r.toString());else if(Ao(r))this.append("null");else if(sl(r))this.appendImmediateValue(r.toISOString());else if(ol(r))this.appendImmediateValue(r.toString());else throw new Error(`invalid immediate value ${r}`)}}Or=new WeakMap,Hn=new WeakMap;const Ru=h({ForKeyShare:"for key share",ForNoKeyUpdate:"for no key update",ForUpdate:"for update",ForShare:"for share",NoWait:"nowait",SkipLocked:"skip locked",Distinct:"distinct"}),Mu=h({InnerJoin:"inner join",LeftJoin:"left join",RightJoin:"right join",FullJoin:"full join",LateralInnerJoin:"inner join lateral",LateralLeftJoin:"left join lateral"}),wn=h({raw(t,e=[]){return h({sql:t,query:pt.createWithSql(t),parameters:h(e)})}}),Bu=/"/g;class Uu extends Du{getCurrentParameterPlaceholder(){return"?"}getLeftExplainOptionsWrapper(){return""}getRightExplainOptionsWrapper(){return""}getLeftIdentifierWrapper(){return'"'}getRightIdentifierWrapper(){return'"'}getAutoIncrement(){return"autoincrement"}sanitizeIdentifier(e){return e.replace(Bu,'""')}visitDefaultInsertValue(e){this.append("null")}}const Qu="kysely_migration",ju="kysely_migration_lock";h({__noMigrations__:!0});class zu{constructor(e){D(this,Os);D(this,Ir,void 0);G(this,Ir,e)}async getSchemas(){return[]}async getTables(e={withInternalKyselyTables:!1}){let r=o(this,Ir).selectFrom("sqlite_master").where("type","in",["table","view"]).where("name","not like","sqlite_%").select("name").orderBy("name").$castTo();e.withInternalKyselyTables||(r=r.where("name","!=",Qu).where("name","!=",ju));const n=await r.execute();return Promise.all(n.map(({name:O})=>Oe(this,Os,il).call(this,O)))}async getMetadata(e){return{tables:await this.getTables(e)}}}Ir=new WeakMap,Os=new WeakSet,il=async function(e){var Y,he,Te,je,et,ct;const r=o(this,Ir),n=await r.selectFrom("sqlite_master").where("name","=",e).select(["sql","type"]).$castTo().executeTakeFirstOrThrow(),O=(ct=(et=(je=(Te=(he=(Y=n.sql)==null?void 0:Y.split(/[\(\),]/))==null?void 0:he.find(ke=>ke.toLowerCase().includes("autoincrement")))==null?void 0:Te.trimStart())==null?void 0:je.split(/\s+/))==null?void 0:et[0])==null?void 0:ct.replace(/["`]/g,""),j=await r.selectFrom(xt`pragma_table_info(${e})`.as("table_info")).select(["name","type","notnull","dflt_value"]).orderBy("cid").execute();return{name:e,isView:n.type==="view",columns:j.map(ke=>({name:ke.name,dataType:ke.type,isNullable:!ke.notnull,isAutoIncrementing:ke.name===O,hasDefaultValue:ke.dflt_value!=null}))}};class Vu{get supportsTransactionalDdl(){return!1}get supportsReturning(){return!0}async acquireMigrationLock(){}async releaseMigrationLock(){}}var Ju=class{createQueryCompiler(){return new Uu}createAdapter(){return new Vu}createIntrospector(t){return new zu(t)}},Gu=(ka=class{constructor(){D(this,gi,new Hu);ve(this,"connection")}async acquireConnection(){return await o(this,gi).lock(),this.connection}async beginTransaction(t){await t.executeQuery(wn.raw("begin"))}async commitTransaction(t){await t.executeQuery(wn.raw("commit"))}async rollbackTransaction(t){await t.executeQuery(wn.raw("rollback"))}async releaseConnection(){o(this,gi).unlock()}},gi=new WeakMap,ka),Hu=class{constructor(){ve(this,"promise");ve(this,"resolve")}async lock(){for(;this.promise;)await this.promise;this.promise=new Promise(t=>{this.resolve=t})}unlock(){const t=this.resolve;this.promise=void 0,this.resolve=void 0,t==null||t()}},$u=class{streamQuery(){throw new Error("Sqlite driver doesn't support streaming")}async executeQuery(t){const{parameters:e,sql:r,query:n}=t;return["SelectQueryNode","RawNode"].includes(n.kind)?{rows:await this.query(r,e)}:{rows:[],...await this.exec(r,e)}}},Ku=class extends Gu{constructor(e){super();ve(this,"config");ve(this,"db");this.config=e}async init(){var e,r;this.db=typeof this.config.database=="function"?await this.config.database():this.config.database,this.connection=new Xu(this.db),await((r=(e=this.config).onCreateConnection)==null?void 0:r.call(e,this.connection))}async destroy(){var e;(e=this.db)==null||e.close()}},Xu=class extends $u{constructor(e){super();ve(this,"db");this.db=e}query(e,r){const n=[];return this.db.exec({sql:e,bind:r??[],rowMode:"object",resultRows:n}),n}exec(e,r){return this.db.exec({sql:e,bind:r??[]}),{numAffectedRows:BigInt(this.db.changes(!1,!0)),insertId:BigInt(this.query("SELECT last_insert_rowid() as id")[0].id)}}},Yu=(Aa=class extends Ju{constructor(e){super();D(this,wi,void 0);G(this,wi,e)}createDriver(){return new Ku(o(this,wi))}},wi=new WeakMap,Aa);async function Zu(t,e=4096,r=32*1024){await t.executeQuery(wn.raw(`PRAGMA cache_size = ${e};`)),await t.executeQuery(wn.raw("PRAGMA journal_mode = WAL;")),await t.executeQuery(wn.raw("PRAGMA temp_store = MEMORY;")),await t.executeQuery(wn.raw(`PRAGMA page_size = ${r};`)),await t.executeQuery(wn.raw("PRAGMA synchronous = NORMAL;"))}var ec=(()=>{var t=self.location.href;return function(e){var r=e||{},n=typeof r<"u"?r:{},O,j;n.ready=new Promise(function(s,i){O=s,j=i});const Y=globalThis.sqlite3InitModuleState||Object.assign(Object.create(null),{debugModule:()=>{}});delete globalThis.sqlite3InitModuleState,Y.debugModule("globalThis.location =",globalThis.location);const he="emscripten-bug-17951";n[he]=function s(i,l){i.env.foo=function(){};const a=n.locateFile(s.uri,typeof ke>"u"?"":ke);Y.debugModule("instantiateWasm() uri =",a);const u=()=>fetch(a,{credentials:"same-origin"});return(WebAssembly.instantiateStreaming?async()=>WebAssembly.instantiateStreaming(u(),i).then(N=>l(N.instance,N.module)):async()=>u().then(N=>N.arrayBuffer()).then(N=>WebAssembly.instantiate(N,i)).then(N=>l(N.instance,N.module)))(),{}},n[he].uri="sqlite3.wasm";var Te=Object.assign({},n),je="./this.program",et=typeof window=="object",ct=typeof importScripts=="function";typeof process=="object"&&typeof process.versions=="object"&&process.versions.node;var ke="";function bi(s){return n.locateFile?n.locateFile(s,ke):ke+s}var $n,Tr,Be;(et||ct)&&(ct?ke=self.location.href:typeof document<"u"&&document.currentScript&&(ke=document.currentScript.src),t&&(ke=t),ke.indexOf("blob:")!==0?ke=ke.substr(0,ke.replace(/[?#].*/,"").lastIndexOf("/")+1):ke="",$n=s=>{var i=new XMLHttpRequest;return i.open("GET",s,!1),i.send(null),i.responseText},ct&&(Be=s=>{var i=new XMLHttpRequest;return i.open("GET",s,!1),i.responseType="arraybuffer",i.send(null),new Uint8Array(i.response)}),Tr=(s,i,l)=>{var a=new XMLHttpRequest;a.open("GET",s,!0),a.responseType="arraybuffer",a.onload=()=>{if(a.status==200||a.status==0&&a.response){i(a.response);return}l()},a.onerror=l,a.send(null)});var Ot=n.print||console.log.bind(console),It=n.printErr||console.warn.bind(console);Object.assign(n,Te),Te=null,n.arguments&&n.arguments,n.thisProgram&&(je=n.thisProgram),n.quit&&n.quit;var On;n.wasmBinary&&(On=n.wasmBinary),n.noExitRuntime,typeof WebAssembly!="object"&&Yn("no native wasm support detected");var Zt,Kn=!1;function In(s,i){s||Yn(i)}var Oa=typeof TextDecoder<"u"?new TextDecoder("utf8"):void 0;function Cr(s,i,l){for(var a=i+l,u=i;s[u]&&!(u>=a);)++u;if(u-i>16&&s.buffer&&Oa)return Oa.decode(s.subarray(i,u));for(var d="";i<u;){var N=s[i++];if(!(N&128)){d+=String.fromCharCode(N);continue}var S=s[i++]&63;if((N&224)==192){d+=String.fromCharCode((N&31)<<6|S);continue}var C=s[i++]&63;if((N&240)==224?N=(N&15)<<12|S<<6|C:N=(N&7)<<18|S<<12|C<<6|s[i++]&63,N<65536)d+=String.fromCharCode(N);else{var V=N-65536;d+=String.fromCharCode(55296|V>>10,56320|V&1023)}}return d}function yc(s,i){return s?Cr(Ni,s,i):""}function Is(s,i,l,a){if(!(a>0))return 0;for(var u=l,d=l+a-1,N=0;N<s.length;++N){var S=s.charCodeAt(N);if(S>=55296&&S<=57343){var C=s.charCodeAt(++N);S=65536+((S&1023)<<10)|C&1023}if(S<=127){if(l>=d)break;i[l++]=S}else if(S<=2047){if(l+1>=d)break;i[l++]=192|S>>6,i[l++]=128|S&63}else if(S<=65535){if(l+2>=d)break;i[l++]=224|S>>12,i[l++]=128|S>>6&63,i[l++]=128|S&63}else{if(l+3>=d)break;i[l++]=240|S>>18,i[l++]=128|S>>12&63,i[l++]=128|S>>6&63,i[l++]=128|S&63}}return i[l]=0,l-u}function Ia(s,i,l){return Is(s,Ni,i,l)}function qi(s){for(var i=0,l=0;l<s.length;++l){var a=s.charCodeAt(l);a<=127?i++:a<=2047?i+=2:a>=55296&&a<=57343?(i+=4,++l):i+=3}return i}var Tt,Ni,Ta,_e,tt;function Ca(){var s=Zt.buffer;n.HEAP8=Tt=new Int8Array(s),n.HEAP16=Ta=new Int16Array(s),n.HEAP32=_e=new Int32Array(s),n.HEAPU8=Ni=new Uint8Array(s),n.HEAPU16=new Uint16Array(s),n.HEAPU32=tt=new Uint32Array(s),n.HEAPF32=new Float32Array(s),n.HEAPF64=new Float64Array(s),n.HEAP64=new BigInt64Array(s),n.HEAPU64=new BigUint64Array(s)}var Pa=n.INITIAL_MEMORY||16777216;n.wasmMemory?Zt=n.wasmMemory:Zt=new WebAssembly.Memory({initial:Pa/65536,maximum:2147483648/65536}),Ca(),Pa=Zt.buffer.byteLength;var Wa=[],Fa=[],La=[];function gc(){if(n.preRun)for(typeof n.preRun=="function"&&(n.preRun=[n.preRun]);n.preRun.length;)qc(n.preRun.shift());mo(Wa)}function wc(){!n.noFSInit&&!c.init.initialized&&c.init(),c.ignorePermissions=!1,mo(Fa)}function bc(){if(n.postRun)for(typeof n.postRun=="function"&&(n.postRun=[n.postRun]);n.postRun.length;)vc(n.postRun.shift());mo(La)}function qc(s){Wa.unshift(s)}function Nc(s){Fa.unshift(s)}function vc(s){La.unshift(s)}var Xn=0,vi=null;function kd(s){return s}function _o(s){Xn++,n.monitorRunDependencies&&n.monitorRunDependencies(Xn)}function Ts(s){if(Xn--,n.monitorRunDependencies&&n.monitorRunDependencies(Xn),Xn==0&&vi){var i=vi;vi=null,i()}}function Yn(s){n.onAbort&&n.onAbort(s),s="Aborted("+s+")",It(s),Kn=!0,s+=". Build with -sASSERTIONS for more info.";var i=new WebAssembly.RuntimeError(s);throw j(i),i}var xc="data:application/octet-stream;base64,";function Da(s){return s.startsWith(xc)}var Ft;n.locateFile?(Ft="sqlite3.wasm",Da(Ft)||(Ft=bi(Ft))):Ft=new URL(""+new URL("sqlite3-14470338.wasm",self.location.href).href,self.location).href;function Ra(s){try{if(s==Ft&&On)return new Uint8Array(On);if(Be)return Be(s);throw"both async and sync fetching of the wasm failed"}catch(i){Yn(i)}}function Ec(){return!On&&(et||ct)&&typeof fetch=="function"?fetch(Ft,{credentials:"same-origin"}).then(function(s){if(!s.ok)throw"failed to load wasm binary file at '"+Ft+"'";return s.arrayBuffer()}).catch(function(){return Ra(Ft)}):Promise.resolve().then(function(){return Ra(Ft)})}function Sc(){var s={env:za,wasi_snapshot_preview1:za};function i(N,S){var C=N.exports;n.asm=C,n.asm.__indirect_function_table,Nc(n.asm.__wasm_call_ctors),Ts()}_o();function l(N){i(N.instance)}function a(N){return Ec().then(function(S){return WebAssembly.instantiate(S,s)}).then(function(S){return S}).then(N,function(S){It("failed to asynchronously prepare wasm: "+S),Yn(S)})}function u(){return!On&&typeof WebAssembly.instantiateStreaming=="function"&&!Da(Ft)&&typeof fetch=="function"?fetch(Ft,{credentials:"same-origin"}).then(function(N){var S=WebAssembly.instantiateStreaming(N,s);return S.then(l,function(C){return It("wasm streaming compile failed: "+C),It("falling back to ArrayBuffer instantiation"),a(l)})}):a(l)}if(n.instantiateWasm)try{var d=n.instantiateWasm(s,i);return d}catch(N){It("Module.instantiateWasm callback failed with error: "+N),j(N)}return u().catch(j),{}}var ye,st;function mo(s){for(;s.length>0;)s.shift()(n)}var Ne={isAbs:s=>s.charAt(0)==="/",splitPath:s=>{var i=/^(\/?|)([\s\S]*?)((?:\.{1,2}|[^\/]+?|)(\.[^.\/]*|))(?:[\/]*)$/;return i.exec(s).slice(1)},normalizeArray:(s,i)=>{for(var l=0,a=s.length-1;a>=0;a--){var u=s[a];u==="."?s.splice(a,1):u===".."?(s.splice(a,1),l++):l&&(s.splice(a,1),l--)}if(i)for(;l;l--)s.unshift("..");return s},normalize:s=>{var i=Ne.isAbs(s),l=s.substr(-1)==="/";return s=Ne.normalizeArray(s.split("/").filter(a=>!!a),!i).join("/"),!s&&!i&&(s="."),s&&l&&(s+="/"),(i?"/":"")+s},dirname:s=>{var i=Ne.splitPath(s),l=i[0],a=i[1];return!l&&!a?".":(a&&(a=a.substr(0,a.length-1)),l+a)},basename:s=>{if(s==="/")return"/";s=Ne.normalize(s),s=s.replace(/\/$/,"");var i=s.lastIndexOf("/");return i===-1?s:s.substr(i+1)},join:function(){var s=Array.prototype.slice.call(arguments);return Ne.normalize(s.join("/"))},join2:(s,i)=>Ne.normalize(s+"/"+i)};function kc(){if(typeof crypto=="object"&&typeof crypto.getRandomValues=="function"){var s=new Uint8Array(1);return()=>(crypto.getRandomValues(s),s[0])}else return()=>Yn("randomDevice")}var dn={resolve:function(){for(var s="",i=!1,l=arguments.length-1;l>=-1&&!i;l--){var a=l>=0?arguments[l]:c.cwd();if(typeof a!="string")throw new TypeError("Arguments to path.resolve must be strings");if(!a)return"";s=a+"/"+s,i=Ne.isAbs(a)}return s=Ne.normalizeArray(s.split("/").filter(u=>!!u),!i).join("/"),(i?"/":"")+s||"."},relative:(s,i)=>{s=dn.resolve(s).substr(1),i=dn.resolve(i).substr(1);function l(V){for(var K=0;K<V.length&&V[K]==="";K++);for(var te=V.length-1;te>=0&&V[te]==="";te--);return K>te?[]:V.slice(K,te-K+1)}for(var a=l(s.split("/")),u=l(i.split("/")),d=Math.min(a.length,u.length),N=d,S=0;S<d;S++)if(a[S]!==u[S]){N=S;break}for(var C=[],S=N;S<a.length;S++)C.push("..");return C=C.concat(u.slice(N)),C.join("/")}};function yo(s,i,l){var a=l>0?l:qi(s)+1,u=new Array(a),d=Is(s,u,0,u.length);return i&&(u.length=d),u}var Zn={ttys:[],init:function(){},shutdown:function(){},register:function(s,i){Zn.ttys[s]={input:[],output:[],ops:i},c.registerDevice(s,Zn.stream_ops)},stream_ops:{open:function(s){var i=Zn.ttys[s.node.rdev];if(!i)throw new c.ErrnoError(43);s.tty=i,s.seekable=!1},close:function(s){s.tty.ops.fsync(s.tty)},fsync:function(s){s.tty.ops.fsync(s.tty)},read:function(s,i,l,a,u){if(!s.tty||!s.tty.ops.get_char)throw new c.ErrnoError(60);for(var d=0,N=0;N<a;N++){var S;try{S=s.tty.ops.get_char(s.tty)}catch{throw new c.ErrnoError(29)}if(S===void 0&&d===0)throw new c.ErrnoError(6);if(S==null)break;d++,i[l+N]=S}return d&&(s.node.timestamp=Date.now()),d},write:function(s,i,l,a,u){if(!s.tty||!s.tty.ops.put_char)throw new c.ErrnoError(60);try{for(var d=0;d<a;d++)s.tty.ops.put_char(s.tty,i[l+d])}catch{throw new c.ErrnoError(29)}return a&&(s.node.timestamp=Date.now()),d}},default_tty_ops:{get_char:function(s){if(!s.input.length){var i=null;if(typeof window<"u"&&typeof window.prompt=="function"?(i=window.prompt("Input: "),i!==null&&(i+=`
`)):typeof readline=="function"&&(i=readline(),i!==null&&(i+=`
`)),!i)return null;s.input=yo(i,!0)}return s.input.shift()},put_char:function(s,i){i===null||i===10?(Ot(Cr(s.output,0)),s.output=[]):i!=0&&s.output.push(i)},fsync:function(s){s.output&&s.output.length>0&&(Ot(Cr(s.output,0)),s.output=[])}},default_tty1_ops:{put_char:function(s,i){i===null||i===10?(It(Cr(s.output,0)),s.output=[]):i!=0&&s.output.push(i)},fsync:function(s){s.output&&s.output.length>0&&(It(Cr(s.output,0)),s.output=[])}}};function Ma(s){Yn()}var de={ops_table:null,mount:function(s){return de.createNode(null,"/",16895,0)},createNode:function(s,i,l,a){if(c.isBlkdev(l)||c.isFIFO(l))throw new c.ErrnoError(63);de.ops_table||(de.ops_table={dir:{node:{getattr:de.node_ops.getattr,setattr:de.node_ops.setattr,lookup:de.node_ops.lookup,mknod:de.node_ops.mknod,rename:de.node_ops.rename,unlink:de.node_ops.unlink,rmdir:de.node_ops.rmdir,readdir:de.node_ops.readdir,symlink:de.node_ops.symlink},stream:{llseek:de.stream_ops.llseek}},file:{node:{getattr:de.node_ops.getattr,setattr:de.node_ops.setattr},stream:{llseek:de.stream_ops.llseek,read:de.stream_ops.read,write:de.stream_ops.write,allocate:de.stream_ops.allocate,mmap:de.stream_ops.mmap,msync:de.stream_ops.msync}},link:{node:{getattr:de.node_ops.getattr,setattr:de.node_ops.setattr,readlink:de.node_ops.readlink},stream:{}},chrdev:{node:{getattr:de.node_ops.getattr,setattr:de.node_ops.setattr},stream:c.chrdev_stream_ops}});var u=c.createNode(s,i,l,a);return c.isDir(u.mode)?(u.node_ops=de.ops_table.dir.node,u.stream_ops=de.ops_table.dir.stream,u.contents={}):c.isFile(u.mode)?(u.node_ops=de.ops_table.file.node,u.stream_ops=de.ops_table.file.stream,u.usedBytes=0,u.contents=null):c.isLink(u.mode)?(u.node_ops=de.ops_table.link.node,u.stream_ops=de.ops_table.link.stream):c.isChrdev(u.mode)&&(u.node_ops=de.ops_table.chrdev.node,u.stream_ops=de.ops_table.chrdev.stream),u.timestamp=Date.now(),s&&(s.contents[i]=u,s.timestamp=u.timestamp),u},getFileDataAsTypedArray:function(s){return s.contents?s.contents.subarray?s.contents.subarray(0,s.usedBytes):new Uint8Array(s.contents):new Uint8Array(0)},expandFileStorage:function(s,i){var l=s.contents?s.contents.length:0;if(!(l>=i)){var a=1024*1024;i=Math.max(i,l*(l<a?2:1.125)>>>0),l!=0&&(i=Math.max(i,256));var u=s.contents;s.contents=new Uint8Array(i),s.usedBytes>0&&s.contents.set(u.subarray(0,s.usedBytes),0)}},resizeFileStorage:function(s,i){if(s.usedBytes!=i)if(i==0)s.contents=null,s.usedBytes=0;else{var l=s.contents;s.contents=new Uint8Array(i),l&&s.contents.set(l.subarray(0,Math.min(i,s.usedBytes))),s.usedBytes=i}},node_ops:{getattr:function(s){var i={};return i.dev=c.isChrdev(s.mode)?s.id:1,i.ino=s.id,i.mode=s.mode,i.nlink=1,i.uid=0,i.gid=0,i.rdev=s.rdev,c.isDir(s.mode)?i.size=4096:c.isFile(s.mode)?i.size=s.usedBytes:c.isLink(s.mode)?i.size=s.link.length:i.size=0,i.atime=new Date(s.timestamp),i.mtime=new Date(s.timestamp),i.ctime=new Date(s.timestamp),i.blksize=4096,i.blocks=Math.ceil(i.size/i.blksize),i},setattr:function(s,i){i.mode!==void 0&&(s.mode=i.mode),i.timestamp!==void 0&&(s.timestamp=i.timestamp),i.size!==void 0&&de.resizeFileStorage(s,i.size)},lookup:function(s,i){throw c.genericErrors[44]},mknod:function(s,i,l,a){return de.createNode(s,i,l,a)},rename:function(s,i,l){if(c.isDir(s.mode)){var a;try{a=c.lookupNode(i,l)}catch{}if(a)for(var u in a.contents)throw new c.ErrnoError(55)}delete s.parent.contents[s.name],s.parent.timestamp=Date.now(),s.name=l,i.contents[l]=s,i.timestamp=s.parent.timestamp,s.parent=i},unlink:function(s,i){delete s.contents[i],s.timestamp=Date.now()},rmdir:function(s,i){var l=c.lookupNode(s,i);for(var a in l.contents)throw new c.ErrnoError(55);delete s.contents[i],s.timestamp=Date.now()},readdir:function(s){var i=[".",".."];for(var l in s.contents)s.contents.hasOwnProperty(l)&&i.push(l);return i},symlink:function(s,i,l){var a=de.createNode(s,i,41471,0);return a.link=l,a},readlink:function(s){if(!c.isLink(s.mode))throw new c.ErrnoError(28);return s.link}},stream_ops:{read:function(s,i,l,a,u){var d=s.node.contents;if(u>=s.node.usedBytes)return 0;var N=Math.min(s.node.usedBytes-u,a);if(N>8&&d.subarray)i.set(d.subarray(u,u+N),l);else for(var S=0;S<N;S++)i[l+S]=d[u+S];return N},write:function(s,i,l,a,u,d){if(i.buffer===Tt.buffer&&(d=!1),!a)return 0;var N=s.node;if(N.timestamp=Date.now(),i.subarray&&(!N.contents||N.contents.subarray)){if(d)return N.contents=i.subarray(l,l+a),N.usedBytes=a,a;if(N.usedBytes===0&&u===0)return N.contents=i.slice(l,l+a),N.usedBytes=a,a;if(u+a<=N.usedBytes)return N.contents.set(i.subarray(l,l+a),u),a}if(de.expandFileStorage(N,u+a),N.contents.subarray&&i.subarray)N.contents.set(i.subarray(l,l+a),u);else for(var S=0;S<a;S++)N.contents[u+S]=i[l+S];return N.usedBytes=Math.max(N.usedBytes,u+a),a},llseek:function(s,i,l){var a=i;if(l===1?a+=s.position:l===2&&c.isFile(s.node.mode)&&(a+=s.node.usedBytes),a<0)throw new c.ErrnoError(28);return a},allocate:function(s,i,l){de.expandFileStorage(s.node,i+l),s.node.usedBytes=Math.max(s.node.usedBytes,i+l)},mmap:function(s,i,l,a,u){if(!c.isFile(s.node.mode))throw new c.ErrnoError(43);var d,N,S=s.node.contents;if(!(u&2)&&S.buffer===Tt.buffer)N=!1,d=S.byteOffset;else{if((l>0||l+i<S.length)&&(S.subarray?S=S.subarray(l,l+i):S=Array.prototype.slice.call(S,l,l+i)),N=!0,d=Ma(),!d)throw new c.ErrnoError(48);Tt.set(S,d)}return{ptr:d,allocated:N}},msync:function(s,i,l,a,u){return de.stream_ops.write(s,i,0,a,l,!1),0}}};function Ac(s,i,l,a){var u=a?"":"al "+s;Tr(s,d=>{In(d,'Loading data file "'+s+'" failed (no arrayBuffer).'),i(new Uint8Array(d)),u&&Ts()},d=>{if(l)l();else throw'Loading data file "'+s+'" failed.'}),u&&_o()}var c={root:null,mounts:[],devices:{},streams:[],nextInode:1,nameTable:null,currentPath:"/",initialized:!1,ignorePermissions:!0,ErrnoError:null,genericErrors:{},filesystems:null,syncFSRequests:0,lookupPath:(s,i={})=>{if(s=dn.resolve(s),!s)return{path:"",node:null};var l={follow_mount:!0,recurse_count:0};if(i=Object.assign(l,i),i.recurse_count>8)throw new c.ErrnoError(32);for(var a=s.split("/").filter(te=>!!te),u=c.root,d="/",N=0;N<a.length;N++){var S=N===a.length-1;if(S&&i.parent)break;if(u=c.lookupNode(u,a[N]),d=Ne.join2(d,a[N]),c.isMountpoint(u)&&(!S||S&&i.follow_mount)&&(u=u.mounted.root),!S||i.follow)for(var C=0;c.isLink(u.mode);){var V=c.readlink(d);d=dn.resolve(Ne.dirname(d),V);var K=c.lookupPath(d,{recurse_count:i.recurse_count+1});if(u=K.node,C++>40)throw new c.ErrnoError(32)}}return{path:d,node:u}},getPath:s=>{for(var i;;){if(c.isRoot(s)){var l=s.mount.mountpoint;return i?l[l.length-1]!=="/"?l+"/"+i:l+i:l}i=i?s.name+"/"+i:s.name,s=s.parent}},hashName:(s,i)=>{for(var l=0,a=0;a<i.length;a++)l=(l<<5)-l+i.charCodeAt(a)|0;return(s+l>>>0)%c.nameTable.length},hashAddNode:s=>{var i=c.hashName(s.parent.id,s.name);s.name_next=c.nameTable[i],c.nameTable[i]=s},hashRemoveNode:s=>{var i=c.hashName(s.parent.id,s.name);if(c.nameTable[i]===s)c.nameTable[i]=s.name_next;else for(var l=c.nameTable[i];l;){if(l.name_next===s){l.name_next=s.name_next;break}l=l.name_next}},lookupNode:(s,i)=>{var l=c.mayLookup(s);if(l)throw new c.ErrnoError(l,s);for(var a=c.hashName(s.id,i),u=c.nameTable[a];u;u=u.name_next){var d=u.name;if(u.parent.id===s.id&&d===i)return u}return c.lookup(s,i)},createNode:(s,i,l,a)=>{var u=new c.FSNode(s,i,l,a);return c.hashAddNode(u),u},destroyNode:s=>{c.hashRemoveNode(s)},isRoot:s=>s===s.parent,isMountpoint:s=>!!s.mounted,isFile:s=>(s&61440)===32768,isDir:s=>(s&61440)===16384,isLink:s=>(s&61440)===40960,isChrdev:s=>(s&61440)===8192,isBlkdev:s=>(s&61440)===24576,isFIFO:s=>(s&61440)===4096,isSocket:s=>(s&49152)===49152,flagModes:{r:0,"r+":2,w:577,"w+":578,a:1089,"a+":1090},modeStringToFlags:s=>{var i=c.flagModes[s];if(typeof i>"u")throw new Error("Unknown file open mode: "+s);return i},flagsToPermissionString:s=>{var i=["r","w","rw"][s&3];return s&512&&(i+="w"),i},nodePermissions:(s,i)=>c.ignorePermissions?0:i.includes("r")&&!(s.mode&292)||i.includes("w")&&!(s.mode&146)||i.includes("x")&&!(s.mode&73)?2:0,mayLookup:s=>{var i=c.nodePermissions(s,"x");return i||(s.node_ops.lookup?0:2)},mayCreate:(s,i)=>{try{var l=c.lookupNode(s,i);return 20}catch{}return c.nodePermissions(s,"wx")},mayDelete:(s,i,l)=>{var a;try{a=c.lookupNode(s,i)}catch(d){return d.errno}var u=c.nodePermissions(s,"wx");if(u)return u;if(l){if(!c.isDir(a.mode))return 54;if(c.isRoot(a)||c.getPath(a)===c.cwd())return 10}else if(c.isDir(a.mode))return 31;return 0},mayOpen:(s,i)=>s?c.isLink(s.mode)?32:c.isDir(s.mode)&&(c.flagsToPermissionString(i)!=="r"||i&512)?31:c.nodePermissions(s,c.flagsToPermissionString(i)):44,MAX_OPEN_FDS:4096,nextfd:(s=0,i=c.MAX_OPEN_FDS)=>{for(var l=s;l<=i;l++)if(!c.streams[l])return l;throw new c.ErrnoError(33)},getStream:s=>c.streams[s],createStream:(s,i,l)=>{c.FSStream||(c.FSStream=function(){this.shared={}},c.FSStream.prototype={},Object.defineProperties(c.FSStream.prototype,{object:{get:function(){return this.node},set:function(u){this.node=u}},isRead:{get:function(){return(this.flags&2097155)!==1}},isWrite:{get:function(){return(this.flags&2097155)!==0}},isAppend:{get:function(){return this.flags&1024}},flags:{get:function(){return this.shared.flags},set:function(u){this.shared.flags=u}},position:{get:function(){return this.shared.position},set:function(u){this.shared.position=u}}})),s=Object.assign(new c.FSStream,s);var a=c.nextfd(i,l);return s.fd=a,c.streams[a]=s,s},closeStream:s=>{c.streams[s]=null},chrdev_stream_ops:{open:s=>{var i=c.getDevice(s.node.rdev);s.stream_ops=i.stream_ops,s.stream_ops.open&&s.stream_ops.open(s)},llseek:()=>{throw new c.ErrnoError(70)}},major:s=>s>>8,minor:s=>s&255,makedev:(s,i)=>s<<8|i,registerDevice:(s,i)=>{c.devices[s]={stream_ops:i}},getDevice:s=>c.devices[s],getMounts:s=>{for(var i=[],l=[s];l.length;){var a=l.pop();i.push(a),l.push.apply(l,a.mounts)}return i},syncfs:(s,i)=>{typeof s=="function"&&(i=s,s=!1),c.syncFSRequests++,c.syncFSRequests>1&&It("warning: "+c.syncFSRequests+" FS.syncfs operations in flight at once, probably just doing extra work");var l=c.getMounts(c.root.mount),a=0;function u(N){return c.syncFSRequests--,i(N)}function d(N){if(N)return d.errored?void 0:(d.errored=!0,u(N));++a>=l.length&&u(null)}l.forEach(N=>{if(!N.type.syncfs)return d(null);N.type.syncfs(N,s,d)})},mount:(s,i,l)=>{var a=l==="/",u=!l,d;if(a&&c.root)throw new c.ErrnoError(10);if(!a&&!u){var N=c.lookupPath(l,{follow_mount:!1});if(l=N.path,d=N.node,c.isMountpoint(d))throw new c.ErrnoError(10);if(!c.isDir(d.mode))throw new c.ErrnoError(54)}var S={type:s,opts:i,mountpoint:l,mounts:[]},C=s.mount(S);return C.mount=S,S.root=C,a?c.root=C:d&&(d.mounted=S,d.mount&&d.mount.mounts.push(S)),C},unmount:s=>{var i=c.lookupPath(s,{follow_mount:!1});if(!c.isMountpoint(i.node))throw new c.ErrnoError(28);var l=i.node,a=l.mounted,u=c.getMounts(a);Object.keys(c.nameTable).forEach(N=>{for(var S=c.nameTable[N];S;){var C=S.name_next;u.includes(S.mount)&&c.destroyNode(S),S=C}}),l.mounted=null;var d=l.mount.mounts.indexOf(a);l.mount.mounts.splice(d,1)},lookup:(s,i)=>s.node_ops.lookup(s,i),mknod:(s,i,l)=>{var a=c.lookupPath(s,{parent:!0}),u=a.node,d=Ne.basename(s);if(!d||d==="."||d==="..")throw new c.ErrnoError(28);var N=c.mayCreate(u,d);if(N)throw new c.ErrnoError(N);if(!u.node_ops.mknod)throw new c.ErrnoError(63);return u.node_ops.mknod(u,d,i,l)},create:(s,i)=>(i=i!==void 0?i:438,i&=4095,i|=32768,c.mknod(s,i,0)),mkdir:(s,i)=>(i=i!==void 0?i:511,i&=1023,i|=16384,c.mknod(s,i,0)),mkdirTree:(s,i)=>{for(var l=s.split("/"),a="",u=0;u<l.length;++u)if(l[u]){a+="/"+l[u];try{c.mkdir(a,i)}catch(d){if(d.errno!=20)throw d}}},mkdev:(s,i,l)=>(typeof l>"u"&&(l=i,i=438),i|=8192,c.mknod(s,i,l)),symlink:(s,i)=>{if(!dn.resolve(s))throw new c.ErrnoError(44);var l=c.lookupPath(i,{parent:!0}),a=l.node;if(!a)throw new c.ErrnoError(44);var u=Ne.basename(i),d=c.mayCreate(a,u);if(d)throw new c.ErrnoError(d);if(!a.node_ops.symlink)throw new c.ErrnoError(63);return a.node_ops.symlink(a,u,s)},rename:(s,i)=>{var l=Ne.dirname(s),a=Ne.dirname(i),u=Ne.basename(s),d=Ne.basename(i),N,S,C;if(N=c.lookupPath(s,{parent:!0}),S=N.node,N=c.lookupPath(i,{parent:!0}),C=N.node,!S||!C)throw new c.ErrnoError(44);if(S.mount!==C.mount)throw new c.ErrnoError(75);var V=c.lookupNode(S,u),K=dn.relative(s,a);if(K.charAt(0)!==".")throw new c.ErrnoError(28);if(K=dn.relative(i,l),K.charAt(0)!==".")throw new c.ErrnoError(55);var te;try{te=c.lookupNode(C,d)}catch{}if(V!==te){var k=c.isDir(V.mode),m=c.mayDelete(S,u,k);if(m)throw new c.ErrnoError(m);if(m=te?c.mayDelete(C,d,k):c.mayCreate(C,d),m)throw new c.ErrnoError(m);if(!S.node_ops.rename)throw new c.ErrnoError(63);if(c.isMountpoint(V)||te&&c.isMountpoint(te))throw new c.ErrnoError(10);if(C!==S&&(m=c.nodePermissions(S,"w"),m))throw new c.ErrnoError(m);c.hashRemoveNode(V);try{S.node_ops.rename(V,C,d)}catch(y){throw y}finally{c.hashAddNode(V)}}},rmdir:s=>{var i=c.lookupPath(s,{parent:!0}),l=i.node,a=Ne.basename(s),u=c.lookupNode(l,a),d=c.mayDelete(l,a,!0);if(d)throw new c.ErrnoError(d);if(!l.node_ops.rmdir)throw new c.ErrnoError(63);if(c.isMountpoint(u))throw new c.ErrnoError(10);l.node_ops.rmdir(l,a),c.destroyNode(u)},readdir:s=>{var i=c.lookupPath(s,{follow:!0}),l=i.node;if(!l.node_ops.readdir)throw new c.ErrnoError(54);return l.node_ops.readdir(l)},unlink:s=>{var i=c.lookupPath(s,{parent:!0}),l=i.node;if(!l)throw new c.ErrnoError(44);var a=Ne.basename(s),u=c.lookupNode(l,a),d=c.mayDelete(l,a,!1);if(d)throw new c.ErrnoError(d);if(!l.node_ops.unlink)throw new c.ErrnoError(63);if(c.isMountpoint(u))throw new c.ErrnoError(10);l.node_ops.unlink(l,a),c.destroyNode(u)},readlink:s=>{var i=c.lookupPath(s),l=i.node;if(!l)throw new c.ErrnoError(44);if(!l.node_ops.readlink)throw new c.ErrnoError(28);return dn.resolve(c.getPath(l.parent),l.node_ops.readlink(l))},stat:(s,i)=>{var l=c.lookupPath(s,{follow:!i}),a=l.node;if(!a)throw new c.ErrnoError(44);if(!a.node_ops.getattr)throw new c.ErrnoError(63);return a.node_ops.getattr(a)},lstat:s=>c.stat(s,!0),chmod:(s,i,l)=>{var a;if(typeof s=="string"){var u=c.lookupPath(s,{follow:!l});a=u.node}else a=s;if(!a.node_ops.setattr)throw new c.ErrnoError(63);a.node_ops.setattr(a,{mode:i&4095|a.mode&-4096,timestamp:Date.now()})},lchmod:(s,i)=>{c.chmod(s,i,!0)},fchmod:(s,i)=>{var l=c.getStream(s);if(!l)throw new c.ErrnoError(8);c.chmod(l.node,i)},chown:(s,i,l,a)=>{var u;if(typeof s=="string"){var d=c.lookupPath(s,{follow:!a});u=d.node}else u=s;if(!u.node_ops.setattr)throw new c.ErrnoError(63);u.node_ops.setattr(u,{timestamp:Date.now()})},lchown:(s,i,l)=>{c.chown(s,i,l,!0)},fchown:(s,i,l)=>{var a=c.getStream(s);if(!a)throw new c.ErrnoError(8);c.chown(a.node,i,l)},truncate:(s,i)=>{if(i<0)throw new c.ErrnoError(28);var l;if(typeof s=="string"){var a=c.lookupPath(s,{follow:!0});l=a.node}else l=s;if(!l.node_ops.setattr)throw new c.ErrnoError(63);if(c.isDir(l.mode))throw new c.ErrnoError(31);if(!c.isFile(l.mode))throw new c.ErrnoError(28);var u=c.nodePermissions(l,"w");if(u)throw new c.ErrnoError(u);l.node_ops.setattr(l,{size:i,timestamp:Date.now()})},ftruncate:(s,i)=>{var l=c.getStream(s);if(!l)throw new c.ErrnoError(8);if(!(l.flags&2097155))throw new c.ErrnoError(28);c.truncate(l.node,i)},utime:(s,i,l)=>{var a=c.lookupPath(s,{follow:!0}),u=a.node;u.node_ops.setattr(u,{timestamp:Math.max(i,l)})},open:(s,i,l)=>{if(s==="")throw new c.ErrnoError(44);i=typeof i=="string"?c.modeStringToFlags(i):i,l=typeof l>"u"?438:l,i&64?l=l&4095|32768:l=0;var a;if(typeof s=="object")a=s;else{s=Ne.normalize(s);try{var u=c.lookupPath(s,{follow:!(i&131072)});a=u.node}catch{}}var d=!1;if(i&64)if(a){if(i&128)throw new c.ErrnoError(20)}else a=c.mknod(s,l,0),d=!0;if(!a)throw new c.ErrnoError(44);if(c.isChrdev(a.mode)&&(i&=-513),i&65536&&!c.isDir(a.mode))throw new c.ErrnoError(54);if(!d){var N=c.mayOpen(a,i);if(N)throw new c.ErrnoError(N)}i&512&&!d&&c.truncate(a,0),i&=-131713;var S=c.createStream({node:a,path:c.getPath(a),flags:i,seekable:!0,position:0,stream_ops:a.stream_ops,ungotten:[],error:!1});return S.stream_ops.open&&S.stream_ops.open(S),n.logReadFiles&&!(i&1)&&(c.readFiles||(c.readFiles={}),s in c.readFiles||(c.readFiles[s]=1)),S},close:s=>{if(c.isClosed(s))throw new c.ErrnoError(8);s.getdents&&(s.getdents=null);try{s.stream_ops.close&&s.stream_ops.close(s)}catch(i){throw i}finally{c.closeStream(s.fd)}s.fd=null},isClosed:s=>s.fd===null,llseek:(s,i,l)=>{if(c.isClosed(s))throw new c.ErrnoError(8);if(!s.seekable||!s.stream_ops.llseek)throw new c.ErrnoError(70);if(l!=0&&l!=1&&l!=2)throw new c.ErrnoError(28);return s.position=s.stream_ops.llseek(s,i,l),s.ungotten=[],s.position},read:(s,i,l,a,u)=>{if(a<0||u<0)throw new c.ErrnoError(28);if(c.isClosed(s))throw new c.ErrnoError(8);if((s.flags&2097155)===1)throw new c.ErrnoError(8);if(c.isDir(s.node.mode))throw new c.ErrnoError(31);if(!s.stream_ops.read)throw new c.ErrnoError(28);var d=typeof u<"u";if(!d)u=s.position;else if(!s.seekable)throw new c.ErrnoError(70);var N=s.stream_ops.read(s,i,l,a,u);return d||(s.position+=N),N},write:(s,i,l,a,u,d)=>{if(a<0||u<0)throw new c.ErrnoError(28);if(c.isClosed(s))throw new c.ErrnoError(8);if(!(s.flags&2097155))throw new c.ErrnoError(8);if(c.isDir(s.node.mode))throw new c.ErrnoError(31);if(!s.stream_ops.write)throw new c.ErrnoError(28);s.seekable&&s.flags&1024&&c.llseek(s,0,2);var N=typeof u<"u";if(!N)u=s.position;else if(!s.seekable)throw new c.ErrnoError(70);var S=s.stream_ops.write(s,i,l,a,u,d);return N||(s.position+=S),S},allocate:(s,i,l)=>{if(c.isClosed(s))throw new c.ErrnoError(8);if(i<0||l<=0)throw new c.ErrnoError(28);if(!(s.flags&2097155))throw new c.ErrnoError(8);if(!c.isFile(s.node.mode)&&!c.isDir(s.node.mode))throw new c.ErrnoError(43);if(!s.stream_ops.allocate)throw new c.ErrnoError(138);s.stream_ops.allocate(s,i,l)},mmap:(s,i,l,a,u)=>{if(a&2&&!(u&2)&&(s.flags&2097155)!==2)throw new c.ErrnoError(2);if((s.flags&2097155)===1)throw new c.ErrnoError(2);if(!s.stream_ops.mmap)throw new c.ErrnoError(43);return s.stream_ops.mmap(s,i,l,a,u)},msync:(s,i,l,a,u)=>s.stream_ops.msync?s.stream_ops.msync(s,i,l,a,u):0,munmap:s=>0,ioctl:(s,i,l)=>{if(!s.stream_ops.ioctl)throw new c.ErrnoError(59);return s.stream_ops.ioctl(s,i,l)},readFile:(s,i={})=>{if(i.flags=i.flags||0,i.encoding=i.encoding||"binary",i.encoding!=="utf8"&&i.encoding!=="binary")throw new Error('Invalid encoding type "'+i.encoding+'"');var l,a=c.open(s,i.flags),u=c.stat(s),d=u.size,N=new Uint8Array(d);return c.read(a,N,0,d,0),i.encoding==="utf8"?l=Cr(N,0):i.encoding==="binary"&&(l=N),c.close(a),l},writeFile:(s,i,l={})=>{l.flags=l.flags||577;var a=c.open(s,l.flags,l.mode);if(typeof i=="string"){var u=new Uint8Array(qi(i)+1),d=Is(i,u,0,u.length);c.write(a,u,0,d,void 0,l.canOwn)}else if(ArrayBuffer.isView(i))c.write(a,i,0,i.byteLength,void 0,l.canOwn);else throw new Error("Unsupported data type");c.close(a)},cwd:()=>c.currentPath,chdir:s=>{var i=c.lookupPath(s,{follow:!0});if(i.node===null)throw new c.ErrnoError(44);if(!c.isDir(i.node.mode))throw new c.ErrnoError(54);var l=c.nodePermissions(i.node,"x");if(l)throw new c.ErrnoError(l);c.currentPath=i.path},createDefaultDirectories:()=>{c.mkdir("/tmp"),c.mkdir("/home"),c.mkdir("/home/web_user")},createDefaultDevices:()=>{c.mkdir("/dev"),c.registerDevice(c.makedev(1,3),{read:()=>0,write:(i,l,a,u,d)=>u}),c.mkdev("/dev/null",c.makedev(1,3)),Zn.register(c.makedev(5,0),Zn.default_tty_ops),Zn.register(c.makedev(6,0),Zn.default_tty1_ops),c.mkdev("/dev/tty",c.makedev(5,0)),c.mkdev("/dev/tty1",c.makedev(6,0));var s=kc();c.createDevice("/dev","random",s),c.createDevice("/dev","urandom",s),c.mkdir("/dev/shm"),c.mkdir("/dev/shm/tmp")},createSpecialDirectories:()=>{c.mkdir("/proc");var s=c.mkdir("/proc/self");c.mkdir("/proc/self/fd"),c.mount({mount:()=>{var i=c.createNode(s,"fd",16895,73);return i.node_ops={lookup:(l,a)=>{var u=+a,d=c.getStream(u);if(!d)throw new c.ErrnoError(8);var N={parent:null,mount:{mountpoint:"fake"},node_ops:{readlink:()=>d.path}};return N.parent=N,N}},i}},{},"/proc/self/fd")},createStandardStreams:()=>{n.stdin?c.createDevice("/dev","stdin",n.stdin):c.symlink("/dev/tty","/dev/stdin"),n.stdout?c.createDevice("/dev","stdout",null,n.stdout):c.symlink("/dev/tty","/dev/stdout"),n.stderr?c.createDevice("/dev","stderr",null,n.stderr):c.symlink("/dev/tty1","/dev/stderr"),c.open("/dev/stdin",0),c.open("/dev/stdout",1),c.open("/dev/stderr",1)},ensureErrnoError:()=>{c.ErrnoError||(c.ErrnoError=function(i,l){this.node=l,this.setErrno=function(a){this.errno=a},this.setErrno(i),this.message="FS error"},c.ErrnoError.prototype=new Error,c.ErrnoError.prototype.constructor=c.ErrnoError,[44].forEach(s=>{c.genericErrors[s]=new c.ErrnoError(s),c.genericErrors[s].stack="<generic error, no stack>"}))},staticInit:()=>{c.ensureErrnoError(),c.nameTable=new Array(4096),c.mount(de,{},"/"),c.createDefaultDirectories(),c.createDefaultDevices(),c.createSpecialDirectories(),c.filesystems={MEMFS:de}},init:(s,i,l)=>{c.init.initialized=!0,c.ensureErrnoError(),n.stdin=s||n.stdin,n.stdout=i||n.stdout,n.stderr=l||n.stderr,c.createStandardStreams()},quit:()=>{c.init.initialized=!1;for(var s=0;s<c.streams.length;s++){var i=c.streams[s];i&&c.close(i)}},getMode:(s,i)=>{var l=0;return s&&(l|=365),i&&(l|=146),l},findObject:(s,i)=>{var l=c.analyzePath(s,i);return l.exists?l.object:null},analyzePath:(s,i)=>{try{var l=c.lookupPath(s,{follow:!i});s=l.path}catch{}var a={isRoot:!1,exists:!1,error:0,name:null,path:null,object:null,parentExists:!1,parentPath:null,parentObject:null};try{var l=c.lookupPath(s,{parent:!0});a.parentExists=!0,a.parentPath=l.path,a.parentObject=l.node,a.name=Ne.basename(s),l=c.lookupPath(s,{follow:!i}),a.exists=!0,a.path=l.path,a.object=l.node,a.name=l.node.name,a.isRoot=l.path==="/"}catch(u){a.error=u.errno}return a},createPath:(s,i,l,a)=>{s=typeof s=="string"?s:c.getPath(s);for(var u=i.split("/").reverse();u.length;){var d=u.pop();if(d){var N=Ne.join2(s,d);try{c.mkdir(N)}catch{}s=N}}return N},createFile:(s,i,l,a,u)=>{var d=Ne.join2(typeof s=="string"?s:c.getPath(s),i),N=c.getMode(a,u);return c.create(d,N)},createDataFile:(s,i,l,a,u,d)=>{var N=i;s&&(s=typeof s=="string"?s:c.getPath(s),N=i?Ne.join2(s,i):s);var S=c.getMode(a,u),C=c.create(N,S);if(l){if(typeof l=="string"){for(var V=new Array(l.length),K=0,te=l.length;K<te;++K)V[K]=l.charCodeAt(K);l=V}c.chmod(C,S|146);var k=c.open(C,577);c.write(k,l,0,l.length,0,d),c.close(k),c.chmod(C,S)}return C},createDevice:(s,i,l,a)=>{var u=Ne.join2(typeof s=="string"?s:c.getPath(s),i),d=c.getMode(!!l,!!a);c.createDevice.major||(c.createDevice.major=64);var N=c.makedev(c.createDevice.major++,0);return c.registerDevice(N,{open:S=>{S.seekable=!1},close:S=>{a&&a.buffer&&a.buffer.length&&a(10)},read:(S,C,V,K,te)=>{for(var k=0,m=0;m<K;m++){var y;try{y=l()}catch{throw new c.ErrnoError(29)}if(y===void 0&&k===0)throw new c.ErrnoError(6);if(y==null)break;k++,C[V+m]=y}return k&&(S.node.timestamp=Date.now()),k},write:(S,C,V,K,te)=>{for(var k=0;k<K;k++)try{a(C[V+k])}catch{throw new c.ErrnoError(29)}return K&&(S.node.timestamp=Date.now()),k}}),c.mkdev(u,d,N)},forceLoadFile:s=>{if(s.isDevice||s.isFolder||s.link||s.contents)return!0;if(typeof XMLHttpRequest<"u")throw new Error("Lazy loading should have been performed (contents set) in createLazyFile, but it was not. Lazy loading only works in web workers. Use --embed-file or --preload-file in emcc on the main thread.");if($n)try{s.contents=yo($n(s.url),!0),s.usedBytes=s.contents.length}catch{throw new c.ErrnoError(29)}else throw new Error("Cannot load without read() or XMLHttpRequest.")},createLazyFile:(s,i,l,a,u)=>{function d(){this.lengthKnown=!1,this.chunks=[]}if(d.prototype.get=function(m){if(!(m>this.length-1||m<0)){var y=m%this.chunkSize,x=m/this.chunkSize|0;return this.getter(x)[y]}},d.prototype.setDataGetter=function(m){this.getter=m},d.prototype.cacheLength=function(){var m=new XMLHttpRequest;if(m.open("HEAD",l,!1),m.send(null),!(m.status>=200&&m.status<300||m.status===304))throw new Error("Couldn't load "+l+". Status: "+m.status);var y=Number(m.getResponseHeader("Content-length")),x,E=(x=m.getResponseHeader("Accept-Ranges"))&&x==="bytes",q=(x=m.getResponseHeader("Content-Encoding"))&&x==="gzip",W=1024*1024;E||(W=y);var M=(L,ie)=>{if(L>ie)throw new Error("invalid range ("+L+", "+ie+") or no bytes requested!");if(ie>y-1)throw new Error("only "+y+" bytes available! programmer error!");var z=new XMLHttpRequest;if(z.open("GET",l,!1),y!==W&&z.setRequestHeader("Range","bytes="+L+"-"+ie),z.responseType="arraybuffer",z.overrideMimeType&&z.overrideMimeType("text/plain; charset=x-user-defined"),z.send(null),!(z.status>=200&&z.status<300||z.status===304))throw new Error("Couldn't load "+l+". Status: "+z.status);return z.response!==void 0?new Uint8Array(z.response||[]):yo(z.responseText||"",!0)},R=this;R.setDataGetter(L=>{var ie=L*W,z=(L+1)*W-1;if(z=Math.min(z,y-1),typeof R.chunks[L]>"u"&&(R.chunks[L]=M(ie,z)),typeof R.chunks[L]>"u")throw new Error("doXHR failed!");return R.chunks[L]}),(q||!y)&&(W=y=1,y=this.getter(0).length,W=y,Ot("LazyFiles on gzip forces download of the whole file when length is accessed")),this._length=y,this._chunkSize=W,this.lengthKnown=!0},typeof XMLHttpRequest<"u"){if(!ct)throw"Cannot do synchronous binary XHRs outside webworkers in modern browsers. Use --embed-file or --preload-file in emcc";var N=new d;Object.defineProperties(N,{length:{get:function(){return this.lengthKnown||this.cacheLength(),this._length}},chunkSize:{get:function(){return this.lengthKnown||this.cacheLength(),this._chunkSize}}});var S={isDevice:!1,contents:N}}else var S={isDevice:!1,url:l};var C=c.createFile(s,i,S,a,u);S.contents?C.contents=S.contents:S.url&&(C.contents=null,C.url=S.url),Object.defineProperties(C,{usedBytes:{get:function(){return this.contents.length}}});var V={},K=Object.keys(C.stream_ops);K.forEach(k=>{var m=C.stream_ops[k];V[k]=function(){return c.forceLoadFile(C),m.apply(null,arguments)}});function te(k,m,y,x,E){var q=k.node.contents;if(E>=q.length)return 0;var W=Math.min(q.length-E,x);if(q.slice)for(var M=0;M<W;M++)m[y+M]=q[E+M];else for(var M=0;M<W;M++)m[y+M]=q.get(E+M);return W}return V.read=(k,m,y,x,E)=>(c.forceLoadFile(C),te(k,m,y,x,E)),V.mmap=(k,m,y,x,E)=>{c.forceLoadFile(C);var q=Ma();if(!q)throw new c.ErrnoError(48);return te(k,Tt,q,m,y),{ptr:q,allocated:!0}},C.stream_ops=V,C},createPreloadedFile:(s,i,l,a,u,d,N,S,C,V)=>{var K=i?dn.resolve(Ne.join2(s,i)):s;function te(k){function m(y){V&&V(),S||c.createDataFile(s,i,y,a,u,C),d&&d(),Ts()}Browser.handledByPreloadPlugin(k,K,m,()=>{N&&N(),Ts()})||m(k)}_o(),typeof l=="string"?Ac(l,k=>te(k),N):te(l)},indexedDB:()=>window.indexedDB||window.mozIndexedDB||window.webkitIndexedDB||window.msIndexedDB,DB_NAME:()=>"EM_FS_"+window.location.pathname,DB_VERSION:20,DB_STORE_NAME:"FILE_DATA",saveFilesToDB:(s,i,l)=>{i=i||(()=>{}),l=l||(()=>{});var a=c.indexedDB();try{var u=a.open(c.DB_NAME(),c.DB_VERSION)}catch(d){return l(d)}u.onupgradeneeded=()=>{Ot("creating db");var d=u.result;d.createObjectStore(c.DB_STORE_NAME)},u.onsuccess=()=>{var d=u.result,N=d.transaction([c.DB_STORE_NAME],"readwrite"),S=N.objectStore(c.DB_STORE_NAME),C=0,V=0,K=s.length;function te(){V==0?i():l()}s.forEach(k=>{var m=S.put(c.analyzePath(k).object.contents,k);m.onsuccess=()=>{C++,C+V==K&&te()},m.onerror=()=>{V++,C+V==K&&te()}}),N.onerror=l},u.onerror=l},loadFilesFromDB:(s,i,l)=>{i=i||(()=>{}),l=l||(()=>{});var a=c.indexedDB();try{var u=a.open(c.DB_NAME(),c.DB_VERSION)}catch(d){return l(d)}u.onupgradeneeded=l,u.onsuccess=()=>{var d=u.result;try{var N=d.transaction([c.DB_STORE_NAME],"readonly")}catch(k){l(k);return}var S=N.objectStore(c.DB_STORE_NAME),C=0,V=0,K=s.length;function te(){V==0?i():l()}s.forEach(k=>{var m=S.get(k);m.onsuccess=()=>{c.analyzePath(k).exists&&c.unlink(k),c.createDataFile(Ne.dirname(k),Ne.basename(k),m.result,!0,!0,!0),C++,C+V==K&&te()},m.onerror=()=>{V++,C+V==K&&te()}}),N.onerror=l},u.onerror=l}},ce={DEFAULT_POLLMASK:5,calculateAt:function(s,i,l){if(Ne.isAbs(i))return i;var a;if(s===-100)a=c.cwd();else{var u=ce.getStreamFromFD(s);a=u.path}if(i.length==0){if(!l)throw new c.ErrnoError(44);return a}return Ne.join2(a,i)},doStat:function(s,i,l){try{var a=s(i)}catch(S){if(S&&S.node&&Ne.normalize(i)!==Ne.normalize(c.getPath(S.node)))return-54;throw S}_e[l>>2]=a.dev,_e[l+8>>2]=a.ino,_e[l+12>>2]=a.mode,tt[l+16>>2]=a.nlink,_e[l+20>>2]=a.uid,_e[l+24>>2]=a.gid,_e[l+28>>2]=a.rdev,st=[a.size>>>0,(ye=a.size,+Math.abs(ye)>=1?ye>0?(Math.min(+Math.floor(ye/4294967296),4294967295)|0)>>>0:~~+Math.ceil((ye-+(~~ye>>>0))/4294967296)>>>0:0)],_e[l+40>>2]=st[0],_e[l+44>>2]=st[1],_e[l+48>>2]=4096,_e[l+52>>2]=a.blocks;var u=a.atime.getTime(),d=a.mtime.getTime(),N=a.ctime.getTime();return st=[Math.floor(u/1e3)>>>0,(ye=Math.floor(u/1e3),+Math.abs(ye)>=1?ye>0?(Math.min(+Math.floor(ye/4294967296),4294967295)|0)>>>0:~~+Math.ceil((ye-+(~~ye>>>0))/4294967296)>>>0:0)],_e[l+56>>2]=st[0],_e[l+60>>2]=st[1],tt[l+64>>2]=u%1e3*1e3,st=[Math.floor(d/1e3)>>>0,(ye=Math.floor(d/1e3),+Math.abs(ye)>=1?ye>0?(Math.min(+Math.floor(ye/4294967296),4294967295)|0)>>>0:~~+Math.ceil((ye-+(~~ye>>>0))/4294967296)>>>0:0)],_e[l+72>>2]=st[0],_e[l+76>>2]=st[1],tt[l+80>>2]=d%1e3*1e3,st=[Math.floor(N/1e3)>>>0,(ye=Math.floor(N/1e3),+Math.abs(ye)>=1?ye>0?(Math.min(+Math.floor(ye/4294967296),4294967295)|0)>>>0:~~+Math.ceil((ye-+(~~ye>>>0))/4294967296)>>>0:0)],_e[l+88>>2]=st[0],_e[l+92>>2]=st[1],tt[l+96>>2]=N%1e3*1e3,st=[a.ino>>>0,(ye=a.ino,+Math.abs(ye)>=1?ye>0?(Math.min(+Math.floor(ye/4294967296),4294967295)|0)>>>0:~~+Math.ceil((ye-+(~~ye>>>0))/4294967296)>>>0:0)],_e[l+104>>2]=st[0],_e[l+108>>2]=st[1],0},doMsync:function(s,i,l,a,u){if(!c.isFile(i.node.mode))throw new c.ErrnoError(43);if(a&2)return 0;var d=Ni.slice(s,s+l);c.msync(i,d,u,l,a)},varargs:void 0,get:function(){ce.varargs+=4;var s=_e[ce.varargs-4>>2];return s},getStr:function(s){var i=yc(s);return i},getStreamFromFD:function(s){var i=c.getStream(s);if(!i)throw new c.ErrnoError(8);return i}};function Oc(s,i){try{return s=ce.getStr(s),c.chmod(s,i),0}catch(l){if(typeof c>"u"||!(l instanceof c.ErrnoError))throw l;return-l.errno}}function Ic(s,i,l,a){try{if(i=ce.getStr(i),i=ce.calculateAt(s,i),l&-8)return-28;var u=c.lookupPath(i,{follow:!0}),d=u.node;if(!d)return-44;var N="";return l&4&&(N+="r"),l&2&&(N+="w"),l&1&&(N+="x"),N&&c.nodePermissions(d,N)?-2:0}catch(S){if(typeof c>"u"||!(S instanceof c.ErrnoError))throw S;return-S.errno}}function Tc(s,i){try{return c.fchmod(s,i),0}catch(l){if(typeof c>"u"||!(l instanceof c.ErrnoError))throw l;return-l.errno}}function Cc(s,i,l){try{return c.fchown(s,i,l),0}catch(a){if(typeof c>"u"||!(a instanceof c.ErrnoError))throw a;return-a.errno}}function Pc(s){return _e[Va()>>2]=s,s}function Wc(s,i,l){ce.varargs=l;try{var a=ce.getStreamFromFD(s);switch(i){case 0:{var u=ce.get();if(u<0)return-28;var d;return d=c.createStream(a,u),d.fd}case 1:case 2:return 0;case 3:return a.flags;case 4:{var u=ce.get();return a.flags|=u,0}case 5:{var u=ce.get(),N=0;return Ta[u+N>>1]=2,0}case 6:case 7:return 0;case 16:case 8:return-28;case 9:return Pc(28),-1;default:return-28}}catch(S){if(typeof c>"u"||!(S instanceof c.ErrnoError))throw S;return-S.errno}}function Fc(s,i){try{var l=ce.getStreamFromFD(s);return ce.doStat(c.stat,l.path,i)}catch(a){if(typeof c>"u"||!(a instanceof c.ErrnoError))throw a;return-a.errno}}var Lc=9007199254740992,Dc=-9007199254740992;function Ba(s){return s<Dc||s>Lc?NaN:Number(s)}function Rc(s,i){try{return i=Ba(i),isNaN(i)?-61:(c.ftruncate(s,i),0)}catch(l){if(typeof c>"u"||!(l instanceof c.ErrnoError))throw l;return-l.errno}}function Mc(s,i){try{if(i===0)return-28;var l=c.cwd(),a=qi(l)+1;return i<a?-68:(Ia(l,s,i),a)}catch(u){if(typeof c>"u"||!(u instanceof c.ErrnoError))throw u;return-u.errno}}function Bc(s,i,l){ce.varargs=l;try{var a=ce.getStreamFromFD(s);switch(i){case 21509:case 21505:return a.tty?0:-59;case 21510:case 21511:case 21512:case 21506:case 21507:case 21508:return a.tty?0:-59;case 21519:{if(!a.tty)return-59;var u=ce.get();return _e[u>>2]=0,0}case 21520:return a.tty?-28:-59;case 21531:{var u=ce.get();return c.ioctl(a,i,u)}case 21523:return a.tty?0:-59;case 21524:return a.tty?0:-59;default:return-28}}catch(d){if(typeof c>"u"||!(d instanceof c.ErrnoError))throw d;return-d.errno}}function Uc(s,i){try{return s=ce.getStr(s),ce.doStat(c.lstat,s,i)}catch(l){if(typeof c>"u"||!(l instanceof c.ErrnoError))throw l;return-l.errno}}function Qc(s,i,l){try{return i=ce.getStr(i),i=ce.calculateAt(s,i),i=Ne.normalize(i),i[i.length-1]==="/"&&(i=i.substr(0,i.length-1)),c.mkdir(i,l,0),0}catch(a){if(typeof c>"u"||!(a instanceof c.ErrnoError))throw a;return-a.errno}}function jc(s,i,l,a){try{i=ce.getStr(i);var u=a&256,d=a&4096;return a=a&-6401,i=ce.calculateAt(s,i,d),ce.doStat(u?c.lstat:c.stat,i,l)}catch(N){if(typeof c>"u"||!(N instanceof c.ErrnoError))throw N;return-N.errno}}function zc(s,i,l,a){ce.varargs=a;try{i=ce.getStr(i),i=ce.calculateAt(s,i);var u=a?ce.get():0;return c.open(i,l,u).fd}catch(d){if(typeof c>"u"||!(d instanceof c.ErrnoError))throw d;return-d.errno}}function Vc(s,i,l,a){try{if(i=ce.getStr(i),i=ce.calculateAt(s,i),a<=0)return-28;var u=c.readlink(i),d=Math.min(a,qi(u)),N=Tt[l+d];return Ia(u,l,a+1),Tt[l+d]=N,d}catch(S){if(typeof c>"u"||!(S instanceof c.ErrnoError))throw S;return-S.errno}}function Jc(s){try{return s=ce.getStr(s),c.rmdir(s),0}catch(i){if(typeof c>"u"||!(i instanceof c.ErrnoError))throw i;return-i.errno}}function Gc(s,i){try{return s=ce.getStr(s),ce.doStat(c.stat,s,i)}catch(l){if(typeof c>"u"||!(l instanceof c.ErrnoError))throw l;return-l.errno}}function Hc(s,i,l){try{return i=ce.getStr(i),i=ce.calculateAt(s,i),l===0?c.unlink(i):l===512?c.rmdir(i):Yn("Invalid flags passed to unlinkat"),0}catch(a){if(typeof c>"u"||!(a instanceof c.ErrnoError))throw a;return-a.errno}}function go(s){return tt[s>>2]+_e[s+4>>2]*4294967296}function $c(s,i,l,a){try{if(i=ce.getStr(i),i=ce.calculateAt(s,i,!0),l){var N=go(l),S=_e[l+8>>2];u=N*1e3+S/(1e3*1e3),l+=16,N=go(l),S=_e[l+8>>2],d=N*1e3+S/(1e3*1e3)}else var u=Date.now(),d=u;return c.utime(i,u,d),0}catch(C){if(typeof c>"u"||!(C instanceof c.ErrnoError))throw C;return-C.errno}}var Kc=!0;function Xc(){return Kc}function Yc(s){return s%4===0&&(s%100!==0||s%400===0)}var Zc=[0,31,60,91,121,152,182,213,244,274,305,335],ed=[0,31,59,90,120,151,181,212,243,273,304,334];function td(s){var i=Yc(s.getFullYear()),l=i?Zc:ed,a=l[s.getMonth()]+s.getDate()-1;return a}function nd(s,i){var l=new Date(go(s)*1e3);_e[i>>2]=l.getSeconds(),_e[i+4>>2]=l.getMinutes(),_e[i+8>>2]=l.getHours(),_e[i+12>>2]=l.getDate(),_e[i+16>>2]=l.getMonth(),_e[i+20>>2]=l.getFullYear()-1900,_e[i+24>>2]=l.getDay();var a=td(l)|0;_e[i+28>>2]=a,_e[i+36>>2]=-(l.getTimezoneOffset()*60);var u=new Date(l.getFullYear(),0,1),d=new Date(l.getFullYear(),6,1).getTimezoneOffset(),N=u.getTimezoneOffset(),S=(d!=N&&l.getTimezoneOffset()==Math.min(N,d))|0;_e[i+32>>2]=S}function Ua(s){var i=qi(s)+1,l=Ja(i);return l&&Is(s,Tt,l,i),l}function rd(s,i,l){var a=new Date().getFullYear(),u=new Date(a,0,1),d=new Date(a,6,1),N=u.getTimezoneOffset(),S=d.getTimezoneOffset(),C=Math.max(N,S);tt[s>>2]=C*60,_e[i>>2]=+(N!=S);function V(y){var x=y.toTimeString().match(/\(([A-Za-z ]+)\)$/);return x?x[1]:"GMT"}var K=V(u),te=V(d),k=Ua(K),m=Ua(te);S<N?(tt[l>>2]=k,tt[l+4>>2]=m):(tt[l>>2]=m,tt[l+4>>2]=k)}function id(){return Date.now()}var Qa;Qa=()=>performance.now();function sd(){return 2147483648}function od(s){var i=Zt.buffer;try{return Zt.grow(s-i.byteLength+65535>>>16),Ca(),1}catch{}}function ad(s){var i=Ni.length;s=s>>>0;var l=sd();if(s>l)return!1;let a=(C,V)=>C+(V-C%V)%V;for(var u=1;u<=4;u*=2){var d=i*(1+.2/u);d=Math.min(d,s+100663296);var N=Math.min(l,a(Math.max(s,d),65536)),S=od(N);if(S)return!0}return!1}var wo={};function ld(){return je||"./this.program"}function xi(){if(!xi.strings){var s=(typeof navigator=="object"&&navigator.languages&&navigator.languages[0]||"C").replace("-","_")+".UTF-8",i={USER:"web_user",LOGNAME:"web_user",PATH:"/",PWD:"/",HOME:"/home/web_user",LANG:s,_:ld()};for(var l in wo)wo[l]===void 0?delete i[l]:i[l]=wo[l];var a=[];for(var l in i)a.push(l+"="+i[l]);xi.strings=a}return xi.strings}function ud(s,i,l){for(var a=0;a<s.length;++a)Tt[i++>>0]=s.charCodeAt(a);l||(Tt[i>>0]=0)}function cd(s,i){var l=0;return xi().forEach(function(a,u){var d=i+l;tt[s+u*4>>2]=d,ud(a,d),l+=a.length+1}),0}function dd(s,i){var l=xi();tt[s>>2]=l.length;var a=0;return l.forEach(function(u){a+=u.length+1}),tt[i>>2]=a,0}function fd(s){try{var i=ce.getStreamFromFD(s);return c.close(i),0}catch(l){if(typeof c>"u"||!(l instanceof c.ErrnoError))throw l;return l.errno}}function hd(s,i){try{var l=ce.getStreamFromFD(s),a=l.tty?2:c.isDir(l.mode)?3:c.isLink(l.mode)?7:4;return Tt[i>>0]=a,0}catch(u){if(typeof c>"u"||!(u instanceof c.ErrnoError))throw u;return u.errno}}function pd(s,i,l,a){for(var u=0,d=0;d<l;d++){var N=tt[i>>2],S=tt[i+4>>2];i+=8;var C=c.read(s,Tt,N,S,a);if(C<0)return-1;if(u+=C,C<S)break;typeof a<"u"&&(a+=C)}return u}function _d(s,i,l,a){try{var u=ce.getStreamFromFD(s),d=pd(u,i,l);return tt[a>>2]=d,0}catch(N){if(typeof c>"u"||!(N instanceof c.ErrnoError))throw N;return N.errno}}function md(s,i,l,a){try{if(i=Ba(i),isNaN(i))return 61;var u=ce.getStreamFromFD(s);return c.llseek(u,i,l),st=[u.position>>>0,(ye=u.position,+Math.abs(ye)>=1?ye>0?(Math.min(+Math.floor(ye/4294967296),4294967295)|0)>>>0:~~+Math.ceil((ye-+(~~ye>>>0))/4294967296)>>>0:0)],_e[a>>2]=st[0],_e[a+4>>2]=st[1],u.getdents&&i===0&&l===0&&(u.getdents=null),0}catch(d){if(typeof c>"u"||!(d instanceof c.ErrnoError))throw d;return d.errno}}function yd(s){try{var i=ce.getStreamFromFD(s);return i.stream_ops&&i.stream_ops.fsync?i.stream_ops.fsync(i):0}catch(l){if(typeof c>"u"||!(l instanceof c.ErrnoError))throw l;return l.errno}}function gd(s,i,l,a){for(var u=0,d=0;d<l;d++){var N=tt[i>>2],S=tt[i+4>>2];i+=8;var C=c.write(s,Tt,N,S,a);if(C<0)return-1;u+=C,typeof a<"u"&&(a+=C)}return u}function wd(s,i,l,a){try{var u=ce.getStreamFromFD(s),d=gd(u,i,l);return tt[a>>2]=d,0}catch(N){if(typeof c>"u"||!(N instanceof c.ErrnoError))throw N;return N.errno}}var ja=function(s,i,l,a){s||(s=this),this.parent=s,this.mount=s.mount,this.mounted=null,this.id=c.nextInode++,this.name=i,this.mode=l,this.node_ops={},this.stream_ops={},this.rdev=a},Cs=365,Ps=146;Object.defineProperties(ja.prototype,{read:{get:function(){return(this.mode&Cs)===Cs},set:function(s){s?this.mode|=Cs:this.mode&=~Cs}},write:{get:function(){return(this.mode&Ps)===Ps},set:function(s){s?this.mode|=Ps:this.mode&=~Ps}},isFolder:{get:function(){return c.isDir(this.mode)}},isDevice:{get:function(){return c.isChrdev(this.mode)}}}),c.FSNode=ja,c.staticInit();var za={__syscall_chmod:Oc,__syscall_faccessat:Ic,__syscall_fchmod:Tc,__syscall_fchown32:Cc,__syscall_fcntl64:Wc,__syscall_fstat64:Fc,__syscall_ftruncate64:Rc,__syscall_getcwd:Mc,__syscall_ioctl:Bc,__syscall_lstat64:Uc,__syscall_mkdirat:Qc,__syscall_newfstatat:jc,__syscall_openat:zc,__syscall_readlinkat:Vc,__syscall_rmdir:Jc,__syscall_stat64:Gc,__syscall_unlinkat:Hc,__syscall_utimensat:$c,_emscripten_get_now_is_monotonic:Xc,_localtime_js:nd,_tzset_js:rd,emscripten_date_now:id,emscripten_get_now:Qa,emscripten_resize_heap:ad,environ_get:cd,environ_sizes_get:dd,fd_close:fd,fd_fdstat_get:hd,fd_read:_d,fd_seek:md,fd_sync:yd,fd_write:wd,memory:Zt};Sc(),n.___wasm_call_ctors=function(){return(n.___wasm_call_ctors=n.asm.__wasm_call_ctors).apply(null,arguments)},n._sqlite3_status64=function(){return(n._sqlite3_status64=n.asm.sqlite3_status64).apply(null,arguments)},n._sqlite3_status=function(){return(n._sqlite3_status=n.asm.sqlite3_status).apply(null,arguments)},n._sqlite3_db_status=function(){return(n._sqlite3_db_status=n.asm.sqlite3_db_status).apply(null,arguments)},n._sqlite3_msize=function(){return(n._sqlite3_msize=n.asm.sqlite3_msize).apply(null,arguments)},n._sqlite3_vfs_find=function(){return(n._sqlite3_vfs_find=n.asm.sqlite3_vfs_find).apply(null,arguments)},n._sqlite3_initialize=function(){return(n._sqlite3_initialize=n.asm.sqlite3_initialize).apply(null,arguments)},n._sqlite3_malloc=function(){return(n._sqlite3_malloc=n.asm.sqlite3_malloc).apply(null,arguments)},n._sqlite3_free=function(){return(n._sqlite3_free=n.asm.sqlite3_free).apply(null,arguments)},n._sqlite3_vfs_register=function(){return(n._sqlite3_vfs_register=n.asm.sqlite3_vfs_register).apply(null,arguments)},n._sqlite3_vfs_unregister=function(){return(n._sqlite3_vfs_unregister=n.asm.sqlite3_vfs_unregister).apply(null,arguments)},n._sqlite3_malloc64=function(){return(n._sqlite3_malloc64=n.asm.sqlite3_malloc64).apply(null,arguments)},n._sqlite3_realloc=function(){return(n._sqlite3_realloc=n.asm.sqlite3_realloc).apply(null,arguments)},n._sqlite3_realloc64=function(){return(n._sqlite3_realloc64=n.asm.sqlite3_realloc64).apply(null,arguments)},n._sqlite3_value_text=function(){return(n._sqlite3_value_text=n.asm.sqlite3_value_text).apply(null,arguments)},n._sqlite3_randomness=function(){return(n._sqlite3_randomness=n.asm.sqlite3_randomness).apply(null,arguments)},n._sqlite3_stricmp=function(){return(n._sqlite3_stricmp=n.asm.sqlite3_stricmp).apply(null,arguments)},n._sqlite3_strnicmp=function(){return(n._sqlite3_strnicmp=n.asm.sqlite3_strnicmp).apply(null,arguments)},n._sqlite3_uri_parameter=function(){return(n._sqlite3_uri_parameter=n.asm.sqlite3_uri_parameter).apply(null,arguments)};var Va=n.___errno_location=function(){return(Va=n.___errno_location=n.asm.__errno_location).apply(null,arguments)};n._sqlite3_uri_boolean=function(){return(n._sqlite3_uri_boolean=n.asm.sqlite3_uri_boolean).apply(null,arguments)},n._sqlite3_serialize=function(){return(n._sqlite3_serialize=n.asm.sqlite3_serialize).apply(null,arguments)},n._sqlite3_prepare_v2=function(){return(n._sqlite3_prepare_v2=n.asm.sqlite3_prepare_v2).apply(null,arguments)},n._sqlite3_step=function(){return(n._sqlite3_step=n.asm.sqlite3_step).apply(null,arguments)},n._sqlite3_column_int64=function(){return(n._sqlite3_column_int64=n.asm.sqlite3_column_int64).apply(null,arguments)},n._sqlite3_column_int=function(){return(n._sqlite3_column_int=n.asm.sqlite3_column_int).apply(null,arguments)},n._sqlite3_finalize=function(){return(n._sqlite3_finalize=n.asm.sqlite3_finalize).apply(null,arguments)},n._sqlite3_file_control=function(){return(n._sqlite3_file_control=n.asm.sqlite3_file_control).apply(null,arguments)},n._sqlite3_reset=function(){return(n._sqlite3_reset=n.asm.sqlite3_reset).apply(null,arguments)},n._sqlite3_deserialize=function(){return(n._sqlite3_deserialize=n.asm.sqlite3_deserialize).apply(null,arguments)},n._sqlite3_clear_bindings=function(){return(n._sqlite3_clear_bindings=n.asm.sqlite3_clear_bindings).apply(null,arguments)},n._sqlite3_value_blob=function(){return(n._sqlite3_value_blob=n.asm.sqlite3_value_blob).apply(null,arguments)},n._sqlite3_value_bytes=function(){return(n._sqlite3_value_bytes=n.asm.sqlite3_value_bytes).apply(null,arguments)},n._sqlite3_value_double=function(){return(n._sqlite3_value_double=n.asm.sqlite3_value_double).apply(null,arguments)},n._sqlite3_value_int=function(){return(n._sqlite3_value_int=n.asm.sqlite3_value_int).apply(null,arguments)},n._sqlite3_value_int64=function(){return(n._sqlite3_value_int64=n.asm.sqlite3_value_int64).apply(null,arguments)},n._sqlite3_value_subtype=function(){return(n._sqlite3_value_subtype=n.asm.sqlite3_value_subtype).apply(null,arguments)},n._sqlite3_value_pointer=function(){return(n._sqlite3_value_pointer=n.asm.sqlite3_value_pointer).apply(null,arguments)},n._sqlite3_value_type=function(){return(n._sqlite3_value_type=n.asm.sqlite3_value_type).apply(null,arguments)},n._sqlite3_value_nochange=function(){return(n._sqlite3_value_nochange=n.asm.sqlite3_value_nochange).apply(null,arguments)},n._sqlite3_value_frombind=function(){return(n._sqlite3_value_frombind=n.asm.sqlite3_value_frombind).apply(null,arguments)},n._sqlite3_value_dup=function(){return(n._sqlite3_value_dup=n.asm.sqlite3_value_dup).apply(null,arguments)},n._sqlite3_value_free=function(){return(n._sqlite3_value_free=n.asm.sqlite3_value_free).apply(null,arguments)},n._sqlite3_result_blob=function(){return(n._sqlite3_result_blob=n.asm.sqlite3_result_blob).apply(null,arguments)},n._sqlite3_result_error_nomem=function(){return(n._sqlite3_result_error_nomem=n.asm.sqlite3_result_error_nomem).apply(null,arguments)},n._sqlite3_result_error_toobig=function(){return(n._sqlite3_result_error_toobig=n.asm.sqlite3_result_error_toobig).apply(null,arguments)},n._sqlite3_result_double=function(){return(n._sqlite3_result_double=n.asm.sqlite3_result_double).apply(null,arguments)},n._sqlite3_result_error=function(){return(n._sqlite3_result_error=n.asm.sqlite3_result_error).apply(null,arguments)},n._sqlite3_result_int=function(){return(n._sqlite3_result_int=n.asm.sqlite3_result_int).apply(null,arguments)},n._sqlite3_result_int64=function(){return(n._sqlite3_result_int64=n.asm.sqlite3_result_int64).apply(null,arguments)},n._sqlite3_result_null=function(){return(n._sqlite3_result_null=n.asm.sqlite3_result_null).apply(null,arguments)},n._sqlite3_result_pointer=function(){return(n._sqlite3_result_pointer=n.asm.sqlite3_result_pointer).apply(null,arguments)},n._sqlite3_result_subtype=function(){return(n._sqlite3_result_subtype=n.asm.sqlite3_result_subtype).apply(null,arguments)},n._sqlite3_result_text=function(){return(n._sqlite3_result_text=n.asm.sqlite3_result_text).apply(null,arguments)},n._sqlite3_result_zeroblob=function(){return(n._sqlite3_result_zeroblob=n.asm.sqlite3_result_zeroblob).apply(null,arguments)},n._sqlite3_result_zeroblob64=function(){return(n._sqlite3_result_zeroblob64=n.asm.sqlite3_result_zeroblob64).apply(null,arguments)},n._sqlite3_result_error_code=function(){return(n._sqlite3_result_error_code=n.asm.sqlite3_result_error_code).apply(null,arguments)},n._sqlite3_user_data=function(){return(n._sqlite3_user_data=n.asm.sqlite3_user_data).apply(null,arguments)},n._sqlite3_context_db_handle=function(){return(n._sqlite3_context_db_handle=n.asm.sqlite3_context_db_handle).apply(null,arguments)},n._sqlite3_vtab_nochange=function(){return(n._sqlite3_vtab_nochange=n.asm.sqlite3_vtab_nochange).apply(null,arguments)},n._sqlite3_vtab_in_first=function(){return(n._sqlite3_vtab_in_first=n.asm.sqlite3_vtab_in_first).apply(null,arguments)},n._sqlite3_vtab_in_next=function(){return(n._sqlite3_vtab_in_next=n.asm.sqlite3_vtab_in_next).apply(null,arguments)},n._sqlite3_aggregate_context=function(){return(n._sqlite3_aggregate_context=n.asm.sqlite3_aggregate_context).apply(null,arguments)},n._sqlite3_get_auxdata=function(){return(n._sqlite3_get_auxdata=n.asm.sqlite3_get_auxdata).apply(null,arguments)},n._sqlite3_set_auxdata=function(){return(n._sqlite3_set_auxdata=n.asm.sqlite3_set_auxdata).apply(null,arguments)},n._sqlite3_column_count=function(){return(n._sqlite3_column_count=n.asm.sqlite3_column_count).apply(null,arguments)},n._sqlite3_data_count=function(){return(n._sqlite3_data_count=n.asm.sqlite3_data_count).apply(null,arguments)},n._sqlite3_column_blob=function(){return(n._sqlite3_column_blob=n.asm.sqlite3_column_blob).apply(null,arguments)},n._sqlite3_column_bytes=function(){return(n._sqlite3_column_bytes=n.asm.sqlite3_column_bytes).apply(null,arguments)},n._sqlite3_column_double=function(){return(n._sqlite3_column_double=n.asm.sqlite3_column_double).apply(null,arguments)},n._sqlite3_column_text=function(){return(n._sqlite3_column_text=n.asm.sqlite3_column_text).apply(null,arguments)},n._sqlite3_column_value=function(){return(n._sqlite3_column_value=n.asm.sqlite3_column_value).apply(null,arguments)},n._sqlite3_column_type=function(){return(n._sqlite3_column_type=n.asm.sqlite3_column_type).apply(null,arguments)},n._sqlite3_column_name=function(){return(n._sqlite3_column_name=n.asm.sqlite3_column_name).apply(null,arguments)},n._sqlite3_bind_blob=function(){return(n._sqlite3_bind_blob=n.asm.sqlite3_bind_blob).apply(null,arguments)},n._sqlite3_bind_double=function(){return(n._sqlite3_bind_double=n.asm.sqlite3_bind_double).apply(null,arguments)},n._sqlite3_bind_int=function(){return(n._sqlite3_bind_int=n.asm.sqlite3_bind_int).apply(null,arguments)},n._sqlite3_bind_int64=function(){return(n._sqlite3_bind_int64=n.asm.sqlite3_bind_int64).apply(null,arguments)},n._sqlite3_bind_null=function(){return(n._sqlite3_bind_null=n.asm.sqlite3_bind_null).apply(null,arguments)},n._sqlite3_bind_pointer=function(){return(n._sqlite3_bind_pointer=n.asm.sqlite3_bind_pointer).apply(null,arguments)},n._sqlite3_bind_text=function(){return(n._sqlite3_bind_text=n.asm.sqlite3_bind_text).apply(null,arguments)},n._sqlite3_bind_parameter_count=function(){return(n._sqlite3_bind_parameter_count=n.asm.sqlite3_bind_parameter_count).apply(null,arguments)},n._sqlite3_bind_parameter_index=function(){return(n._sqlite3_bind_parameter_index=n.asm.sqlite3_bind_parameter_index).apply(null,arguments)},n._sqlite3_db_handle=function(){return(n._sqlite3_db_handle=n.asm.sqlite3_db_handle).apply(null,arguments)},n._sqlite3_stmt_readonly=function(){return(n._sqlite3_stmt_readonly=n.asm.sqlite3_stmt_readonly).apply(null,arguments)},n._sqlite3_stmt_isexplain=function(){return(n._sqlite3_stmt_isexplain=n.asm.sqlite3_stmt_isexplain).apply(null,arguments)},n._sqlite3_stmt_status=function(){return(n._sqlite3_stmt_status=n.asm.sqlite3_stmt_status).apply(null,arguments)},n._sqlite3_sql=function(){return(n._sqlite3_sql=n.asm.sqlite3_sql).apply(null,arguments)},n._sqlite3_expanded_sql=function(){return(n._sqlite3_expanded_sql=n.asm.sqlite3_expanded_sql).apply(null,arguments)},n._sqlite3_preupdate_old=function(){return(n._sqlite3_preupdate_old=n.asm.sqlite3_preupdate_old).apply(null,arguments)},n._sqlite3_preupdate_count=function(){return(n._sqlite3_preupdate_count=n.asm.sqlite3_preupdate_count).apply(null,arguments)},n._sqlite3_preupdate_depth=function(){return(n._sqlite3_preupdate_depth=n.asm.sqlite3_preupdate_depth).apply(null,arguments)},n._sqlite3_preupdate_blobwrite=function(){return(n._sqlite3_preupdate_blobwrite=n.asm.sqlite3_preupdate_blobwrite).apply(null,arguments)},n._sqlite3_preupdate_new=function(){return(n._sqlite3_preupdate_new=n.asm.sqlite3_preupdate_new).apply(null,arguments)},n._sqlite3_value_numeric_type=function(){return(n._sqlite3_value_numeric_type=n.asm.sqlite3_value_numeric_type).apply(null,arguments)},n._sqlite3_errmsg=function(){return(n._sqlite3_errmsg=n.asm.sqlite3_errmsg).apply(null,arguments)},n._sqlite3_set_authorizer=function(){return(n._sqlite3_set_authorizer=n.asm.sqlite3_set_authorizer).apply(null,arguments)},n._sqlite3_strglob=function(){return(n._sqlite3_strglob=n.asm.sqlite3_strglob).apply(null,arguments)},n._sqlite3_strlike=function(){return(n._sqlite3_strlike=n.asm.sqlite3_strlike).apply(null,arguments)},n._sqlite3_exec=function(){return(n._sqlite3_exec=n.asm.sqlite3_exec).apply(null,arguments)},n._sqlite3_auto_extension=function(){return(n._sqlite3_auto_extension=n.asm.sqlite3_auto_extension).apply(null,arguments)},n._sqlite3_cancel_auto_extension=function(){return(n._sqlite3_cancel_auto_extension=n.asm.sqlite3_cancel_auto_extension).apply(null,arguments)},n._sqlite3_reset_auto_extension=function(){return(n._sqlite3_reset_auto_extension=n.asm.sqlite3_reset_auto_extension).apply(null,arguments)},n._sqlite3_prepare_v3=function(){return(n._sqlite3_prepare_v3=n.asm.sqlite3_prepare_v3).apply(null,arguments)},n._sqlite3_create_module=function(){return(n._sqlite3_create_module=n.asm.sqlite3_create_module).apply(null,arguments)},n._sqlite3_create_module_v2=function(){return(n._sqlite3_create_module_v2=n.asm.sqlite3_create_module_v2).apply(null,arguments)},n._sqlite3_drop_modules=function(){return(n._sqlite3_drop_modules=n.asm.sqlite3_drop_modules).apply(null,arguments)},n._sqlite3_declare_vtab=function(){return(n._sqlite3_declare_vtab=n.asm.sqlite3_declare_vtab).apply(null,arguments)},n._sqlite3_vtab_on_conflict=function(){return(n._sqlite3_vtab_on_conflict=n.asm.sqlite3_vtab_on_conflict).apply(null,arguments)},n._sqlite3_vtab_collation=function(){return(n._sqlite3_vtab_collation=n.asm.sqlite3_vtab_collation).apply(null,arguments)},n._sqlite3_vtab_in=function(){return(n._sqlite3_vtab_in=n.asm.sqlite3_vtab_in).apply(null,arguments)},n._sqlite3_vtab_rhs_value=function(){return(n._sqlite3_vtab_rhs_value=n.asm.sqlite3_vtab_rhs_value).apply(null,arguments)},n._sqlite3_vtab_distinct=function(){return(n._sqlite3_vtab_distinct=n.asm.sqlite3_vtab_distinct).apply(null,arguments)},n._sqlite3_keyword_name=function(){return(n._sqlite3_keyword_name=n.asm.sqlite3_keyword_name).apply(null,arguments)},n._sqlite3_keyword_count=function(){return(n._sqlite3_keyword_count=n.asm.sqlite3_keyword_count).apply(null,arguments)},n._sqlite3_keyword_check=function(){return(n._sqlite3_keyword_check=n.asm.sqlite3_keyword_check).apply(null,arguments)},n._sqlite3_complete=function(){return(n._sqlite3_complete=n.asm.sqlite3_complete).apply(null,arguments)},n._sqlite3_libversion=function(){return(n._sqlite3_libversion=n.asm.sqlite3_libversion).apply(null,arguments)},n._sqlite3_libversion_number=function(){return(n._sqlite3_libversion_number=n.asm.sqlite3_libversion_number).apply(null,arguments)},n._sqlite3_shutdown=function(){return(n._sqlite3_shutdown=n.asm.sqlite3_shutdown).apply(null,arguments)},n._sqlite3_last_insert_rowid=function(){return(n._sqlite3_last_insert_rowid=n.asm.sqlite3_last_insert_rowid).apply(null,arguments)},n._sqlite3_set_last_insert_rowid=function(){return(n._sqlite3_set_last_insert_rowid=n.asm.sqlite3_set_last_insert_rowid).apply(null,arguments)},n._sqlite3_changes64=function(){return(n._sqlite3_changes64=n.asm.sqlite3_changes64).apply(null,arguments)},n._sqlite3_changes=function(){return(n._sqlite3_changes=n.asm.sqlite3_changes).apply(null,arguments)},n._sqlite3_total_changes64=function(){return(n._sqlite3_total_changes64=n.asm.sqlite3_total_changes64).apply(null,arguments)},n._sqlite3_total_changes=function(){return(n._sqlite3_total_changes=n.asm.sqlite3_total_changes).apply(null,arguments)},n._sqlite3_txn_state=function(){return(n._sqlite3_txn_state=n.asm.sqlite3_txn_state).apply(null,arguments)},n._sqlite3_close_v2=function(){return(n._sqlite3_close_v2=n.asm.sqlite3_close_v2).apply(null,arguments)},n._sqlite3_busy_handler=function(){return(n._sqlite3_busy_handler=n.asm.sqlite3_busy_handler).apply(null,arguments)},n._sqlite3_progress_handler=function(){return(n._sqlite3_progress_handler=n.asm.sqlite3_progress_handler).apply(null,arguments)},n._sqlite3_busy_timeout=function(){return(n._sqlite3_busy_timeout=n.asm.sqlite3_busy_timeout).apply(null,arguments)},n._sqlite3_create_function=function(){return(n._sqlite3_create_function=n.asm.sqlite3_create_function).apply(null,arguments)},n._sqlite3_create_function_v2=function(){return(n._sqlite3_create_function_v2=n.asm.sqlite3_create_function_v2).apply(null,arguments)},n._sqlite3_create_window_function=function(){return(n._sqlite3_create_window_function=n.asm.sqlite3_create_window_function).apply(null,arguments)},n._sqlite3_overload_function=function(){return(n._sqlite3_overload_function=n.asm.sqlite3_overload_function).apply(null,arguments)},n._sqlite3_trace_v2=function(){return(n._sqlite3_trace_v2=n.asm.sqlite3_trace_v2).apply(null,arguments)},n._sqlite3_commit_hook=function(){return(n._sqlite3_commit_hook=n.asm.sqlite3_commit_hook).apply(null,arguments)},n._sqlite3_update_hook=function(){return(n._sqlite3_update_hook=n.asm.sqlite3_update_hook).apply(null,arguments)},n._sqlite3_rollback_hook=function(){return(n._sqlite3_rollback_hook=n.asm.sqlite3_rollback_hook).apply(null,arguments)},n._sqlite3_preupdate_hook=function(){return(n._sqlite3_preupdate_hook=n.asm.sqlite3_preupdate_hook).apply(null,arguments)},n._sqlite3_error_offset=function(){return(n._sqlite3_error_offset=n.asm.sqlite3_error_offset).apply(null,arguments)},n._sqlite3_errcode=function(){return(n._sqlite3_errcode=n.asm.sqlite3_errcode).apply(null,arguments)},n._sqlite3_extended_errcode=function(){return(n._sqlite3_extended_errcode=n.asm.sqlite3_extended_errcode).apply(null,arguments)},n._sqlite3_errstr=function(){return(n._sqlite3_errstr=n.asm.sqlite3_errstr).apply(null,arguments)},n._sqlite3_limit=function(){return(n._sqlite3_limit=n.asm.sqlite3_limit).apply(null,arguments)},n._sqlite3_open=function(){return(n._sqlite3_open=n.asm.sqlite3_open).apply(null,arguments)},n._sqlite3_open_v2=function(){return(n._sqlite3_open_v2=n.asm.sqlite3_open_v2).apply(null,arguments)},n._sqlite3_create_collation=function(){return(n._sqlite3_create_collation=n.asm.sqlite3_create_collation).apply(null,arguments)},n._sqlite3_create_collation_v2=function(){return(n._sqlite3_create_collation_v2=n.asm.sqlite3_create_collation_v2).apply(null,arguments)},n._sqlite3_collation_needed=function(){return(n._sqlite3_collation_needed=n.asm.sqlite3_collation_needed).apply(null,arguments)},n._sqlite3_table_column_metadata=function(){return(n._sqlite3_table_column_metadata=n.asm.sqlite3_table_column_metadata).apply(null,arguments)},n._sqlite3_extended_result_codes=function(){return(n._sqlite3_extended_result_codes=n.asm.sqlite3_extended_result_codes).apply(null,arguments)},n._sqlite3_uri_key=function(){return(n._sqlite3_uri_key=n.asm.sqlite3_uri_key).apply(null,arguments)},n._sqlite3_uri_int64=function(){return(n._sqlite3_uri_int64=n.asm.sqlite3_uri_int64).apply(null,arguments)},n._sqlite3_db_name=function(){return(n._sqlite3_db_name=n.asm.sqlite3_db_name).apply(null,arguments)},n._sqlite3_db_filename=function(){return(n._sqlite3_db_filename=n.asm.sqlite3_db_filename).apply(null,arguments)},n._sqlite3_compileoption_used=function(){return(n._sqlite3_compileoption_used=n.asm.sqlite3_compileoption_used).apply(null,arguments)},n._sqlite3_compileoption_get=function(){return(n._sqlite3_compileoption_get=n.asm.sqlite3_compileoption_get).apply(null,arguments)},n._sqlite3session_diff=function(){return(n._sqlite3session_diff=n.asm.sqlite3session_diff).apply(null,arguments)},n._sqlite3session_attach=function(){return(n._sqlite3session_attach=n.asm.sqlite3session_attach).apply(null,arguments)},n._sqlite3session_create=function(){return(n._sqlite3session_create=n.asm.sqlite3session_create).apply(null,arguments)},n._sqlite3session_delete=function(){return(n._sqlite3session_delete=n.asm.sqlite3session_delete).apply(null,arguments)},n._sqlite3session_table_filter=function(){return(n._sqlite3session_table_filter=n.asm.sqlite3session_table_filter).apply(null,arguments)},n._sqlite3session_changeset=function(){return(n._sqlite3session_changeset=n.asm.sqlite3session_changeset).apply(null,arguments)},n._sqlite3session_changeset_strm=function(){return(n._sqlite3session_changeset_strm=n.asm.sqlite3session_changeset_strm).apply(null,arguments)},n._sqlite3session_patchset_strm=function(){return(n._sqlite3session_patchset_strm=n.asm.sqlite3session_patchset_strm).apply(null,arguments)},n._sqlite3session_patchset=function(){return(n._sqlite3session_patchset=n.asm.sqlite3session_patchset).apply(null,arguments)},n._sqlite3session_enable=function(){return(n._sqlite3session_enable=n.asm.sqlite3session_enable).apply(null,arguments)},n._sqlite3session_indirect=function(){return(n._sqlite3session_indirect=n.asm.sqlite3session_indirect).apply(null,arguments)},n._sqlite3session_isempty=function(){return(n._sqlite3session_isempty=n.asm.sqlite3session_isempty).apply(null,arguments)},n._sqlite3session_memory_used=function(){return(n._sqlite3session_memory_used=n.asm.sqlite3session_memory_used).apply(null,arguments)},n._sqlite3session_object_config=function(){return(n._sqlite3session_object_config=n.asm.sqlite3session_object_config).apply(null,arguments)},n._sqlite3session_changeset_size=function(){return(n._sqlite3session_changeset_size=n.asm.sqlite3session_changeset_size).apply(null,arguments)},n._sqlite3changeset_start=function(){return(n._sqlite3changeset_start=n.asm.sqlite3changeset_start).apply(null,arguments)},n._sqlite3changeset_start_v2=function(){return(n._sqlite3changeset_start_v2=n.asm.sqlite3changeset_start_v2).apply(null,arguments)},n._sqlite3changeset_start_strm=function(){return(n._sqlite3changeset_start_strm=n.asm.sqlite3changeset_start_strm).apply(null,arguments)},n._sqlite3changeset_start_v2_strm=function(){return(n._sqlite3changeset_start_v2_strm=n.asm.sqlite3changeset_start_v2_strm).apply(null,arguments)},n._sqlite3changeset_next=function(){return(n._sqlite3changeset_next=n.asm.sqlite3changeset_next).apply(null,arguments)},n._sqlite3changeset_op=function(){return(n._sqlite3changeset_op=n.asm.sqlite3changeset_op).apply(null,arguments)},n._sqlite3changeset_pk=function(){return(n._sqlite3changeset_pk=n.asm.sqlite3changeset_pk).apply(null,arguments)},n._sqlite3changeset_old=function(){return(n._sqlite3changeset_old=n.asm.sqlite3changeset_old).apply(null,arguments)},n._sqlite3changeset_new=function(){return(n._sqlite3changeset_new=n.asm.sqlite3changeset_new).apply(null,arguments)},n._sqlite3changeset_conflict=function(){return(n._sqlite3changeset_conflict=n.asm.sqlite3changeset_conflict).apply(null,arguments)},n._sqlite3changeset_fk_conflicts=function(){return(n._sqlite3changeset_fk_conflicts=n.asm.sqlite3changeset_fk_conflicts).apply(null,arguments)},n._sqlite3changeset_finalize=function(){return(n._sqlite3changeset_finalize=n.asm.sqlite3changeset_finalize).apply(null,arguments)},n._sqlite3changeset_invert=function(){return(n._sqlite3changeset_invert=n.asm.sqlite3changeset_invert).apply(null,arguments)},n._sqlite3changeset_invert_strm=function(){return(n._sqlite3changeset_invert_strm=n.asm.sqlite3changeset_invert_strm).apply(null,arguments)},n._sqlite3changeset_apply_v2=function(){return(n._sqlite3changeset_apply_v2=n.asm.sqlite3changeset_apply_v2).apply(null,arguments)},n._sqlite3changeset_apply=function(){return(n._sqlite3changeset_apply=n.asm.sqlite3changeset_apply).apply(null,arguments)},n._sqlite3changeset_apply_v2_strm=function(){return(n._sqlite3changeset_apply_v2_strm=n.asm.sqlite3changeset_apply_v2_strm).apply(null,arguments)},n._sqlite3changeset_apply_strm=function(){return(n._sqlite3changeset_apply_strm=n.asm.sqlite3changeset_apply_strm).apply(null,arguments)},n._sqlite3changegroup_new=function(){return(n._sqlite3changegroup_new=n.asm.sqlite3changegroup_new).apply(null,arguments)},n._sqlite3changegroup_add=function(){return(n._sqlite3changegroup_add=n.asm.sqlite3changegroup_add).apply(null,arguments)},n._sqlite3changegroup_output=function(){return(n._sqlite3changegroup_output=n.asm.sqlite3changegroup_output).apply(null,arguments)},n._sqlite3changegroup_add_strm=function(){return(n._sqlite3changegroup_add_strm=n.asm.sqlite3changegroup_add_strm).apply(null,arguments)},n._sqlite3changegroup_output_strm=function(){return(n._sqlite3changegroup_output_strm=n.asm.sqlite3changegroup_output_strm).apply(null,arguments)},n._sqlite3changegroup_delete=function(){return(n._sqlite3changegroup_delete=n.asm.sqlite3changegroup_delete).apply(null,arguments)},n._sqlite3changeset_concat=function(){return(n._sqlite3changeset_concat=n.asm.sqlite3changeset_concat).apply(null,arguments)},n._sqlite3changeset_concat_strm=function(){return(n._sqlite3changeset_concat_strm=n.asm.sqlite3changeset_concat_strm).apply(null,arguments)},n._sqlite3session_config=function(){return(n._sqlite3session_config=n.asm.sqlite3session_config).apply(null,arguments)},n._sqlite3_sourceid=function(){return(n._sqlite3_sourceid=n.asm.sqlite3_sourceid).apply(null,arguments)},n._sqlite3_wasm_pstack_ptr=function(){return(n._sqlite3_wasm_pstack_ptr=n.asm.sqlite3_wasm_pstack_ptr).apply(null,arguments)},n._sqlite3_wasm_pstack_restore=function(){return(n._sqlite3_wasm_pstack_restore=n.asm.sqlite3_wasm_pstack_restore).apply(null,arguments)},n._sqlite3_wasm_pstack_alloc=function(){return(n._sqlite3_wasm_pstack_alloc=n.asm.sqlite3_wasm_pstack_alloc).apply(null,arguments)},n._sqlite3_wasm_pstack_remaining=function(){return(n._sqlite3_wasm_pstack_remaining=n.asm.sqlite3_wasm_pstack_remaining).apply(null,arguments)},n._sqlite3_wasm_pstack_quota=function(){return(n._sqlite3_wasm_pstack_quota=n.asm.sqlite3_wasm_pstack_quota).apply(null,arguments)},n._sqlite3_wasm_db_error=function(){return(n._sqlite3_wasm_db_error=n.asm.sqlite3_wasm_db_error).apply(null,arguments)},n._sqlite3_wasm_test_struct=function(){return(n._sqlite3_wasm_test_struct=n.asm.sqlite3_wasm_test_struct).apply(null,arguments)},n._sqlite3_wasm_enum_json=function(){return(n._sqlite3_wasm_enum_json=n.asm.sqlite3_wasm_enum_json).apply(null,arguments)},n._sqlite3_wasm_vfs_unlink=function(){return(n._sqlite3_wasm_vfs_unlink=n.asm.sqlite3_wasm_vfs_unlink).apply(null,arguments)},n._sqlite3_wasm_db_vfs=function(){return(n._sqlite3_wasm_db_vfs=n.asm.sqlite3_wasm_db_vfs).apply(null,arguments)},n._sqlite3_wasm_db_reset=function(){return(n._sqlite3_wasm_db_reset=n.asm.sqlite3_wasm_db_reset).apply(null,arguments)},n._sqlite3_wasm_db_export_chunked=function(){return(n._sqlite3_wasm_db_export_chunked=n.asm.sqlite3_wasm_db_export_chunked).apply(null,arguments)},n._sqlite3_wasm_db_serialize=function(){return(n._sqlite3_wasm_db_serialize=n.asm.sqlite3_wasm_db_serialize).apply(null,arguments)},n._sqlite3_wasm_vfs_create_file=function(){return(n._sqlite3_wasm_vfs_create_file=n.asm.sqlite3_wasm_vfs_create_file).apply(null,arguments)},n._sqlite3_wasm_kvvfsMakeKeyOnPstack=function(){return(n._sqlite3_wasm_kvvfsMakeKeyOnPstack=n.asm.sqlite3_wasm_kvvfsMakeKeyOnPstack).apply(null,arguments)},n._sqlite3_wasm_kvvfs_methods=function(){return(n._sqlite3_wasm_kvvfs_methods=n.asm.sqlite3_wasm_kvvfs_methods).apply(null,arguments)},n._sqlite3_wasm_vtab_config=function(){return(n._sqlite3_wasm_vtab_config=n.asm.sqlite3_wasm_vtab_config).apply(null,arguments)},n._sqlite3_wasm_db_config_ip=function(){return(n._sqlite3_wasm_db_config_ip=n.asm.sqlite3_wasm_db_config_ip).apply(null,arguments)},n._sqlite3_wasm_db_config_pii=function(){return(n._sqlite3_wasm_db_config_pii=n.asm.sqlite3_wasm_db_config_pii).apply(null,arguments)},n._sqlite3_wasm_db_config_s=function(){return(n._sqlite3_wasm_db_config_s=n.asm.sqlite3_wasm_db_config_s).apply(null,arguments)},n._sqlite3_wasm_config_i=function(){return(n._sqlite3_wasm_config_i=n.asm.sqlite3_wasm_config_i).apply(null,arguments)},n._sqlite3_wasm_config_ii=function(){return(n._sqlite3_wasm_config_ii=n.asm.sqlite3_wasm_config_ii).apply(null,arguments)},n._sqlite3_wasm_config_j=function(){return(n._sqlite3_wasm_config_j=n.asm.sqlite3_wasm_config_j).apply(null,arguments)},n._sqlite3_wasm_init_wasmfs=function(){return(n._sqlite3_wasm_init_wasmfs=n.asm.sqlite3_wasm_init_wasmfs).apply(null,arguments)},n._sqlite3_wasm_test_intptr=function(){return(n._sqlite3_wasm_test_intptr=n.asm.sqlite3_wasm_test_intptr).apply(null,arguments)},n._sqlite3_wasm_test_voidptr=function(){return(n._sqlite3_wasm_test_voidptr=n.asm.sqlite3_wasm_test_voidptr).apply(null,arguments)},n._sqlite3_wasm_test_int64_max=function(){return(n._sqlite3_wasm_test_int64_max=n.asm.sqlite3_wasm_test_int64_max).apply(null,arguments)},n._sqlite3_wasm_test_int64_min=function(){return(n._sqlite3_wasm_test_int64_min=n.asm.sqlite3_wasm_test_int64_min).apply(null,arguments)},n._sqlite3_wasm_test_int64_times2=function(){return(n._sqlite3_wasm_test_int64_times2=n.asm.sqlite3_wasm_test_int64_times2).apply(null,arguments)},n._sqlite3_wasm_test_int64_minmax=function(){return(n._sqlite3_wasm_test_int64_minmax=n.asm.sqlite3_wasm_test_int64_minmax).apply(null,arguments)},n._sqlite3_wasm_test_int64ptr=function(){return(n._sqlite3_wasm_test_int64ptr=n.asm.sqlite3_wasm_test_int64ptr).apply(null,arguments)},n._sqlite3_wasm_test_stack_overflow=function(){return(n._sqlite3_wasm_test_stack_overflow=n.asm.sqlite3_wasm_test_stack_overflow).apply(null,arguments)},n._sqlite3_wasm_test_str_hello=function(){return(n._sqlite3_wasm_test_str_hello=n.asm.sqlite3_wasm_test_str_hello).apply(null,arguments)};var Ja=n._malloc=function(){return(Ja=n._malloc=n.asm.malloc).apply(null,arguments)};n._free=function(){return(n._free=n.asm.free).apply(null,arguments)},n._realloc=function(){return(n._realloc=n.asm.realloc).apply(null,arguments)},n.stackSave=function(){return(n.stackSave=n.asm.stackSave).apply(null,arguments)},n.stackRestore=function(){return(n.stackRestore=n.asm.stackRestore).apply(null,arguments)},n.stackAlloc=function(){return(n.stackAlloc=n.asm.stackAlloc).apply(null,arguments)},n.wasmMemory=Zt;var Ws;vi=function s(){Ws||Ga(),Ws||(vi=s)};function Ga(s){if(Xn>0||(gc(),Xn>0))return;function i(){Ws||(Ws=!0,n.calledRun=!0,!Kn&&(wc(),O(n),n.onRuntimeInitialized&&n.onRuntimeInitialized(),bc()))}n.setStatus?(n.setStatus("Running..."),setTimeout(function(){setTimeout(function(){n.setStatus("")},1),i()},1)):i()}if(n.preInit)for(typeof n.preInit=="function"&&(n.preInit=[n.preInit]);n.preInit.length>0;)n.preInit.pop()();return Ga(),n.postRun||(n.postRun=[]),n.postRun.push(function(s){if(globalThis.sqlite3ApiBootstrap=function i(l=globalThis.sqlite3ApiConfig||i.defaultConfig){if(i.sqlite3)return console.warn("sqlite3ApiBootstrap() called multiple times.","Config and external initializers are ignored on calls after the first."),i.sqlite3;const a=Object.assign(Object.create(null),{exports:void 0,memory:void 0,bigIntEnabled:(()=>typeof s<"u"?!!s.HEAPU64:!!globalThis.BigInt64Array)(),debug:console.debug.bind(console),warn:console.warn.bind(console),error:console.error.bind(console),log:console.log.bind(console),wasmfsOpfsDir:"/opfs",useStdAlloc:!1},l||{});Object.assign(a,{allocExportName:a.useStdAlloc?"malloc":"sqlite3_malloc",deallocExportName:a.useStdAlloc?"free":"sqlite3_free",reallocExportName:a.useStdAlloc?"realloc":"sqlite3_realloc"},a),["exports","memory","wasmfsOpfsDir"].forEach(f=>{typeof a[f]=="function"&&(a[f]=a[f]())}),a.wasmOpfsDir=!1;const u=Object.create(null),d=Object.create(null),N=f=>u.sqlite3_js_rc_str&&u.sqlite3_js_rc_str(f)||"Unknown result code #"+f,S=f=>typeof f=="number"&&f===(f|0);class C extends Error{constructor(...p){let _;if(p.length)if(S(p[0]))if(_=p[0],p.length===1)super(N(p[0]));else{const P=N(_);typeof p[1]=="object"?super(P,p[1]):(p[0]=P+":",super(p.join(" ")))}else p.length===2&&typeof p[1]=="object"?super(...p):super(p.join(" "));this.resultCode=_||u.SQLITE_ERROR,this.name="SQLite3Error"}}C.toss=(...f)=>{throw new C(...f)};const V=C.toss;a.wasmfsOpfsDir&&!/^\/[^/]+$/.test(a.wasmfsOpfsDir)&&V("config.wasmfsOpfsDir must be falsy or in the form '/dir-name'.");const K=f=>typeof f!="bigint"&&f===(f|0)&&f<=2147483647&&f>=-2147483648,te=function f(p){return f._max||(f._max=BigInt("0x7fffffffffffffff"),f._min=~f._max),p>=f._min&&p<=f._max},k=f=>f>=-0x7fffffffn-1n&&f<=0x7fffffffn,m=function f(p){return f._min||(f._min=Number.MIN_SAFE_INTEGER,f._max=Number.MAX_SAFE_INTEGER),p>=f._min&&p<=f._max},y=f=>f&&f.constructor&&K(f.constructor.BYTES_PER_ELEMENT)?f:!1,x=typeof SharedArrayBuffer>"u"?function(){}:SharedArrayBuffer,E=f=>f.buffer instanceof x,q=(f,p,_)=>E(f)?f.slice(p,_):f.subarray(p,_),W=f=>f&&(f instanceof Uint8Array||f instanceof Int8Array||f instanceof ArrayBuffer),M=f=>f&&(f instanceof Uint8Array||f instanceof Int8Array||f instanceof ArrayBuffer),R=f=>W(f)||V("Value is not of a supported TypedArray type."),L=new TextDecoder("utf-8"),ie=function(f,p,_){return L.decode(q(f,p,_))},z=function(f){return M(f)?ie(f instanceof ArrayBuffer?new Uint8Array(f):f):Array.isArray(f)?f.join(""):(d.isPtr(f)&&(f=d.cstrToJs(f)),f)};class g extends Error{constructor(...p){p.length===2&&typeof p[1]=="object"?super(...p):p.length?super(p.join(" ")):super("Allocation failed."),this.resultCode=u.SQLITE_NOMEM,this.name="WasmAllocError"}}g.toss=(...f)=>{throw new g(...f)},Object.assign(u,{sqlite3_bind_blob:void 0,sqlite3_bind_text:void 0,sqlite3_create_function_v2:(f,p,_,P,F,ne,re,se,fe)=>{},sqlite3_create_function:(f,p,_,P,F,ne,re,se)=>{},sqlite3_create_window_function:(f,p,_,P,F,ne,re,se,fe,le)=>{},sqlite3_prepare_v3:(f,p,_,P,F,ne)=>{},sqlite3_prepare_v2:(f,p,_,P,F)=>{},sqlite3_exec:(f,p,_,P,F)=>{},sqlite3_randomness:(f,p)=>{}});const v={affirmBindableTypedArray:R,flexibleString:z,bigIntFits32:k,bigIntFits64:te,bigIntFitsDouble:m,isBindableTypedArray:W,isInt32:K,isSQLableTypedArray:M,isTypedArray:y,typedArrayToString:ie,isUIThread:()=>globalThis.window===globalThis&&!!globalThis.document,isSharedTypedArray:E,toss:function(...f){throw new Error(f.join(" "))},toss3:V,typedArrayPart:q};Object.assign(d,{ptrSizeof:a.wasmPtrSizeof||4,ptrIR:a.wasmPtrIR||"i32",bigIntEnabled:!!a.bigIntEnabled,exports:a.exports||V("Missing API config.exports (WASM module exports)."),memory:a.memory||a.exports.memory||V("API config object requires a WebAssembly.Memory object","in either config.exports.memory (exported)","or config.memory (imported)."),alloc:void 0,realloc:void 0,dealloc:void 0}),d.allocFromTypedArray=function(f){f instanceof ArrayBuffer&&(f=new Uint8Array(f)),R(f);const p=d.alloc(f.byteLength||1);return d.heapForSize(f.constructor).set(f.byteLength?f:[0],p),p};{const f=a.allocExportName,p=a.deallocExportName,_=a.reallocExportName;for(const P of[f,p,_])d.exports[P]instanceof Function||V("Missing required exports[",P,"] function.");d.alloc=function P(F){return P.impl(F)||g.toss("Failed to allocate",F," bytes.")},d.alloc.impl=d.exports[f],d.realloc=function P(F,ne){const re=P.impl(F,ne);return ne?re||g.toss("Failed to reallocate",ne," bytes."):0},d.realloc.impl=d.exports[_],d.dealloc=d.exports[p]}d.compileOptionUsed=function f(p){if(arguments.length){if(Array.isArray(p)){const _={};return p.forEach(P=>{_[P]=u.sqlite3_compileoption_used(P)}),_}else if(typeof p=="object")return Object.keys(p).forEach(_=>{p[_]=u.sqlite3_compileoption_used(_)}),p}else{if(f._result)return f._result;f._opt||(f._rx=/^([^=]+)=(.+)/,f._rxInt=/^-?\d+$/,f._opt=function(re,se){const fe=f._rx.exec(re);se[0]=fe?fe[1]:re,se[1]=fe?f._rxInt.test(fe[2])?+fe[2]:fe[2]:!0});const _={},P=[0,0];let F=0,ne;for(;ne=u.sqlite3_compileoption_get(F++);)f._opt(ne,P),_[P[0]]=P[1];return f._result=_}return typeof p=="string"?!!u.sqlite3_compileoption_used(p):!1},d.pstack=Object.assign(Object.create(null),{restore:d.exports.sqlite3_wasm_pstack_restore,alloc:function(f){return typeof f=="string"&&!(f=d.sizeofIR(f))&&g.toss("Invalid value for pstack.alloc(",arguments[0],")"),d.exports.sqlite3_wasm_pstack_alloc(f)||g.toss("Could not allocate",f,"bytes from the pstack.")},allocChunks:function(f,p){typeof p=="string"&&!(p=d.sizeofIR(p))&&g.toss("Invalid size value for allocChunks(",arguments[1],")");const _=d.pstack.alloc(f*p),P=[];let F=0,ne=0;for(;F<f;++F,ne+=p)P.push(_+ne);return P},allocPtr:(f=1,p=!0)=>f===1?d.pstack.alloc(p?8:d.ptrSizeof):d.pstack.allocChunks(f,p?8:d.ptrSizeof)}),Object.defineProperties(d.pstack,{pointer:{configurable:!1,iterable:!0,writeable:!1,get:d.exports.sqlite3_wasm_pstack_ptr},quota:{configurable:!1,iterable:!0,writeable:!1,get:d.exports.sqlite3_wasm_pstack_quota},remaining:{configurable:!1,iterable:!0,writeable:!1,get:d.exports.sqlite3_wasm_pstack_remaining}}),u.sqlite3_randomness=(...f)=>{if(f.length===1&&v.isTypedArray(f[0])&&f[0].BYTES_PER_ELEMENT===1){const p=f[0];if(p.byteLength===0)return d.exports.sqlite3_randomness(0,0),p;const _=d.pstack.pointer;try{let P=p.byteLength,F=0;const ne=d.exports.sqlite3_randomness,re=d.heap8u(),se=P<512?P:512,fe=d.pstack.alloc(se);do{const le=P>se?se:P;ne(le,fe),p.set(q(re,fe,fe+le),F),P-=le,F+=le}while(P>0)}catch(P){console.error("Highly unexpected (and ignored!) exception in sqlite3_randomness():",P)}finally{d.pstack.restore(_)}return p}d.exports.sqlite3_randomness(...f)};let A;if(u.sqlite3_wasmfs_opfs_dir=function(){if(A!==void 0)return A;const f=a.wasmfsOpfsDir;if(console.error("sqlite3_wasmfs_opfs_dir() can no longer work due to incompatible WASMFS changes. It will be removed."),!f||!globalThis.FileSystemHandle||!globalThis.FileSystemDirectoryHandle||!globalThis.FileSystemFileHandle)return A="";try{return f&&d.xCallWrapped("sqlite3_wasm_init_wasmfs","i32",["string"],f)===0?A=f:A=""}catch{return A=""}},u.sqlite3_wasmfs_filename_is_persistent=function(f){const p=u.sqlite3_wasmfs_opfs_dir();return p&&f?f.startsWith(p+"/"):!1},u.sqlite3_js_db_uses_vfs=function(f,p,_=0){try{const P=u.sqlite3_vfs_find(p);return P?f?P===u.sqlite3_js_db_vfs(f,_)?P:!1:P===u.sqlite3_vfs_find(0)?P:!1:!1}catch{return!1}},u.sqlite3_js_vfs_list=function(){const f=[];let p=u.sqlite3_vfs_find(0);for(;p;){const _=new u.sqlite3_vfs(p);f.push(d.cstrToJs(_.$zName)),p=_.$pNext,_.dispose()}return f},u.sqlite3_js_db_export=function(f,p=0){f=d.xWrap.testConvertArg("sqlite3*",f),f||V("Invalid sqlite3* argument."),d.bigIntEnabled||V("BigInt64 support is not enabled.");const _=d.scopedAllocPush();let P;try{const F=d.scopedAlloc(8+d.ptrSizeof),ne=F+8,re=p?d.isPtr(p)?p:d.scopedAllocCString(""+p):0;let se=d.exports.sqlite3_wasm_db_serialize(f,re,ne,F,0);se&&V("Database serialization failed with code",w.capi.sqlite3_js_rc_str(se)),P=d.peekPtr(ne);const fe=d.peek(F,"i64");return se=fe?d.heap8u().slice(P,P+Number(fe)):new Uint8Array,se}finally{P&&d.exports.sqlite3_free(P),d.scopedAllocPop(_)}},u.sqlite3_js_db_vfs=(f,p=0)=>d.sqlite3_wasm_db_vfs(f,p),u.sqlite3_js_aggregate_context=(f,p)=>u.sqlite3_aggregate_context(f,p)||(p?g.toss("Cannot allocate",p,"bytes for sqlite3_aggregate_context()"):0),u.sqlite3_js_vfs_create_file=function(f,p,_,P){let F;_?(d.isPtr(_)?F=_:_ instanceof ArrayBuffer&&(_=new Uint8Array(_)),_ instanceof Uint8Array?(F=d.allocFromTypedArray(_),(arguments.length<4||!v.isInt32(P)||P<0)&&(P=_.byteLength)):C.toss("Invalid 3rd argument type for sqlite3_js_vfs_create_file().")):F=0,(!v.isInt32(P)||P<0)&&(d.dealloc(F),C.toss("Invalid 4th argument for sqlite3_js_vfs_create_file()."));try{const ne=d.sqlite3_wasm_vfs_create_file(f,p,F,P);ne&&C.toss("Creation of file failed with sqlite3 result code",u.sqlite3_js_rc_str(ne))}finally{d.dealloc(F)}},v.isUIThread()){const f=function(p){const _=Object.create(null);return _.prefix="kvvfs-"+p,_.stores=[],(p==="session"||p==="")&&_.stores.push(globalThis.sessionStorage),(p==="local"||p==="")&&_.stores.push(globalThis.localStorage),_};u.sqlite3_js_kvvfs_clear=function(p=""){let _=0;const P=f(p);return P.stores.forEach(F=>{const ne=[];let re;for(re=0;re<F.length;++re){const se=F.key(re);se.startsWith(P.prefix)&&ne.push(se)}ne.forEach(se=>F.removeItem(se)),_+=ne.length}),_},u.sqlite3_js_kvvfs_size=function(p=""){let _=0;const P=f(p);return P.stores.forEach(F=>{let ne;for(ne=0;ne<F.length;++ne){const re=F.key(ne);re.startsWith(P.prefix)&&(_+=re.length,_+=F.getItem(re).length)}}),_*2}}u.sqlite3_db_config=(function(f,p,..._){switch(this.s||(this.s=d.xWrap("sqlite3_wasm_db_config_s","int",["sqlite3*","int","string:static"]),this.pii=d.xWrap("sqlite3_wasm_db_config_pii","int",["sqlite3*","int","*","int","int"]),this.ip=d.xWrap("sqlite3_wasm_db_config_ip","int",["sqlite3*","int","int","*"])),p){case u.SQLITE_DBCONFIG_ENABLE_FKEY:case u.SQLITE_DBCONFIG_ENABLE_TRIGGER:case u.SQLITE_DBCONFIG_ENABLE_FTS3_TOKENIZER:case u.SQLITE_DBCONFIG_ENABLE_LOAD_EXTENSION:case u.SQLITE_DBCONFIG_NO_CKPT_ON_CLOSE:case u.SQLITE_DBCONFIG_ENABLE_QPSG:case u.SQLITE_DBCONFIG_TRIGGER_EQP:case u.SQLITE_DBCONFIG_RESET_DATABASE:case u.SQLITE_DBCONFIG_DEFENSIVE:case u.SQLITE_DBCONFIG_WRITABLE_SCHEMA:case u.SQLITE_DBCONFIG_LEGACY_ALTER_TABLE:case u.SQLITE_DBCONFIG_DQS_DML:case u.SQLITE_DBCONFIG_DQS_DDL:case u.SQLITE_DBCONFIG_ENABLE_VIEW:case u.SQLITE_DBCONFIG_LEGACY_FILE_FORMAT:case u.SQLITE_DBCONFIG_TRUSTED_SCHEMA:case u.SQLITE_DBCONFIG_STMT_SCANSTATUS:case u.SQLITE_DBCONFIG_REVERSE_SCANORDER:return this.ip(f,p,_[0],_[1]||0);case u.SQLITE_DBCONFIG_LOOKASIDE:return this.pii(f,p,_[0],_[1],_[2]);case u.SQLITE_DBCONFIG_MAINDBNAME:return this.s(f,p,_[0]);default:return u.SQLITE_MISUSE}}).bind(Object.create(null)),u.sqlite3_value_to_js=function(f,p=!0){let _;const P=u.sqlite3_value_type(f);switch(P){case u.SQLITE_INTEGER:d.bigIntEnabled?(_=u.sqlite3_value_int64(f),v.bigIntFitsDouble(_)&&(_=Number(_))):_=u.sqlite3_value_double(f);break;case u.SQLITE_FLOAT:_=u.sqlite3_value_double(f);break;case u.SQLITE_TEXT:_=u.sqlite3_value_text(f);break;case u.SQLITE_BLOB:{const F=u.sqlite3_value_bytes(f),ne=u.sqlite3_value_blob(f);F&&!ne&&w.WasmAllocError.toss("Cannot allocate memory for blob argument of",F,"byte(s)"),_=F?d.heap8u().slice(ne,ne+Number(F)):null;break}case u.SQLITE_NULL:_=null;break;default:p&&V(u.SQLITE_MISMATCH,"Unhandled sqlite3_value_type():",P),_=void 0}return _},u.sqlite3_values_to_js=function(f,p,_=!0){let P;const F=[];for(P=0;P<f;++P)F.push(u.sqlite3_value_to_js(d.peekPtr(p+d.ptrSizeof*P)));return F},u.sqlite3_result_error_js=function(f,p){p instanceof g?u.sqlite3_result_error_nomem(f):u.sqlite3_result_error(f,""+p,-1)},u.sqlite3_result_js=function(f,p){if(p instanceof Error){u.sqlite3_result_error_js(f,p);return}try{switch(typeof p){case"undefined":break;case"boolean":u.sqlite3_result_int(f,p?1:0);break;case"bigint":v.bigIntFits32(p)?u.sqlite3_result_int(f,Number(p)):v.bigIntFitsDouble(p)?u.sqlite3_result_double(f,Number(p)):d.bigIntEnabled?v.bigIntFits64(p)?u.sqlite3_result_int64(f,p):V("BigInt value",p.toString(),"is too BigInt for int64."):V("BigInt value",p.toString(),"is too BigInt.");break;case"number":{let _;v.isInt32(p)?_=u.sqlite3_result_int:d.bigIntEnabled&&Number.isInteger(p)&&v.bigIntFits64(BigInt(p))?_=u.sqlite3_result_int64:_=u.sqlite3_result_double,_(f,p);break}case"string":{const[_,P]=d.allocCString(p,!0);u.sqlite3_result_text(f,_,P,u.SQLITE_WASM_DEALLOC);break}case"object":if(p===null){u.sqlite3_result_null(f);break}else if(v.isBindableTypedArray(p)){const _=d.allocFromTypedArray(p);u.sqlite3_result_blob(f,_,p.byteLength,u.SQLITE_WASM_DEALLOC);break}default:V("Don't not how to handle this UDF result value:",typeof p,p)}}catch(_){u.sqlite3_result_error_js(f,_)}},u.sqlite3_column_js=function(f,p,_=!0){const P=u.sqlite3_column_value(f,p);return P===0?void 0:u.sqlite3_value_to_js(P,_)};const b=(function(f,p,_){_=u[_],this.ptr?d.pokePtr(this.ptr,0):this.ptr=d.allocPtr();const P=_(f,p,this.ptr);if(P)return C.toss(P,arguments[2]+"() failed with code "+P);const F=d.peekPtr(this.ptr);return F?u.sqlite3_value_to_js(F,!0):void 0}).bind(Object.create(null));u.sqlite3_preupdate_new_js=(f,p)=>b(f,p,"sqlite3_preupdate_new"),u.sqlite3_preupdate_old_js=(f,p)=>b(f,p,"sqlite3_preupdate_old"),u.sqlite3changeset_new_js=(f,p)=>b(f,p,"sqlite3changeset_new"),u.sqlite3changeset_old_js=(f,p)=>b(f,p,"sqlite3changeset_old");const w={WasmAllocError:g,SQLite3Error:C,capi:u,util:v,wasm:d,config:a,version:Object.create(null),client:void 0,asyncPostInit:async function(){let f=i.initializersAsync;if(delete i.initializersAsync,!f||!f.length)return Promise.resolve(w);f=f.map(_=>(_ instanceof Promise?_:_(w)).catch(F=>{throw console.error("an async sqlite3 initializer failed:",F),F}));const p=()=>(w.__isUnderTest||(delete w.util,delete w.StructBinder),w);{let _=f.shift();for(;f.length;)_=_.then(f.shift());return _.then(p)}},scriptInfo:void 0};try{i.initializers.forEach(f=>{f(w)})}catch(f){throw console.error("sqlite3 bootstrap initializer threw:",f),f}return delete i.initializers,i.sqlite3=w,w},globalThis.sqlite3ApiBootstrap.initializers=[],globalThis.sqlite3ApiBootstrap.initializersAsync=[],globalThis.sqlite3ApiBootstrap.defaultConfig=Object.create(null),globalThis.sqlite3ApiBootstrap.sqlite3=void 0,globalThis.WhWasmUtilInstaller=function(i){var z;i.bigIntEnabled===void 0&&(i.bigIntEnabled=!!self.BigInt64Array);const l=(...g)=>{throw new Error(g.join(" "))};i.exports||Object.defineProperty(i,"exports",{enumerable:!0,configurable:!0,get:()=>i.instance&&i.instance.exports});const a=i.pointerIR||"i32",u=i.ptrSizeof=a==="i32"?4:a==="i64"?8:l("Unhandled ptrSizeof:",a),d=Object.create(null);d.heapSize=0,d.memory=null,d.freeFuncIndexes=[],d.scopedAlloc=[],d.utf8Decoder=new TextDecoder,d.utf8Encoder=new TextEncoder("utf-8"),i.sizeofIR=g=>{switch(g){case"i8":return 1;case"i16":return 2;case"i32":case"f32":case"float":return 4;case"i64":case"f64":case"double":return 8;case"*":return u;default:return(""+g).endsWith("*")?u:void 0}};const N=function(){if(!d.memory)d.memory=i.memory instanceof WebAssembly.Memory?i.memory:i.exports.memory;else if(d.heapSize===d.memory.buffer.byteLength)return d;const g=d.memory.buffer;return d.HEAP8=new Int8Array(g),d.HEAP8U=new Uint8Array(g),d.HEAP16=new Int16Array(g),d.HEAP16U=new Uint16Array(g),d.HEAP32=new Int32Array(g),d.HEAP32U=new Uint32Array(g),i.bigIntEnabled&&(d.HEAP64=new BigInt64Array(g),d.HEAP64U=new BigUint64Array(g)),d.HEAP32F=new Float32Array(g),d.HEAP64F=new Float64Array(g),d.heapSize=g.byteLength,d};i.heap8=()=>N().HEAP8,i.heap8u=()=>N().HEAP8U,i.heap16=()=>N().HEAP16,i.heap16u=()=>N().HEAP16U,i.heap32=()=>N().HEAP32,i.heap32u=()=>N().HEAP32U,i.heapForSize=function(g,v=!0){const A=d.memory&&d.heapSize===d.memory.buffer.byteLength?d:N();switch(g){case Int8Array:return A.HEAP8;case Uint8Array:return A.HEAP8U;case Int16Array:return A.HEAP16;case Uint16Array:return A.HEAP16U;case Int32Array:return A.HEAP32;case Uint32Array:return A.HEAP32U;case 8:return v?A.HEAP8U:A.HEAP8;case 16:return v?A.HEAP16U:A.HEAP16;case 32:return v?A.HEAP32U:A.HEAP32;case 64:if(A.HEAP64)return v?A.HEAP64U:A.HEAP64;break;default:if(i.bigIntEnabled){if(g===self.BigUint64Array)return A.HEAP64U;if(g===self.BigInt64Array)return A.HEAP64;break}}l("Invalid heapForSize() size: expecting 8, 16, 32,","or (if BigInt is enabled) 64.")},i.functionTable=function(){return i.exports.__indirect_function_table},i.functionEntry=function(g){const v=i.functionTable();return g<v.length?v.get(g):void 0},i.jsFuncToWasm=function g(v,A){if(g._||(g._={sigTypes:Object.assign(Object.create(null),{i:"i32",p:"i32",P:"i32",s:"i32",j:"i64",f:"f32",d:"f64"}),typeCodes:Object.assign(Object.create(null),{f64:124,f32:125,i64:126,i32:127}),uleb128Encode:function(f,p,_){_<128?f[p](_):f[p](_%128|128,_>>7)},rxJSig:/^(\w)\((\w*)\)$/,sigParams:function(f){const p=g._.rxJSig.exec(f);return p?p[2]:f.substr(1)},letterType:f=>g._.sigTypes[f]||l("Invalid signature letter:",f),pushSigType:(f,p)=>f.push(g._.typeCodes[g._.letterType(p)])}),typeof v=="string"){const f=A;A=v,v=f}const b=g._.sigParams(A),w=[1,96];g._.uleb128Encode(w,"push",b.length);for(const f of b)g._.pushSigType(w,f);return A[0]==="v"?w.push(0):(w.push(1),g._.pushSigType(w,A[0])),g._.uleb128Encode(w,"unshift",w.length),w.unshift(0,97,115,109,1,0,0,0,1),w.push(2,7,1,1,101,1,102,0,0,7,5,1,1,102,0,0),new WebAssembly.Instance(new WebAssembly.Module(new Uint8Array(w)),{e:{f:v}}).exports.f};const S=function(v,A,b){if(b&&!d.scopedAlloc.length&&l("No scopedAllocPush() scope is active."),typeof v=="string"){const _=A;A=v,v=_}(typeof A!="string"||!(v instanceof Function))&&l("Invalid arguments: expecting (function,signature) or (signature,function).");const w=i.functionTable(),f=w.length;let p;for(;d.freeFuncIndexes.length&&(p=d.freeFuncIndexes.pop(),w.get(p));){p=null;continue}p||(p=f,w.grow(1));try{return w.set(p,v),b&&d.scopedAlloc[d.scopedAlloc.length-1].push(p),p}catch(_){if(!(_ instanceof TypeError))throw p===f&&d.freeFuncIndexes.push(f),_}try{const _=i.jsFuncToWasm(v,A);w.set(p,_),b&&d.scopedAlloc[d.scopedAlloc.length-1].push(p)}catch(_){throw p===f&&d.freeFuncIndexes.push(f),_}return p};i.installFunction=(g,v)=>S(g,v,!1),i.scopedInstallFunction=(g,v)=>S(g,v,!0),i.uninstallFunction=function(g){if(!g&&g!==0)return;const v=d.freeFuncIndexes,A=i.functionTable();v.push(g);const b=A.get(g);return A.set(g,null),b},i.peek=function(v,A="i8"){A.endsWith("*")&&(A=a);const b=d.memory&&d.heapSize===d.memory.buffer.byteLength?d:N(),w=Array.isArray(v)?[]:void 0;let f;do{switch(w&&(v=arguments[0].shift()),A){case"i1":case"i8":f=b.HEAP8[v>>0];break;case"i16":f=b.HEAP16[v>>1];break;case"i32":f=b.HEAP32[v>>2];break;case"float":case"f32":f=b.HEAP32F[v>>2];break;case"double":case"f64":f=Number(b.HEAP64F[v>>3]);break;case"i64":if(i.bigIntEnabled){f=BigInt(b.HEAP64[v>>3]);break}default:l("Invalid type for peek():",A)}w&&w.push(f)}while(w&&arguments[0].length);return w||f},i.poke=function(g,v,A="i8"){A.endsWith("*")&&(A=a);const b=d.memory&&d.heapSize===d.memory.buffer.byteLength?d:N();for(const w of Array.isArray(g)?g:[g])switch(A){case"i1":case"i8":b.HEAP8[w>>0]=v;continue;case"i16":b.HEAP16[w>>1]=v;continue;case"i32":b.HEAP32[w>>2]=v;continue;case"float":case"f32":b.HEAP32F[w>>2]=v;continue;case"double":case"f64":b.HEAP64F[w>>3]=v;continue;case"i64":if(b.HEAP64){b.HEAP64[w>>3]=BigInt(v);continue}default:l("Invalid type for poke(): "+A)}return this},i.peekPtr=(...g)=>i.peek(g.length===1?g[0]:g,a),i.pokePtr=(g,v=0)=>i.poke(g,v,a),i.peek8=(...g)=>i.peek(g.length===1?g[0]:g,"i8"),i.poke8=(g,v)=>i.poke(g,v,"i8"),i.peek16=(...g)=>i.peek(g.length===1?g[0]:g,"i16"),i.poke16=(g,v)=>i.poke(g,v,"i16"),i.peek32=(...g)=>i.peek(g.length===1?g[0]:g,"i32"),i.poke32=(g,v)=>i.poke(g,v,"i32"),i.peek64=(...g)=>i.peek(g.length===1?g[0]:g,"i64"),i.poke64=(g,v)=>i.poke(g,v,"i64"),i.peek32f=(...g)=>i.peek(g.length===1?g[0]:g,"f32"),i.poke32f=(g,v)=>i.poke(g,v,"f32"),i.peek64f=(...g)=>i.peek(g.length===1?g[0]:g,"f64"),i.poke64f=(g,v)=>i.poke(g,v,"f64"),i.getMemValue=i.peek,i.getPtrValue=i.peekPtr,i.setMemValue=i.poke,i.setPtrValue=i.pokePtr,i.isPtr32=g=>typeof g=="number"&&g===(g|0)&&g>=0,i.isPtr=i.isPtr32,i.cstrlen=function(g){if(!g||!i.isPtr(g))return null;const v=N().HEAP8U;let A=g;for(;v[A]!==0;++A);return A-g};const C=typeof SharedArrayBuffer>"u"?function(){}:SharedArrayBuffer,V=function(g,v,A){return d.utf8Decoder.decode(g.buffer instanceof C?g.slice(v,A):g.subarray(v,A))};i.cstrToJs=function(g){const v=i.cstrlen(g);return v?V(N().HEAP8U,g,g+v):v===null?v:""},i.jstrlen=function(g){if(typeof g!="string")return null;const v=g.length;let A=0;for(let b=0;b<v;++b){let w=g.charCodeAt(b);w>=55296&&w<=57343&&(w=65536+((w&1023)<<10)|g.charCodeAt(++b)&1023),w<=127?++A:w<=2047?A+=2:w<=65535?A+=3:A+=4}return A},i.jstrcpy=function(g,v,A=0,b=-1,w=!0){if((!v||!(v instanceof Int8Array)&&!(v instanceof Uint8Array))&&l("jstrcpy() target must be an Int8Array or Uint8Array."),b<0&&(b=v.length-A),!(b>0)||!(A>=0))return 0;let f=0,p=g.length;const _=A,P=A+b-(w?1:0);for(;f<p&&A<P;++f){let F=g.charCodeAt(f);if(F>=55296&&F<=57343&&(F=65536+((F&1023)<<10)|g.charCodeAt(++f)&1023),F<=127){if(A>=P)break;v[A++]=F}else if(F<=2047){if(A+1>=P)break;v[A++]=192|F>>6,v[A++]=128|F&63}else if(F<=65535){if(A+2>=P)break;v[A++]=224|F>>12,v[A++]=128|F>>6&63,v[A++]=128|F&63}else{if(A+3>=P)break;v[A++]=240|F>>18,v[A++]=128|F>>12&63,v[A++]=128|F>>6&63,v[A++]=128|F&63}}return w&&(v[A++]=0),A-_},i.cstrncpy=function(g,v,A){if((!g||!v)&&l("cstrncpy() does not accept NULL strings."),A<0)A=i.cstrlen(strPtr)+1;else if(!(A>0))return 0;const b=i.heap8u();let w=0,f;for(;w<A&&(f=b[v+w]);++w)b[g+w]=f;return w<A&&(b[g+w++]=0),w},i.jstrToUintArray=(g,v=!1)=>d.utf8Encoder.encode(v?g+"\0":g);const K=(g,v)=>{(!(g.alloc instanceof Function)||!(g.dealloc instanceof Function))&&l("Object is missing alloc() and/or dealloc() function(s)","required by",v+"().")},te=function(g,v,A,b){if(K(i,b),typeof g!="string")return null;{const w=d.utf8Encoder.encode(g),f=A(w.length+1),p=N().HEAP8U;return p.set(w,f),p[f+w.length]=0,v?[f,w.length]:f}};i.allocCString=(g,v=!1)=>te(g,v,i.alloc,"allocCString()"),i.scopedAllocPush=function(){K(i,"scopedAllocPush");const g=[];return d.scopedAlloc.push(g),g},i.scopedAllocPop=function(g){K(i,"scopedAllocPop");const v=arguments.length?d.scopedAlloc.indexOf(g):d.scopedAlloc.length-1;v<0&&l("Invalid state object for scopedAllocPop()."),arguments.length===0&&(g=d.scopedAlloc[v]),d.scopedAlloc.splice(v,1);for(let A;A=g.pop();)i.functionEntry(A)?i.uninstallFunction(A):i.dealloc(A)},i.scopedAlloc=function(g){d.scopedAlloc.length||l("No scopedAllocPush() scope is active.");const v=i.alloc(g);return d.scopedAlloc[d.scopedAlloc.length-1].push(v),v},Object.defineProperty(i.scopedAlloc,"level",{configurable:!1,enumerable:!1,get:()=>d.scopedAlloc.length,set:()=>l("The 'active' property is read-only.")}),i.scopedAllocCString=(g,v=!1)=>te(g,v,i.scopedAlloc,"scopedAllocCString()");const k=function(g,v){const A=i[g?"scopedAlloc":"alloc"]((v.length+1)*i.ptrSizeof);let b=0;return v.forEach(w=>{i.pokePtr(A+i.ptrSizeof*b++,i[g?"scopedAllocCString":"allocCString"](""+w))}),i.pokePtr(A+i.ptrSizeof*b,0),A};i.scopedAllocMainArgv=g=>k(!0,g),i.allocMainArgv=g=>k(!1,g),i.cArgvToJs=(g,v)=>{const A=[];for(let b=0;b<g;++b){const w=i.peekPtr(v+i.ptrSizeof*b);A.push(w?i.cstrToJs(w):null)}return A},i.scopedAllocCall=function(g){i.scopedAllocPush();try{return g()}finally{i.scopedAllocPop()}};const m=function(g,v,A){K(i,A);const b=v?"i64":a;let w=i[A](g*(v?8:u));if(i.poke(w,0,b),g===1)return w;const f=[w];for(let p=1;p<g;++p)w+=v?8:u,f[p]=w,i.poke(w,0,b);return f};i.allocPtr=(g=1,v=!0)=>m(g,v,"alloc"),i.scopedAllocPtr=(g=1,v=!0)=>m(g,v,"scopedAlloc"),i.xGet=function(g){return i.exports[g]||l("Cannot find exported symbol:",g)};const y=(g,v)=>l(g+"() requires",v,"argument(s).");i.xCall=function(g,...v){const A=i.xGet(g);return A instanceof Function||l("Exported symbol",g,"is not a function."),A.length!==v.length&&y(g,A.length),arguments.length===2&&Array.isArray(arguments[1])?A.apply(null,arguments[1]):A.apply(null,v)},d.xWrap=Object.create(null),d.xWrap.convert=Object.create(null),d.xWrap.convert.arg=new Map,d.xWrap.convert.result=new Map;const x=d.xWrap.convert.arg,E=d.xWrap.convert.result;i.bigIntEnabled&&x.set("i64",g=>BigInt(g));const q=a==="i32"?g=>g|0:g=>BigInt(g)|BigInt(0);x.set("i32",q).set("i16",g=>(g|0)&65535).set("i8",g=>(g|0)&255).set("f32",g=>Number(g).valueOf()).set("float",x.get("f32")).set("f64",x.get("f32")).set("double",x.get("f64")).set("int",x.get("i32")).set("null",g=>g).set(null,x.get("null")).set("**",q).set("*",q),E.set("*",q).set("pointer",q).set("number",g=>Number(g)).set("void",g=>{}).set("null",g=>g).set(null,E.get("null"));{const g=["i8","i16","i32","int","f32","float","f64","double"];i.bigIntEnabled&&g.push("i64");const v=x.get(a);for(const A of g)x.set(A+"*",v),E.set(A+"*",v),E.set(A,x.get(A)||l("Missing arg converter:",A))}const W=function(g){return typeof g=="string"?i.scopedAllocCString(g):g?q(g):null};x.set("string",W).set("utf8",W).set("pointer",W),E.set("string",g=>i.cstrToJs(g)).set("utf8",E.get("string")).set("string:dealloc",g=>{try{return g?i.cstrToJs(g):null}finally{i.dealloc(g)}}).set("utf8:dealloc",E.get("string:dealloc")).set("json",g=>JSON.parse(i.cstrToJs(g))).set("json:dealloc",g=>{try{return g?JSON.parse(i.cstrToJs(g)):null}finally{i.dealloc(g)}});const M=class{constructor(g){this.name=g.name||"unnamed adapter"}convertArg(g,v,A){l("AbstractArgAdapter must be subclassed.")}};x.FuncPtrAdapter=(z=class extends M{constructor(v){super(v),x.FuncPtrAdapter.warnOnUse&&console.warn("xArg.FuncPtrAdapter is an internal-only API","and is not intended to be invoked from","client-level code. Invoked with:",v),this.signature=v.signature,v.contextKey instanceof Function&&(this.contextKey=v.contextKey,v.bindScope||(v.bindScope="context")),this.bindScope=v.bindScope||l("FuncPtrAdapter options requires a bindScope (explicit or implied)."),z.bindScopes.indexOf(v.bindScope)<0&&l("Invalid options.bindScope ("+v.bindMod+") for FuncPtrAdapter. Expecting one of: ("+z.bindScopes.join(", ")+")"),this.isTransient=this.bindScope==="transient",this.isContext=this.bindScope==="context",this.isPermanent=this.bindScope==="permanent",this.singleton=this.bindScope==="singleton"?[]:void 0,this.callProxy=v.callProxy instanceof Function?v.callProxy:void 0}contextKey(v,A){return this}contextMap(v){const A=this.__cmap||(this.__cmap=new Map);let b=A.get(v);return b===void 0&&A.set(v,b=[]),b}convertArg(v,A,b){let w=this.singleton;if(!w&&this.isContext&&(w=this.contextMap(this.contextKey(A,b))),w&&w[0]===v)return w[1];if(v instanceof Function){this.callProxy&&(v=this.callProxy(v));const f=S(v,this.signature,this.isTransient);if(z.debugFuncInstall&&z.debugOut("FuncPtrAdapter installed",this,this.contextKey(A,b),"@"+f,v),w){if(w[1]){z.debugFuncInstall&&z.debugOut("FuncPtrAdapter uninstalling",this,this.contextKey(A,b),"@"+w[1],v);try{i.uninstallFunction(w[1])}catch{}}w[0]=v,w[1]=f}return f}else if(i.isPtr(v)||v===null||v===void 0){if(w&&w[1]&&w[1]!==v){z.debugFuncInstall&&z.debugOut("FuncPtrAdapter uninstalling",this,this.contextKey(A,b),"@"+w[1],v);try{i.uninstallFunction(w[1])}catch{}w[0]=w[1]=v|0}return v||0}else throw new TypeError("Invalid FuncPtrAdapter argument type. Expecting a function pointer or a "+(this.name?this.name+" ":"")+"function matching signature "+this.signature+".")}},ve(z,"warnOnUse",!1),ve(z,"debugFuncInstall",!1),ve(z,"debugOut",console.debug.bind(console)),ve(z,"bindScopes",["transient","context","singleton","permanent"]),z);const R=g=>x.get(g)||l("Argument adapter not found:",g),L=g=>E.get(g)||l("Result adapter not found:",g);d.xWrap.convertArg=(g,...v)=>R(g)(...v),d.xWrap.convertArgNoCheck=(g,...v)=>x.get(g)(...v),d.xWrap.convertResult=(g,v)=>g===null?v:g?L(g)(v):void 0,d.xWrap.convertResultNoCheck=(g,v)=>g===null?v:g?E.get(g)(v):void 0,i.xWrap=function(g,v,...A){arguments.length===3&&Array.isArray(arguments[2])&&(A=arguments[2]),i.isPtr(g)&&(g=i.functionEntry(g)||l("Function pointer not found in WASM function table."));const b=g instanceof Function,w=b?g:i.xGet(g);if(b&&(g=w.name||"unnamed function"),A.length!==w.length&&y(g,w.length),v===null&&w.length===0)return w;v!=null&&L(v);for(const p of A)p instanceof M?x.set(p,(..._)=>p.convertArg(..._)):R(p);const f=d.xWrap;return w.length===0?(...p)=>p.length?y(g,w.length):f.convertResult(v,w.call(null)):function(...p){p.length!==w.length&&y(g,w.length);const _=i.scopedAllocPush();try{for(const P in p)p[P]=f.convertArgNoCheck(A[P],p[P],p,P);return f.convertResultNoCheck(v,w.apply(null,p))}finally{i.scopedAllocPop(_)}}};const ie=function(g,v,A,b,w,f){if(typeof A=="string"){if(v===1)return f.get(A);if(v===2){if(b)b instanceof Function||l(w,"requires a function argument.");else return delete f.get(A),g;return f.set(A,b),g}}l("Invalid arguments to",w)};return i.xWrap.resultAdapter=function g(v,A){return ie(g,arguments.length,v,A,"resultAdapter()",E)},i.xWrap.argAdapter=function g(v,A){return ie(g,arguments.length,v,A,"argAdapter()",x)},i.xWrap.FuncPtrAdapter=x.FuncPtrAdapter,i.xCallWrapped=function(g,v,A,...b){return Array.isArray(arguments[3])&&(b=arguments[3]),i.xWrap(g,v,A||[]).apply(null,b||[])},i.xWrap.testConvertArg=d.xWrap.convertArg,i.xWrap.testConvertResult=d.xWrap.convertResult,i},globalThis.WhWasmUtilInstaller.yawl=(function(i){const l=()=>fetch(i.uri,{credentials:"same-origin"}),a=this,u=function(N){if(i.wasmUtilTarget){const S=(...V)=>{throw new Error(V.join(" "))},C=i.wasmUtilTarget;if(C.module=N.module,C.instance=N.instance,C.instance.exports.memory||(C.memory=i.imports&&i.imports.env&&i.imports.env.memory||S("Missing 'memory' object!")),!C.alloc&&N.instance.exports.malloc){const V=N.instance.exports;C.alloc=function(K){return V.malloc(K)||S("Allocation of",K,"bytes failed.")},C.dealloc=function(K){V.free(K)}}a(C)}return i.onload&&i.onload(N,i),N};return WebAssembly.instantiateStreaming?function(){return WebAssembly.instantiateStreaming(l(),i.imports||{}).then(u)}:function(){return l().then(S=>S.arrayBuffer()).then(S=>WebAssembly.instantiate(S,i.imports||{})).then(u)}}).bind(globalThis.WhWasmUtilInstaller),globalThis.Jaccwabyt=function i(l){const a=(...T)=>{throw new Error(T.join(" "))};!(l.heap instanceof WebAssembly.Memory)&&!(l.heap instanceof Function)&&a("config.heap must be WebAssembly.Memory instance or a function."),["alloc","dealloc"].forEach(function(T){l[T]instanceof Function||a("Config option '"+T+"' must be a function.")});const u=i,d=l.heap instanceof Function?l.heap:()=>new Uint8Array(l.heap.buffer),N=l.alloc,S=l.dealloc,C=l.log||console.log.bind(console),V=l.memberPrefix||"",K=l.memberSuffix||"",te=l.bigIntEnabled===void 0?!!self.BigInt64Array:!!l.bigIntEnabled,k=self.BigInt,m=self.BigInt64Array,y=l.ptrSizeof||4,x=l.ptrIR||"i32";u.debugFlags||(u.__makeDebugFlags=function(T=null){T&&T.__flags&&(T=T.__flags);const J=function H(X){return arguments.length===0?H.__flags:(X<0?(delete H.__flags.getter,delete H.__flags.setter,delete H.__flags.alloc,delete H.__flags.dealloc):(H.__flags.getter=(1&X)!==0,H.__flags.setter=(2&X)!==0,H.__flags.alloc=(4&X)!==0,H.__flags.dealloc=(8&X)!==0),H._flags)};return Object.defineProperty(J,"__flags",{iterable:!1,writable:!1,value:Object.create(T)}),T||J(0),J},u.debugFlags=u.__makeDebugFlags());const E=function(){const T=new ArrayBuffer(2);return new DataView(T).setInt16(0,256,!0),new Int16Array(T)[0]===256}(),q=T=>T[1]==="(",W=T=>T==="P",M=T=>q(T)?"p":T[0],R=function(T){switch(M(T)){case"c":case"C":return"i8";case"i":return"i32";case"p":case"P":case"s":return x;case"j":return"i64";case"f":return"float";case"d":return"double"}a("Unhandled signature IR:",T)},L=m?()=>!0:()=>a("BigInt64Array is not available."),ie=function(T){switch(M(T)){case"p":case"P":case"s":{switch(y){case 4:return"getInt32";case 8:return L()&&"getBigInt64"}break}case"i":return"getInt32";case"c":return"getInt8";case"C":return"getUint8";case"j":return L()&&"getBigInt64";case"f":return"getFloat32";case"d":return"getFloat64"}a("Unhandled DataView getter for signature:",T)},z=function(T){switch(M(T)){case"p":case"P":case"s":{switch(y){case 4:return"setInt32";case 8:return L()&&"setBigInt64"}break}case"i":return"setInt32";case"c":return"setInt8";case"C":return"setUint8";case"j":return L()&&"setBigInt64";case"f":return"setFloat32";case"d":return"setFloat64"}a("Unhandled DataView setter for signature:",T)},g=function(T){switch(M(T)){case"i":case"f":case"c":case"C":case"d":return Number;case"j":return L()&&k;case"p":case"P":case"s":switch(y){case 4:return Number;case 8:return L()&&k}break}a("Unhandled DataView set wrapper for signature:",T)},v=(T,J)=>T+"::"+J,A=function(T,J){return()=>a(v(T,J),"is read-only.")},b=new WeakMap,w="(pointer-is-external)",f=function(T,J,H){if(H||(H=b.get(J)),H){if(b.delete(J),Array.isArray(J.ondispose)){let X;for(;X=J.ondispose.shift();)try{X instanceof Function?X.call(J):X instanceof we?X.dispose():typeof X=="number"&&S(X)}catch(Ae){console.warn("ondispose() for",T.structName,"@",H,"threw. NOT propagating it.",Ae)}}else if(J.ondispose instanceof Function)try{J.ondispose()}catch(X){console.warn("ondispose() for",T.structName,"@",H,"threw. NOT propagating it.",X)}delete J.ondispose,T.debugFlags.__flags.dealloc&&C("debug.dealloc:",J[w]?"EXTERNAL":"",T.structName,"instance:",T.structInfo.sizeof,"bytes @"+H),J[w]||S(H)}},p=T=>({configurable:!1,writable:!1,iterable:!1,value:T}),_=function(T,J,H){let X=!H;H?Object.defineProperty(J,w,p(H)):(H=N(T.structInfo.sizeof),H||a("Allocation of",T.structName,"structure failed."));try{T.debugFlags.__flags.alloc&&C("debug.alloc:",X?"":"EXTERNAL",T.structName,"instance:",T.structInfo.sizeof,"bytes @"+H),X&&d().fill(0,H,H+T.structInfo.sizeof),b.set(J,H)}catch(Ae){throw f(T,J,H),Ae}},P=function(){const T=this.pointer;return T?new Uint8Array(d().slice(T,T+this.structInfo.sizeof)):null},ne=p(T=>V+T+K),re=function(T,J,H=!0){let X=T.members[J];if(!X&&(V||K)){for(const Ae of Object.values(T.members))if(Ae.key===J){X=Ae;break}!X&&H&&a(v(T.name,J),"is not a mapped struct member.")}return X},se=function T(J,H,X=!1){T._||(T._=Re=>Re.replace(/[^vipPsjrdcC]/g,"").replace(/[pPscC]/g,"i"));const Ae=re(J.structInfo,H,!0);return X?T._(Ae.signature):Ae.signature},fe={configurable:!1,enumerable:!1,get:function(){return b.get(this)},set:()=>a("Cannot assign the 'pointer' property of a struct.")},le=p(function(){const T=[];for(const J of Object.keys(this.structInfo.members))T.push(this.memberKey(J));return T}),be=new TextDecoder("utf-8"),Ve=new TextEncoder,dt=typeof SharedArrayBuffer>"u"?function(){}:SharedArrayBuffer,en=function(T,J,H){return be.decode(T.buffer instanceof dt?T.slice(J,H):T.subarray(J,H))},I=function(T,J,H=!1){const X=re(T.structInfo,J,H);return X&&X.signature.length===1&&X.signature[0]==="s"?X:!1},B=function(T){T.signature!=="s"&&a("Invalid member type signature for C-string value:",JSON.stringify(T))},Q=function(J,H){const X=re(J.structInfo,H,!0);B(X);const Ae=J[X.key];if(!Ae)return null;let Re=Ae;const Ce=d();for(;Ce[Re]!==0;++Re);return Ae===Re?"":en(Ce,Ae,Re)},Z=function(T,...J){T.ondispose?Array.isArray(T.ondispose)||(T.ondispose=[T.ondispose]):T.ondispose=[],T.ondispose.push(...J)},$=function(T){const J=Ve.encode(T),H=N(J.length+1);H||a("Allocation error while duplicating string:",T);const X=d();return X.set(J,H),X[H+J.length]=0,H},qe=function(T,J,H){const X=re(T.structInfo,J,!0);B(X);const Ae=$(H);return T[X.key]=Ae,Z(T,Ae),T},we=function(J,H){arguments[2]!==p&&a("Do not call the StructType constructor","from client-level code."),Object.defineProperties(this,{structName:p(J),structInfo:p(H)})};we.prototype=Object.create(null,{dispose:p(function(){f(this.constructor,this)}),lookupMember:p(function(T,J=!0){return re(this.structInfo,T,J)}),memberToJsString:p(function(T){return Q(this,T)}),memberIsString:p(function(T,J=!0){return I(this,T,J)}),memberKey:ne,memberKeys:le,memberSignature:p(function(T,J=!1){return se(this,T,J)}),memoryDump:p(P),pointer:fe,setMemberCString:p(function(T,J){return qe(this,T,J)})}),Object.assign(we.prototype,{addOnDispose:function(...T){return Z(this,...T),this}}),Object.defineProperties(we,{allocCString:p($),isA:p(T=>T instanceof we),hasExternalPointer:p(T=>T instanceof we&&!!T[w]),memberKey:ne});const ee=T=>Number.isFinite(T)||T instanceof(k||Number),Lt=function T(J,H,X){if(!T._){T._={getters:{},setters:{},sw:{}};const gt=["i","c","C","p","P","s","f","d","v()"];te&&gt.push("j"),gt.forEach(function(tn){T._.getters[tn]=ie(tn),T._.setters[tn]=z(tn),T._.sw[tn]=g(tn)});const bd=/^[ipPsjfdcC]$/,qd=/^[vipPsjfdcC]\([ipPsjfdcC]*\)$/;T.sigCheck=function(tn,Nd,Ha,bo){Object.prototype.hasOwnProperty.call(tn,Ha)&&a(tn.structName,"already has a property named",Ha+"."),bd.test(bo)||qd.test(bo)||a("Malformed signature for",v(tn.structName,Nd)+":",bo)}}const Ae=J.memberKey(H);T.sigCheck(J.prototype,H,Ae,X.signature),X.key=Ae,X.name=H;const Re=M(X.signature),Ce=v(J.prototype.structName,Ae),ze=J.prototype.debugFlags.__flags,Pr=Object.create(null);Pr.configurable=!1,Pr.enumerable=!1,Pr.get=function(){ze.getter&&C("debug.getter:",T._.getters[Re],"for",R(Re),Ce,"@",this.pointer,"+",X.offset,"sz",X.sizeof);let gt=new DataView(d().buffer,this.pointer+X.offset,X.sizeof)[T._.getters[Re]](0,E);return ze.getter&&C("debug.getter:",Ce,"result =",gt),gt},X.readOnly?Pr.set=A(J.prototype.structName,Ae):Pr.set=function(gt){if(ze.setter&&C("debug.setter:",T._.setters[Re],"for",R(Re),Ce,"@",this.pointer,"+",X.offset,"sz",X.sizeof,gt),this.pointer||a("Cannot set struct property on disposed instance."),gt===null)gt=0;else for(;!ee(gt);){if(W(X.signature)&&gt instanceof we){gt=gt.pointer||0,ze.setter&&C("debug.setter:",Ce,"resolved to",gt);break}a("Invalid value for pointer-type",Ce+".")}new DataView(d().buffer,this.pointer+X.offset,X.sizeof)[T._.setters[Re]](0,T._.sw[Re](gt),E)},Object.defineProperty(J.prototype,Ae,Pr)},ot=function T(J,H){arguments.length===1?(H=J,J=H.name):H.name||(H.name=J),J||a("Struct name is required.");let X=!1;Object.keys(H.members).forEach(Ce=>{const ze=H.members[Ce];ze.sizeof?ze.sizeof===1?ze.signature==="c"||ze.signature==="C"||a("Unexpected sizeof==1 member",v(H.name,Ce),"with signature",ze.signature):(ze.sizeof%4!==0&&(console.warn("Invalid struct member description =",ze,"from",H),a(J,"member",Ce,"sizeof is not aligned. sizeof="+ze.sizeof)),ze.offset%4!==0&&(console.warn("Invalid struct member description =",ze,"from",H),a(J,"member",Ce,"offset is not aligned. offset="+ze.offset))):a(J,"member",Ce,"is missing sizeof."),(!X||X.offset<ze.offset)&&(X=ze)}),X?H.sizeof<X.offset+X.sizeof&&a("Invalid struct config:",J,"max member offset ("+X.offset+") ","extends past end of struct (sizeof="+H.sizeof+")."):a("No member property descriptions found.");const Ae=p(u.__makeDebugFlags(T.debugFlags)),Re=function Ce(ze){this instanceof Ce?arguments.length?((ze!==(ze|0)||ze<=0)&&a("Invalid pointer value for",J,"constructor."),_(Ce,this,ze)):_(Ce,this):a("The",J,"constructor may only be called via 'new'.")};return Object.defineProperties(Re,{debugFlags:Ae,isA:p(Ce=>Ce instanceof Re),memberKey:ne,memberKeys:le,methodInfoForKey:p(function(Ce){}),structInfo:p(H),structName:p(J)}),Re.prototype=new we(J,H,p),Object.defineProperties(Re.prototype,{debugFlags:Ae,constructor:p(Re)}),Object.keys(H.members).forEach(Ce=>Lt(Re,Ce,H.members[Ce])),Re};return ot.StructType=we,ot.config=l,ot.allocCString=$,ot.debugFlags||(ot.debugFlags=u.__makeDebugFlags(u.debugFlags)),ot},globalThis.sqlite3ApiBootstrap.initializers.push(function(i){const l=(...k)=>{throw new Error(k.join(" "))};i.SQLite3Error.toss;const a=i.capi,u=i.wasm,d=i.util;if(globalThis.WhWasmUtilInstaller(u),delete globalThis.WhWasmUtilInstaller,u.bindingSignatures=[["sqlite3_aggregate_context","void*","sqlite3_context*","int"],["sqlite3_bind_double","int","sqlite3_stmt*","int","f64"],["sqlite3_bind_int","int","sqlite3_stmt*","int","int"],["sqlite3_bind_null",void 0,"sqlite3_stmt*","int"],["sqlite3_bind_parameter_count","int","sqlite3_stmt*"],["sqlite3_bind_parameter_index","int","sqlite3_stmt*","string"],["sqlite3_bind_pointer","int","sqlite3_stmt*","int","*","string:static","*"],["sqlite3_busy_handler","int",["sqlite3*",new u.xWrap.FuncPtrAdapter({signature:"i(pi)",contextKey:(k,m)=>k[0]}),"*"]],["sqlite3_busy_timeout","int","sqlite3*","int"],["sqlite3_changes","int","sqlite3*"],["sqlite3_clear_bindings","int","sqlite3_stmt*"],["sqlite3_collation_needed","int","sqlite3*","*","*"],["sqlite3_column_blob","*","sqlite3_stmt*","int"],["sqlite3_column_bytes","int","sqlite3_stmt*","int"],["sqlite3_column_count","int","sqlite3_stmt*"],["sqlite3_column_double","f64","sqlite3_stmt*","int"],["sqlite3_column_int","int","sqlite3_stmt*","int"],["sqlite3_column_name","string","sqlite3_stmt*","int"],["sqlite3_column_text","string","sqlite3_stmt*","int"],["sqlite3_column_type","int","sqlite3_stmt*","int"],["sqlite3_column_value","sqlite3_value*","sqlite3_stmt*","int"],["sqlite3_commit_hook","void*",["sqlite3*",new u.xWrap.FuncPtrAdapter({name:"sqlite3_commit_hook",signature:"i(p)",contextKey:k=>k[0]}),"*"]],["sqlite3_compileoption_get","string","int"],["sqlite3_compileoption_used","int","string"],["sqlite3_complete","int","string:flexible"],["sqlite3_context_db_handle","sqlite3*","sqlite3_context*"],["sqlite3_data_count","int","sqlite3_stmt*"],["sqlite3_db_filename","string","sqlite3*","string"],["sqlite3_db_handle","sqlite3*","sqlite3_stmt*"],["sqlite3_db_name","string","sqlite3*","int"],["sqlite3_db_status","int","sqlite3*","int","*","*","int"],["sqlite3_errcode","int","sqlite3*"],["sqlite3_errmsg","string","sqlite3*"],["sqlite3_error_offset","int","sqlite3*"],["sqlite3_errstr","string","int"],["sqlite3_exec","int",["sqlite3*","string:flexible",new u.xWrap.FuncPtrAdapter({signature:"i(pipp)",bindScope:"transient",callProxy:k=>{let m;return(y,x,E,q)=>{try{const W=u.cArgvToJs(x,E);return m||(m=u.cArgvToJs(x,q)),k(W,m)|0}catch(W){return W.resultCode||a.SQLITE_ERROR}}}}),"*","**"]],["sqlite3_expanded_sql","string","sqlite3_stmt*"],["sqlite3_extended_errcode","int","sqlite3*"],["sqlite3_extended_result_codes","int","sqlite3*","int"],["sqlite3_file_control","int","sqlite3*","string","int","*"],["sqlite3_finalize","int","sqlite3_stmt*"],["sqlite3_free",void 0,"*"],["sqlite3_get_auxdata","*","sqlite3_context*","int"],["sqlite3_initialize",void 0],["sqlite3_keyword_count","int"],["sqlite3_keyword_name","int",["int","**","*"]],["sqlite3_keyword_check","int",["string","int"]],["sqlite3_libversion","string"],["sqlite3_libversion_number","int"],["sqlite3_limit","int",["sqlite3*","int","int"]],["sqlite3_malloc","*","int"],["sqlite3_open","int","string","*"],["sqlite3_open_v2","int","string","*","int","string"],["sqlite3_progress_handler",void 0,["sqlite3*","int",new u.xWrap.FuncPtrAdapter({name:"xProgressHandler",signature:"i(p)",bindScope:"context",contextKey:(k,m)=>k[0]}),"*"]],["sqlite3_realloc","*","*","int"],["sqlite3_reset","int","sqlite3_stmt*"],["sqlite3_result_blob",void 0,"sqlite3_context*","*","int","*"],["sqlite3_result_double",void 0,"sqlite3_context*","f64"],["sqlite3_result_error",void 0,"sqlite3_context*","string","int"],["sqlite3_result_error_code",void 0,"sqlite3_context*","int"],["sqlite3_result_error_nomem",void 0,"sqlite3_context*"],["sqlite3_result_error_toobig",void 0,"sqlite3_context*"],["sqlite3_result_int",void 0,"sqlite3_context*","int"],["sqlite3_result_null",void 0,"sqlite3_context*"],["sqlite3_result_pointer",void 0,"sqlite3_context*","*","string:static","*"],["sqlite3_result_subtype",void 0,"sqlite3_value*","int"],["sqlite3_result_text",void 0,"sqlite3_context*","string","int","*"],["sqlite3_result_zeroblob",void 0,"sqlite3_context*","int"],["sqlite3_rollback_hook","void*",["sqlite3*",new u.xWrap.FuncPtrAdapter({name:"sqlite3_rollback_hook",signature:"v(p)",contextKey:k=>k[0]}),"*"]],["sqlite3_set_authorizer","int",["sqlite3*",new u.xWrap.FuncPtrAdapter({name:"sqlite3_set_authorizer::xAuth",signature:"i(pissss)",contextKey:(k,m)=>k[0],callProxy:k=>(m,y,x,E,q,W)=>{try{return x=x&&u.cstrToJs(x),E=E&&u.cstrToJs(E),q=q&&u.cstrToJs(q),W=W&&u.cstrToJs(W),k(m,y,x,E,q,W)||0}catch(M){return M.resultCode||a.SQLITE_ERROR}}}),"*"]],["sqlite3_set_auxdata",void 0,["sqlite3_context*","int","*",new u.xWrap.FuncPtrAdapter({name:"xDestroyAuxData",signature:"v(*)",contextKey:(k,m)=>k[0]})]],["sqlite3_shutdown",void 0],["sqlite3_sourceid","string"],["sqlite3_sql","string","sqlite3_stmt*"],["sqlite3_status","int","int","*","*","int"],["sqlite3_step","int","sqlite3_stmt*"],["sqlite3_stmt_isexplain","int",["sqlite3_stmt*"]],["sqlite3_stmt_readonly","int",["sqlite3_stmt*"]],["sqlite3_stmt_status","int","sqlite3_stmt*","int","int"],["sqlite3_strglob","int","string","string"],["sqlite3_stricmp","int","string","string"],["sqlite3_strlike","int","string","string","int"],["sqlite3_strnicmp","int","string","string","int"],["sqlite3_table_column_metadata","int","sqlite3*","string","string","string","**","**","*","*","*"],["sqlite3_total_changes","int","sqlite3*"],["sqlite3_trace_v2","int",["sqlite3*","int",new u.xWrap.FuncPtrAdapter({name:"sqlite3_trace_v2::callback",signature:"i(ippp)",contextKey:(k,m)=>k[0]}),"*"]],["sqlite3_txn_state","int",["sqlite3*","string"]],["sqlite3_uri_boolean","int","sqlite3_filename","string","int"],["sqlite3_uri_key","string","sqlite3_filename","int"],["sqlite3_uri_parameter","string","sqlite3_filename","string"],["sqlite3_user_data","void*","sqlite3_context*"],["sqlite3_value_blob","*","sqlite3_value*"],["sqlite3_value_bytes","int","sqlite3_value*"],["sqlite3_value_double","f64","sqlite3_value*"],["sqlite3_value_dup","sqlite3_value*","sqlite3_value*"],["sqlite3_value_free",void 0,"sqlite3_value*"],["sqlite3_value_frombind","int","sqlite3_value*"],["sqlite3_value_int","int","sqlite3_value*"],["sqlite3_value_nochange","int","sqlite3_value*"],["sqlite3_value_numeric_type","int","sqlite3_value*"],["sqlite3_value_pointer","*","sqlite3_value*","string:static"],["sqlite3_value_subtype","int","sqlite3_value*"],["sqlite3_value_text","string","sqlite3_value*"],["sqlite3_value_type","int","sqlite3_value*"],["sqlite3_vfs_find","*","string"],["sqlite3_vfs_register","int","sqlite3_vfs*","int"],["sqlite3_vfs_unregister","int","sqlite3_vfs*"]],u.exports.sqlite3_activate_see instanceof Function&&u.bindingSignatures.push(["sqlite3_key","int","sqlite3*","string","int"],["sqlite3_key_v2","int","sqlite3*","string","*","int"],["sqlite3_rekey","int","sqlite3*","string","int"],["sqlite3_rekey_v2","int","sqlite3*","string","*","int"],["sqlite3_activate_see",void 0,"string"]),u.bindingSignatures.int64=[["sqlite3_bind_int64","int",["sqlite3_stmt*","int","i64"]],["sqlite3_changes64","i64",["sqlite3*"]],["sqlite3_column_int64","i64",["sqlite3_stmt*","int"]],["sqlite3_create_module","int",["sqlite3*","string","sqlite3_module*","*"]],["sqlite3_create_module_v2","int",["sqlite3*","string","sqlite3_module*","*","*"]],["sqlite3_declare_vtab","int",["sqlite3*","string:flexible"]],["sqlite3_deserialize","int","sqlite3*","string","*","i64","i64","int"],["sqlite3_drop_modules","int",["sqlite3*","**"]],["sqlite3_last_insert_rowid","i64",["sqlite3*"]],["sqlite3_malloc64","*","i64"],["sqlite3_msize","i64","*"],["sqlite3_overload_function","int",["sqlite3*","string","int"]],["sqlite3_preupdate_blobwrite","int","sqlite3*"],["sqlite3_preupdate_count","int","sqlite3*"],["sqlite3_preupdate_depth","int","sqlite3*"],["sqlite3_preupdate_hook","*",["sqlite3*",new u.xWrap.FuncPtrAdapter({name:"sqlite3_preupdate_hook",signature:"v(ppippjj)",contextKey:k=>k[0],callProxy:k=>(m,y,x,E,q,W,M)=>{k(m,y,x,u.cstrToJs(E),u.cstrToJs(q),W,M)}}),"*"]],["sqlite3_preupdate_new","int",["sqlite3*","int","**"]],["sqlite3_preupdate_old","int",["sqlite3*","int","**"]],["sqlite3_realloc64","*","*","i64"],["sqlite3_result_int64",void 0,"*","i64"],["sqlite3_result_zeroblob64","int","*","i64"],["sqlite3_serialize","*","sqlite3*","string","*","int"],["sqlite3_set_last_insert_rowid",void 0,["sqlite3*","i64"]],["sqlite3_status64","int","int","*","*","int"],["sqlite3_total_changes64","i64",["sqlite3*"]],["sqlite3_update_hook","*",["sqlite3*",new u.xWrap.FuncPtrAdapter({name:"sqlite3_update_hook",signature:"v(iippj)",contextKey:k=>k[0],callProxy:k=>(m,y,x,E,q)=>{k(m,y,u.cstrToJs(x),u.cstrToJs(E),q)}}),"*"]],["sqlite3_uri_int64","i64",["sqlite3_filename","string","i64"]],["sqlite3_value_int64","i64","sqlite3_value*"],["sqlite3_vtab_collation","string","sqlite3_index_info*","int"],["sqlite3_vtab_distinct","int","sqlite3_index_info*"],["sqlite3_vtab_in","int","sqlite3_index_info*","int","int"],["sqlite3_vtab_in_first","int","sqlite3_value*","**"],["sqlite3_vtab_in_next","int","sqlite3_value*","**"],["sqlite3_vtab_nochange","int","sqlite3_context*"],["sqlite3_vtab_on_conflict","int","sqlite3*"],["sqlite3_vtab_rhs_value","int","sqlite3_index_info*","int","**"]],u.bigIntEnabled&&u.exports.sqlite3changegroup_add){const k={signature:"i(ps)",callProxy:m=>(y,x)=>{try{return m(y,u.cstrToJs(x))|0}catch(E){return E.resultCode||a.SQLITE_ERROR}}};u.bindingSignatures.int64.push(["sqlite3changegroup_add","int",["sqlite3_changegroup*","int","void*"]],["sqlite3changegroup_add_strm","int",["sqlite3_changegroup*",new u.xWrap.FuncPtrAdapter({name:"xInput",signature:"i(ppp)",bindScope:"transient"}),"void*"]],["sqlite3changegroup_delete",void 0,["sqlite3_changegroup*"]],["sqlite3changegroup_new","int",["**"]],["sqlite3changegroup_output","int",["sqlite3_changegroup*","int*","**"]],["sqlite3changegroup_output_strm","int",["sqlite3_changegroup*",new u.xWrap.FuncPtrAdapter({name:"xOutput",signature:"i(ppi)",bindScope:"transient"}),"void*"]],["sqlite3changeset_apply","int",["sqlite3*","int","void*",new u.xWrap.FuncPtrAdapter({name:"xFilter",bindScope:"transient",...k}),new u.xWrap.FuncPtrAdapter({name:"xConflict",signature:"i(pip)",bindScope:"transient"}),"void*"]],["sqlite3changeset_apply_strm","int",["sqlite3*",new u.xWrap.FuncPtrAdapter({name:"xInput",signature:"i(ppp)",bindScope:"transient"}),"void*",new u.xWrap.FuncPtrAdapter({name:"xFilter",bindScope:"transient",...k}),new u.xWrap.FuncPtrAdapter({name:"xConflict",signature:"i(pip)",bindScope:"transient"}),"void*"]],["sqlite3changeset_apply_v2","int",["sqlite3*","int","void*",new u.xWrap.FuncPtrAdapter({name:"xFilter",bindScope:"transient",...k}),new u.xWrap.FuncPtrAdapter({name:"xConflict",signature:"i(pip)",bindScope:"transient"}),"void*","**","int*","int"]],["sqlite3changeset_apply_v2_strm","int",["sqlite3*",new u.xWrap.FuncPtrAdapter({name:"xInput",signature:"i(ppp)",bindScope:"transient"}),"void*",new u.xWrap.FuncPtrAdapter({name:"xFilter",bindScope:"transient",...k}),new u.xWrap.FuncPtrAdapter({name:"xConflict",signature:"i(pip)",bindScope:"transient"}),"void*","**","int*","int"]],["sqlite3changeset_concat","int",["int","void*","int","void*","int*","**"]],["sqlite3changeset_concat_strm","int",[new u.xWrap.FuncPtrAdapter({name:"xInputA",signature:"i(ppp)",bindScope:"transient"}),"void*",new u.xWrap.FuncPtrAdapter({name:"xInputB",signature:"i(ppp)",bindScope:"transient"}),"void*",new u.xWrap.FuncPtrAdapter({name:"xOutput",signature:"i(ppi)",bindScope:"transient"}),"void*"]],["sqlite3changeset_conflict","int",["sqlite3_changeset_iter*","int","**"]],["sqlite3changeset_finalize","int",["sqlite3_changeset_iter*"]],["sqlite3changeset_fk_conflicts","int",["sqlite3_changeset_iter*","int*"]],["sqlite3changeset_invert","int",["int","void*","int*","**"]],["sqlite3changeset_invert_strm","int",[new u.xWrap.FuncPtrAdapter({name:"xInput",signature:"i(ppp)",bindScope:"transient"}),"void*",new u.xWrap.FuncPtrAdapter({name:"xOutput",signature:"i(ppi)",bindScope:"transient"}),"void*"]],["sqlite3changeset_new","int",["sqlite3_changeset_iter*","int","**"]],["sqlite3changeset_next","int",["sqlite3_changeset_iter*"]],["sqlite3changeset_old","int",["sqlite3_changeset_iter*","int","**"]],["sqlite3changeset_op","int",["sqlite3_changeset_iter*","**","int*","int*","int*"]],["sqlite3changeset_pk","int",["sqlite3_changeset_iter*","**","int*"]],["sqlite3changeset_start","int",["**","int","*"]],["sqlite3changeset_start_strm","int",["**",new u.xWrap.FuncPtrAdapter({name:"xInput",signature:"i(ppp)",bindScope:"transient"}),"void*"]],["sqlite3changeset_start_v2","int",["**","int","*","int"]],["sqlite3changeset_start_v2_strm","int",["**",new u.xWrap.FuncPtrAdapter({name:"xInput",signature:"i(ppp)",bindScope:"transient"}),"void*","int"]],["sqlite3session_attach","int",["sqlite3_session*","string"]],["sqlite3session_changeset","int",["sqlite3_session*","int*","**"]],["sqlite3session_changeset_size","i64",["sqlite3_session*"]],["sqlite3session_changeset_strm","int",["sqlite3_session*",new u.xWrap.FuncPtrAdapter({name:"xOutput",signature:"i(ppp)",bindScope:"transient"}),"void*"]],["sqlite3session_config","int",["int","void*"]],["sqlite3session_create","int",["sqlite3*","string","**"]],["sqlite3session_diff","int",["sqlite3_session*","string","string","**"]],["sqlite3session_enable","int",["sqlite3_session*","int"]],["sqlite3session_indirect","int",["sqlite3_session*","int"]],["sqlite3session_isempty","int",["sqlite3_session*"]],["sqlite3session_memory_used","i64",["sqlite3_session*"]],["sqlite3session_object_config","int",["sqlite3_session*","int","void*"]],["sqlite3session_patchset","int",["sqlite3_session*","*","**"]],["sqlite3session_patchset_strm","int",["sqlite3_session*",new u.xWrap.FuncPtrAdapter({name:"xOutput",signature:"i(ppp)",bindScope:"transient"}),"void*"]],["sqlite3session_table_filter",void 0,["sqlite3_session*",new u.xWrap.FuncPtrAdapter({name:"xFilter",...k,contextKey:(m,y)=>m[0]}),"*"]])}u.bindingSignatures.wasm=[["sqlite3_wasm_db_reset","int","sqlite3*"],["sqlite3_wasm_db_vfs","sqlite3_vfs*","sqlite3*","string"],["sqlite3_wasm_vfs_create_file","int","sqlite3_vfs*","string","*","int"],["sqlite3_wasm_vfs_unlink","int","sqlite3_vfs*","string"]],i.StructBinder=globalThis.Jaccwabyt({heap:u.heap8u,alloc:u.alloc,dealloc:u.dealloc,bigIntEnabled:u.bigIntEnabled,memberPrefix:"$"}),delete globalThis.Jaccwabyt;{const k=u.xWrap.argAdapter("string");u.xWrap.argAdapter("string:flexible",q=>k(d.flexibleString(q))),u.xWrap.argAdapter("string:static",(function(q){return u.isPtr(q)?q:(q=""+q,this[q]||(this[q]=u.allocCString(q)))}).bind(Object.create(null)));const m=u.xWrap.argAdapter("*"),y=function(){};u.xWrap.argAdapter("sqlite3_filename",m)("sqlite3_context*",m)("sqlite3_value*",m)("void*",m)("sqlite3_changegroup*",m)("sqlite3_changeset_iter*",m)("sqlite3_session*",m)("sqlite3_stmt*",q=>{var W;return m(q instanceof(((W=i==null?void 0:i.oo1)==null?void 0:W.Stmt)||y)?q.pointer:q)})("sqlite3*",q=>{var W;return m(q instanceof(((W=i==null?void 0:i.oo1)==null?void 0:W.DB)||y)?q.pointer:q)})("sqlite3_index_info*",q=>m(q instanceof(a.sqlite3_index_info||y)?q.pointer:q))("sqlite3_module*",q=>m(q instanceof(a.sqlite3_module||y)?q.pointer:q))("sqlite3_vfs*",q=>typeof q=="string"?a.sqlite3_vfs_find(q)||i.SQLite3Error.toss(a.SQLITE_NOTFOUND,"Unknown sqlite3_vfs name:",q):m(q instanceof(a.sqlite3_vfs||y)?q.pointer:q));const x=u.xWrap.resultAdapter("*");u.xWrap.resultAdapter("sqlite3*",x)("sqlite3_context*",x)("sqlite3_stmt*",x)("sqlite3_value*",x)("sqlite3_vfs*",x)("void*",x);for(const q of u.bindingSignatures)a[q[0]]=u.xWrap.apply(null,q);for(const q of u.bindingSignatures.wasm)u[q[0]]=u.xWrap.apply(null,q);const E=function(q){return()=>l(q+"() is unavailable due to lack","of BigInt support in this build.")};for(const q of u.bindingSignatures.int64)a[q[0]]=u.bigIntEnabled?u.xWrap.apply(null,q):E(q[0]);if(delete u.bindingSignatures,u.exports.sqlite3_wasm_db_error){const q=u.xWrap("sqlite3_wasm_db_error","int","sqlite3*","int","string");d.sqlite3_wasm_db_error=function(W,M,R){return M instanceof i.WasmAllocError?(M=a.SQLITE_NOMEM,R=0):M instanceof Error&&(R=R||""+M,M=M.resultCode||a.SQLITE_ERROR),W?q(W,M,R):M}}else d.sqlite3_wasm_db_error=function(q,W,M){return console.warn("sqlite3_wasm_db_error() is not exported.",arguments),W}}{const k=u.xCall("sqlite3_wasm_enum_json");k||l("Maintenance required: increase sqlite3_wasm_enum_json()'s","static buffer size!"),u.ctype=JSON.parse(u.cstrToJs(k));const m=["access","authorizer","blobFinalizers","changeset","config","dataTypes","dbConfig","dbStatus","encodings","fcntl","flock","ioCap","limits","openFlags","prepareFlags","resultCodes","sqlite3Status","stmtStatus","syncFlags","trace","txnState","udfFlags","version"];u.bigIntEnabled&&m.push("serialize","session","vtab");for(const E of m)for(const q of Object.entries(u.ctype[E]))a[q[0]]=q[1];u.functionEntry(a.SQLITE_WASM_DEALLOC)||l("Internal error: cannot resolve exported function","entry SQLITE_WASM_DEALLOC (=="+a.SQLITE_WASM_DEALLOC+").");const y=Object.create(null);for(const E of["resultCodes"])for(const q of Object.entries(u.ctype[E]))y[q[1]]=q[0];a.sqlite3_js_rc_str=E=>y[E];const x=Object.assign(Object.create(null),{WasmTestStruct:!0,sqlite3_kvvfs_methods:!d.isUIThread(),sqlite3_index_info:!u.bigIntEnabled,sqlite3_index_constraint:!u.bigIntEnabled,sqlite3_index_orderby:!u.bigIntEnabled,sqlite3_index_constraint_usage:!u.bigIntEnabled});for(const E of u.ctype.structs)x[E.name]||(a[E.name]=i.StructBinder(E));if(a.sqlite3_index_info){for(const E of["sqlite3_index_constraint","sqlite3_index_orderby","sqlite3_index_constraint_usage"])a.sqlite3_index_info[E]=a[E],delete a[E];a.sqlite3_vtab_config=u.xWrap("sqlite3_wasm_vtab_config","int",["sqlite3*","int","int"])}}const N=(k,m,y)=>i.util.sqlite3_wasm_db_error(k,a.SQLITE_MISUSE,m+"() requires "+y+" argument"+(y===1?"":"s")+"."),S=k=>d.sqlite3_wasm_db_error(k,a.SQLITE_FORMAT,"SQLITE_UTF8 is the only supported encoding."),C=k=>u.xWrap.argAdapter("sqlite3*")(k),V=k=>u.isPtr(k)?u.cstrToJs(k):k,K=(function(k,m){k=C(k);let y=this.dbMap.get(k);if(m)!y&&m>0&&this.dbMap.set(k,y=Object.create(null));else return this.dbMap.delete(k),y;return y}).bind(Object.assign(Object.create(null),{dbMap:new Map}));K.addCollation=function(k,m){const y=K(k,1);y.collation||(y.collation=new Set),y.collation.add(V(m).toLowerCase())},K._addUDF=function(k,m,y,x){m=V(m).toLowerCase();let E=x.get(m);E||x.set(m,E=new Set),E.add(y<0?-1:y)},K.addFunction=function(k,m,y){const x=K(k,1);x.udf||(x.udf=new Map),this._addUDF(k,m,y,x.udf)},K.addWindowFunc=function(k,m,y){const x=K(k,1);x.wudf||(x.wudf=new Map),this._addUDF(k,m,y,x.wudf)},K.cleanup=function(k){k=C(k);const m=[k];for(const E of["sqlite3_busy_handler","sqlite3_commit_hook","sqlite3_preupdate_hook","sqlite3_progress_handler","sqlite3_rollback_hook","sqlite3_set_authorizer","sqlite3_trace_v2","sqlite3_update_hook"]){const q=u.exports[E];m.length=q.length;try{a[E](...m)}catch(W){console.warn("close-time call of",E+"(",m,") threw:",W)}}const y=K(k,0);if(!y)return;if(y.collation){for(const E of y.collation)try{a.sqlite3_create_collation_v2(k,E,a.SQLITE_UTF8,0,0,0)}catch{}delete y.collation}let x;for(x=0;x<2;++x){const E=x?y.wudf:y.udf;if(!E)continue;const q=x?a.sqlite3_create_window_function:a.sqlite3_create_function_v2;for(const W of E){const M=W[0],R=W[1],L=[k,M,0,a.SQLITE_UTF8,0,0,0,0,0];x&&L.push(0);for(const ie of R)try{L[2]=ie,q.apply(null,L)}catch{}R.clear()}E.clear()}delete y.udf,delete y.wudf};{const k=u.xWrap("sqlite3_close_v2","int","sqlite3*");a.sqlite3_close_v2=function(m){if(arguments.length!==1)return N(m,"sqlite3_close_v2",1);if(m)try{K.cleanup(m)}catch{}return k(m)}}if(a.sqlite3session_table_filter){const k=u.xWrap("sqlite3session_delete",void 0,["sqlite3_session*"]);a.sqlite3session_delete=function(m){if(arguments.length!==1)return N(pDb,"sqlite3session_delete",1);m&&a.sqlite3session_table_filter(m,0,0),k(m)}}{const k=(y,x)=>"argv["+x+"]:"+y[0]+":"+u.cstrToJs(y[1]).toLowerCase(),m=u.xWrap("sqlite3_create_collation_v2","int",["sqlite3*","string","int","*",new u.xWrap.FuncPtrAdapter({name:"xCompare",signature:"i(pipip)",contextKey:k}),new u.xWrap.FuncPtrAdapter({name:"xDestroy",signature:"v(p)",contextKey:k})]);a.sqlite3_create_collation_v2=function(y,x,E,q,W,M){if(arguments.length!==6)return N(y,"sqlite3_create_collation_v2",6);if(!(E&15))E|=a.SQLITE_UTF8;else if(a.SQLITE_UTF8!==(E&15))return S(y);try{const R=m(y,x,E,q,W,M);return R===0&&W instanceof Function&&K.addCollation(y,x),R}catch(R){return d.sqlite3_wasm_db_error(y,R)}},a.sqlite3_create_collation=(y,x,E,q,W)=>arguments.length===5?a.sqlite3_create_collation_v2(y,x,E,q,W,0):N(y,"sqlite3_create_collation",5)}{const k=function(E,q){return E[0]+":"+(E[2]<0?-1:E[2])+":"+q+":"+u.cstrToJs(E[1]).toLowerCase()},m=Object.assign(Object.create(null),{xInverseAndStep:{signature:"v(pip)",contextKey:k,callProxy:E=>(q,W,M)=>{try{E(q,...a.sqlite3_values_to_js(W,M))}catch(R){a.sqlite3_result_error_js(q,R)}}},xFinalAndValue:{signature:"v(p)",contextKey:k,callProxy:E=>q=>{try{a.sqlite3_result_js(q,E(q))}catch(W){a.sqlite3_result_error_js(q,W)}}},xFunc:{signature:"v(pip)",contextKey:k,callProxy:E=>(q,W,M)=>{try{a.sqlite3_result_js(q,E(q,...a.sqlite3_values_to_js(W,M)))}catch(R){a.sqlite3_result_error_js(q,R)}}},xDestroy:{signature:"v(p)",contextKey:k,callProxy:E=>q=>{try{E(q)}catch(W){console.error("UDF xDestroy method threw:",W)}}}}),y=u.xWrap("sqlite3_create_function_v2","int",["sqlite3*","string","int","int","*",new u.xWrap.FuncPtrAdapter({name:"xFunc",...m.xFunc}),new u.xWrap.FuncPtrAdapter({name:"xStep",...m.xInverseAndStep}),new u.xWrap.FuncPtrAdapter({name:"xFinal",...m.xFinalAndValue}),new u.xWrap.FuncPtrAdapter({name:"xDestroy",...m.xDestroy})]),x=u.xWrap("sqlite3_create_window_function","int",["sqlite3*","string","int","int","*",new u.xWrap.FuncPtrAdapter({name:"xStep",...m.xInverseAndStep}),new u.xWrap.FuncPtrAdapter({name:"xFinal",...m.xFinalAndValue}),new u.xWrap.FuncPtrAdapter({name:"xValue",...m.xFinalAndValue}),new u.xWrap.FuncPtrAdapter({name:"xInverse",...m.xInverseAndStep}),new u.xWrap.FuncPtrAdapter({name:"xDestroy",...m.xDestroy})]);a.sqlite3_create_function_v2=function E(q,W,M,R,L,ie,z,g,v){if(E.length!==arguments.length)return N(q,"sqlite3_create_function_v2",E.length);if(!(R&15))R|=a.SQLITE_UTF8;else if(a.SQLITE_UTF8!==(R&15))return S(q);try{const A=y(q,W,M,R,L,ie,z,g,v);return A===0&&(ie instanceof Function||z instanceof Function||g instanceof Function||v instanceof Function)&&K.addFunction(q,W,M),A}catch(A){return console.error("sqlite3_create_function_v2() setup threw:",A),d.sqlite3_wasm_db_error(q,A,"Creation of UDF threw: "+A)}},a.sqlite3_create_function=function E(q,W,M,R,L,ie,z,g){return E.length===arguments.length?a.sqlite3_create_function_v2(q,W,M,R,L,ie,z,g,0):N(q,"sqlite3_create_function",E.length)},a.sqlite3_create_window_function=function E(q,W,M,R,L,ie,z,g,v,A){if(E.length!==arguments.length)return N(q,"sqlite3_create_window_function",E.length);if(!(R&15))R|=a.SQLITE_UTF8;else if(a.SQLITE_UTF8!==(R&15))return S(q);try{const b=x(q,W,M,R,L,ie,z,g,v,A);return b===0&&(ie instanceof Function||z instanceof Function||g instanceof Function||v instanceof Function||A instanceof Function)&&K.addWindowFunc(q,W,M),b}catch(b){return console.error("sqlite3_create_window_function() setup threw:",b),d.sqlite3_wasm_db_error(q,b,"Creation of UDF threw: "+b)}},a.sqlite3_create_function_v2.udfSetResult=a.sqlite3_create_function.udfSetResult=a.sqlite3_create_window_function.udfSetResult=a.sqlite3_result_js,a.sqlite3_create_function_v2.udfConvertArgs=a.sqlite3_create_function.udfConvertArgs=a.sqlite3_create_window_function.udfConvertArgs=a.sqlite3_values_to_js,a.sqlite3_create_function_v2.udfSetError=a.sqlite3_create_function.udfSetError=a.sqlite3_create_window_function.udfSetError=a.sqlite3_result_error_js}{const k=(y,x)=>(typeof y=="string"?x=-1:d.isSQLableTypedArray(y)?(x=y.byteLength,y=d.typedArrayToString(y instanceof ArrayBuffer?new Uint8Array(y):y)):Array.isArray(y)&&(y=y.join(""),x=-1),[y,x]),m={basic:u.xWrap("sqlite3_prepare_v3","int",["sqlite3*","string","int","int","**","**"]),full:u.xWrap("sqlite3_prepare_v3","int",["sqlite3*","*","int","int","**","**"])};a.sqlite3_prepare_v3=function y(x,E,q,W,M,R){if(y.length!==arguments.length)return N(x,"sqlite3_prepare_v3",y.length);const[L,ie]=k(E,q);switch(typeof L){case"string":return m.basic(x,L,ie,W,M,null);case"number":return m.full(x,L,ie,W,M,R);default:return d.sqlite3_wasm_db_error(x,a.SQLITE_MISUSE,"Invalid SQL argument type for sqlite3_prepare_v2/v3().")}},a.sqlite3_prepare_v2=function y(x,E,q,W,M){return y.length===arguments.length?a.sqlite3_prepare_v3(x,E,q,0,W,M):N(x,"sqlite3_prepare_v2",y.length)}}{const k=u.xWrap("sqlite3_bind_text","int",["sqlite3_stmt*","int","string","int","*"]),m=u.xWrap("sqlite3_bind_blob","int",["sqlite3_stmt*","int","*","int","*"]);a.sqlite3_bind_text=function y(x,E,q,W,M){if(y.length!==arguments.length)return N(a.sqlite3_db_handle(x),"sqlite3_bind_text",y.length);if(u.isPtr(q)||q===null)return k(x,E,q,W,M);q instanceof ArrayBuffer?q=new Uint8Array(q):Array.isArray(pMem)&&(q=pMem.join(""));let R,L;try{if(d.isSQLableTypedArray(q))R=u.allocFromTypedArray(q),L=q.byteLength;else if(typeof q=="string")[R,L]=u.allocCString(q);else return d.sqlite3_wasm_db_error(a.sqlite3_db_handle(x),a.SQLITE_MISUSE,"Invalid 3rd argument type for sqlite3_bind_text().");return k(x,E,R,L,a.SQLITE_WASM_DEALLOC)}catch(ie){return u.dealloc(R),d.sqlite3_wasm_db_error(a.sqlite3_db_handle(x),ie)}},a.sqlite3_bind_blob=function y(x,E,q,W,M){if(y.length!==arguments.length)return N(a.sqlite3_db_handle(x),"sqlite3_bind_blob",y.length);if(u.isPtr(q)||q===null)return m(x,E,q,W,M);q instanceof ArrayBuffer?q=new Uint8Array(q):Array.isArray(q)&&(q=q.join(""));let R,L;try{if(d.isBindableTypedArray(q))R=u.allocFromTypedArray(q),L=W>=0?W:q.byteLength;else if(typeof q=="string")[R,L]=u.allocCString(q);else return d.sqlite3_wasm_db_error(a.sqlite3_db_handle(x),a.SQLITE_MISUSE,"Invalid 3rd argument type for sqlite3_bind_blob().");return m(x,E,R,L,a.SQLITE_WASM_DEALLOC)}catch(ie){return u.dealloc(R),d.sqlite3_wasm_db_error(a.sqlite3_db_handle(x),ie)}}}a.sqlite3_config=function(k,...m){if(arguments.length<2)return a.SQLITE_MISUSE;switch(k){case a.SQLITE_CONFIG_COVERING_INDEX_SCAN:case a.SQLITE_CONFIG_MEMSTATUS:case a.SQLITE_CONFIG_SMALL_MALLOC:case a.SQLITE_CONFIG_SORTERREF_SIZE:case a.SQLITE_CONFIG_STMTJRNL_SPILL:case a.SQLITE_CONFIG_URI:return u.exports.sqlite3_wasm_config_i(k,m[0]);case a.SQLITE_CONFIG_LOOKASIDE:return u.exports.sqlite3_wasm_config_ii(k,m[0],m[1]);case a.SQLITE_CONFIG_MEMDB_MAXSIZE:return u.exports.sqlite3_wasm_config_j(k,m[0]);case a.SQLITE_CONFIG_GETMALLOC:case a.SQLITE_CONFIG_GETMUTEX:case a.SQLITE_CONFIG_GETPCACHE2:case a.SQLITE_CONFIG_GETPCACHE:case a.SQLITE_CONFIG_HEAP:case a.SQLITE_CONFIG_LOG:case a.SQLITE_CONFIG_MALLOC:case a.SQLITE_CONFIG_MMAP_SIZE:case a.SQLITE_CONFIG_MULTITHREAD:case a.SQLITE_CONFIG_MUTEX:case a.SQLITE_CONFIG_PAGECACHE:case a.SQLITE_CONFIG_PCACHE2:case a.SQLITE_CONFIG_PCACHE:case a.SQLITE_CONFIG_PCACHE_HDRSZ:case a.SQLITE_CONFIG_PMASZ:case a.SQLITE_CONFIG_SERIALIZED:case a.SQLITE_CONFIG_SINGLETHREAD:case a.SQLITE_CONFIG_SQLLOG:case a.SQLITE_CONFIG_WIN32_HEAPSIZE:default:return a.SQLITE_NOTFOUND}};{const k=new Set;a.sqlite3_auto_extension=function(m){if(m instanceof Function)m=u.installFunction("i(ppp)",m);else if(arguments.length!==1||!u.isPtr(m))return a.SQLITE_MISUSE;const y=u.exports.sqlite3_auto_extension(m);return m!==arguments[0]&&(y===0?k.add(m):u.uninstallFunction(m)),y},a.sqlite3_cancel_auto_extension=function(m){return!m||arguments.length!==1||!u.isPtr(m)?0:u.exports.sqlite3_cancel_auto_extension(m)},a.sqlite3_reset_auto_extension=function(){u.exports.sqlite3_reset_auto_extension();for(const m of k)u.uninstallFunction(m);k.clear()}}const te=a.sqlite3_vfs_find("kvvfs");if(te)if(d.isUIThread()){const k=new a.sqlite3_kvvfs_methods(u.exports.sqlite3_wasm_kvvfs_methods());delete a.sqlite3_kvvfs_methods;const m=u.exports.sqlite3_wasm_kvvfsMakeKeyOnPstack,y=u.pstack,x=q=>u.peek(q)===115?sessionStorage:localStorage,E={xRead:(q,W,M,R)=>{const L=y.pointer,ie=u.scopedAllocPush();try{const z=m(q,W);if(!z)return-3;const g=u.cstrToJs(z),v=x(q).getItem(g);if(!v)return-1;const A=v.length;if(R<=0)return A;if(R===1)return u.poke(M,0),A;const b=u.scopedAllocCString(v);return R>A+1&&(R=A+1),u.heap8u().copyWithin(M,b,b+R-1),u.poke(M+R-1,0),R-1}catch(z){return console.error("kvstorageRead()",z),-2}finally{y.restore(L),u.scopedAllocPop(ie)}},xWrite:(q,W,M)=>{const R=y.pointer;try{const L=m(q,W);if(!L)return 1;const ie=u.cstrToJs(L);return x(q).setItem(ie,u.cstrToJs(M)),0}catch(L){return console.error("kvstorageWrite()",L),a.SQLITE_IOERR}finally{y.restore(R)}},xDelete:(q,W)=>{const M=y.pointer;try{const R=m(q,W);return R?(x(q).removeItem(u.cstrToJs(R)),0):1}catch(R){return console.error("kvstorageDelete()",R),a.SQLITE_IOERR}finally{y.restore(M)}}};for(const q of Object.keys(E))k[k.memberKey(q)]=u.installFunction(k.memberSignature(q),E[q])}else a.sqlite3_vfs_unregister(te);u.xWrap.FuncPtrAdapter.warnOnUse=!0}),globalThis.sqlite3ApiBootstrap.initializers.push(function(i){i.version={libVersion:"3.42.0",libVersionNumber:3042e3,sourceId:"2023-05-16 12:36:15 831d0fb2836b71c9bc51067c49fee4b8f18047814f2ff22d817d25195cf350b0",downloadVersion:342e4}}),globalThis.sqlite3ApiBootstrap.initializers.push(function(i){const l=(...b)=>{throw new i.SQLite3Error(...b)},a=i.capi,u=i.wasm,d=i.util,N=new WeakMap,S=new WeakMap,C=(b,w,f)=>{const p=Object.getOwnPropertyDescriptor(b,w);return p?p.value:f},V=function(b,w){return w&&(b instanceof m&&(b=b.pointer),l("sqlite3 result code",w+":",b?a.sqlite3_errmsg(b):a.sqlite3_errstr(w))),arguments[0]},K=u.installFunction("i(ippp)",(function(b,w,f,p){a.SQLITE_TRACE_STMT===b&&console.log("SQL TRACE #"+ ++this.counter+" via sqlite3@"+w+":",u.cstrToJs(p))}).bind({counter:0})),te=Object.create(null),k=function b(...w){if(!b._name2vfs){b._name2vfs=Object.create(null);const le=typeof importScripts=="function"?be=>l("The VFS for",be,"is only available in the main window thread."):!1;b._name2vfs[":localStorage:"]={vfs:"kvvfs",filename:le||(()=>"local")},b._name2vfs[":sessionStorage:"]={vfs:"kvvfs",filename:le||(()=>"session")}}const f=b.normalizeArgs(...w);let p=f.filename,_=f.vfs,P=f.flags;(typeof p!="string"&&typeof p!="number"||typeof P!="string"||_&&typeof _!="string"&&typeof _!="number")&&(i.config.error("Invalid DB ctor args",f,arguments),l("Invalid arguments for DB constructor."));let F=typeof p=="number"?u.cstrToJs(p):p;const ne=b._name2vfs[F];ne&&(_=ne.vfs,p=F=ne.filename(F));let re,se=0;P.indexOf("c")>=0&&(se|=a.SQLITE_OPEN_CREATE|a.SQLITE_OPEN_READWRITE),P.indexOf("w")>=0&&(se|=a.SQLITE_OPEN_READWRITE),se===0&&(se|=a.SQLITE_OPEN_READONLY),se|=a.SQLITE_OPEN_EXRESCODE;const fe=u.pstack.pointer;try{const le=u.pstack.allocPtr();let be=a.sqlite3_open_v2(p,le,se,_||0);re=u.peekPtr(le),V(re,be),a.sqlite3_extended_result_codes(re,1),P.indexOf("t")>=0&&a.sqlite3_trace_v2(re,a.SQLITE_TRACE_STMT,K,re)}catch(le){throw re&&a.sqlite3_close_v2(re),le}finally{u.pstack.restore(fe)}this.filename=F,N.set(this,re),S.set(this,Object.create(null));try{const le=a.sqlite3_js_db_vfs(re);le||l("Internal error: cannot get VFS for new db handle.");const be=te[le];be instanceof Function?be(this,i):be&&V(re,a.sqlite3_exec(re,be,0,0,0))}catch(le){throw this.close(),le}};k.setVfsPostOpenSql=function(b,w){te[b]=w},k.normalizeArgs=function(b=":memory:",w="c",f=null){const p={};return arguments.length===1&&arguments[0]&&typeof arguments[0]=="object"?(Object.assign(p,arguments[0]),p.flags===void 0&&(p.flags="c"),p.vfs===void 0&&(p.vfs=null),p.filename===void 0&&(p.filename=":memory:")):(p.filename=b,p.flags=w,p.vfs=f),p};const m=function(...b){k.apply(this,b)};m.dbCtorHelper=k;const y={null:1,number:2,string:3,boolean:4,blob:5};y.undefined==y.null,u.bigIntEnabled&&(y.bigint=y.number);const x=function(){y!==arguments[2]&&l(a.SQLITE_MISUSE,"Do not call the Stmt constructor directly. Use DB.prepare()."),this.db=arguments[0],N.set(this,arguments[1]),this.columnCount=a.sqlite3_column_count(this.pointer),this.parameterCount=a.sqlite3_bind_parameter_count(this.pointer)},E=function(b){return b.pointer||l("DB has been closed."),b},q=function(b,w){return(w!==(w|0)||w<0||w>=b.columnCount)&&l("Column index",w,"is out of range."),b},W=function(b,w){const f=Object.create(null);switch(f.opt=Object.create(null),w.length){case 1:typeof w[0]=="string"||d.isSQLableTypedArray(w[0])||Array.isArray(w[0])?f.sql=w[0]:w[0]&&typeof w[0]=="object"&&(f.opt=w[0],f.sql=f.opt.sql);break;case 2:f.sql=w[0],f.opt=w[1];break;default:l("Invalid argument count for exec().")}f.sql=d.flexibleString(f.sql),typeof f.sql!="string"&&l("Missing SQL argument or unsupported SQL value type.");const p=f.opt;switch(p.returnValue){case"resultRows":p.resultRows||(p.resultRows=[]),f.returnVal=()=>p.resultRows;break;case"saveSql":p.saveSql||(p.saveSql=[]),f.returnVal=()=>p.saveSql;break;case void 0:case"this":f.returnVal=()=>b;break;default:l("Invalid returnValue value:",p.returnValue)}if(!p.callback&&!p.returnValue&&p.rowMode!==void 0&&(p.resultRows||(p.resultRows=[]),f.returnVal=()=>p.resultRows),p.callback||p.resultRows)switch(p.rowMode===void 0?"array":p.rowMode){case"object":f.cbArg=_=>_.get(Object.create(null));break;case"array":f.cbArg=_=>_.get([]);break;case"stmt":Array.isArray(p.resultRows)&&l("exec(): invalid rowMode for a resultRows array: must","be one of 'array', 'object',","a result column number, or column name reference."),f.cbArg=_=>_;break;default:if(d.isInt32(p.rowMode)){f.cbArg=_=>_.get(p.rowMode);break}else if(typeof p.rowMode=="string"&&p.rowMode.length>1&&p.rowMode[0]==="$"){const _=p.rowMode.substr(1);f.cbArg=P=>{const F=P.get(Object.create(null))[_];return F===void 0?l(a.SQLITE_NOTFOUND,"exec(): unknown result column:",_):F};break}l("Invalid rowMode:",p.rowMode)}return f},M=(b,w,f,...p)=>{const _=b.prepare(w);try{return _.bind(f).step()?_.get(...p):void 0}finally{_.finalize()}},R=(b,w,f,p)=>b.exec({sql:w,bind:f,rowMode:p,returnValue:"resultRows"});m.checkRc=(b,w)=>V(b,w),m.prototype={isOpen:function(){return!!this.pointer},affirmOpen:function(){return E(this)},close:function(){if(this.pointer){if(this.onclose&&this.onclose.before instanceof Function)try{this.onclose.before(this)}catch{}const b=this.pointer;if(Object.keys(S.get(this)).forEach((w,f)=>{f&&f.pointer&&f.finalize()}),N.delete(this),S.delete(this),a.sqlite3_close_v2(b),this.onclose&&this.onclose.after instanceof Function)try{this.onclose.after(this)}catch{}delete this.filename}},changes:function(b=!1,w=!1){const f=E(this).pointer;return b?w?a.sqlite3_total_changes64(f):a.sqlite3_total_changes(f):w?a.sqlite3_changes64(f):a.sqlite3_changes(f)},dbFilename:function(b="main"){return a.sqlite3_db_filename(E(this).pointer,b)},dbName:function(b=0){return a.sqlite3_db_name(E(this).pointer,b)},dbVfsName:function(b=0){let w;const f=a.sqlite3_js_db_vfs(E(this).pointer,b);if(f){const p=new a.sqlite3_vfs(f);try{w=u.cstrToJs(p.$zName)}finally{p.dispose()}}return w},prepare:function(b){E(this);const w=u.pstack.pointer;let f,p;try{f=u.pstack.alloc(8),m.checkRc(this,a.sqlite3_prepare_v2(this.pointer,b,-1,f,null)),p=u.peekPtr(f)}finally{u.pstack.restore(w)}p||l("Cannot prepare empty SQL.");const _=new x(this,p,y);return S.get(this)[p]=_,_},exec:function(){E(this);const b=W(this,arguments);if(!b.sql)return l("exec() requires an SQL string.");const w=b.opt,f=w.callback,p=Array.isArray(w.resultRows)?w.resultRows:void 0;let _,P=w.bind,F=!!(b.cbArg||w.columnNames||p);const ne=u.scopedAllocPush(),re=Array.isArray(w.saveSql)?w.saveSql:void 0;try{const se=d.isSQLableTypedArray(b.sql);let fe=se?b.sql.byteLength:u.jstrlen(b.sql);const le=u.scopedAlloc(2*u.ptrSizeof+(fe+1)),be=le+u.ptrSizeof;let Ve=be+u.ptrSizeof;const dt=Ve+fe;for(se?u.heap8().set(b.sql,Ve):u.jstrcpy(b.sql,u.heap8(),Ve,fe,!1),u.poke(Ve+fe,0);Ve&&u.peek(Ve,"i8");){u.pokePtr([le,be],0),m.checkRc(this,a.sqlite3_prepare_v3(this.pointer,Ve,fe,0,le,be));const en=u.peekPtr(le);if(Ve=u.peekPtr(be),fe=dt-Ve,!!en){if(re&&re.push(a.sqlite3_sql(en).trim()),_=new x(this,en,y),P&&_.parameterCount&&(_.bind(P),P=null),F&&_.columnCount){if(F=!1,Array.isArray(w.columnNames)&&_.getColumnNames(w.columnNames),b.cbArg||p){for(;_.step();_._isLocked=!1){_._isLocked=!0;const I=b.cbArg(_);if(p&&p.push(I),f&&f.call(w,I,_)===!1)break}_._isLocked=!1}}else _.step();_.finalize(),_=null}}}finally{_&&(delete _._isLocked,_.finalize()),u.scopedAllocPop(ne)}return b.returnVal()},createFunction:function(w,f,p){const _=B=>B instanceof Function;switch(arguments.length){case 1:p=w,w=p.name,f=p.xFunc||0;break;case 2:_(f)||(p=f,f=p.xFunc||0);break}p||(p={}),typeof w!="string"&&l("Invalid arguments: missing function name.");let P=p.xStep||0,F=p.xFinal||0;const ne=p.xValue||0,re=p.xInverse||0;let se;_(f)?(se=!1,(_(P)||_(F))&&l("Ambiguous arguments: scalar or aggregate?"),P=F=null):_(P)?(_(F)||l("Missing xFinal() callback for aggregate or window UDF."),f=null):_(F)?l("Missing xStep() callback for aggregate or window UDF."):l("Missing function-type properties."),se===!1?(_(ne)||_(re))&&l("xValue and xInverse are not permitted for non-window UDFs."):_(ne)?(_(re)||l("xInverse must be provided if xValue is."),se=!0):_(re)&&l("xValue must be provided if xInverse is.");const fe=p.pApp;fe!=null&&(typeof fe!="number"||!d.isInt32(fe))&&l("Invalid value for pApp property. Must be a legal WASM pointer value.");const le=p.xDestroy||0;le&&!_(le)&&l("xDestroy property must be a function.");let be=0;C(p,"deterministic")&&(be|=a.SQLITE_DETERMINISTIC),C(p,"directOnly")&&(be|=a.SQLITE_DIRECTONLY),C(p,"innocuous")&&(be|=a.SQLITE_INNOCUOUS),w=w.toLowerCase();const Ve=f||P,dt=C(p,"arity"),en=typeof dt=="number"?dt:Ve.length?Ve.length-1:0;let I;return se?I=a.sqlite3_create_window_function(this.pointer,w,en,a.SQLITE_UTF8|be,fe||0,P,F,ne,re,le):I=a.sqlite3_create_function_v2(this.pointer,w,en,a.SQLITE_UTF8|be,fe||0,f,P,F,le),m.checkRc(this,I),this},selectValue:function(b,w,f){return M(this,b,w,0,f)},selectValues:function(b,w,f){const p=this.prepare(b),_=[];try{for(p.bind(w);p.step();)_.push(p.get(0,f))}finally{p.finalize()}return _},selectArray:function(b,w){return M(this,b,w,[])},selectObject:function(b,w){return M(this,b,w,{})},selectArrays:function(b,w){return R(this,b,w,"array")},selectObjects:function(b,w){return R(this,b,w,"object")},openStatementCount:function(){return this.pointer?Object.keys(S.get(this)).length:0},transaction:function(b){let w="BEGIN";arguments.length>1&&(/[^a-zA-Z]/.test(arguments[0])&&l(a.SQLITE_MISUSE,"Invalid argument for BEGIN qualifier."),w+=" "+arguments[0],b=arguments[1]),E(this).exec(w);try{const f=b(this);return this.exec("COMMIT"),f}catch(f){throw this.exec("ROLLBACK"),f}},savepoint:function(b){E(this).exec("SAVEPOINT oo1");try{const w=b(this);return this.exec("RELEASE oo1"),w}catch(w){throw this.exec("ROLLBACK to SAVEPOINT oo1; RELEASE SAVEPOINT oo1"),w}},checkRc:function(b){return m.checkRc(this,b)}};const L=function(b){return b.pointer||l("Stmt has been closed."),b},ie=function(b){let w=y[b==null?"null":typeof b];switch(w){case y.boolean:case y.null:case y.number:case y.string:return w;case y.bigint:if(u.bigIntEnabled)return w;default:return d.isBindableTypedArray(b)?y.blob:void 0}},z=function(b){return ie(b)||l("Unsupported bind() argument type:",typeof b)},g=function(b,w){const f=typeof w=="number"?w:a.sqlite3_bind_parameter_index(b.pointer,w);return f===0||!d.isInt32(f)?l("Invalid bind() parameter name: "+w):(f<1||f>b.parameterCount)&&l("Bind index",w,"is out of range."),f},v=function(b,w){return b._isLocked&&l("Operation is illegal when statement is locked:",w),b},A=function b(w,f,p,_){v(L(w),"bind()"),b._||(b._tooBigInt=F=>l("BigInt value is too big to store without precision loss:",F),b._={string:function(F,ne,re,se){const[fe,le]=u.allocCString(re,!0);return(se?a.sqlite3_bind_blob:a.sqlite3_bind_text)(F.pointer,ne,fe,le,a.SQLITE_WASM_DEALLOC)}}),z(_),f=g(w,f);let P=0;switch(_==null?y.null:p){case y.null:P=a.sqlite3_bind_null(w.pointer,f);break;case y.string:P=b._.string(w,f,_,!1);break;case y.number:{let F;d.isInt32(_)?F=a.sqlite3_bind_int:typeof _=="bigint"?d.bigIntFits64(_)?u.bigIntEnabled?F=a.sqlite3_bind_int64:d.bigIntFitsDouble(_)?(_=Number(_),F=a.sqlite3_bind_double):b._tooBigInt(_):b._tooBigInt(_):(_=Number(_),u.bigIntEnabled&&Number.isInteger(_)?F=a.sqlite3_bind_int64:F=a.sqlite3_bind_double),P=F(w.pointer,f,_);break}case y.boolean:P=a.sqlite3_bind_int(w.pointer,f,_?1:0);break;case y.blob:{if(typeof _=="string"){P=b._.string(w,f,_,!0);break}else _ instanceof ArrayBuffer?_=new Uint8Array(_):d.isBindableTypedArray(_)||l("Binding a value as a blob requires","that it be a string, Uint8Array, Int8Array, or ArrayBuffer.");const F=u.alloc(_.byteLength||1);u.heap8().set(_.byteLength?_:[0],F),P=a.sqlite3_bind_blob(w.pointer,f,F,_.byteLength,a.SQLITE_WASM_DEALLOC);break}default:i.config.warn("Unsupported bind() argument type:",_),l("Unsupported bind() argument type: "+typeof _)}return P&&m.checkRc(w.db.pointer,P),w._mayGet=!1,w};x.prototype={finalize:function(){this.pointer&&(v(this,"finalize()"),delete S.get(this.db)[this.pointer],a.sqlite3_finalize(this.pointer),N.delete(this),delete this._mayGet,delete this.columnCount,delete this.parameterCount,delete this.db,delete this._isLocked)},clearBindings:function(){return v(L(this),"clearBindings()"),a.sqlite3_clear_bindings(this.pointer),this._mayGet=!1,this},reset:function(b){return v(this,"reset()"),b&&this.clearBindings(),a.sqlite3_reset(L(this).pointer),this._mayGet=!1,this},bind:function(){L(this);let b,w;switch(arguments.length){case 1:b=1,w=arguments[0];break;case 2:b=arguments[0],w=arguments[1];break;default:l("Invalid bind() arguments.")}return w===void 0?this:(this.parameterCount||l("This statement has no bindable parameters."),this._mayGet=!1,w===null?A(this,b,y.null,w):Array.isArray(w)?(arguments.length!==1&&l("When binding an array, an index argument is not permitted."),w.forEach((f,p)=>A(this,p+1,z(f),f)),this):(w instanceof ArrayBuffer&&(w=new Uint8Array(w)),typeof w=="object"&&!d.isBindableTypedArray(w)?(arguments.length!==1&&l("When binding an object, an index argument is not permitted."),Object.keys(w).forEach(f=>A(this,f,z(w[f]),w[f])),this):A(this,b,z(w),w)))},bindAsBlob:function(b,w){L(this),arguments.length===1&&(w=b,b=1);const f=z(w);return y.string!==f&&y.blob!==f&&y.null!==f&&l("Invalid value type for bindAsBlob()"),A(this,b,y.blob,w)},step:function(){v(this,"step()");const b=a.sqlite3_step(L(this).pointer);switch(b){case a.SQLITE_DONE:return this._mayGet=!1;case a.SQLITE_ROW:return this._mayGet=!0;default:this._mayGet=!1,i.config.warn("sqlite3_step() rc=",b,a.sqlite3_js_rc_str(b),"SQL =",a.sqlite3_sql(this.pointer)),m.checkRc(this.db.pointer,b)}},stepReset:function(){return this.step(),this.reset()},stepFinalize:function(){const b=this.step();return this.finalize(),b},get:function(b,w){if(L(this)._mayGet||l("Stmt.step() has not (recently) returned true."),Array.isArray(b)){let f=0;for(;f<this.columnCount;)b[f]=this.get(f++);return b}else if(b&&typeof b=="object"){let f=0;for(;f<this.columnCount;)b[a.sqlite3_column_name(this.pointer,f)]=this.get(f++);return b}switch(q(this,b),w===void 0?a.sqlite3_column_type(this.pointer,b):w){case a.SQLITE_NULL:return null;case a.SQLITE_INTEGER:if(u.bigIntEnabled){const f=a.sqlite3_column_int64(this.pointer,b);return f>=Number.MIN_SAFE_INTEGER&&f<=Number.MAX_SAFE_INTEGER?Number(f).valueOf():f}else{const f=a.sqlite3_column_double(this.pointer,b);return(f>Number.MAX_SAFE_INTEGER||f<Number.MIN_SAFE_INTEGER)&&l("Integer is out of range for JS integer range: "+f),d.isInt32(f)?f|0:f}case a.SQLITE_FLOAT:return a.sqlite3_column_double(this.pointer,b);case a.SQLITE_TEXT:return a.sqlite3_column_text(this.pointer,b);case a.SQLITE_BLOB:{const f=a.sqlite3_column_bytes(this.pointer,b),p=a.sqlite3_column_blob(this.pointer,b),_=new Uint8Array(f);return f&&_.set(u.heap8u().slice(p,p+f),0),f&&this.db._blobXfer instanceof Array&&this.db._blobXfer.push(_.buffer),_}default:l("Don't know how to translate","type of result column #"+b+".")}l("Not reached.")},getInt:function(b){return this.get(b,a.SQLITE_INTEGER)},getFloat:function(b){return this.get(b,a.SQLITE_FLOAT)},getString:function(b){return this.get(b,a.SQLITE_TEXT)},getBlob:function(b){return this.get(b,a.SQLITE_BLOB)},getJSON:function(b){const w=this.get(b,a.SQLITE_STRING);return w===null?w:JSON.parse(w)},getColumnName:function(b){return a.sqlite3_column_name(q(L(this),b).pointer,b)},getColumnNames:function(b=[]){q(L(this),0);for(let w=0;w<this.columnCount;++w)b.push(a.sqlite3_column_name(this.pointer,w));return b},getParamIndex:function(b){return L(this).parameterCount?a.sqlite3_bind_parameter_index(this.pointer,b):void 0}};{const b={enumerable:!0,get:function(){return N.get(this)},set:()=>l("The pointer property is read-only.")};Object.defineProperty(x.prototype,"pointer",b),Object.defineProperty(m.prototype,"pointer",b)}if(i.oo1={DB:m,Stmt:x},d.isUIThread()){i.oo1.JsStorageDb=function(w="session"){w!=="session"&&w!=="local"&&l("JsStorageDb db name must be one of 'session' or 'local'."),k.call(this,{filename:w,flags:"c",vfs:"kvvfs"})};const b=i.oo1.JsStorageDb;b.prototype=Object.create(m.prototype),b.clearStorage=a.sqlite3_js_kvvfs_clear,b.prototype.clearStorage=function(){return b.clearStorage(E(this).filename)},b.storageSize=a.sqlite3_js_kvvfs_size,b.prototype.storageSize=function(){return b.storageSize(E(this).filename)}}}),globalThis.sqlite3ApiBootstrap.initializers.push(function(i){i.initWorker1API=(function(){const l=(...m)=>{throw new Error(m.join(" "))};globalThis.WorkerGlobalScope instanceof Function||l("initWorker1API() must be run from a Worker thread."),this.self;const a=this.sqlite3||l("Missing this.sqlite3 object."),u=a.oo1.DB,d=function(m){let y=N.idMap.get(m);return y||(y="db#"+ ++N.idSeq+"@"+m.pointer,N.idMap.set(m,y),y)},N={dbList:[],idSeq:0,idMap:new WeakMap,xfer:[],open:function(m){const y=new u(m);return this.dbs[d(y)]=y,this.dbList.indexOf(y)<0&&this.dbList.push(y),y},close:function(m,y){if(m){delete this.dbs[d(m)];const x=m.filename,E=a.wasm.sqlite3_wasm_db_vfs(m.pointer,0);m.close();const q=this.dbList.indexOf(m);q>=0&&this.dbList.splice(q,1),y&&x&&E&&a.wasm.sqlite3_wasm_vfs_unlink(E,x)}},post:function(m,y){y&&y.length?(globalThis.postMessage(m,Array.from(y)),y.length=0):globalThis.postMessage(m)},dbs:Object.create(null),getDb:function(m,y=!0){return this.dbs[m]||(y?l("Unknown (or closed) DB ID:",m):void 0)}},S=function(m=N.dbList[0]){return m&&m.pointer?m:l("DB is not opened.")},C=function(m,y=!0){const x=N.getDb(m.dbId,!1)||N.dbList[0];return y?S(x):x},V=function(){return N.dbList[0]&&d(N.dbList[0])},K=function(m){const y=/^file:.+(vfs=(\w+))/.exec(m);return a.capi.sqlite3_vfs_find(y?y[2]:0)},te=m=>m===""||m[0]===":",k={open:function(m){const y=Object.create(null),x=m.args||Object.create(null);x.simulateError&&l("Throwing because of simulateError flag.");const E=Object.create(null);let q,W;if(y.vfs=x.vfs,te(x.filename)?y.filename=x.filename||"":(y.filename=x.filename,q=x.byteArray,q&&(W=K(x.filename))),W){let R;try{R=a.wasm.allocFromTypedArray(q);const L=a.wasm.sqlite3_wasm_vfs_create_file(W,y.filename,R,q.byteLength);L&&a.SQLite3Error.toss(L)}catch(L){throw new a.SQLite3Error(L.name+" creating "+x.filename+": "+L.message,{cause:L})}finally{R&&a.wasm.dealloc(R)}}const M=N.open(y);return E.filename=M.filename,E.persistent=!!a.capi.sqlite3_js_db_uses_vfs(M.pointer,"opfs"),E.dbId=d(M),E.vfs=M.dbVfsName(),E},close:function(m){const y=C(m,!1),x={filename:y&&y.filename};if(y){const E=m.args&&typeof m.args=="object"?!!m.args.unlink:!1;N.close(y,E)}return x},exec:function(m){const y=typeof m.args=="string"?{sql:m.args}:m.args||Object.create(null);y.rowMode==="stmt"?l("Invalid rowMode for 'exec': stmt mode","does not work in the Worker API."):y.sql||l("'exec' requires input SQL.");const x=C(m);(y.callback||Array.isArray(y.resultRows))&&(x._blobXfer=N.xfer);const E=y.callback;let q=0;const W=!!y.columnNames;typeof E=="string"&&(W||(y.columnNames=[]),y.callback=function(M,R){N.post({type:E,columnNames:y.columnNames,rowNumber:++q,row:M},N.xfer)});try{x.exec(y),y.callback instanceof Function&&(y.callback=E,N.post({type:E,columnNames:y.columnNames,rowNumber:null,row:void 0}))}finally{delete x._blobXfer,y.callback&&(y.callback=E)}return y},"config-get":function(){const m=Object.create(null),y=a.config;return["bigIntEnabled"].forEach(function(x){Object.getOwnPropertyDescriptor(y,x)&&(m[x]=y[x])}),m.version=a.version,m.vfsList=a.capi.sqlite3_js_vfs_list(),m.opfsEnabled=!!a.opfs,m},export:function(m){const y=C(m),x={byteArray:a.capi.sqlite3_js_db_export(y.pointer),filename:y.filename,mimetype:"application/x-sqlite3"};return N.xfer.push(x.byteArray.buffer),x},toss:function(m){l("Testing worker exception")},"opfs-tree":async function(m){return a.opfs||l("OPFS support is unavailable."),await a.opfs.treeList()}};globalThis.onmessage=async function(m){m=m.data;let y,x=m.dbId,E=m.type;const q=performance.now();try{k.hasOwnProperty(E)&&k[E]instanceof Function?y=await k[E](m):l("Unknown db worker message type:",m.type)}catch(W){E="error",y={operation:m.type,message:W.message,errorClass:W.name,input:m},W.stack&&(y.stack=typeof W.stack=="string"?W.stack.split(/\n\s*/):W.stack)}x||(x=y.dbId||V()),N.post({type:E,dbId:x,messageId:m.messageId,workerReceivedTime:q,workerRespondTime:performance.now(),departureTime:m.departureTime,result:y},N.xfer)},globalThis.postMessage({type:"sqlite3-api",result:"worker1-ready"})}).bind({self,sqlite3:i})}),globalThis.sqlite3ApiBootstrap.initializers.push(function(i){const l=i.wasm,a=i.capi,u=i.util.toss3,d=Object.create(null),N=Object.create(null),S=i.StructBinder;i.vfs=d,i.vtab=N;const C=a.sqlite3_index_info;C.prototype.nthConstraint=function(m,y=!1){if(m<0||m>=this.$nConstraint)return!1;const x=this.$aConstraint+C.sqlite3_index_constraint.structInfo.sizeof*m;return y?x:new C.sqlite3_index_constraint(x)},C.prototype.nthConstraintUsage=function(m,y=!1){if(m<0||m>=this.$nConstraint)return!1;const x=this.$aConstraintUsage+C.sqlite3_index_constraint_usage.structInfo.sizeof*m;return y?x:new C.sqlite3_index_constraint_usage(x)},C.prototype.nthOrderBy=function(m,y=!1){if(m<0||m>=this.$nOrderBy)return!1;const x=this.$aOrderBy+C.sqlite3_index_orderby.structInfo.sizeof*m;return y?x:new C.sqlite3_index_orderby(x)};const V=function m(y,x,E,q=m.installMethodArgcCheck){if(y instanceof S.StructType?!(E instanceof Function)&&!l.isPtr(E)&&u("Usage errror: expecting a Function or WASM pointer to one."):u("Usage error: target object is-not-a StructType."),arguments.length===1)return(L,ie)=>m(y,L,ie,q);m.argcProxy||(m.argcProxy=function(L,ie,z,g){return function(...v){return z.length!==arguments.length&&u("Argument mismatch for",L.structInfo.name+"::"+ie+": Native signature is:",g),z.apply(this,v)}},m.removeFuncList=function(){this.ondispose.__removeFuncList&&(this.ondispose.__removeFuncList.forEach((L,ie)=>{if(typeof L=="number")try{l.uninstallFunction(L)}catch{}}),delete this.ondispose.__removeFuncList)});const W=y.memberSignature(x);W.length<2&&u("Member",x,"does not have a function pointer signature:",W);const M=y.memberKey(x),R=q&&!l.isPtr(E)?m.argcProxy(y,M,E,W):E;if(l.isPtr(R))R&&!l.functionEntry(R)&&u("Pointer",R,"is not a WASM function table entry."),y[M]=R;else{const L=l.installFunction(R,y.memberSignature(x,!0));y[M]=L,(!y.ondispose||!y.ondispose.__removeFuncList)&&(y.addOnDispose("ondispose.__removeFuncList handler",m.removeFuncList),y.ondispose.__removeFuncList=[]),y.ondispose.__removeFuncList.push(M,L)}return(L,ie)=>m(y,L,ie,q)};V.installMethodArgcCheck=!1;const K=function(m,y,x=V.installMethodArgcCheck){const E=new Map;for(const q of Object.keys(y)){const W=y[q],M=E.get(W);if(M){const R=m.memberKey(q);m[R]=m[m.memberKey(M)]}else V(m,q,W,x),E.set(W,q)}return m};S.StructType.prototype.installMethod=function(y,x,E=V.installMethodArgcCheck){return arguments.length<3&&y&&typeof y=="object"?K(this,...arguments):V(this,...arguments)},S.StructType.prototype.installMethods=function(m,y=V.installMethodArgcCheck){return K(this,m,y)},a.sqlite3_vfs.prototype.registerVfs=function(m=!1){this instanceof i.capi.sqlite3_vfs||u("Expecting a sqlite3_vfs-type argument.");const y=a.sqlite3_vfs_register(this,m?1:0);return y&&u("sqlite3_vfs_register(",this,") failed with rc",y),this.pointer!==a.sqlite3_vfs_find(this.$zName)&&u("BUG: sqlite3_vfs_find(vfs.$zName) failed for just-installed VFS",this),this},d.installVfs=function(m){let y=0;const x=["io","vfs"];for(const E of x){const q=m[E];q&&(++y,K(q.struct,q.methods,!!q.applyArgcCheck),E==="vfs"&&(!q.struct.$zName&&typeof q.name=="string"&&q.struct.addOnDispose(q.struct.$zName=l.allocCString(q.name)),q.struct.registerVfs(!!q.asDefault)))}return y||u("Misuse: installVfs() options object requires at least","one of:",x),this};const te=function(m,y){return(function(x,E=!1){if(arguments.length===0&&(x=new y),x instanceof y)return this.set(x.pointer,x),x;l.isPtr(x)||i.SQLite3Error.toss("Invalid argument to",m+"()");let q=this.get(x);return E&&this.delete(x),q}).bind(new Map)},k=function(m,y){const x=te(m,y);return Object.assign(Object.create(null),{StructType:y,create:E=>{const q=x();return l.pokePtr(E,q.pointer),q},get:E=>x(E),unget:E=>x(E,!0),dispose:E=>{const q=x(E,!0);q&&q.dispose()}})};N.xVtab=k("xVtab",a.sqlite3_vtab),N.xCursor=k("xCursor",a.sqlite3_vtab_cursor),N.xIndexInfo=m=>new a.sqlite3_index_info(m),N.xError=function m(y,x,E){if(m.errorReporter instanceof Function)try{m.errorReporter("sqlite3_module::"+y+"(): "+x.message)}catch{}let q;return x instanceof i.WasmAllocError?q=a.SQLITE_NOMEM:arguments.length>2?q=E:x instanceof i.SQLite3Error&&(q=x.resultCode),q||a.SQLITE_ERROR},N.xError.errorReporter=console.error.bind(console),N.xRowid=(m,y)=>l.poke(m,y,"i64"),N.setupModule=function(m){let y=!1;const x=this instanceof a.sqlite3_module?this:m.struct||(y=new a.sqlite3_module);try{const E=m.methods||u("Missing 'methods' object.");for(const q of Object.entries({xConnect:"xCreate",xDisconnect:"xDestroy"})){const W=q[0],M=q[1];E[W]===!0?E[W]=E[M]:E[M]===!0&&(E[M]=E[W])}if(m.catchExceptions){const q=function(R,L){return["xConnect","xCreate"].indexOf(R)>=0?function(ie,z,g,v,A,b){try{return L(...arguments)||0}catch(w){return w instanceof i.WasmAllocError||(l.dealloc(l.peekPtr(b)),l.pokePtr(b,l.allocCString(w.message))),N.xError(R,w)}}:function(...ie){try{return L(...ie)||0}catch(z){return N.xError(R,z)}}},W=["xCreate","xConnect","xBestIndex","xDisconnect","xDestroy","xOpen","xClose","xFilter","xNext","xEof","xColumn","xRowid","xUpdate","xBegin","xSync","xCommit","xRollback","xFindFunction","xRename","xSavepoint","xRelease","xRollbackTo","xShadowName"],M=Object.create(null);for(const R of W){const L=E[R];if(L instanceof Function)R==="xConnect"&&E.xCreate===L?M[R]=E.xCreate:R==="xCreate"&&E.xConnect===L?M[R]=E.xConnect:M[R]=q(R,L);else continue}K(x,M,!1)}else K(x,E,!!m.applyArgcCheck);if(x.$iVersion===0){let q;typeof m.iVersion=="number"?q=m.iVersion:x.$xShadowName?q=3:x.$xSavePoint||x.$xRelease||x.$xRollbackTo?q=2:q=1,x.$iVersion=q}}catch(E){throw y&&y.dispose(),E}return x},a.sqlite3_module.prototype.setupModule=function(m){return N.setupModule.call(this,m)}}),globalThis.sqlite3ApiBootstrap.initializers.push(function(i){const l=function a(u){var S;if(!globalThis.SharedArrayBuffer||!globalThis.Atomics)return Promise.reject(new Error("Cannot install OPFS: Missing SharedArrayBuffer and/or Atomics. The server must emit the COOP/COEP response headers to enable those. See https://sqlite.org/wasm/doc/trunk/persistence.md#coop-coep"));if(typeof WorkerGlobalScope>"u")return Promise.reject(new Error("The OPFS sqlite3_vfs cannot run in the main thread because it requires Atomics.wait()."));if(!globalThis.FileSystemHandle||!globalThis.FileSystemDirectoryHandle||!globalThis.FileSystemFileHandle||!globalThis.FileSystemFileHandle.prototype.createSyncAccessHandle||!((S=navigator==null?void 0:navigator.storage)!=null&&S.getDirectory))return Promise.reject(new Error("Missing required OPFS APIs."));(!u||typeof u!="object")&&(u=Object.create(null));const d=new URL(globalThis.location.href).searchParams;return u.verbose===void 0&&(u.verbose=d.has("opfs-verbose")?+d.get("opfs-verbose")||2:1),u.sanityChecks===void 0&&(u.sanityChecks=d.has("opfs-sanity-check")),u.proxyUri===void 0&&(u.proxyUri=a.defaultProxyUri),typeof u.proxyUri=="function"&&(u.proxyUri=u.proxyUri()),new Promise(function(C,V){const K={0:i.config.error,1:i.config.warn,2:i.config.log},te=(I,...B)=>{u.verbose>I&&K[I]("OPFS syncer:",...B)},k=(...I)=>te(2,...I),m=(...I)=>te(1,...I),y=(...I)=>te(0,...I),x=i.util.toss,E=i.capi,q=i.wasm,W=E.sqlite3_vfs,M=E.sqlite3_file,R=E.sqlite3_io_methods,L=Object.create(null),ie=()=>{var I;return globalThis.FileSystemHandle&&globalThis.FileSystemDirectoryHandle&&globalThis.FileSystemFileHandle&&globalThis.FileSystemFileHandle.prototype.createSyncAccessHandle&&((I=navigator==null?void 0:navigator.storage)==null?void 0:I.getDirectory)};L.metrics={dump:function(){let I,B=0,Q=0,Z=0;for(I in _.opIds){const $=P[I];B+=$.count,Q+=$.time,Z+=$.wait,$.avgTime=$.count&&$.time?$.time/$.count:0,$.avgWait=$.count&&$.wait?$.wait/$.count:0}i.config.log(globalThis.location.href,"metrics for",globalThis.location.href,":",P,`
Total of`,B,"op(s) for",Q,"ms (incl. "+Z+" ms of waiting on the async side)"),i.config.log("Serialization metrics:",P.s11n),w.postMessage({type:"opfs-async-metrics"})},reset:function(){let I;const B=Z=>Z.count=Z.time=Z.wait=0;for(I in _.opIds)B(P[I]=Object.create(null));let Q=P.s11n=Object.create(null);Q=Q.serialize=Object.create(null),Q.count=Q.time=0,Q=P.s11n.deserialize=Object.create(null),Q.count=Q.time=0}};const z=new W,g=new R;let v;const A=I=>(v=!0,z.dispose(),V(I)),b=I=>(v=!1,C(I)),w=new Worker(new URL(""+new URL("sqlite3-opfs-async-proxy-9f074d6f.js",self.location.href).href,self.location));setTimeout(()=>{v===void 0&&A(new Error("Timeout while waiting for OPFS async proxy worker."))},4e3),w._originalOnError=w.onerror,w.onerror=function(I){y("Error initializing OPFS asyncer:",I),A(new Error("Loading OPFS async Worker failed for unknown reasons."))};const f=E.sqlite3_vfs_find(null),p=f?new W(f):null;z.$iVersion=2,z.$szOsFile=E.sqlite3_file.structInfo.sizeof,z.$mxPathname=1024,z.$zName=q.allocCString("opfs"),z.$xDlOpen=z.$xDlError=z.$xDlSym=z.$xDlClose=null,z.ondispose=["$zName",z.$zName,"cleanup default VFS wrapper",()=>p?p.dispose():null,"cleanup opfsIoMethods",()=>g.dispose()];const _=Object.create(null);_.verbose=u.verbose,_.littleEndian=(()=>{const I=new ArrayBuffer(2);return new DataView(I).setInt16(0,256,!0),new Int16Array(I)[0]===256})(),_.asyncIdleWaitTime=150,_.asyncS11nExceptions=1,_.fileBufferSize=1024*64,_.sabS11nOffset=_.fileBufferSize,_.sabS11nSize=z.$mxPathname*2,_.sabIO=new SharedArrayBuffer(_.fileBufferSize+_.sabS11nSize),_.opIds=Object.create(null);const P=Object.create(null);{let I=0;_.opIds.whichOp=I++,_.opIds.rc=I++,_.opIds.xAccess=I++,_.opIds.xClose=I++,_.opIds.xDelete=I++,_.opIds.xDeleteNoWait=I++,_.opIds.xFileSize=I++,_.opIds.xLock=I++,_.opIds.xOpen=I++,_.opIds.xRead=I++,_.opIds.xSleep=I++,_.opIds.xSync=I++,_.opIds.xTruncate=I++,_.opIds.xUnlock=I++,_.opIds.xWrite=I++,_.opIds.mkdir=I++,_.opIds["opfs-async-metrics"]=I++,_.opIds["opfs-async-shutdown"]=I++,_.opIds.retry=I++,_.sabOP=new SharedArrayBuffer(I*4),L.metrics.reset()}_.sq3Codes=Object.create(null),["SQLITE_ACCESS_EXISTS","SQLITE_ACCESS_READWRITE","SQLITE_BUSY","SQLITE_ERROR","SQLITE_IOERR","SQLITE_IOERR_ACCESS","SQLITE_IOERR_CLOSE","SQLITE_IOERR_DELETE","SQLITE_IOERR_FSYNC","SQLITE_IOERR_LOCK","SQLITE_IOERR_READ","SQLITE_IOERR_SHORT_READ","SQLITE_IOERR_TRUNCATE","SQLITE_IOERR_UNLOCK","SQLITE_IOERR_WRITE","SQLITE_LOCK_EXCLUSIVE","SQLITE_LOCK_NONE","SQLITE_LOCK_PENDING","SQLITE_LOCK_RESERVED","SQLITE_LOCK_SHARED","SQLITE_LOCKED","SQLITE_MISUSE","SQLITE_NOTFOUND","SQLITE_OPEN_CREATE","SQLITE_OPEN_DELETEONCLOSE","SQLITE_OPEN_MAIN_DB","SQLITE_OPEN_READONLY"].forEach(I=>{(_.sq3Codes[I]=E[I])===void 0&&x("Maintenance required: not found:",I)}),_.opfsFlags=Object.assign(Object.create(null),{OPFS_UNLOCK_ASAP:1,defaultUnlockAsap:!1});const F=(I,...B)=>{const Q=_.opIds[I]||x("Invalid op ID:",I);_.s11n.serialize(...B),Atomics.store(_.sabOPView,_.opIds.rc,-1),Atomics.store(_.sabOPView,_.opIds.whichOp,Q),Atomics.notify(_.sabOPView,_.opIds.whichOp);const Z=performance.now();Atomics.wait(_.sabOPView,_.opIds.rc,-1);const $=Atomics.load(_.sabOPView,_.opIds.rc);if(P[I].wait+=performance.now()-Z,$&&_.asyncS11nExceptions){const qe=_.s11n.deserialize();qe&&y(I+"() async error:",...qe)}return $};L.debug={asyncShutdown:()=>{m("Shutting down OPFS async listener. The OPFS VFS will no longer work."),F("opfs-async-shutdown")},asyncRestart:()=>{m("Attempting to restart OPFS VFS async listener. Might work, might not."),w.postMessage({type:"opfs-async-restart"})}};const ne=()=>{if(_.s11n)return _.s11n;const I=new TextDecoder,B=new TextEncoder("utf-8"),Q=new Uint8Array(_.sabIO,_.sabS11nOffset,_.sabS11nSize),Z=new DataView(_.sabIO,_.sabS11nOffset,_.sabS11nSize);_.s11n=Object.create(null);const $=Object.create(null);$.number={id:1,size:8,getter:"getFloat64",setter:"setFloat64"},$.bigint={id:2,size:8,getter:"getBigInt64",setter:"setBigInt64"},$.boolean={id:3,size:4,getter:"getInt32",setter:"setInt32"},$.string={id:4};const qe=ee=>$[typeof ee]||x("Maintenance required: this value type cannot be serialized.",ee),we=ee=>{switch(ee){case $.number.id:return $.number;case $.bigint.id:return $.bigint;case $.boolean.id:return $.boolean;case $.string.id:return $.string;default:x("Invalid type ID:",ee)}};return _.s11n.deserialize=function(ee=!1){++P.s11n.deserialize.count;const Lt=performance.now(),ot=Q[0],T=ot?[]:null;if(ot){const J=[];let H=1,X,Ae,Re;for(X=0;X<ot;++X,++H)J.push(we(Q[H]));for(X=0;X<ot;++X){const Ce=J[X];Ce.getter?(Re=Z[Ce.getter](H,_.littleEndian),H+=Ce.size):(Ae=Z.getInt32(H,_.littleEndian),H+=4,Re=I.decode(Q.slice(H,H+Ae)),H+=Ae),T.push(Re)}}return ee&&(Q[0]=0),P.s11n.deserialize.time+=performance.now()-Lt,T},_.s11n.serialize=function(...ee){const Lt=performance.now();if(++P.s11n.serialize.count,ee.length){const ot=[];let T=0,J=1;for(Q[0]=ee.length&255;T<ee.length;++T,++J)ot.push(qe(ee[T])),Q[J]=ot[T].id;for(T=0;T<ee.length;++T){const H=ot[T];if(H.setter)Z[H.setter](J,ee[T],_.littleEndian),J+=H.size;else{const X=B.encode(ee[T]);Z.setInt32(J,X.byteLength,_.littleEndian),J+=4,Q.set(X,J),J+=X.byteLength}}}else Q[0]=0;P.s11n.serialize.time+=performance.now()-Lt},_.s11n},re=function I(B=16){I._chars||(I._chars="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ012346789",I._n=I._chars.length);const Q=[];let Z=0;for(;Z<B;++Z){const $=Math.random()*(I._n*64)%I._n|0;Q[Z]=I._chars[$]}return Q.join("")},se=Object.create(null),fe=Object.create(null);fe.op=void 0,fe.start=void 0;const le=I=>{fe.start=performance.now(),fe.op=I,++P[I].count},be=()=>P[fe.op].time+=performance.now()-fe.start,Ve={xCheckReservedLock:function(I,B){const Q=se[I];return q.poke(B,Q.lockType?1:0,"i32"),0},xClose:function(I){le("xClose");let B=0;const Q=se[I];return Q&&(delete se[I],B=F("xClose",I),Q.sq3File&&Q.sq3File.dispose()),be(),B},xDeviceCharacteristics:function(I){return E.SQLITE_IOCAP_UNDELETABLE_WHEN_OPEN},xFileControl:function(I,B,Q){return E.SQLITE_NOTFOUND},xFileSize:function(I,B){le("xFileSize");let Q=F("xFileSize",I);if(Q==0)try{const Z=_.s11n.deserialize()[0];q.poke(B,Z,"i64")}catch(Z){y("Unexpected error reading xFileSize() result:",Z),Q=_.sq3Codes.SQLITE_IOERR}return be(),Q},xLock:function(I,B){le("xLock");const Q=se[I];let Z=0;return Q.lockType?Q.lockType=B:(Z=F("xLock",I,B),Z===0&&(Q.lockType=B)),be(),Z},xRead:function(I,B,Q,Z){le("xRead");const $=se[I];let qe;try{qe=F("xRead",I,Q,Number(Z)),(qe===0||E.SQLITE_IOERR_SHORT_READ===qe)&&q.heap8u().set($.sabView.subarray(0,Q),B)}catch(we){y("xRead(",arguments,") failed:",we,$),qe=E.SQLITE_IOERR_READ}return be(),qe},xSync:function(I,B){le("xSync"),++P.xSync.count;const Q=F("xSync",I,B);return be(),Q},xTruncate:function(I,B){le("xTruncate");const Q=F("xTruncate",I,Number(B));return be(),Q},xUnlock:function(I,B){le("xUnlock");const Q=se[I];let Z=0;return E.SQLITE_LOCK_NONE===B&&Q.lockType&&(Z=F("xUnlock",I,B)),Z===0&&(Q.lockType=B),be(),Z},xWrite:function(I,B,Q,Z){le("xWrite");const $=se[I];let qe;try{$.sabView.set(q.heap8u().subarray(B,B+Q)),qe=F("xWrite",I,Q,Number(Z))}catch(we){y("xWrite(",arguments,") failed:",we,$),qe=E.SQLITE_IOERR_WRITE}return be(),qe}},dt={xAccess:function(I,B,Q,Z){le("xAccess");const $=F("xAccess",q.cstrToJs(B));return q.poke(Z,$?0:1,"i32"),be(),0},xCurrentTime:function(I,B){return q.poke(B,24405875e-1+new Date().getTime()/864e5,"double"),0},xCurrentTimeInt64:function(I,B){return q.poke(B,24405875e-1*864e5+new Date().getTime(),"i64"),0},xDelete:function(I,B,Q){return le("xDelete"),F("xDelete",q.cstrToJs(B),Q,!1),be(),0},xFullPathname:function(I,B,Q,Z){return q.cstrncpy(Z,B,Q)<Q?0:E.SQLITE_CANTOPEN},xGetLastError:function(I,B,Q){return m("OPFS xGetLastError() has nothing sensible to return."),0},xOpen:function(B,Q,Z,$,qe){le("xOpen");let we=0;Q===0?Q=re():typeof Q=="number"&&(E.sqlite3_uri_boolean(Q,"opfs-unlock-asap",0)&&(we|=_.opfsFlags.OPFS_UNLOCK_ASAP),Q=q.cstrToJs(Q));const ee=Object.create(null);ee.fid=Z,ee.filename=Q,ee.sab=new SharedArrayBuffer(_.fileBufferSize),ee.flags=$;const Lt=F("xOpen",Z,Q,$,we);return Lt||(ee.readOnly&&q.poke(qe,E.SQLITE_OPEN_READONLY,"i32"),se[Z]=ee,ee.sabView=_.sabFileBufView,ee.sq3File=new M(Z),ee.sq3File.$pMethods=g.pointer,ee.lockType=E.SQLITE_LOCK_NONE),be(),Lt}};if(p&&(z.$xRandomness=p.$xRandomness,z.$xSleep=p.$xSleep),z.$xRandomness||(dt.xRandomness=function(I,B,Q){const Z=q.heap8u();let $=0;for(;$<B;++$)Z[Q+$]=Math.random()*255e3&255;return $}),z.$xSleep||(dt.xSleep=function(I,B){return Atomics.wait(_.sabOPView,_.opIds.xSleep,0,B),0}),L.getResolvedPath=function(I,B){const Q=new URL(I,"file://irrelevant").pathname;return B?Q.split("/").filter(Z=>!!Z):Q},L.getDirForFilename=async function(B,Q=!1){const Z=L.getResolvedPath(B,!0),$=Z.pop();let qe=L.rootDirectory;for(const we of Z)we&&(qe=await qe.getDirectoryHandle(we,{create:!!Q}));return[qe,$]},L.mkdir=async function(I){try{return await L.getDirForFilename(I+"/filepart",!0),!0}catch{return!1}},L.entryExists=async function(I){try{const[B,Q]=await L.getDirForFilename(I);return await B.getFileHandle(Q),!0}catch{return!1}},L.randomFilename=re,L.registerVfs=(I=!1)=>q.exports.sqlite3_vfs_register(z.pointer,I?1:0),L.treeList=async function(){const I=async function Q(Z,$){$.name=Z.name,$.dirs=[],$.files=[];for await(const qe of Z.values())if(qe.kind==="directory"){const we=Object.create(null);$.dirs.push(we),await Q(qe,we)}else $.files.push(qe.name)},B=Object.create(null);return await I(L.rootDirectory,B),B},L.rmfr=async function(){const I=L.rootDirectory,B={recurse:!0};for await(const Q of I.values())I.removeEntry(Q.name,B)},L.unlink=async function(I,B=!1,Q=!1){try{const[Z,$]=await L.getDirForFilename(I,!1);return await Z.removeEntry($,{recursive:B}),!0}catch(Z){if(Q)throw new Error("unlink(",arguments[0],") failed: "+Z.message,{cause:Z});return!1}},L.traverse=async function(I){const B={recursive:!0,directory:L.rootDirectory};typeof I=="function"&&(I={callback:I}),I=Object.assign(B,I||{}),async function Z($,qe){for await(const we of $.values()){if(I.callback(we,$,qe)===!1)return!1;if(I.recursive&&we.kind==="directory"&&await Z(we,qe+1)===!1)break}}(I.directory,0)},i.oo1){const I=function(...B){const Q=i.oo1.DB.dbCtorHelper.normalizeArgs(...B);Q.vfs=z.$zName,i.oo1.DB.dbCtorHelper.call(this,Q)};I.prototype=Object.create(i.oo1.DB.prototype),i.oo1.OpfsDb=I,i.oo1.DB.dbCtorHelper.setVfsPostOpenSql(z.pointer,function(B,Q){Q.capi.sqlite3_busy_timeout(B,1e4),Q.capi.sqlite3_exec(B,["pragma journal_mode=persist;","pragma cache_size=-16384;"],0,0,0)})}const en=function(){const I=q.scopedAllocPush(),B=new M;try{const Q=B.pointer,Z=E.SQLITE_OPEN_CREATE|E.SQLITE_OPEN_READWRITE|E.SQLITE_OPEN_MAIN_DB,$=q.scopedAlloc(8),qe="/sanity/check/file"+re(8),we=q.scopedAllocCString(qe);let ee;if(_.s11n.serialize("This is ä string."),ee=_.s11n.deserialize(),k("deserialize() says:",ee),ee[0]!=="This is ä string."&&x("String d13n error."),dt.xAccess(z.pointer,we,0,$),ee=q.peek($,"i32"),k("xAccess(",qe,") exists ?=",ee),ee=dt.xOpen(z.pointer,we,Q,Z,$),k("open rc =",ee,"state.sabOPView[xOpen] =",_.sabOPView[_.opIds.xOpen]),ee!==0){y("open failed with code",ee);return}dt.xAccess(z.pointer,we,0,$),ee=q.peek($,"i32"),ee||x("xAccess() failed to detect file."),ee=Ve.xSync(B.pointer,0),ee&&x("sync failed w/ rc",ee),ee=Ve.xTruncate(B.pointer,1024),ee&&x("truncate failed w/ rc",ee),q.poke($,0,"i64"),ee=Ve.xFileSize(B.pointer,$),ee&&x("xFileSize failed w/ rc",ee),k("xFileSize says:",q.peek($,"i64")),ee=Ve.xWrite(B.pointer,we,10,1),ee&&x("xWrite() failed!");const Lt=q.scopedAlloc(16);ee=Ve.xRead(B.pointer,Lt,6,2),q.poke(Lt+6,0);let ot=q.cstrToJs(Lt);k("xRead() got:",ot),ot!=="sanity"&&x("Unexpected xRead() value."),dt.xSleep&&(k("xSleep()ing before close()ing..."),dt.xSleep(z.pointer,2e3),k("waking up from xSleep()")),ee=Ve.xClose(Q),k("xClose rc =",ee,"sabOPView =",_.sabOPView),k("Deleting file:",qe),dt.xDelete(z.pointer,we,4660),dt.xAccess(z.pointer,we,0,$),ee=q.peek($,"i32"),ee&&x("Expecting 0 from xAccess(",qe,") after xDelete()."),m("End of OPFS sanity checks.")}finally{B.dispose(),q.scopedAllocPop(I)}};w.onmessage=function({data:I}){switch(I.type){case"opfs-unavailable":A(new Error(I.payload.join(" ")));break;case"opfs-async-loaded":w.postMessage({type:"opfs-async-init",args:_});break;case"opfs-async-inited":{if(v===!0)break;try{i.vfs.installVfs({io:{struct:g,methods:Ve},vfs:{struct:z,methods:dt}}),_.sabOPView=new Int32Array(_.sabOP),_.sabFileBufView=new Uint8Array(_.sabIO,0,_.fileBufferSize),_.sabS11nView=new Uint8Array(_.sabIO,_.sabS11nOffset,_.sabS11nSize),ne(),u.sanityChecks&&(m("Running sanity checks because of opfs-sanity-check URL arg..."),en()),ie()?navigator.storage.getDirectory().then(B=>{w.onerror=w._originalOnError,delete w._originalOnError,i.opfs=L,L.rootDirectory=B,k("End of OPFS sqlite3_vfs setup.",z),b(i)}).catch(A):b(i)}catch(B){y(B),A(B)}break}default:{const B="Unexpected message from the OPFS async worker: "+JSON.stringify(I);y(B),A(new Error(B));break}}}})};l.defaultProxyUri="sqlite3-opfs-async-proxy.js",globalThis.sqlite3ApiBootstrap.initializersAsync.push(async a=>{try{let u=l.defaultProxyUri;return a.scriptInfo.sqlite3Dir&&(l.defaultProxyUri=a.scriptInfo.sqlite3Dir+u),l().catch(d=>{a.config.warn("Ignoring inability to install OPFS sqlite3_vfs:",d.message)})}catch(u){throw a.config.error("installOpfsVfs() exception:",u),u}})}),typeof s<"u"){const i=Object.assign(Object.create(null),{exports:s.asm,memory:s.wasmMemory},globalThis.sqlite3ApiConfig||{});globalThis.sqlite3ApiConfig=i;let l;try{l=globalThis.sqlite3ApiBootstrap()}catch(a){throw console.error("sqlite3ApiBootstrap() error:",a),a}finally{delete globalThis.sqlite3ApiBootstrap,delete globalThis.sqlite3ApiConfig}s.sqlite3=l}else console.warn("This is not running in an Emscripten module context, so","globalThis.sqlite3ApiBootstrap() is _not_ being called due to lack","of config info for the WASM environment.","It must be called manually.")}),r.ready}})();const tc=function(){var r,n;const t=ec;if(!t)throw new Error("Expecting globalThis.sqlite3InitModule to be defined by the Emscripten build.");const e=globalThis.sqlite3InitModuleState=Object.assign(Object.create(null),{moduleScript:(r=globalThis==null?void 0:globalThis.document)==null?void 0:r.currentScript,isWorker:typeof WorkerGlobalScope<"u",location:globalThis.location,urlParams:(n=globalThis==null?void 0:globalThis.location)!=null&&n.href?new URL(globalThis.location.href).searchParams:new URLSearchParams});if(e.debugModule=e.urlParams.has("sqlite3.debugModule")?(...O)=>console.warn("sqlite3.debugModule:",...O):()=>{},e.urlParams.has("sqlite3.dir"))e.sqlite3Dir=e.urlParams.get("sqlite3.dir")+"/";else if(e.moduleScript){const O=e.moduleScript.src.split("/");O.pop(),e.sqlite3Dir=O.join("/")+"/"}if(globalThis.sqlite3InitModule=function O(...j){return t(...j).then(Y=>{var je,et,ct;if(typeof WorkerGlobalScope<"u"&&(Y.ENVIRONMENT_IS_PTHREAD||Y._pthread_self||typeof threadAlert=="function"||(ct=(et=(je=globalThis==null?void 0:globalThis.location)==null?void 0:je.pathname)==null?void 0:et.endsWith)!=null&&ct.call(et,".worker.js")))return Y;const he=Y.sqlite3;he.scriptInfo=e,O.__isUnderTest&&(he.__isUnderTest=!0);const Te=he.asyncPostInit;return delete he.asyncPostInit,Te()}).catch(Y=>{throw console.error("Exception loading sqlite3 module:",Y),Y})},globalThis.sqlite3InitModule.ready=t.ready,globalThis.sqlite3InitModuleState.moduleScript){const O=globalThis.sqlite3InitModuleState;let j=O.moduleScript.src.split("/");j.pop(),O.scriptDir=j.join("/")+"/"}return e.debugModule("sqlite3InitModuleState =",e),globalThis.sqlite3InitModule}();/**
 * @license
 * Copyright 2019 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function nc(t){return t.constructor.name==="MessagePort"}function rc(t){nc(t)&&t.close()}function ic(t){return sc(t,{type:"RELEASE"}).then(()=>{rc(t)})}const xa=new WeakMap;"FinalizationRegistry"in globalThis&&new FinalizationRegistry(t=>{const e=(xa.get(t)||0)-1;xa.set(t,e),e===0&&ic(t)});function sc(t,e,r){return new Promise(n=>{const O=oc();t.addEventListener("message",function j(Y){!Y.data||!Y.data.id||Y.data.id!==O||(t.removeEventListener("message",j),n(Y.data))}),t.start&&t.start(),t.postMessage(Object.assign({id:O},e),r)})}function oc(){return new Array(4).fill(0).map(()=>Math.floor(Math.random()*Number.MAX_SAFE_INTEGER).toString(16)).join("-")}var Ea=t=>t==null||typeof t=="bigint"||typeof t=="string"||typeof t=="number"||typeof t=="object"&&"buffer"in t?t:typeof t=="boolean"?`${t}`:t instanceof Date?t.toISOString():JSON.stringify(t),ac=t=>{if(t==null||typeof t=="bigint"||typeof t=="number"||typeof t=="object"&&"buffer"in t)return t;if(typeof t=="string"){const e=/^\d{4}-\d{2}-\d{2}[T ]\d{2}:\d{2}:\d{2}(?:\.\d+)?Z?$/;if(/^(true|false)$/.test(t))return t==="true";if(e.test(t))return new Date(t);try{return JSON.parse(t,(r,n)=>typeof n=="string"&&e.exec(n)?new Date(n):n)}catch{}}return t},lc=class extends $s{constructor(e){super();ve(this,"serializer");this.serializer=e||Ea}transformPrimitiveValueList(e){return{...e,values:e.values.map(this.serializer)}}transformColumnUpdate(e){const{value:r}=e;if(r.kind!=="ValueNode")return super.transformColumnUpdate(e);const{value:n,...O}=r,j=this.serializer(n);return n===j?super.transformColumnUpdate(e):super.transformColumnUpdate({...e,value:{...O,value:j}})}transformValue(e){return{...e,value:this.serializer(e.value)}}},uc=class{constructor({deserializer:t,serializer:e}={}){ve(this,"serializeParametersTransformer");ve(this,"deserializer");ve(this,"ctx");this.serializeParametersTransformer=new lc(e),this.deserializer=t||ac,this.ctx=new WeakMap}transformQuery({node:t,queryId:e}){return t.kind==="SelectQueryNode"&&this.ctx.set(e,t.kind),this.serializeParametersTransformer.transformNode(t)}async parseResult(t){return await Promise.all(t.map(async e=>{const r={...e};for(const n in r)r[n]=await this.deserializer(r[n]);return r}))}async transformResult({result:t,queryId:e}){const{rows:r}=t,n=this.ctx.get(e);return this.ctx.delete(e),r&&n==="SelectQueryNode"?{...t,rows:await this.parseResult(r)}:t}};async function Sa(t,e,r,n,O="rowid"){await xt`
      create trigger if not exists ${xt.raw(e)}_${xt.raw(n)}
      after ${xt.raw(r)}
      on ${xt.table(e)}
      begin
        update ${xt.table(e)}
        set ${xt.ref(n)} = datetime('now','localtime')
        where ${xt.ref(O)} = NEW.${xt.ref(O)};
      end
    `.execute(t).catch(j=>{console.error(j)})}function cc(t){const e=new Map;for(const r in t){if(!Object.prototype.hasOwnProperty.call(t,r))continue;const n=t[r];e.set(r,n)}return e}async function dc(t,e,r=!1){for(const[n,O]of e){const{columns:j,property:Y}=O;r&&await t.schema.dropTable(n).ifExists().execute().catch();let he=t.schema.createTable(n);const{index:Te,primary:je,timestamp:et,unique:ct}=Y||{};let ke="rowid",bi=!1;const $n=typeof et=="object"&&et.create||"createAt",Tr=typeof et=="object"&&et.update||"updateAt";for(const[Be,Ot]of Object.entries(j)){let It="text";const{type:On,notNull:Zt,defaultTo:Kn}=Ot;switch(On){case"boolean":case"date":case"object":case"string":It="text";break;case"increments":ke=Be;case"number":It="integer";break;case"blob":It="blob"}[$n,Tr].includes(Be)||(he=he.addColumn(Be,It,In=>On==="increments"?(bi=!0,In.autoIncrement().primaryKey()):(Zt&&(In=In.notNull()),Kn!==void 0&&(In=In.defaultTo(Kn instanceof Function?Kn(xt):Kn)),In)))}if(et&&(he=he.addColumn($n,"text").addColumn(Tr,"text")),!bi&&je){const Be=Array.isArray(je);ke=Be?je[0]:je,he=he.addPrimaryKeyConstraint(`pk_${Be?je.join("_"):je}`,Be?je:[je])}if(ct==null||ct.forEach(Be=>{const Ot=Array.isArray(Be);ke=!je&&!bi?Ot?Be[0]:Be:ke,he=he.addUniqueConstraint(`un_${Ot?Be.join("_"):Be}`,Ot?Be:[Be])}),await he.ifNotExists().execute(),Te)for(const Be of Te){const Ot=Array.isArray(Be);await t.schema.createIndex(`idx_${Ot?Be.join("_"):Be}`).on(n).columns(Ot?Be:[Be]).ifNotExists().execute()}et&&(await Sa(t,n,"insert",$n,ke),await Sa(t,n,"update",Tr,ke))}}function fc(t){function e(r){return`__precomile_${r}`}return{setParam(r){let n;return(O,j)=>{if(!n){const{parameters:Y,sql:he,query:Te}=r(t,e).compile();n={sql:he,query:(j==null?void 0:j(Te))||{kind:Te.kind},parameters:Y}}return{...n,parameters:n.parameters.map(Y=>typeof Y=="string"&&Y.startsWith("__precomile_")?Ea(O[Y.slice(12)]):Y)}}}}}var hc=class{constructor(){ve(this,"items");this.items=[]}push(t){this.items.push(t)}pop(){return this.items.pop()}peek(){return this.items[this.items.length-1]}isEmpty(){return this.items.length===0}size(){return this.items.length}},pc=class{constructor(t){ve(this,"kysely");ve(this,"status");ve(this,"tableMap");ve(this,"logger");ve(this,"trxs");const{dialect:e,tables:r,dropTableBeforeInit:n,onQuery:O,plugins:j,logger:Y}=t;this.logger=Y;const he=j??[];he.push(new uc),this.kysely=new Zr({dialect:e,log:Te=>{var je;Te.level==="error"?(je=this.logger)==null||je.error("Uncaught DB Error",Te.error):O==null||O(Te.query,Te.queryDurationMillis)},plugins:he}),this.status=n?0:1,this.tableMap=cc(r),this.trxs=new hc}async init(t=!1){const e=t||this.status===0;return await dc(this.kysely,this.tableMap,e),this.status=2,this}async isEmptyTable(){var t;return this.status!==2&&await this.init(),this.status===2?!1:((t=this.logger)==null||t.error("fail to init table"),!0)}async transaction(t,e){if(!await this.isEmptyTable())return await this.kysely.transaction().execute(r=>(this.trxs.push(r),t(r))).catch(r=>{var n;e&&((n=this.logger)==null||n.error(e,r))}).finally(()=>{this.trxs.pop()})}getDB(){return this.trxs.isEmpty()?this.kysely:this.trxs.peek()}async exec(t,e){if(!await this.isEmptyTable())return t(this.getDB()).catch(r=>{var n;e&&((n=this.logger)==null||n.error(e,r))})}async execOne(t,e){const r=await this.execList(t,e);return r!=null&&r.length?r[0]:void 0}async execList(t,e){if(!await this.isEmptyTable())return t(this.getDB()).execute().catch(r=>{var n;e&&((n=this.logger)==null||n.error(e,r))})}preCompile(t){return fc(t(this.kysely))}async execCompiledRows(t,e){const r=await this.execCompiled(t,e);return(r==null?void 0:r.rows)??void 0}async execCompiled(t,e){if(!await this.isEmptyTable())return this.getDB().executeQuery(t).catch(r=>{var n;e&&((n=this.logger)==null||n.error(e,r))})}async toSQL(t){return t(this.getDB()).compile()}async raw(t){if(!await this.isEmptyTable())return t(xt).execute(this.getDB())}};async function _c(t){const e=await new pc({dialect:t,tables:{test:{columns:{id:{type:"increments"},name:{type:"string"},blobtest:{type:"blob"},createAt:{type:"date"},updateAt:{type:"date"}},property:{timestamp:!0}}}}).init();console.log("test"),console.log(await e.raw(r=>r`PRAGMA table_info(${r.table("test")});`)),console.log(await e.raw(r=>r`select last_insert_rowid()`));for(let r=0;r<100;r++)await e.transaction(n=>n.insertInto("test").values({name:`test at ${Date.now()}`,blobtest:Uint8Array.from([2,3,4,5,6,7,8])}).execute());return e.exec(r=>r.selectFrom("test").selectAll().execute())}const mc=new Yu({database:async()=>{const t=(await tc()).oo1;if(!t)return Promise.reject("fail to load sqlite");const e="/test.db";return t.OpfsDb?(console.log("support OPFS"),new t.OpfsDb(e)):(console.log("doesn't support OPFS"),new t.DB(e))},async onCreateConnection(t){await Zu(t)}});onmessage=()=>{console.log("start official wasm test"),_c(mc).then(t=>{t==null||t.forEach(e=>console.log("[official wasm]",e))})}})();
