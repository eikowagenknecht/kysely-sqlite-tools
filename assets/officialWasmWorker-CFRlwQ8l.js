var kc=Object.defineProperty;var Ac=(t,e,r)=>e in t?kc(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r;var Re=(t,e,r)=>(Ac(t,typeof e!="symbol"?e+"":e,r),r),Oo=(t,e,r)=>{if(!e.has(t))throw TypeError("Cannot "+r)};var i=(t,e,r)=>(Oo(t,e,"read from private field"),r?r.call(t):e.get(t)),B=(t,e,r)=>{if(e.has(t))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(t):e.set(t,r)},J=(t,e,r,n)=>(Oo(t,e,"write to private field"),n?n.call(t,r):e.set(t,r),r);var ve=(t,e,r)=>(Oo(t,e,"access private method"),r);function Vn(t){return typeof t>"u"||t===void 0}function jt(t){return typeof t=="string"}function go(t){return typeof t=="number"}function _s(t){return typeof t=="boolean"}function Zo(t){return t===null}function Oc(t){return t instanceof Date}function ea(t){return typeof t=="bigint"}function zt(t){return typeof t=="function"}function un(t){return typeof t=="object"&&t!==null}function f(t){return Object.freeze(t)}function os(t){return In(t)?t:[t]}function In(t){return Array.isArray(t)}function $n(t){return t}const Ve=f({is(t){return t.kind==="AlterTableNode"},create(t){return f({kind:"AlterTableNode",table:t})},cloneWithTableProps(t,e){return f({...t,...e})},cloneWithColumnAlteration(t,e){return f({...t,columnAlterations:t.columnAlterations?[...t.columnAlterations,e]:[e]})}}),Ye=f({is(t){return t.kind==="IdentifierNode"},create(t){return f({kind:"IdentifierNode",name:t})}}),_n=f({is(t){return t.kind==="CreateIndexNode"},create(t){return f({kind:"CreateIndexNode",name:Ye.create(t)})},cloneWith(t,e){return f({...t,...e})},cloneWithColumns(t,e){return f({...t,columns:[...t.columns||[],...e]})}}),yl=f({is(t){return t.kind==="CreateSchemaNode"},create(t,e){return f({kind:"CreateSchemaNode",schema:Ye.create(t),...e})},cloneWith(t,e){return f({...t,...e})}}),Tc=["preserve rows","delete rows","drop"],Wt=f({is(t){return t.kind==="CreateTableNode"},create(t){return f({kind:"CreateTableNode",table:t,columns:f([])})},cloneWithColumn(t,e){return f({...t,columns:f([...t.columns,e])})},cloneWithConstraint(t,e){return f({...t,constraints:t.constraints?f([...t.constraints,e]):f([e])})},cloneWithFrontModifier(t,e){return f({...t,frontModifiers:t.frontModifiers?f([...t.frontModifiers,e]):f([e])})},cloneWithEndModifier(t,e){return f({...t,endModifiers:t.endModifiers?f([...t.endModifiers,e]):f([e])})},cloneWith(t,e){return f({...t,...e})}}),Jn=f({is(t){return t.kind==="SchemableIdentifierNode"},create(t){return f({kind:"SchemableIdentifierNode",identifier:Ye.create(t)})},createWithSchema(t,e){return f({kind:"SchemableIdentifierNode",schema:Ye.create(t),identifier:Ye.create(e)})}}),pi=f({is(t){return t.kind==="DropIndexNode"},create(t,e){return f({kind:"DropIndexNode",name:Jn.create(t),...e})},cloneWith(t,e){return f({...t,...e})}}),Po=f({is(t){return t.kind==="DropSchemaNode"},create(t,e){return f({kind:"DropSchemaNode",schema:Ye.create(t),...e})},cloneWith(t,e){return f({...t,...e})}}),Wo=f({is(t){return t.kind==="DropTableNode"},create(t,e){return f({kind:"DropTableNode",table:t,...e})},cloneWith(t,e){return f({...t,...e})}}),Yn=f({is(t){return t.kind==="AliasNode"},create(t,e){return f({kind:"AliasNode",node:t,alias:e})}}),Hn=f({is(t){return t.kind==="TableNode"},create(t){return f({kind:"TableNode",table:Jn.create(t)})},createWithSchema(t,e){return f({kind:"TableNode",table:Jn.createWithSchema(t,e)})}});function Ft(t){return un(t)&&zt(t.toOperationNode)}function Cc(t){return un(t)&&"expressionType"in t&&Ft(t)}function Fc(t){return un(t)&&"expression"in t&&jt(t.alias)&&Ft(t)}const mn=f({is(t){return t.kind==="SelectModifierNode"},create(t,e){return f({kind:"SelectModifierNode",modifier:t,of:e})},createWithExpression(t){return f({kind:"SelectModifierNode",rawModifier:t})}}),Gn=f({is(t){return t.kind==="AndNode"},create(t,e){return f({kind:"AndNode",left:t,right:e})}}),si=f({is(t){return t.kind==="OrNode"},create(t,e){return f({kind:"OrNode",left:t,right:e})}}),To=f({is(t){return t.kind==="OnNode"},create(t){return f({kind:"OnNode",on:t})},cloneWithOperation(t,e,r){return f({...t,on:e==="And"?Gn.create(t.on,r):si.create(t.on,r)})}}),mi=f({is(t){return t.kind==="JoinNode"},create(t,e){return f({kind:"JoinNode",joinType:t,table:e,on:void 0})},createWithOn(t,e,r){return f({kind:"JoinNode",joinType:t,table:e,on:To.create(r)})},cloneWithOn(t,e){return f({...t,on:t.on?To.cloneWithOperation(t.on,"And",e):To.create(e)})}}),ni=f({is(t){return t.kind==="BinaryOperationNode"},create(t,e,r){return f({kind:"BinaryOperationNode",leftOperand:t,operator:e,rightOperand:r})}}),Pc=["=","==","!=","<>",">",">=","<","<=","in","not in","is","is not","like","not like","match","ilike","not ilike","@>","<@","&&","?","?&","!<","!>","<=>","!~","~","~*","!~*","@@","@@@","!!","<->","regexp","is distinct from","is not distinct from"],Wc=["+","-","*","/","%","^","&","|","#","<<",">>"],gl=["->","->>"],Lc=[...Pc,...Wc,"&&","||"],Dc=["exists","not exists"],Rc=["not","-",...Dc],Mc=[...Lc,...gl,...Rc,"between","between symmetric"],Kn=f({is(t){return t.kind==="OperatorNode"},create(t){return f({kind:"OperatorNode",operator:t})}});function Ua(t){return jt(t)&&gl.includes(t)}const ot=f({is(t){return t.kind==="ColumnNode"},create(t){return f({kind:"ColumnNode",column:Ye.create(t)})}}),ta=f({is(t){return t.kind==="SelectAllNode"},create(){return f({kind:"SelectAllNode"})}}),wo=f({is(t){return t.kind==="ReferenceNode"},create(t,e){return f({kind:"ReferenceNode",table:e,column:t})},createSelectAll(t){return f({kind:"ReferenceNode",table:t,column:ta.create()})}});var Wr;class Bc{constructor(e){B(this,Wr,void 0);J(this,Wr,e)}get dynamicReference(){return i(this,Wr)}get refType(){}toOperationNode(){return vl(i(this,Wr))}}Wr=new WeakMap;function wl(t){return un(t)&&Ft(t)&&jt(t.dynamicReference)}const Lo=f({is(t){return t.kind==="OrderByItemNode"},create(t,e){return f({kind:"OrderByItemNode",orderBy:t,direction:e})}}),bt=f({is(t){return t.kind==="RawNode"},create(t,e){return f({kind:"RawNode",sqlFragments:f(t),parameters:f(e)})},createWithSql(t){return bt.create([t],[])},createWithChild(t){return bt.create(["",""],[t])},createWithChildren(t){return bt.create(new Array(t.length+1).fill(""),t)}});function bl(t){return t==="asc"||t==="desc"}function bo(t){if(t.length===2)return[Co(t[0],t[1])];if(t.length===1){const[e]=t;return Array.isArray(e)?e.map(r=>Co(r)):[Co(e)]}throw new Error(`Invalid number of arguments at order by! expected 1-2, received ${t.length}`)}function Co(t,e){const r=Qc(t);if(Lo.is(r)){if(e)throw new Error("Cannot specify direction twice!");return r}return Lo.create(r,ql(e))}function Qc(t){if(es(t))return vr(t);if(wl(t))return t.toOperationNode();const[e,r]=t.split(" ");if(r){if(!bl(r))throw new Error(`Invalid order by direction: ${r}`);return Lo.create(kn(e),ql(r))}return kn(t)}function ql(t){if(t)return t==="asc"||t==="desc"?bt.createWithSql(t):t.toOperationNode()}const ys=f({is(t){return t.kind==="JSONReferenceNode"},create(t,e){return f({kind:"JSONReferenceNode",reference:t,traversal:e})},cloneWithTraversal(t,e){return f({...t,traversal:e})}}),Nl=f({is(t){return t.kind==="JSONOperatorChainNode"},create(t){return f({kind:"JSONOperatorChainNode",operator:t,values:f([])})},cloneWithValue(t,e){return f({...t,values:f([...t.values,e])})}}),_i=f({is(t){return t.kind==="JSONPathNode"},create(t){return f({kind:"JSONPathNode",inOperator:t,pathLegs:f([])})},cloneWithLeg(t,e){return f({...t,pathLegs:f([...t.pathLegs,e])})}});function vl(t){return jt(t)?kn(t):t.toOperationNode()}function Ii(t){return In(t)?t.map(e=>Ut(e)):[Ut(t)]}function Ut(t){return es(t)?vr(t):vl(t)}function Uc(t,e){const r=kn(t);if(Ua(e))return ys.create(r,Nl.create(Kn.create(e)));const n=e.slice(0,-1);if(Ua(n))return ys.create(r,_i.create(Kn.create(n)));throw new Error(`Invalid JSON operator: ${e}`)}function kn(t){const e=".";if(!t.includes(e))return wo.create(ot.create(t));const r=t.split(e).map(na);if(r.length===3)return zc(r);if(r.length===2)return Vc(r);throw new Error(`invalid column reference ${t}`)}function jc(t){const e=" as ";if(t.includes(e)){const[r,n]=t.split(e).map(na);return Yn.create(kn(r),Ye.create(n))}else return kn(t)}function xl(t){return ot.create(t)}function gs(t){const e=" ";if(t.includes(e)){const[r,n]=t.split(e).map(na);if(!bl(n))throw new Error(`invalid order direction "${n}" next to "${r}"`);return bo([r,n])[0]}else return xl(t)}function zc(t){const[e,r,n]=t;return wo.create(ot.create(n),Hn.createWithSchema(e,r))}function Vc(t){const[e,r]=t;return wo.create(ot.create(r),Hn.create(e))}function na(t){return t.trim()}const El=f({is(t){return t.kind==="PrimitiveValueListNode"},create(t){return f({kind:"PrimitiveValueListNode",values:f([...t])})}}),ra=f({is(t){return t.kind==="ValueListNode"},create(t){return f({kind:"ValueListNode",values:f(t)})}}),dn=f({is(t){return t.kind==="ValueNode"},create(t){return f({kind:"ValueNode",value:t})},createImmediate(t){return f({kind:"ValueNode",value:t,immediate:!0})}});function $c(t){return In(t)?Hc(t):ut(t)}function ut(t){return es(t)?vr(t):dn.create(t)}function ia(t){return go(t)||_s(t)||Zo(t)}function sa(t){if(!ia(t))throw new Error(`unsafe immediate value ${JSON.stringify(t)}`);return dn.createImmediate(t)}function Hc(t){return t.some(es)?ra.create(t.map(e=>ut(e))):El.create(t)}const ri=f({is(t){return t.kind==="ParensNode"},create(t){return f({kind:"ParensNode",node:t})}});function qt(t){if(t.length===3)return oa(t[0],t[1],t[2]);if(t.length===1)return ut(t[0]);throw new Error(`invalid arguments: ${JSON.stringify(t)}`)}function oa(t,e,r){return Jc(e)&&Sl(r)?ni.create(Ut(t),Do(e),dn.createImmediate(r)):ni.create(Ut(t),Do(e),$c(r))}function fn(t,e,r){return ni.create(Ut(t),Do(e),Ut(r))}function ja(t,e){return ws(Object.entries(t).filter(([,r])=>!Vn(r)).map(([r,n])=>oa(r,Sl(n)?"is":"=",n)),e)}function ws(t,e,r=!0){const n=e==="and"?Gn.create:si.create;if(t.length===0)return ni.create(dn.createImmediate(1),Kn.create("="),dn.createImmediate(e==="and"?1:0));let I=za(t[0]);for(let Q=1;Q<t.length;++Q)I=n(I,za(t[Q]));return t.length>1&&r?ri.create(I):I}function Jc(t){return t==="is"||t==="is not"}function Sl(t){return Zo(t)||_s(t)}function Do(t){if(jt(t)&&Mc.includes(t))return Kn.create(t);if(Ft(t))return t.toOperationNode();throw new Error(`invalid operator ${JSON.stringify(t)}`)}function za(t){return Ft(t)?t.toOperationNode():t}const ii=f({is(t){return t.kind==="OrderByNode"},create(t){return f({kind:"OrderByNode",items:f([...t])})},cloneWithItems(t,e){return f({...t,items:f([...t.items,...e])})}}),Va=f({is(t){return t.kind==="PartitionByNode"},create(t){return f({kind:"PartitionByNode",items:f(t)})},cloneWithItems(t,e){return f({...t,items:f([...t.items,...e])})}}),Ro=f({is(t){return t.kind==="OverNode"},create(){return f({kind:"OverNode"})},cloneWithOrderByItems(t,e){return f({...t,orderBy:t.orderBy?ii.cloneWithItems(t.orderBy,e):ii.create(e)})},cloneWithPartitionByItems(t,e){return f({...t,partitionBy:t.partitionBy?Va.cloneWithItems(t.partitionBy,e):Va.create(e)})}}),bs=f({is(t){return t.kind==="FromNode"},create(t){return f({kind:"FromNode",froms:f(t)})},cloneWithFroms(t,e){return f({...t,froms:f([...t.froms,...e])})}}),$a=f({is(t){return t.kind==="GroupByNode"},create(t){return f({kind:"GroupByNode",items:f(t)})},cloneWithItems(t,e){return f({...t,items:f([...t.items,...e])})}}),Ha=f({is(t){return t.kind==="HavingNode"},create(t){return f({kind:"HavingNode",having:t})},cloneWithOperation(t,e,r){return f({...t,having:e==="And"?Gn.create(t.having,r):si.create(t.having,r)})}}),Oe=f({is(t){return t.kind==="SelectQueryNode"},create(t){return f({kind:"SelectQueryNode",...t&&{with:t}})},createFrom(t,e){return f({kind:"SelectQueryNode",from:bs.create(t),...e&&{with:e}})},cloneWithSelections(t,e){return f({...t,selections:t.selections?f([...t.selections,...e]):f(e)})},cloneWithDistinctOn(t,e){return f({...t,distinctOn:t.distinctOn?f([...t.distinctOn,...e]):f(e)})},cloneWithFrontModifier(t,e){return f({...t,frontModifiers:t.frontModifiers?f([...t.frontModifiers,e]):f([e])})},cloneWithEndModifier(t,e){return f({...t,endModifiers:t.endModifiers?f([...t.endModifiers,e]):f([e])})},cloneWithOrderByItems(t,e){return f({...t,orderBy:t.orderBy?ii.cloneWithItems(t.orderBy,e):ii.create(e)})},cloneWithGroupByItems(t,e){return f({...t,groupBy:t.groupBy?$a.cloneWithItems(t.groupBy,e):$a.create(e)})},cloneWithLimit(t,e){return f({...t,limit:e})},cloneWithOffset(t,e){return f({...t,offset:e})},cloneWithFetch(t,e){return f({...t,fetch:e})},cloneWithHaving(t,e){return f({...t,having:t.having?Ha.cloneWithOperation(t.having,"And",e):Ha.create(e)})},cloneWithSetOperations(t,e){return f({...t,setOperations:t.setOperations?f([...t.setOperations,...e]):f([...e])})},cloneWithoutSelections(t){return f({...t,selections:[]})},cloneWithoutLimit(t){return f({...t,limit:void 0})},cloneWithoutOffset(t){return f({...t,offset:void 0})},cloneWithoutOrderBy(t){return f({...t,orderBy:void 0})}});function Se(t,e){Object.defineProperties(t.prototype,{then:{enumerable:!1,value:()=>{throw new Error(e)}}})}var Gt;const bi=class bi{constructor(e){B(this,Gt,void 0);J(this,Gt,f(e))}on(...e){return new bi({...i(this,Gt),joinNode:mi.cloneWithOn(i(this,Gt).joinNode,qt(e))})}onRef(e,r,n){return new bi({...i(this,Gt),joinNode:mi.cloneWithOn(i(this,Gt).joinNode,fn(e,r,n))})}onTrue(){return new bi({...i(this,Gt),joinNode:mi.cloneWithOn(i(this,Gt).joinNode,bt.createWithSql("true"))})}$call(e){return e(this)}toOperationNode(){return i(this,Gt).joinNode}};Gt=new WeakMap;let qs=bi;Se(qs,"don't await JoinBuilder instances. They are never executed directly and are always just a part of a query.");const Gc=f({is(t){return t.kind==="PartitionByItemNode"},create(t){return f({kind:"PartitionByItemNode",partitionBy:t})}});function Kc(t){return Ii(t).map(Gc.create)}var ur;const Js=class Js{constructor(e){B(this,ur,void 0);J(this,ur,f(e))}orderBy(e,r){return new Js({overNode:Ro.cloneWithOrderByItems(i(this,ur).overNode,bo([e,r]))})}partitionBy(e){return new Js({overNode:Ro.cloneWithPartitionByItems(i(this,ur).overNode,Kc(e))})}$call(e){return e(this)}toOperationNode(){return i(this,ur).overNode}};ur=new WeakMap;let Ns=Js;Se(Ns,"don't await OverBuilder instances. They are never executed directly and are always just a part of a query.");const yi=f({is(t){return t.kind==="SelectionNode"},create(t){return f({kind:"SelectionNode",selection:t})},createSelectAll(){return f({kind:"SelectionNode",selection:ta.create()})},createSelectAllFromTable(t){return f({kind:"SelectionNode",selection:wo.createSelectAll(t)})}});function oi(t){return zt(t)?oi(t(li())):In(t)?t.map(e=>Ja(e)):[Ja(t)]}function Ja(t){return jt(t)?yi.create(jc(t)):wl(t)?yi.create(t.toOperationNode()):yi.create(Ul(t))}function Gi(t){return t?Array.isArray(t)?t.map(Ga):[Ga(t)]:[yi.createSelectAll()]}function Ga(t){if(jt(t))return yi.createSelectAllFromTable(st(t));throw new Error(`invalid value selectAll expression: ${JSON.stringify(t)}`)}const Xc=f({is(t){return t.kind==="ValuesNode"},create(t){return f({kind:"ValuesNode",values:f(t)})}}),Yc=f({is(t){return t.kind==="DefaultInsertValueNode"},create(){return f({kind:"DefaultInsertValueNode"})}});function Il(t){const e=zt(t)?t(li()):t,r=In(e)?e:f([e]);return Zc(r)}function Zc(t){const e=ed(t);return[f([...e.keys()].map(ot.create)),Xc.create(t.map(r=>td(r,e)))]}function ed(t){const e=new Map;for(const r of t){const n=Object.keys(r);for(const I of n)!e.has(I)&&r[I]!==void 0&&e.set(I,e.size)}return e}function td(t,e){const r=Object.keys(t),n=Array.from({length:e.size});let I=!1;for(const re of r){const Ie=e.get(re);if(Vn(Ie))continue;const ze=t[re];(Vn(ze)||es(ze))&&(I=!0),n[Ie]=ze}if(r.length<e.size||I){const re=Yc.create();return ra.create(n.map(Ie=>Vn(Ie)?re:ut(Ie)))}return El.create(n)}const Qt=f({is(t){return t.kind==="InsertQueryNode"},create(t,e,r){return f({kind:"InsertQueryNode",into:t,...e&&{with:e},replace:r})},createWithoutInto(){return f({kind:"InsertQueryNode"})},cloneWith(t,e){return f({...t,...e})}}),Fr=f({is(t){return t.kind==="UpdateQueryNode"},create(t,e){return f({kind:"UpdateQueryNode",table:t,...e&&{with:e}})},createWithoutTable(){return f({kind:"UpdateQueryNode"})},cloneWithFromItems(t,e){return f({...t,from:t.from?bs.cloneWithFroms(t.from,e):bs.create(e)})},cloneWithUpdates(t,e){return f({...t,updates:t.updates?f([...t.updates,...e]):e})},cloneWithLimit(t,e){return f({...t,limit:e})}}),Ka=f({is(t){return t.kind==="UsingNode"},create(t){return f({kind:"UsingNode",tables:f(t)})},cloneWithTables(t,e){return f({...t,tables:f([...t.tables,...e])})}}),rr=f({is(t){return t.kind==="DeleteQueryNode"},create(t,e){return f({kind:"DeleteQueryNode",from:bs.create(t),...e&&{with:e}})},cloneWithOrderByItems(t,e){return f({...t,orderBy:t.orderBy?ii.cloneWithItems(t.orderBy,e):ii.create(e)})},cloneWithoutOrderBy(t){return f({...t,orderBy:void 0})},cloneWithLimit(t,e){return f({...t,limit:e})},cloneWithoutLimit(t){return f({...t,limit:void 0})},cloneWithUsing(t,e){return f({...t,using:t.using!==void 0?Ka.cloneWithTables(t.using,e):Ka.create(e)})}}),Tt=f({is(t){return t.kind==="WhereNode"},create(t){return f({kind:"WhereNode",where:t})},cloneWithOperation(t,e,r){return f({...t,where:e==="And"?Gn.create(t.where,r):si.create(t.where,r)})}}),Xa=f({is(t){return t.kind==="ReturningNode"},create(t){return f({kind:"ReturningNode",selections:f(t)})},cloneWithSelections(t,e){return f({...t,selections:t.selections?f([...t.selections,...e]):f(e)})}}),nd=f({is(t){return t.kind==="ExplainNode"},create(t,e){return f({kind:"ExplainNode",format:t,options:e})}}),Ki=f({is(t){return t.kind==="WhenNode"},create(t){return f({kind:"WhenNode",condition:t})},cloneWithResult(t,e){return f({...t,result:e})}}),Ct=f({is(t){return t.kind==="MergeQueryNode"},create(t,e){return f({kind:"MergeQueryNode",into:t,...e&&{with:e}})},cloneWithUsing(t,e){return f({...t,using:e})},cloneWithWhen(t,e){return f({...t,whens:t.whens?f([...t.whens,e]):f([e])})},cloneWithThen(t,e){return f({...t,whens:t.whens?f([...t.whens.slice(0,-1),Ki.cloneWithResult(t.whens[t.whens.length-1],e)]):void 0})}}),we=f({is(t){return Oe.is(t)||Qt.is(t)||Fr.is(t)||rr.is(t)||Ct.is(t)},cloneWithWhere(t,e){return f({...t,where:t.where?Tt.cloneWithOperation(t.where,"And",e):Tt.create(e)})},cloneWithJoin(t,e){return f({...t,joins:t.joins?f([...t.joins,e]):f([e])})},cloneWithReturning(t,e){return f({...t,returning:t.returning?Xa.cloneWithSelections(t.returning,e):Xa.create(e)})},cloneWithoutReturning(t){return f({...t,returning:void 0})},cloneWithoutWhere(t){return f({...t,where:void 0})},cloneWithExplain(t,e,r){return f({...t,explain:nd.create(e,r?.toOperationNode())})},cloneWithTop(t,e){return f({...t,top:e})}}),kl=f({is(t){return t.kind==="ColumnUpdateNode"},create(t,e){return f({kind:"ColumnUpdateNode",column:t,value:e})}});function rd(...t){return t.length===2?[kl.create(Ut(t[0]),ut(t[1]))]:aa(t[0])}function aa(t){const e=zt(t)?t(li()):t;return Object.entries(e).filter(([r,n])=>n!==void 0).map(([r,n])=>kl.create(ot.create(r),ut(n)))}const id=f({is(t){return t.kind==="OnDuplicateKeyNode"},create(t){return f({kind:"OnDuplicateKeyNode",updates:t})}});class sd{constructor(e,r){Re(this,"insertId");Re(this,"numInsertedOrUpdatedRows");this.insertId=e,this.numInsertedOrUpdatedRows=r}}class Xi extends Error{constructor(r){super("no result");Re(this,"node");this.node=r}}function Yi(t){return Object.prototype.hasOwnProperty.call(t,"prototype")}const Bt=f({is(t){return t.kind==="OnConflictNode"},create(){return f({kind:"OnConflictNode"})},cloneWith(t,e){return f({...t,...e})},cloneWithIndexWhere(t,e){return f({...t,indexWhere:t.indexWhere?Tt.cloneWithOperation(t.indexWhere,"And",e):Tt.create(e)})},cloneWithIndexOrWhere(t,e){return f({...t,indexWhere:t.indexWhere?Tt.cloneWithOperation(t.indexWhere,"Or",e):Tt.create(e)})},cloneWithUpdateWhere(t,e){return f({...t,updateWhere:t.updateWhere?Tt.cloneWithOperation(t.updateWhere,"And",e):Tt.create(e)})},cloneWithUpdateOrWhere(t,e){return f({...t,updateWhere:t.updateWhere?Tt.cloneWithOperation(t.updateWhere,"Or",e):Tt.create(e)})},cloneWithoutIndexWhere(t){return f({...t,indexWhere:void 0})},cloneWithoutUpdateWhere(t){return f({...t,updateWhere:void 0})}});var Je;const gn=class gn{constructor(e){B(this,Je,void 0);J(this,Je,f(e))}column(e){const r=ot.create(e);return new gn({...i(this,Je),onConflictNode:Bt.cloneWith(i(this,Je).onConflictNode,{columns:i(this,Je).onConflictNode.columns?f([...i(this,Je).onConflictNode.columns,r]):f([r])})})}columns(e){const r=e.map(ot.create);return new gn({...i(this,Je),onConflictNode:Bt.cloneWith(i(this,Je).onConflictNode,{columns:i(this,Je).onConflictNode.columns?f([...i(this,Je).onConflictNode.columns,...r]):f(r)})})}constraint(e){return new gn({...i(this,Je),onConflictNode:Bt.cloneWith(i(this,Je).onConflictNode,{constraint:Ye.create(e)})})}expression(e){return new gn({...i(this,Je),onConflictNode:Bt.cloneWith(i(this,Je).onConflictNode,{indexExpression:e.toOperationNode()})})}where(...e){return new gn({...i(this,Je),onConflictNode:Bt.cloneWithIndexWhere(i(this,Je).onConflictNode,qt(e))})}whereRef(e,r,n){return new gn({...i(this,Je),onConflictNode:Bt.cloneWithIndexWhere(i(this,Je).onConflictNode,fn(e,r,n))})}clearWhere(){return new gn({...i(this,Je),onConflictNode:Bt.cloneWithoutIndexWhere(i(this,Je).onConflictNode)})}doNothing(){return new Al({...i(this,Je),onConflictNode:Bt.cloneWith(i(this,Je).onConflictNode,{doNothing:!0})})}doUpdateSet(e){return new xs({...i(this,Je),onConflictNode:Bt.cloneWith(i(this,Je).onConflictNode,{updates:aa(e)})})}$call(e){return e(this)}};Je=new WeakMap;let vs=gn;Se(vs,"don't await OnConflictBuilder instances.");var Wi;class Al{constructor(e){B(this,Wi,void 0);J(this,Wi,f(e))}toOperationNode(){return i(this,Wi).onConflictNode}}Wi=new WeakMap;Se(Al,"don't await OnConflictDoNothingBuilder instances.");var Kt;const qi=class qi{constructor(e){B(this,Kt,void 0);J(this,Kt,f(e))}where(...e){return new qi({...i(this,Kt),onConflictNode:Bt.cloneWithUpdateWhere(i(this,Kt).onConflictNode,qt(e))})}whereRef(e,r,n){return new qi({...i(this,Kt),onConflictNode:Bt.cloneWithUpdateWhere(i(this,Kt).onConflictNode,fn(e,r,n))})}clearWhere(){return new qi({...i(this,Kt),onConflictNode:Bt.cloneWithoutUpdateWhere(i(this,Kt).onConflictNode)})}$call(e){return e(this)}toOperationNode(){return i(this,Kt).onConflictNode}};Kt=new WeakMap;let xs=qi;Se(xs,"don't await OnConflictUpdateBuilder instances.");const od=f({is(t){return t.kind==="TopNode"},create(t,e){return f({kind:"TopNode",expression:t,modifiers:e})}});function ai(t,e){if(!go(t)&&!ea(t))throw new Error(`Invalid top expression: ${t}`);if(!Vn(e)&&!ad(e))throw new Error(`Invalid top modifiers: ${e}`);return od.create(t,e)}function ad(t){return t==="percent"||t==="with ties"||t==="percent with ties"}var Ne;const ct=class ct{constructor(e){B(this,Ne,void 0);J(this,Ne,f(e))}values(e){const[r,n]=Il(e);return new ct({...i(this,Ne),queryNode:Qt.cloneWith(i(this,Ne).queryNode,{columns:r,values:n})})}columns(e){return new ct({...i(this,Ne),queryNode:Qt.cloneWith(i(this,Ne).queryNode,{columns:f(e.map(ot.create))})})}expression(e){return new ct({...i(this,Ne),queryNode:Qt.cloneWith(i(this,Ne).queryNode,{values:vr(e)})})}defaultValues(){return new ct({...i(this,Ne),queryNode:Qt.cloneWith(i(this,Ne).queryNode,{defaultValues:!0})})}ignore(){return new ct({...i(this,Ne),queryNode:Qt.cloneWith(i(this,Ne).queryNode,{ignore:!0})})}top(e,r){return new ct({...i(this,Ne),queryNode:we.cloneWithTop(i(this,Ne).queryNode,ai(e,r))})}onConflict(e){return new ct({...i(this,Ne),queryNode:Qt.cloneWith(i(this,Ne).queryNode,{onConflict:e(new vs({onConflictNode:Bt.create()})).toOperationNode()})})}onDuplicateKeyUpdate(e){return new ct({...i(this,Ne),queryNode:Qt.cloneWith(i(this,Ne).queryNode,{onDuplicateKey:id.create(aa(e))})})}returning(e){return new ct({...i(this,Ne),queryNode:we.cloneWithReturning(i(this,Ne).queryNode,oi(e))})}returningAll(){return new ct({...i(this,Ne),queryNode:we.cloneWithReturning(i(this,Ne).queryNode,Gi())})}clearReturning(){return new ct({...i(this,Ne),queryNode:we.cloneWithoutReturning(i(this,Ne).queryNode)})}$call(e){return e(this)}$if(e,r){return e?r(this):new ct({...i(this,Ne)})}$castTo(){return new ct(i(this,Ne))}$narrowType(){return new ct(i(this,Ne))}$assertType(){return new ct(i(this,Ne))}withPlugin(e){return new ct({...i(this,Ne),executor:i(this,Ne).executor.withPlugin(e)})}toOperationNode(){return i(this,Ne).executor.transformQuery(i(this,Ne).queryNode,i(this,Ne).queryId)}compile(){return i(this,Ne).executor.compileQuery(this.toOperationNode(),i(this,Ne).queryId)}async execute(){const e=this.compile(),r=e.query,n=await i(this,Ne).executor.executeQuery(e,i(this,Ne).queryId);return i(this,Ne).executor.adapter.supportsReturning&&r.returning?n.rows:[new sd(n.insertId,n.numAffectedRows??n.numUpdatedOrDeletedRows)]}async executeTakeFirst(){const[e]=await this.execute();return e}async executeTakeFirstOrThrow(e=Xi){const r=await this.executeTakeFirst();if(r===void 0)throw Yi(e)?new e(this.toOperationNode()):e(this.toOperationNode());return r}async*stream(e=100){const r=this.compile(),n=i(this,Ne).executor.stream(r,e,i(this,Ne).queryId);for await(const I of n)yield*I.rows}async explain(e,r){return await new ct({...i(this,Ne),queryNode:we.cloneWithExplain(i(this,Ne).queryNode,e,r)}).execute()}};Ne=new WeakMap;let ki=ct;Se(ki,"don't await InsertQueryBuilder instances directly. To execute the query you need to call `execute` or `executeTakeFirst`.");class ld{constructor(e){Re(this,"numDeletedRows");this.numDeletedRows=e}}const la=f({is(t){return t.kind==="LimitNode"},create(t){return f({kind:"LimitNode",limit:t})}});var de;const Xe=class Xe{constructor(e){B(this,de,void 0);J(this,de,f(e))}where(...e){return new Xe({...i(this,de),queryNode:we.cloneWithWhere(i(this,de).queryNode,qt(e))})}whereRef(e,r,n){return new Xe({...i(this,de),queryNode:we.cloneWithWhere(i(this,de).queryNode,fn(e,r,n))})}clearWhere(){return new Xe({...i(this,de),queryNode:we.cloneWithoutWhere(i(this,de).queryNode)})}top(e,r){return new Xe({...i(this,de),queryNode:we.cloneWithTop(i(this,de).queryNode,ai(e,r))})}using(e){return new Xe({...i(this,de),queryNode:rr.cloneWithUsing(i(this,de).queryNode,Oi(e))})}innerJoin(...e){return new Xe({...i(this,de),queryNode:we.cloneWithJoin(i(this,de).queryNode,At("InnerJoin",e))})}leftJoin(...e){return new Xe({...i(this,de),queryNode:we.cloneWithJoin(i(this,de).queryNode,At("LeftJoin",e))})}rightJoin(...e){return new Xe({...i(this,de),queryNode:we.cloneWithJoin(i(this,de).queryNode,At("RightJoin",e))})}fullJoin(...e){return new Xe({...i(this,de),queryNode:we.cloneWithJoin(i(this,de).queryNode,At("FullJoin",e))})}returning(e){return new Xe({...i(this,de),queryNode:we.cloneWithReturning(i(this,de).queryNode,oi(e))})}returningAll(e){return new Xe({...i(this,de),queryNode:we.cloneWithReturning(i(this,de).queryNode,Gi(e))})}clearReturning(){return new Xe({...i(this,de),queryNode:we.cloneWithoutReturning(i(this,de).queryNode)})}clearLimit(){return new Xe({...i(this,de),queryNode:rr.cloneWithoutLimit(i(this,de).queryNode)})}clearOrderBy(){return new Xe({...i(this,de),queryNode:rr.cloneWithoutOrderBy(i(this,de).queryNode)})}orderBy(e,r){return new Xe({...i(this,de),queryNode:rr.cloneWithOrderByItems(i(this,de).queryNode,bo([e,r]))})}limit(e){return new Xe({...i(this,de),queryNode:rr.cloneWithLimit(i(this,de).queryNode,la.create(ut(e)))})}$call(e){return e(this)}$if(e,r){return e?r(this):new Xe({...i(this,de)})}$castTo(){return new Xe(i(this,de))}$narrowType(){return new Xe(i(this,de))}$assertType(){return new Xe(i(this,de))}withPlugin(e){return new Xe({...i(this,de),executor:i(this,de).executor.withPlugin(e)})}toOperationNode(){return i(this,de).executor.transformQuery(i(this,de).queryNode,i(this,de).queryId)}compile(){return i(this,de).executor.compileQuery(this.toOperationNode(),i(this,de).queryId)}async execute(){const e=this.compile(),r=e.query,n=await i(this,de).executor.executeQuery(e,i(this,de).queryId);return i(this,de).executor.adapter.supportsReturning&&r.returning?n.rows:[new ld(n.numAffectedRows??n.numUpdatedOrDeletedRows??BigInt(0))]}async executeTakeFirst(){const[e]=await this.execute();return e}async executeTakeFirstOrThrow(e=Xi){const r=await this.executeTakeFirst();if(r===void 0)throw Yi(e)?new e(this.toOperationNode()):e(this.toOperationNode());return r}async*stream(e=100){const r=this.compile(),n=i(this,de).executor.stream(r,e,i(this,de).queryId);for await(const I of n)yield*I.rows}async explain(e,r){return await new Xe({...i(this,de),queryNode:we.cloneWithExplain(i(this,de).queryNode,e,r)}).execute()}};de=new WeakMap;let Es=Xe;Se(Es,"don't await DeleteQueryBuilder instances directly. To execute the query you need to call `execute` or `executeTakeFirst`.");class ud{constructor(e,r){Re(this,"numUpdatedRows");Re(this,"numChangedRows");this.numUpdatedRows=e,this.numChangedRows=r}}var me;const tt=class tt{constructor(e){B(this,me,void 0);J(this,me,f(e))}where(...e){return new tt({...i(this,me),queryNode:we.cloneWithWhere(i(this,me).queryNode,qt(e))})}whereRef(e,r,n){return new tt({...i(this,me),queryNode:we.cloneWithWhere(i(this,me).queryNode,fn(e,r,n))})}clearWhere(){return new tt({...i(this,me),queryNode:we.cloneWithoutWhere(i(this,me).queryNode)})}top(e,r){return new tt({...i(this,me),queryNode:we.cloneWithTop(i(this,me).queryNode,ai(e,r))})}from(e){return new tt({...i(this,me),queryNode:Fr.cloneWithFromItems(i(this,me).queryNode,Oi(e))})}innerJoin(...e){return new tt({...i(this,me),queryNode:we.cloneWithJoin(i(this,me).queryNode,At("InnerJoin",e))})}leftJoin(...e){return new tt({...i(this,me),queryNode:we.cloneWithJoin(i(this,me).queryNode,At("LeftJoin",e))})}rightJoin(...e){return new tt({...i(this,me),queryNode:we.cloneWithJoin(i(this,me).queryNode,At("RightJoin",e))})}fullJoin(...e){return new tt({...i(this,me),queryNode:we.cloneWithJoin(i(this,me).queryNode,At("FullJoin",e))})}limit(e){return new tt({...i(this,me),queryNode:Fr.cloneWithLimit(i(this,me).queryNode,la.create(ut(e)))})}set(...e){return new tt({...i(this,me),queryNode:Fr.cloneWithUpdates(i(this,me).queryNode,rd(...e))})}returning(e){return new tt({...i(this,me),queryNode:we.cloneWithReturning(i(this,me).queryNode,oi(e))})}returningAll(){return new tt({...i(this,me),queryNode:we.cloneWithReturning(i(this,me).queryNode,Gi())})}clearReturning(){return new tt({...i(this,me),queryNode:we.cloneWithoutReturning(i(this,me).queryNode)})}$call(e){return e(this)}$if(e,r){return e?r(this):new tt({...i(this,me)})}$castTo(){return new tt(i(this,me))}$narrowType(){return new tt(i(this,me))}$assertType(){return new tt(i(this,me))}withPlugin(e){return new tt({...i(this,me),executor:i(this,me).executor.withPlugin(e)})}toOperationNode(){return i(this,me).executor.transformQuery(i(this,me).queryNode,i(this,me).queryId)}compile(){return i(this,me).executor.compileQuery(this.toOperationNode(),i(this,me).queryId)}async execute(){const e=this.compile(),r=e.query,n=await i(this,me).executor.executeQuery(e,i(this,me).queryId);return i(this,me).executor.adapter.supportsReturning&&r.returning?n.rows:[new ud(n.numAffectedRows??n.numUpdatedOrDeletedRows??BigInt(0),n.numChangedRows)]}async executeTakeFirst(){const[e]=await this.execute();return e}async executeTakeFirstOrThrow(e=Xi){const r=await this.executeTakeFirst();if(r===void 0)throw Yi(e)?new e(this.toOperationNode()):e(this.toOperationNode());return r}async*stream(e=100){const r=this.compile(),n=i(this,me).executor.stream(r,e,i(this,me).queryId);for await(const I of n)yield*I.rows}async explain(e,r){return await new tt({...i(this,me),queryNode:we.cloneWithExplain(i(this,me).queryNode,e,r)}).execute()}};me=new WeakMap;let Ai=tt;Se(Ai,"don't await UpdateQueryBuilder instances directly. To execute the query you need to call `execute` or `executeTakeFirst`.");const Ya=f({is(t){return t.kind==="CommonTableExpressionNameNode"},create(t,e){return f({kind:"CommonTableExpressionNameNode",table:Hn.create(t),columns:e?f(e.map(ot.create)):void 0})}}),Ss=f({is(t){return t.kind==="CommonTableExpressionNode"},create(t,e){return f({kind:"CommonTableExpressionNode",name:t,expression:e})},cloneWith(t,e){return f({...t,...e})}});var wn;const Gs=class Gs{constructor(e){B(this,wn,void 0);J(this,wn,f(e))}materialized(){return new Gs({...i(this,wn),node:Ss.cloneWith(i(this,wn).node,{materialized:!0})})}notMaterialized(){return new Gs({...i(this,wn),node:Ss.cloneWith(i(this,wn).node,{materialized:!1})})}toOperationNode(){return i(this,wn).node}};wn=new WeakMap;let Is=Gs;Se(Is,"don't await CTEBuilder instances. They are never executed directly and are always just a part of a query.");function Za(t,e){const r=e(qd()).toOperationNode();return zt(t)?t(cd(r)).toOperationNode():Ss.create(Ol(t),r)}function cd(t){return e=>new Is({node:Ss.create(Ol(e),t)})}function Ol(t){if(t.includes("(")){const e=t.split(/[\(\)]/),r=e[0],n=e[1].split(",").map(I=>I.trim());return Ya.create(r,n)}else return Ya.create(t)}const as=f({is(t){return t.kind==="WithNode"},create(t,e){return f({kind:"WithNode",expressions:f([t]),...e})},cloneWithExpression(t,e){return f({...t,expressions:f([...t.expressions,e])})}}),el=["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","0","1","2","3","4","5","6","7","8","9"];function dd(t){let e="";for(let r=0;r<t;++r)e+=fd();return e}function fd(){return el[~~(Math.random()*el.length)]}function $e(){return new hd}var Lr;class hd{constructor(){B(this,Lr,void 0)}get queryId(){return i(this,Lr)===void 0&&J(this,Lr,dd(8)),i(this,Lr)}}Lr=new WeakMap;var Ks;class ua{constructor(){Re(this,"nodeStack",[]);B(this,Ks,f({AliasNode:this.transformAlias.bind(this),ColumnNode:this.transformColumn.bind(this),IdentifierNode:this.transformIdentifier.bind(this),SchemableIdentifierNode:this.transformSchemableIdentifier.bind(this),RawNode:this.transformRaw.bind(this),ReferenceNode:this.transformReference.bind(this),SelectQueryNode:this.transformSelectQuery.bind(this),SelectionNode:this.transformSelection.bind(this),TableNode:this.transformTable.bind(this),FromNode:this.transformFrom.bind(this),SelectAllNode:this.transformSelectAll.bind(this),AndNode:this.transformAnd.bind(this),OrNode:this.transformOr.bind(this),ValueNode:this.transformValue.bind(this),ValueListNode:this.transformValueList.bind(this),PrimitiveValueListNode:this.transformPrimitiveValueList.bind(this),ParensNode:this.transformParens.bind(this),JoinNode:this.transformJoin.bind(this),OperatorNode:this.transformOperator.bind(this),WhereNode:this.transformWhere.bind(this),InsertQueryNode:this.transformInsertQuery.bind(this),DeleteQueryNode:this.transformDeleteQuery.bind(this),ReturningNode:this.transformReturning.bind(this),CreateTableNode:this.transformCreateTable.bind(this),AddColumnNode:this.transformAddColumn.bind(this),ColumnDefinitionNode:this.transformColumnDefinition.bind(this),DropTableNode:this.transformDropTable.bind(this),DataTypeNode:this.transformDataType.bind(this),OrderByNode:this.transformOrderBy.bind(this),OrderByItemNode:this.transformOrderByItem.bind(this),GroupByNode:this.transformGroupBy.bind(this),GroupByItemNode:this.transformGroupByItem.bind(this),UpdateQueryNode:this.transformUpdateQuery.bind(this),ColumnUpdateNode:this.transformColumnUpdate.bind(this),LimitNode:this.transformLimit.bind(this),OffsetNode:this.transformOffset.bind(this),OnConflictNode:this.transformOnConflict.bind(this),OnDuplicateKeyNode:this.transformOnDuplicateKey.bind(this),CreateIndexNode:this.transformCreateIndex.bind(this),DropIndexNode:this.transformDropIndex.bind(this),ListNode:this.transformList.bind(this),PrimaryKeyConstraintNode:this.transformPrimaryKeyConstraint.bind(this),UniqueConstraintNode:this.transformUniqueConstraint.bind(this),ReferencesNode:this.transformReferences.bind(this),CheckConstraintNode:this.transformCheckConstraint.bind(this),WithNode:this.transformWith.bind(this),CommonTableExpressionNode:this.transformCommonTableExpression.bind(this),CommonTableExpressionNameNode:this.transformCommonTableExpressionName.bind(this),HavingNode:this.transformHaving.bind(this),CreateSchemaNode:this.transformCreateSchema.bind(this),DropSchemaNode:this.transformDropSchema.bind(this),AlterTableNode:this.transformAlterTable.bind(this),DropColumnNode:this.transformDropColumn.bind(this),RenameColumnNode:this.transformRenameColumn.bind(this),AlterColumnNode:this.transformAlterColumn.bind(this),ModifyColumnNode:this.transformModifyColumn.bind(this),AddConstraintNode:this.transformAddConstraint.bind(this),DropConstraintNode:this.transformDropConstraint.bind(this),ForeignKeyConstraintNode:this.transformForeignKeyConstraint.bind(this),CreateViewNode:this.transformCreateView.bind(this),DropViewNode:this.transformDropView.bind(this),GeneratedNode:this.transformGenerated.bind(this),DefaultValueNode:this.transformDefaultValue.bind(this),OnNode:this.transformOn.bind(this),ValuesNode:this.transformValues.bind(this),SelectModifierNode:this.transformSelectModifier.bind(this),CreateTypeNode:this.transformCreateType.bind(this),DropTypeNode:this.transformDropType.bind(this),ExplainNode:this.transformExplain.bind(this),DefaultInsertValueNode:this.transformDefaultInsertValue.bind(this),AggregateFunctionNode:this.transformAggregateFunction.bind(this),OverNode:this.transformOver.bind(this),PartitionByNode:this.transformPartitionBy.bind(this),PartitionByItemNode:this.transformPartitionByItem.bind(this),SetOperationNode:this.transformSetOperation.bind(this),BinaryOperationNode:this.transformBinaryOperation.bind(this),UnaryOperationNode:this.transformUnaryOperation.bind(this),UsingNode:this.transformUsing.bind(this),FunctionNode:this.transformFunction.bind(this),CaseNode:this.transformCase.bind(this),WhenNode:this.transformWhen.bind(this),JSONReferenceNode:this.transformJSONReference.bind(this),JSONPathNode:this.transformJSONPath.bind(this),JSONPathLegNode:this.transformJSONPathLeg.bind(this),JSONOperatorChainNode:this.transformJSONOperatorChain.bind(this),TupleNode:this.transformTuple.bind(this),MergeQueryNode:this.transformMergeQuery.bind(this),MatchedNode:this.transformMatched.bind(this),AddIndexNode:this.transformAddIndex.bind(this),CastNode:this.transformCast.bind(this),FetchNode:this.transformFetch.bind(this),TopNode:this.transformTop.bind(this)}))}transformNode(e){if(!e)return e;this.nodeStack.push(e);const r=this.transformNodeImpl(e);return this.nodeStack.pop(),f(r)}transformNodeImpl(e){return i(this,Ks)[e.kind](e)}transformNodeList(e){return e&&f(e.map(r=>this.transformNode(r)))}transformSelectQuery(e){return{kind:"SelectQueryNode",from:this.transformNode(e.from),selections:this.transformNodeList(e.selections),distinctOn:this.transformNodeList(e.distinctOn),joins:this.transformNodeList(e.joins),groupBy:this.transformNode(e.groupBy),orderBy:this.transformNode(e.orderBy),where:this.transformNode(e.where),frontModifiers:this.transformNodeList(e.frontModifiers),endModifiers:this.transformNodeList(e.endModifiers),limit:this.transformNode(e.limit),offset:this.transformNode(e.offset),with:this.transformNode(e.with),having:this.transformNode(e.having),explain:this.transformNode(e.explain),setOperations:this.transformNodeList(e.setOperations),fetch:this.transformNode(e.fetch),top:this.transformNode(e.top)}}transformSelection(e){return{kind:"SelectionNode",selection:this.transformNode(e.selection)}}transformColumn(e){return{kind:"ColumnNode",column:this.transformNode(e.column)}}transformAlias(e){return{kind:"AliasNode",node:this.transformNode(e.node),alias:this.transformNode(e.alias)}}transformTable(e){return{kind:"TableNode",table:this.transformNode(e.table)}}transformFrom(e){return{kind:"FromNode",froms:this.transformNodeList(e.froms)}}transformReference(e){return{kind:"ReferenceNode",column:this.transformNode(e.column),table:this.transformNode(e.table)}}transformAnd(e){return{kind:"AndNode",left:this.transformNode(e.left),right:this.transformNode(e.right)}}transformOr(e){return{kind:"OrNode",left:this.transformNode(e.left),right:this.transformNode(e.right)}}transformValueList(e){return{kind:"ValueListNode",values:this.transformNodeList(e.values)}}transformParens(e){return{kind:"ParensNode",node:this.transformNode(e.node)}}transformJoin(e){return{kind:"JoinNode",joinType:e.joinType,table:this.transformNode(e.table),on:this.transformNode(e.on)}}transformRaw(e){return{kind:"RawNode",sqlFragments:f([...e.sqlFragments]),parameters:this.transformNodeList(e.parameters)}}transformWhere(e){return{kind:"WhereNode",where:this.transformNode(e.where)}}transformInsertQuery(e){return{kind:"InsertQueryNode",into:this.transformNode(e.into),columns:this.transformNodeList(e.columns),values:this.transformNode(e.values),returning:this.transformNode(e.returning),onConflict:this.transformNode(e.onConflict),onDuplicateKey:this.transformNode(e.onDuplicateKey),with:this.transformNode(e.with),ignore:e.ignore,replace:e.replace,explain:this.transformNode(e.explain),defaultValues:e.defaultValues,top:this.transformNode(e.top)}}transformValues(e){return{kind:"ValuesNode",values:this.transformNodeList(e.values)}}transformDeleteQuery(e){return{kind:"DeleteQueryNode",from:this.transformNode(e.from),using:this.transformNode(e.using),joins:this.transformNodeList(e.joins),where:this.transformNode(e.where),returning:this.transformNode(e.returning),with:this.transformNode(e.with),orderBy:this.transformNode(e.orderBy),limit:this.transformNode(e.limit),explain:this.transformNode(e.explain),top:this.transformNode(e.top)}}transformReturning(e){return{kind:"ReturningNode",selections:this.transformNodeList(e.selections)}}transformCreateTable(e){return{kind:"CreateTableNode",table:this.transformNode(e.table),columns:this.transformNodeList(e.columns),constraints:this.transformNodeList(e.constraints),temporary:e.temporary,ifNotExists:e.ifNotExists,onCommit:e.onCommit,frontModifiers:this.transformNodeList(e.frontModifiers),endModifiers:this.transformNodeList(e.endModifiers),selectQuery:this.transformNode(e.selectQuery)}}transformColumnDefinition(e){return{kind:"ColumnDefinitionNode",column:this.transformNode(e.column),dataType:this.transformNode(e.dataType),references:this.transformNode(e.references),primaryKey:e.primaryKey,autoIncrement:e.autoIncrement,unique:e.unique,notNull:e.notNull,unsigned:e.unsigned,defaultTo:this.transformNode(e.defaultTo),check:this.transformNode(e.check),generated:this.transformNode(e.generated),frontModifiers:this.transformNodeList(e.frontModifiers),endModifiers:this.transformNodeList(e.endModifiers),nullsNotDistinct:e.nullsNotDistinct,identity:e.identity}}transformAddColumn(e){return{kind:"AddColumnNode",column:this.transformNode(e.column)}}transformDropTable(e){return{kind:"DropTableNode",table:this.transformNode(e.table),ifExists:e.ifExists,cascade:e.cascade}}transformOrderBy(e){return{kind:"OrderByNode",items:this.transformNodeList(e.items)}}transformOrderByItem(e){return{kind:"OrderByItemNode",orderBy:this.transformNode(e.orderBy),direction:this.transformNode(e.direction)}}transformGroupBy(e){return{kind:"GroupByNode",items:this.transformNodeList(e.items)}}transformGroupByItem(e){return{kind:"GroupByItemNode",groupBy:this.transformNode(e.groupBy)}}transformUpdateQuery(e){return{kind:"UpdateQueryNode",table:this.transformNode(e.table),from:this.transformNode(e.from),joins:this.transformNodeList(e.joins),where:this.transformNode(e.where),updates:this.transformNodeList(e.updates),returning:this.transformNode(e.returning),with:this.transformNode(e.with),explain:this.transformNode(e.explain),limit:this.transformNode(e.limit),top:this.transformNode(e.top)}}transformColumnUpdate(e){return{kind:"ColumnUpdateNode",column:this.transformNode(e.column),value:this.transformNode(e.value)}}transformLimit(e){return{kind:"LimitNode",limit:this.transformNode(e.limit)}}transformOffset(e){return{kind:"OffsetNode",offset:this.transformNode(e.offset)}}transformOnConflict(e){return{kind:"OnConflictNode",columns:this.transformNodeList(e.columns),constraint:this.transformNode(e.constraint),indexExpression:this.transformNode(e.indexExpression),indexWhere:this.transformNode(e.indexWhere),updates:this.transformNodeList(e.updates),updateWhere:this.transformNode(e.updateWhere),doNothing:e.doNothing}}transformOnDuplicateKey(e){return{kind:"OnDuplicateKeyNode",updates:this.transformNodeList(e.updates)}}transformCreateIndex(e){return{kind:"CreateIndexNode",name:this.transformNode(e.name),table:this.transformNode(e.table),columns:this.transformNodeList(e.columns),unique:e.unique,using:this.transformNode(e.using),ifNotExists:e.ifNotExists,where:this.transformNode(e.where),nullsNotDistinct:e.nullsNotDistinct}}transformList(e){return{kind:"ListNode",items:this.transformNodeList(e.items)}}transformDropIndex(e){return{kind:"DropIndexNode",name:this.transformNode(e.name),table:this.transformNode(e.table),ifExists:e.ifExists,cascade:e.cascade}}transformPrimaryKeyConstraint(e){return{kind:"PrimaryKeyConstraintNode",columns:this.transformNodeList(e.columns),name:this.transformNode(e.name)}}transformUniqueConstraint(e){return{kind:"UniqueConstraintNode",columns:this.transformNodeList(e.columns),name:this.transformNode(e.name),nullsNotDistinct:e.nullsNotDistinct}}transformForeignKeyConstraint(e){return{kind:"ForeignKeyConstraintNode",columns:this.transformNodeList(e.columns),references:this.transformNode(e.references),name:this.transformNode(e.name),onDelete:e.onDelete,onUpdate:e.onUpdate}}transformSetOperation(e){return{kind:"SetOperationNode",operator:e.operator,expression:this.transformNode(e.expression),all:e.all}}transformReferences(e){return{kind:"ReferencesNode",table:this.transformNode(e.table),columns:this.transformNodeList(e.columns),onDelete:e.onDelete,onUpdate:e.onUpdate}}transformCheckConstraint(e){return{kind:"CheckConstraintNode",expression:this.transformNode(e.expression),name:this.transformNode(e.name)}}transformWith(e){return{kind:"WithNode",expressions:this.transformNodeList(e.expressions),recursive:e.recursive}}transformCommonTableExpression(e){return{kind:"CommonTableExpressionNode",name:this.transformNode(e.name),materialized:e.materialized,expression:this.transformNode(e.expression)}}transformCommonTableExpressionName(e){return{kind:"CommonTableExpressionNameNode",table:this.transformNode(e.table),columns:this.transformNodeList(e.columns)}}transformHaving(e){return{kind:"HavingNode",having:this.transformNode(e.having)}}transformCreateSchema(e){return{kind:"CreateSchemaNode",schema:this.transformNode(e.schema),ifNotExists:e.ifNotExists}}transformDropSchema(e){return{kind:"DropSchemaNode",schema:this.transformNode(e.schema),ifExists:e.ifExists,cascade:e.cascade}}transformAlterTable(e){return{kind:"AlterTableNode",table:this.transformNode(e.table),renameTo:this.transformNode(e.renameTo),setSchema:this.transformNode(e.setSchema),columnAlterations:this.transformNodeList(e.columnAlterations),addConstraint:this.transformNode(e.addConstraint),dropConstraint:this.transformNode(e.dropConstraint),addIndex:this.transformNode(e.addIndex),dropIndex:this.transformNode(e.dropIndex)}}transformDropColumn(e){return{kind:"DropColumnNode",column:this.transformNode(e.column)}}transformRenameColumn(e){return{kind:"RenameColumnNode",column:this.transformNode(e.column),renameTo:this.transformNode(e.renameTo)}}transformAlterColumn(e){return{kind:"AlterColumnNode",column:this.transformNode(e.column),dataType:this.transformNode(e.dataType),dataTypeExpression:this.transformNode(e.dataTypeExpression),setDefault:this.transformNode(e.setDefault),dropDefault:e.dropDefault,setNotNull:e.setNotNull,dropNotNull:e.dropNotNull}}transformModifyColumn(e){return{kind:"ModifyColumnNode",column:this.transformNode(e.column)}}transformAddConstraint(e){return{kind:"AddConstraintNode",constraint:this.transformNode(e.constraint)}}transformDropConstraint(e){return{kind:"DropConstraintNode",constraintName:this.transformNode(e.constraintName),ifExists:e.ifExists,modifier:e.modifier}}transformCreateView(e){return{kind:"CreateViewNode",name:this.transformNode(e.name),temporary:e.temporary,orReplace:e.orReplace,ifNotExists:e.ifNotExists,materialized:e.materialized,columns:this.transformNodeList(e.columns),as:this.transformNode(e.as)}}transformDropView(e){return{kind:"DropViewNode",name:this.transformNode(e.name),ifExists:e.ifExists,materialized:e.materialized,cascade:e.cascade}}transformGenerated(e){return{kind:"GeneratedNode",byDefault:e.byDefault,always:e.always,identity:e.identity,stored:e.stored,expression:this.transformNode(e.expression)}}transformDefaultValue(e){return{kind:"DefaultValueNode",defaultValue:this.transformNode(e.defaultValue)}}transformOn(e){return{kind:"OnNode",on:this.transformNode(e.on)}}transformSelectModifier(e){return{kind:"SelectModifierNode",modifier:e.modifier,rawModifier:this.transformNode(e.rawModifier),of:this.transformNodeList(e.of)}}transformCreateType(e){return{kind:"CreateTypeNode",name:this.transformNode(e.name),enum:this.transformNode(e.enum)}}transformDropType(e){return{kind:"DropTypeNode",name:this.transformNode(e.name),ifExists:e.ifExists}}transformExplain(e){return{kind:"ExplainNode",format:e.format,options:this.transformNode(e.options)}}transformSchemableIdentifier(e){return{kind:"SchemableIdentifierNode",schema:this.transformNode(e.schema),identifier:this.transformNode(e.identifier)}}transformAggregateFunction(e){return{kind:"AggregateFunctionNode",aggregated:this.transformNodeList(e.aggregated),distinct:e.distinct,filter:this.transformNode(e.filter),func:e.func,over:this.transformNode(e.over)}}transformOver(e){return{kind:"OverNode",orderBy:this.transformNode(e.orderBy),partitionBy:this.transformNode(e.partitionBy)}}transformPartitionBy(e){return{kind:"PartitionByNode",items:this.transformNodeList(e.items)}}transformPartitionByItem(e){return{kind:"PartitionByItemNode",partitionBy:this.transformNode(e.partitionBy)}}transformBinaryOperation(e){return{kind:"BinaryOperationNode",leftOperand:this.transformNode(e.leftOperand),operator:this.transformNode(e.operator),rightOperand:this.transformNode(e.rightOperand)}}transformUnaryOperation(e){return{kind:"UnaryOperationNode",operator:this.transformNode(e.operator),operand:this.transformNode(e.operand)}}transformUsing(e){return{kind:"UsingNode",tables:this.transformNodeList(e.tables)}}transformFunction(e){return{kind:"FunctionNode",func:e.func,arguments:this.transformNodeList(e.arguments)}}transformCase(e){return{kind:"CaseNode",value:this.transformNode(e.value),when:this.transformNodeList(e.when),else:this.transformNode(e.else),isStatement:e.isStatement}}transformWhen(e){return{kind:"WhenNode",condition:this.transformNode(e.condition),result:this.transformNode(e.result)}}transformJSONReference(e){return{kind:"JSONReferenceNode",reference:this.transformNode(e.reference),traversal:this.transformNode(e.traversal)}}transformJSONPath(e){return{kind:"JSONPathNode",inOperator:this.transformNode(e.inOperator),pathLegs:this.transformNodeList(e.pathLegs)}}transformJSONPathLeg(e){return{kind:"JSONPathLegNode",type:e.type,value:e.value}}transformJSONOperatorChain(e){return{kind:"JSONOperatorChainNode",operator:this.transformNode(e.operator),values:this.transformNodeList(e.values)}}transformTuple(e){return{kind:"TupleNode",values:this.transformNodeList(e.values)}}transformMergeQuery(e){return{kind:"MergeQueryNode",into:this.transformNode(e.into),using:this.transformNode(e.using),whens:this.transformNodeList(e.whens),with:this.transformNode(e.with),top:this.transformNode(e.top)}}transformMatched(e){return{kind:"MatchedNode",not:e.not,bySource:e.bySource}}transformAddIndex(e){return{kind:"AddIndexNode",name:this.transformNode(e.name),columns:this.transformNodeList(e.columns),unique:e.unique,using:this.transformNode(e.using),ifNotExists:e.ifNotExists}}transformCast(e){return{kind:"CastNode",expression:this.transformNode(e.expression),dataType:this.transformNode(e.dataType)}}transformFetch(e){return{kind:"FetchNode",rowCount:this.transformNode(e.rowCount),modifier:e.modifier}}transformTop(e){return{kind:"TopNode",expression:e.expression,modifiers:e.modifiers}}transformDataType(e){return e}transformSelectAll(e){return e}transformIdentifier(e){return e}transformValue(e){return e}transformPrimitiveValueList(e){return e}transformOperator(e){return e}transformDefaultInsertValue(e){return e}}Ks=new WeakMap;const pd=f({AlterTableNode:!0,CreateIndexNode:!0,CreateSchemaNode:!0,CreateTableNode:!0,CreateTypeNode:!0,CreateViewNode:!0,DeleteQueryNode:!0,DropIndexNode:!0,DropSchemaNode:!0,DropTableNode:!0,DropTypeNode:!0,DropViewNode:!0,InsertQueryNode:!0,RawNode:!0,SelectQueryNode:!0,UpdateQueryNode:!0,MergeQueryNode:!0});var Dr,cr,dr,Xs,Tl,Ys,Cl,Zs,Fl,Ln,kr,Li,Mo,eo,Pl;class md extends ua{constructor(r){super();B(this,Xs);B(this,Ys);B(this,Zs);B(this,Ln);B(this,Li);B(this,eo);B(this,Dr,void 0);B(this,cr,new Set);B(this,dr,new Set);J(this,Dr,r)}transformNodeImpl(r){if(!ve(this,Xs,Tl).call(this,r))return super.transformNodeImpl(r);const n=ve(this,Zs,Fl).call(this,r);for(const re of n)i(this,dr).add(re);const I=ve(this,Ys,Cl).call(this,r);for(const re of I)i(this,cr).add(re);const Q=super.transformNodeImpl(r);for(const re of I)i(this,cr).delete(re);for(const re of n)i(this,dr).delete(re);return Q}transformSchemableIdentifier(r){const n=super.transformSchemableIdentifier(r);return n.schema||!i(this,cr).has(r.identifier.name)?n:{...n,schema:Ye.create(i(this,Dr))}}transformReferences(r){const n=super.transformReferences(r);return n.table.table.schema?n:{...n,table:Hn.createWithSchema(i(this,Dr),n.table.table.identifier.name)}}}Dr=new WeakMap,cr=new WeakMap,dr=new WeakMap,Xs=new WeakSet,Tl=function(r){return r.kind in pd},Ys=new WeakSet,Cl=function(r){const n=new Set;if("name"in r&&r.name&&Jn.is(r.name)&&ve(this,Li,Mo).call(this,r.name,n),"from"in r&&r.from)for(const I of r.from.froms)ve(this,Ln,kr).call(this,I,n);if("into"in r&&r.into&&ve(this,Ln,kr).call(this,r.into,n),"table"in r&&r.table&&ve(this,Ln,kr).call(this,r.table,n),"joins"in r&&r.joins)for(const I of r.joins)ve(this,Ln,kr).call(this,I.table,n);return"using"in r&&r.using&&ve(this,Ln,kr).call(this,r.using,n),n},Zs=new WeakSet,Fl=function(r){const n=new Set;return"with"in r&&r.with&&ve(this,eo,Pl).call(this,r.with,n),n},Ln=new WeakSet,kr=function(r,n){const I=Hn.is(r)?r:Yn.is(r)&&Hn.is(r.node)?r.node:null;I&&ve(this,Li,Mo).call(this,I.table,n)},Li=new WeakSet,Mo=function(r,n){const I=r.identifier.name;!i(this,cr).has(I)&&!i(this,dr).has(I)&&n.add(I)},eo=new WeakSet,Pl=function(r,n){for(const I of r.expressions){const Q=I.name.table.table.identifier.name;i(this,dr).has(Q)||n.add(Q)}};var Di;class Zi{constructor(e){B(this,Di,void 0);J(this,Di,new md(e))}transformQuery(e){return i(this,Di).transformNode(e.node)}async transformResult(e){return e.result}}Di=new WeakMap;const _d=f({is(t){return t.kind==="MatchedNode"},create(t,e=!1){return f({kind:"MatchedNode",not:t,bySource:e})}});function tl(t,e,r){return Ki.create(ws([_d.create(!t.isMatched,t.bySource),...e&&e.length>0?[e.length===3&&r?fn(e[0],e[1],e[2]):qt(e)]:[]],"and",!1))}function gi(t){return jt(t)?bt.create([t],[]):Ft(t)?t.toOperationNode():t}var Ri,Rr,Mr;class nl{constructor(){B(this,Ri,void 0);B(this,Rr,void 0);B(this,Mr,void 0);Re(this,"resolve",e=>{i(this,Rr)&&i(this,Rr).call(this,e)});Re(this,"reject",e=>{i(this,Mr)&&i(this,Mr).call(this,e)});J(this,Ri,new Promise((e,r)=>{J(this,Mr,r),J(this,Rr,e)}))}get promise(){return i(this,Ri)}}Ri=new WeakMap,Rr=new WeakMap,Mr=new WeakMap;const rl=new Set;function yd(t){rl.has(t)||(rl.add(t),console.log(t))}const gd=f([]);var fr,Mi,Bo;class Wl{constructor(e=gd){B(this,Mi);B(this,fr,void 0);J(this,fr,e)}get plugins(){return i(this,fr)}transformQuery(e,r){for(const n of i(this,fr)){const I=n.transformQuery({node:e,queryId:r});if(I.kind===e.kind)e=I;else throw new Error(["KyselyPlugin.transformQuery must return a node","of the same kind that was given to it.",`The plugin was given a ${e.kind}`,`but it returned a ${I.kind}`].join(" "))}return e}async executeQuery(e,r){return await this.provideConnection(async n=>{const I=await n.executeQuery(e),Q=await ve(this,Mi,Bo).call(this,I,r);return wd(I,Q),Q})}async*stream(e,r,n){const I=new nl,Q=new nl;this.provideConnection(async Ie=>(I.resolve(Ie),await Q.promise)).catch(Ie=>I.reject(Ie));const re=await I.promise;try{for await(const Ie of re.streamQuery(e,r))yield await ve(this,Mi,Bo).call(this,Ie,n)}finally{Q.resolve()}}}fr=new WeakMap,Mi=new WeakSet,Bo=async function(e,r){for(const n of i(this,fr))e=await n.transformResult({result:e,queryId:r});return e};function wd(t,e){const{numAffectedRows:r}=t;r===void 0&&t.numUpdatedOrDeletedRows===void 0||r!==void 0&&e.numAffectedRows!==void 0||yd("kysely:warning: outdated driver/plugin detected! QueryResult.numUpdatedOrDeletedRows is deprecated and will be removed in a future release.")}class Or extends Wl{get adapter(){throw new Error("this query cannot be compiled to SQL")}compileQuery(){throw new Error("this query cannot be compiled to SQL")}provideConnection(){throw new Error("this query cannot be executed")}withConnectionProvider(){throw new Error("this query cannot have a connection provider")}withPlugin(e){return new Or([...this.plugins,e])}withPlugins(e){return new Or([...this.plugins,...e])}withPluginAtFront(e){return new Or([e,...this.plugins])}withoutPlugins(){return new Or([])}}const qo=new Or;class bd{constructor(e){Re(this,"numChangedRows");this.numChangedRows=e}}var Dn;const _a=class _a{constructor(e){B(this,Dn,void 0);J(this,Dn,f(e))}top(e,r){return new _a({...i(this,Dn),queryNode:we.cloneWithTop(i(this,Dn).queryNode,ai(e,r))})}using(...e){return new Sn({...i(this,Dn),queryNode:Ct.cloneWithUsing(i(this,Dn).queryNode,At("Using",e))})}};Dn=new WeakMap;let ks=_a;Se(ks,"don't await MergeQueryBuilder instances directly. To execute the query you need to call `execute` when available.");var dt,Br,us,bn,tr;const to=class to{constructor(e){B(this,Br);B(this,bn);B(this,dt,void 0);J(this,dt,f(e))}top(e,r){return new to({...i(this,dt),queryNode:we.cloneWithTop(i(this,dt).queryNode,ai(e,r))})}whenMatched(){return ve(this,Br,us).call(this,[])}whenMatchedAnd(...e){return ve(this,Br,us).call(this,e)}whenMatchedAndRef(e,r,n){return ve(this,Br,us).call(this,[e,r,n],!0)}whenNotMatched(){return ve(this,bn,tr).call(this,[])}whenNotMatchedAnd(...e){return ve(this,bn,tr).call(this,e)}whenNotMatchedAndRef(e,r,n){return ve(this,bn,tr).call(this,[e,r,n],!0)}whenNotMatchedBySource(){return ve(this,bn,tr).call(this,[],!1,!0)}whenNotMatchedBySourceAnd(...e){return ve(this,bn,tr).call(this,e,!1,!0)}whenNotMatchedBySourceAndRef(e,r,n){return ve(this,bn,tr).call(this,[e,r,n],!0,!0)}$call(e){return e(this)}$if(e,r){return e?r(this):new to({...i(this,dt)})}toOperationNode(){return i(this,dt).executor.transformQuery(i(this,dt).queryNode,i(this,dt).queryId)}compile(){return i(this,dt).executor.compileQuery(i(this,dt).queryNode,i(this,dt).queryId)}async execute(){const e=this.compile(),r=await i(this,dt).executor.executeQuery(e,i(this,dt).queryId);return[new bd(r.numAffectedRows)]}async executeTakeFirst(){const[e]=await this.execute();return e}async executeTakeFirstOrThrow(e=Xi){const r=await this.executeTakeFirst();if(r===void 0)throw Yi(e)?new e(this.toOperationNode()):e(this.toOperationNode());return r}};dt=new WeakMap,Br=new WeakSet,us=function(e,r){return new Qo({...i(this,dt),queryNode:Ct.cloneWithWhen(i(this,dt).queryNode,tl({isMatched:!0},e,r))})},bn=new WeakSet,tr=function(e,r=!1,n=!1){const I={...i(this,dt),queryNode:Ct.cloneWithWhen(i(this,dt).queryNode,tl({isMatched:!1,bySource:n},e,r))},Q=n?Qo:Ll;return new Q(I)};let Sn=to;Se(Sn,"don't await WheneableMergeQueryBuilder instances directly. To execute the query you need to call `execute`.");var Xt;class Qo{constructor(e){B(this,Xt,void 0);J(this,Xt,f(e))}thenDelete(){return new Sn({...i(this,Xt),queryNode:Ct.cloneWithThen(i(this,Xt).queryNode,gi("delete"))})}thenDoNothing(){return new Sn({...i(this,Xt),queryNode:Ct.cloneWithThen(i(this,Xt).queryNode,gi("do nothing"))})}thenUpdate(e){return new Sn({...i(this,Xt),queryNode:Ct.cloneWithThen(i(this,Xt).queryNode,gi(e(new Ai({queryId:i(this,Xt).queryId,executor:qo,queryNode:Fr.createWithoutTable()}))))})}thenUpdateSet(...e){return this.thenUpdate(r=>r.set(...e))}}Xt=new WeakMap;Se(Qo,"don't await MatchedThenableMergeQueryBuilder instances directly. To execute the query you need to call `execute` when available.");var Rn;class Ll{constructor(e){B(this,Rn,void 0);J(this,Rn,f(e))}thenDoNothing(){return new Sn({...i(this,Rn),queryNode:Ct.cloneWithThen(i(this,Rn).queryNode,gi("do nothing"))})}thenInsertValues(e){const[r,n]=Il(e);return new Sn({...i(this,Rn),queryNode:Ct.cloneWithThen(i(this,Rn).queryNode,gi(Qt.cloneWith(Qt.createWithoutInto(),{columns:r,values:n})))})}}Rn=new WeakMap;Se(Ll,"don't await NotMatchedThenableMergeQueryBuilder instances directly. To execute the query you need to call `execute` when available.");var Qe;const ir=class ir{constructor(e){B(this,Qe,void 0);J(this,Qe,f(e))}selectFrom(e){return zo({queryId:$e(),executor:i(this,Qe).executor,queryNode:Oe.createFrom(Oi(e),i(this,Qe).withNode)})}selectNoFrom(e){return zo({queryId:$e(),executor:i(this,Qe).executor,queryNode:Oe.cloneWithSelections(Oe.create(i(this,Qe).withNode),oi(e))})}insertInto(e){return new ki({queryId:$e(),executor:i(this,Qe).executor,queryNode:Qt.create(st(e),i(this,Qe).withNode)})}replaceInto(e){return new ki({queryId:$e(),executor:i(this,Qe).executor,queryNode:Qt.create(st(e),i(this,Qe).withNode,!0)})}deleteFrom(e){return new Es({queryId:$e(),executor:i(this,Qe).executor,queryNode:rr.create(Oi(e),i(this,Qe).withNode)})}updateTable(e){return new Ai({queryId:$e(),executor:i(this,Qe).executor,queryNode:Fr.create(Ti(e),i(this,Qe).withNode)})}mergeInto(e){return new ks({queryId:$e(),executor:i(this,Qe).executor,queryNode:Ct.create(jl(e),i(this,Qe).withNode)})}with(e,r){const n=Za(e,r);return new ir({...i(this,Qe),withNode:i(this,Qe).withNode?as.cloneWithExpression(i(this,Qe).withNode,n):as.create(n)})}withRecursive(e,r){const n=Za(e,r);return new ir({...i(this,Qe),withNode:i(this,Qe).withNode?as.cloneWithExpression(i(this,Qe).withNode,n):as.create(n,{recursive:!0})})}withPlugin(e){return new ir({...i(this,Qe),executor:i(this,Qe).executor.withPlugin(e)})}withoutPlugins(){return new ir({...i(this,Qe),executor:i(this,Qe).executor.withoutPlugins()})}withSchema(e){return new ir({...i(this,Qe),executor:i(this,Qe).executor.withPluginAtFront(new Zi(e))})}};Qe=new WeakMap;let As=ir;function qd(){return new As({executor:qo})}function Nd(t,e){return new qs({joinNode:mi.create(t,Ti(e))})}function vd(){return new Ns({overNode:Ro.create()})}function At(t,e){if(e.length===3)return Ed(t,e[0],e[1],e[2]);if(e.length===2)return xd(t,e[0],e[1]);throw new Error("not implemented")}function xd(t,e,r){return r(Nd(t,e)).toOperationNode()}function Ed(t,e,r,n){return mi.createWithOn(t,Ti(e),fn(r,"=",n))}const Sd=f({is(t){return t.kind==="OffsetNode"},create(t){return f({kind:"OffsetNode",offset:t})}}),Id=f({is(t){return t.kind==="GroupByItemNode"},create(t){return f({kind:"GroupByItemNode",groupBy:t})}});function kd(t){return t=zt(t)?t(li()):t,Ii(t).map(Id.create)}const Dl=f({is(t){return t.kind==="SetOperationNode"},create(t,e,r){return f({kind:"SetOperationNode",operator:t,expression:e,all:r})}});function Ir(t,e,r){return zt(e)&&(e=e(da())),In(e)||(e=[e]),e.map(n=>Dl.create(t,vr(n),r))}var qn;const no=class no{constructor(e){B(this,qn,void 0);J(this,qn,e)}get expressionType(){}as(e){return new ca(this,e)}or(...e){return new Uo(si.create(i(this,qn),qt(e)))}and(...e){return new jo(Gn.create(i(this,qn),qt(e)))}$castTo(){return new no(i(this,qn))}$notNull(){return new no(i(this,qn))}toOperationNode(){return i(this,qn)}};qn=new WeakMap;let Ke=no;var Qr,Mn;class ca{constructor(e,r){B(this,Qr,void 0);B(this,Mn,void 0);J(this,Qr,e),J(this,Mn,r)}get expression(){return i(this,Qr)}get alias(){return i(this,Mn)}toOperationNode(){return Yn.create(i(this,Qr).toOperationNode(),Ft(i(this,Mn))?i(this,Mn).toOperationNode():Ye.create(i(this,Mn)))}}Qr=new WeakMap,Mn=new WeakMap;var hr;const ro=class ro{constructor(e){B(this,hr,void 0);J(this,hr,e)}get expressionType(){}as(e){return new ca(this,e)}or(...e){return new ro(si.create(i(this,hr),qt(e)))}$castTo(){return new ro(i(this,hr))}toOperationNode(){return ri.create(i(this,hr))}};hr=new WeakMap;let Uo=ro;var pr;const io=class io{constructor(e){B(this,pr,void 0);J(this,pr,e)}get expressionType(){}as(e){return new ca(this,e)}and(...e){return new io(Gn.create(i(this,pr),qt(e)))}$castTo(){return new io(i(this,pr))}toOperationNode(){return ri.create(i(this,pr))}};pr=new WeakMap;let jo=io;const Ad={is(t){return t.kind==="FetchNode"},create(t,e){return{kind:"FetchNode",rowCount:dn.create(t),modifier:e}}};function Od(t,e){if(!go(t)&&!ea(t))throw new Error(`Invalid fetch row count: ${t}`);if(!Td(e))throw new Error(`Invalid fetch modifier: ${e}`);return Ad.create(t,e)}function Td(t){return t==="only"||t==="with ties"}var Y;const ye=class ye{constructor(e){B(this,Y,void 0);J(this,Y,f(e))}get expressionType(){}get isSelectQueryBuilder(){return!0}where(...e){return new ye({...i(this,Y),queryNode:we.cloneWithWhere(i(this,Y).queryNode,qt(e))})}whereRef(e,r,n){return new ye({...i(this,Y),queryNode:we.cloneWithWhere(i(this,Y).queryNode,fn(e,r,n))})}having(...e){return new ye({...i(this,Y),queryNode:Oe.cloneWithHaving(i(this,Y).queryNode,qt(e))})}havingRef(e,r,n){return new ye({...i(this,Y),queryNode:Oe.cloneWithHaving(i(this,Y).queryNode,fn(e,r,n))})}select(e){return new ye({...i(this,Y),queryNode:Oe.cloneWithSelections(i(this,Y).queryNode,oi(e))})}distinctOn(e){return new ye({...i(this,Y),queryNode:Oe.cloneWithDistinctOn(i(this,Y).queryNode,Ii(e))})}modifyFront(e){return new ye({...i(this,Y),queryNode:Oe.cloneWithFrontModifier(i(this,Y).queryNode,mn.createWithExpression(e.toOperationNode()))})}modifyEnd(e){return new ye({...i(this,Y),queryNode:Oe.cloneWithEndModifier(i(this,Y).queryNode,mn.createWithExpression(e.toOperationNode()))})}distinct(){return new ye({...i(this,Y),queryNode:Oe.cloneWithFrontModifier(i(this,Y).queryNode,mn.create("Distinct"))})}forUpdate(e){return new ye({...i(this,Y),queryNode:Oe.cloneWithEndModifier(i(this,Y).queryNode,mn.create("ForUpdate",e?os(e).map(st):void 0))})}forShare(e){return new ye({...i(this,Y),queryNode:Oe.cloneWithEndModifier(i(this,Y).queryNode,mn.create("ForShare",e?os(e).map(st):void 0))})}forKeyShare(e){return new ye({...i(this,Y),queryNode:Oe.cloneWithEndModifier(i(this,Y).queryNode,mn.create("ForKeyShare",e?os(e).map(st):void 0))})}forNoKeyUpdate(e){return new ye({...i(this,Y),queryNode:Oe.cloneWithEndModifier(i(this,Y).queryNode,mn.create("ForNoKeyUpdate",e?os(e).map(st):void 0))})}skipLocked(){return new ye({...i(this,Y),queryNode:Oe.cloneWithEndModifier(i(this,Y).queryNode,mn.create("SkipLocked"))})}noWait(){return new ye({...i(this,Y),queryNode:Oe.cloneWithEndModifier(i(this,Y).queryNode,mn.create("NoWait"))})}selectAll(e){return new ye({...i(this,Y),queryNode:Oe.cloneWithSelections(i(this,Y).queryNode,Gi(e))})}innerJoin(...e){return new ye({...i(this,Y),queryNode:we.cloneWithJoin(i(this,Y).queryNode,At("InnerJoin",e))})}leftJoin(...e){return new ye({...i(this,Y),queryNode:we.cloneWithJoin(i(this,Y).queryNode,At("LeftJoin",e))})}rightJoin(...e){return new ye({...i(this,Y),queryNode:we.cloneWithJoin(i(this,Y).queryNode,At("RightJoin",e))})}fullJoin(...e){return new ye({...i(this,Y),queryNode:we.cloneWithJoin(i(this,Y).queryNode,At("FullJoin",e))})}innerJoinLateral(...e){return new ye({...i(this,Y),queryNode:we.cloneWithJoin(i(this,Y).queryNode,At("LateralInnerJoin",e))})}leftJoinLateral(...e){return new ye({...i(this,Y),queryNode:we.cloneWithJoin(i(this,Y).queryNode,At("LateralLeftJoin",e))})}orderBy(...e){return new ye({...i(this,Y),queryNode:Oe.cloneWithOrderByItems(i(this,Y).queryNode,bo(e))})}groupBy(e){return new ye({...i(this,Y),queryNode:Oe.cloneWithGroupByItems(i(this,Y).queryNode,kd(e))})}limit(e){return new ye({...i(this,Y),queryNode:Oe.cloneWithLimit(i(this,Y).queryNode,la.create(ut(e)))})}offset(e){return new ye({...i(this,Y),queryNode:Oe.cloneWithOffset(i(this,Y).queryNode,Sd.create(ut(e)))})}fetch(e,r="only"){return new ye({...i(this,Y),queryNode:Oe.cloneWithFetch(i(this,Y).queryNode,Od(e,r))})}top(e,r){return new ye({...i(this,Y),queryNode:we.cloneWithTop(i(this,Y).queryNode,ai(e,r))})}union(e){return new ye({...i(this,Y),queryNode:Oe.cloneWithSetOperations(i(this,Y).queryNode,Ir("union",e,!1))})}unionAll(e){return new ye({...i(this,Y),queryNode:Oe.cloneWithSetOperations(i(this,Y).queryNode,Ir("union",e,!0))})}intersect(e){return new ye({...i(this,Y),queryNode:Oe.cloneWithSetOperations(i(this,Y).queryNode,Ir("intersect",e,!1))})}intersectAll(e){return new ye({...i(this,Y),queryNode:Oe.cloneWithSetOperations(i(this,Y).queryNode,Ir("intersect",e,!0))})}except(e){return new ye({...i(this,Y),queryNode:Oe.cloneWithSetOperations(i(this,Y).queryNode,Ir("except",e,!1))})}exceptAll(e){return new ye({...i(this,Y),queryNode:Oe.cloneWithSetOperations(i(this,Y).queryNode,Ir("except",e,!0))})}as(e){return new Rl(this,e)}clearSelect(){return new ye({...i(this,Y),queryNode:Oe.cloneWithoutSelections(i(this,Y).queryNode)})}clearWhere(){return new ye({...i(this,Y),queryNode:we.cloneWithoutWhere(i(this,Y).queryNode)})}clearLimit(){return new ye({...i(this,Y),queryNode:Oe.cloneWithoutLimit(i(this,Y).queryNode)})}clearOffset(){return new ye({...i(this,Y),queryNode:Oe.cloneWithoutOffset(i(this,Y).queryNode)})}clearOrderBy(){return new ye({...i(this,Y),queryNode:Oe.cloneWithoutOrderBy(i(this,Y).queryNode)})}$call(e){return e(this)}$if(e,r){return e?r(this):new ye({...i(this,Y)})}$castTo(){return new ye(i(this,Y))}$narrowType(){return new ye(i(this,Y))}$assertType(){return new ye(i(this,Y))}$asTuple(){return new Ke(this.toOperationNode())}withPlugin(e){return new ye({...i(this,Y),executor:i(this,Y).executor.withPlugin(e)})}toOperationNode(){return i(this,Y).executor.transformQuery(i(this,Y).queryNode,i(this,Y).queryId)}compile(){return i(this,Y).executor.compileQuery(this.toOperationNode(),i(this,Y).queryId)}async execute(){const e=this.compile();return(await i(this,Y).executor.executeQuery(e,i(this,Y).queryId)).rows}async executeTakeFirst(){const[e]=await this.execute();return e}async executeTakeFirstOrThrow(e=Xi){const r=await this.executeTakeFirst();if(r===void 0)throw Yi(e)?new e(this.toOperationNode()):e(this.toOperationNode());return r}async*stream(e=100){const r=this.compile(),n=i(this,Y).executor.stream(r,e,i(this,Y).queryId);for await(const I of n)yield*I.rows}async explain(e,r){return await new ye({...i(this,Y),queryNode:we.cloneWithExplain(i(this,Y).queryNode,e,r)}).execute()}};Y=new WeakMap;let Os=ye;Se(Os,"don't await SelectQueryBuilder instances directly. To execute the query you need to call `execute` or `executeTakeFirst`.");function zo(t){return new Os(t)}var Ur,jr;class Rl{constructor(e,r){B(this,Ur,void 0);B(this,jr,void 0);J(this,Ur,e),J(this,jr,r)}get expression(){return i(this,Ur)}get alias(){return i(this,jr)}get isAliasedSelectQueryBuilder(){return!0}toOperationNode(){return Yn.create(i(this,Ur).toOperationNode(),Ye.create(i(this,jr)))}}Ur=new WeakMap,jr=new WeakMap;Se(Rl,"don't await AliasedSelectQueryBuilder instances directly. AliasedSelectQueryBuilder should never be executed directly since it's always a part of another query.");const lr=f({is(t){return t.kind==="AggregateFunctionNode"},create(t,e=[]){return f({kind:"AggregateFunctionNode",func:t,aggregated:e})},cloneWithDistinct(t){return f({...t,distinct:!0})},cloneWithFilter(t,e){return f({...t,filter:t.filter?Tt.cloneWithOperation(t.filter,"And",e):Tt.create(e)})},cloneWithOrFilter(t,e){return f({...t,filter:t.filter?Tt.cloneWithOperation(t.filter,"Or",e):Tt.create(e)})},cloneWithOver(t,e){return f({...t,over:e})}}),il=f({is(t){return t.kind==="FunctionNode"},create(t,e){return f({kind:"FunctionNode",func:t,arguments:e})}});var Et;const Fn=class Fn{constructor(e){B(this,Et,void 0);J(this,Et,f(e))}get expressionType(){}as(e){return new Cd(this,e)}distinct(){return new Fn({...i(this,Et),aggregateFunctionNode:lr.cloneWithDistinct(i(this,Et).aggregateFunctionNode)})}filterWhere(...e){return new Fn({...i(this,Et),aggregateFunctionNode:lr.cloneWithFilter(i(this,Et).aggregateFunctionNode,qt(e))})}filterWhereRef(e,r,n){return new Fn({...i(this,Et),aggregateFunctionNode:lr.cloneWithFilter(i(this,Et).aggregateFunctionNode,fn(e,r,n))})}over(e){const r=vd();return new Fn({...i(this,Et),aggregateFunctionNode:lr.cloneWithOver(i(this,Et).aggregateFunctionNode,(e?e(r):r).toOperationNode())})}$call(e){return e(this)}$castTo(){return new Fn(i(this,Et))}$notNull(){return new Fn(i(this,Et))}toOperationNode(){return i(this,Et).aggregateFunctionNode}};Et=new WeakMap;let Pr=Fn;Se(Pr,"don't await AggregateFunctionBuilder instances. They are never executed directly and are always just a part of a query.");var zr,Vr;class Cd{constructor(e,r){B(this,zr,void 0);B(this,Vr,void 0);J(this,zr,e),J(this,Vr,r)}get expression(){return i(this,zr)}get alias(){return i(this,Vr)}toOperationNode(){return Yn.create(i(this,zr).toOperationNode(),Ye.create(i(this,Vr)))}}zr=new WeakMap,Vr=new WeakMap;function Ml(){const t=(r,n)=>new Ke(il.create(r,Ii(n??[]))),e=(r,n)=>new Pr({aggregateFunctionNode:lr.create(r,n?Ii(n):void 0)});return Object.assign(t,{agg:e,avg(r){return e("avg",[r])},coalesce(...r){return t("coalesce",r)},count(r){return e("count",[r])},countAll(r){return new Pr({aggregateFunctionNode:lr.create("count",Gi(r))})},max(r){return e("max",[r])},min(r){return e("min",[r])},sum(r){return e("sum",[r])},any(r){return t("any",[r])},jsonAgg(r){return new Pr({aggregateFunctionNode:lr.create("json_agg",[jt(r)?st(r):r.toOperationNode()])})},toJson(r){return new Ke(il.create("to_json",[jt(r)?st(r):r.toOperationNode()]))}})}const Fd=f({is(t){return t.kind==="UnaryOperationNode"},create(t,e){return f({kind:"UnaryOperationNode",operator:t,operand:e})}});function Pd(t,e){return Fd.create(Kn.create(t),Ut(e))}const cn=f({is(t){return t.kind==="CaseNode"},create(t){return f({kind:"CaseNode",value:t})},cloneWithWhen(t,e){return f({...t,when:f(t.when?[...t.when,e]:[e])})},cloneWithThen(t,e){return f({...t,when:t.when?f([...t.when.slice(0,-1),Ki.cloneWithResult(t.when[t.when.length-1],e)]):void 0})},cloneWith(t,e){return f({...t,...e})}});var $r;class Bl{constructor(e){B(this,$r,void 0);J(this,$r,f(e))}when(...e){return new Ql({...i(this,$r),node:cn.cloneWithWhen(i(this,$r).node,Ki.create(qt(e)))})}}$r=new WeakMap;var Hr;class Ql{constructor(e){B(this,Hr,void 0);J(this,Hr,f(e))}then(e){return new Wd({...i(this,Hr),node:cn.cloneWithThen(i(this,Hr).node,ia(e)?sa(e):ut(e))})}}Hr=new WeakMap;var sn;class Wd{constructor(e){B(this,sn,void 0);J(this,sn,f(e))}when(...e){return new Ql({...i(this,sn),node:cn.cloneWithWhen(i(this,sn).node,Ki.create(qt(e)))})}else(e){return new Ld({...i(this,sn),node:cn.cloneWith(i(this,sn).node,{else:ia(e)?sa(e):ut(e)})})}end(){return new Ke(cn.cloneWith(i(this,sn).node,{isStatement:!1}))}endCase(){return new Ke(cn.cloneWith(i(this,sn).node,{isStatement:!0}))}}sn=new WeakMap;var Jr;class Ld{constructor(e){B(this,Jr,void 0);J(this,Jr,f(e))}end(){return new Ke(cn.cloneWith(i(this,Jr).node,{isStatement:!1}))}endCase(){return new Ke(cn.cloneWith(i(this,Jr).node,{isStatement:!0}))}}Jr=new WeakMap;const sl=f({is(t){return t.kind==="JSONPathLegNode"},create(t,e){return f({kind:"JSONPathLegNode",type:t,value:e})}});var on,Bi,Vo;class wi{constructor(e){B(this,Bi);B(this,on,void 0);J(this,on,e)}at(e){return ve(this,Bi,Vo).call(this,"ArrayLocation",e)}key(e){return ve(this,Bi,Vo).call(this,"Member",e)}}on=new WeakMap,Bi=new WeakSet,Vo=function(e,r){return ys.is(i(this,on))?new ol(ys.cloneWithTraversal(i(this,on),_i.is(i(this,on).traversal)?_i.cloneWithLeg(i(this,on).traversal,sl.create(e,r)):Nl.cloneWithValue(i(this,on).traversal,dn.createImmediate(r)))):new ol(_i.cloneWithLeg(i(this,on),sl.create(e,r)))};var mr;class ol extends wi{constructor(r){super(r);B(this,mr,void 0);J(this,mr,r)}get expressionType(){}as(r){return new Dd(this,r)}$castTo(){return new wi(i(this,mr))}$notNull(){return new wi(i(this,mr))}toOperationNode(){return i(this,mr)}}mr=new WeakMap;var Gr,Bn;class Dd{constructor(e,r){B(this,Gr,void 0);B(this,Bn,void 0);J(this,Gr,e),J(this,Bn,r)}get expression(){return i(this,Gr)}get alias(){return i(this,Bn)}toOperationNode(){return Yn.create(i(this,Gr).toOperationNode(),Ft(i(this,Bn))?i(this,Bn).toOperationNode():Ye.create(i(this,Bn)))}}Gr=new WeakMap,Bn=new WeakMap;const al=f({is(t){return t.kind==="TupleNode"},create(t){return f({kind:"TupleNode",values:f(t)})}}),Rd=["varchar","char","text","integer","int2","int4","int8","smallint","bigint","boolean","real","double precision","float4","float8","decimal","numeric","binary","bytea","date","datetime","time","timetz","timestamp","timestamptz","serial","bigserial","uuid","json","jsonb","blob"],Md=[/^varchar\(\d+\)$/,/^char\(\d+\)$/,/^decimal\(\d+, \d+\)$/,/^numeric\(\d+, \d+\)$/,/^binary\(\d+\)$/,/^datetime\(\d+\)$/,/^time\(\d+\)$/,/^timez\(\d+\)$/,/^timestamp\(\d+\)$/,/^timestamptz\(\d+\)$/],Bd=f({is(t){return t.kind==="DataTypeNode"},create(t){return f({kind:"DataTypeNode",dataType:t})}});function Qd(t){return!!(Rd.includes(t)||Md.some(e=>e.test(t)))}function Nr(t){if(Ft(t))return t.toOperationNode();if(Qd(t))return Bd.create(t);throw new Error(`invalid column data type ${JSON.stringify(t)}`)}const Ud=f({is(t){return t.kind==="CastNode"},create(t,e){return f({kind:"CastNode",expression:t,dataType:e})}});function da(t=qo){function e(I,Q,re){return new Ke(oa(I,Q,re))}function r(I,Q){return new Ke(Pd(I,Q))}const n=Object.assign(e,{fn:void 0,eb:void 0,selectFrom(I){return zo({queryId:$e(),executor:t,queryNode:Oe.createFrom(Oi(I))})},case(I){return new Bl({node:cn.create(Vn(I)?void 0:Ut(I))})},ref(I,Q){return Vn(Q)?new Ke(kn(I)):new wi(Uc(I,Q))},jsonPath(){return new wi(_i.create())},table(I){return new Ke(st(I))},val(I){return new Ke(ut(I))},refTuple(...I){return new Ke(al.create(I.map(Ut)))},tuple(...I){return new Ke(al.create(I.map(ut)))},lit(I){return new Ke(sa(I))},unary:r,not(I){return r("not",I)},exists(I){return r("exists",I)},neg(I){return r("-",I)},between(I,Q,re){return new Ke(ni.create(Ut(I),Kn.create("between"),Gn.create(ut(Q),ut(re))))},betweenSymmetric(I,Q,re){return new Ke(ni.create(Ut(I),Kn.create("between symmetric"),Gn.create(ut(Q),ut(re))))},and(I){return In(I)?new Ke(ws(I,"and")):new Ke(ja(I,"and"))},or(I){return In(I)?new Ke(ws(I,"or")):new Ke(ja(I,"or"))},parens(...I){const Q=qt(I);return ri.is(Q)?new Ke(Q):new Ke(ri.create(Q))},cast(I,Q){return new Ke(Ud.create(Ut(I),Nr(Q)))},withSchema(I){return da(t.withPluginAtFront(new Zi(I)))}});return n.fn=Ml(),n.eb=n,n}function li(t){return da()}function vr(t){if(Ft(t))return t.toOperationNode();if(zt(t))return t(li()).toOperationNode();throw new Error(`invalid expression: ${JSON.stringify(t)}`)}function Ul(t){if(Ft(t))return t.toOperationNode();if(zt(t))return t(li()).toOperationNode();throw new Error(`invalid aliased expression: ${JSON.stringify(t)}`)}function es(t){return Cc(t)||Fc(t)||zt(t)}function Oi(t){return In(t)?t.map(e=>Ti(e)):[Ti(t)]}function Ti(t){return jt(t)?jl(t):Ul(t)}function jl(t){const e=" as ";if(t.includes(e)){const[r,n]=t.split(e).map(zl);return Yn.create(st(r),Ye.create(n))}else return st(t)}function st(t){const e=".";if(t.includes(e)){const[r,n]=t.split(e).map(zl);return Hn.createWithSchema(r,n)}else return Hn.create(t)}function zl(t){return t.trim()}const Vl=f({is(t){return t.kind==="AddColumnNode"},create(t){return f({kind:"AddColumnNode",column:t})}}),et=f({is(t){return t.kind==="ColumnDefinitionNode"},create(t,e){return f({kind:"ColumnDefinitionNode",column:ot.create(t),dataType:e})},cloneWithFrontModifier(t,e){return f({...t,frontModifiers:t.frontModifiers?f([...t.frontModifiers,e]):[e]})},cloneWithEndModifier(t,e){return f({...t,endModifiers:t.endModifiers?f([...t.endModifiers,e]):[e]})},cloneWith(t,e){return f({...t,...e})}}),$l=f({is(t){return t.kind==="DropColumnNode"},create(t){return f({kind:"DropColumnNode",column:ot.create(t)})}}),Hl=f({is(t){return t.kind==="RenameColumnNode"},create(t,e){return f({kind:"RenameColumnNode",column:ot.create(t),renameTo:ot.create(e)})}}),fa=f({is(t){return t.kind==="CheckConstraintNode"},create(t,e){return f({kind:"CheckConstraintNode",expression:t,name:e?Ye.create(e):void 0})}}),jd=["no action","restrict","cascade","set null","set default"],cs=f({is(t){return t.kind==="ReferencesNode"},create(t,e){return f({kind:"ReferencesNode",table:t,columns:f([...e])})},cloneWithOnDelete(t,e){return f({...t,onDelete:e})},cloneWithOnUpdate(t,e){return f({...t,onUpdate:e})}});function Jl(t){return Ft(t)?t.toOperationNode():dn.createImmediate(t)}const ls=f({is(t){return t.kind==="GeneratedNode"},create(t){return f({kind:"GeneratedNode",...t})},createWithExpression(t){return f({kind:"GeneratedNode",always:!0,expression:t})},cloneWith(t,e){return f({...t,...e})}}),zd=f({is(t){return t.kind==="DefaultValueNode"},create(t){return f({kind:"DefaultValueNode",defaultValue:t})}});function Ts(t){if(jd.includes(t))return t;throw new Error(`invalid OnModifyForeignAction ${t}`)}var Ue;const at=class at{constructor(e){B(this,Ue,void 0);J(this,Ue,e)}autoIncrement(){return new at(et.cloneWith(i(this,Ue),{autoIncrement:!0}))}identity(){return new at(et.cloneWith(i(this,Ue),{identity:!0}))}primaryKey(){return new at(et.cloneWith(i(this,Ue),{primaryKey:!0}))}references(e){const r=kn(e);if(!r.table||ta.is(r.column))throw new Error(`invalid call references('${e}'). The reference must have format table.column or schema.table.column`);return new at(et.cloneWith(i(this,Ue),{references:cs.create(r.table,[r.column])}))}onDelete(e){if(!i(this,Ue).references)throw new Error("on delete constraint can only be added for foreign keys");return new at(et.cloneWith(i(this,Ue),{references:cs.cloneWithOnDelete(i(this,Ue).references,Ts(e))}))}onUpdate(e){if(!i(this,Ue).references)throw new Error("on update constraint can only be added for foreign keys");return new at(et.cloneWith(i(this,Ue),{references:cs.cloneWithOnUpdate(i(this,Ue).references,Ts(e))}))}unique(){return new at(et.cloneWith(i(this,Ue),{unique:!0}))}notNull(){return new at(et.cloneWith(i(this,Ue),{notNull:!0}))}unsigned(){return new at(et.cloneWith(i(this,Ue),{unsigned:!0}))}defaultTo(e){return new at(et.cloneWith(i(this,Ue),{defaultTo:zd.create(Jl(e))}))}check(e){return new at(et.cloneWith(i(this,Ue),{check:fa.create(e.toOperationNode())}))}generatedAlwaysAs(e){return new at(et.cloneWith(i(this,Ue),{generated:ls.createWithExpression(e.toOperationNode())}))}generatedAlwaysAsIdentity(){return new at(et.cloneWith(i(this,Ue),{generated:ls.create({identity:!0,always:!0})}))}generatedByDefaultAsIdentity(){return new at(et.cloneWith(i(this,Ue),{generated:ls.create({identity:!0,byDefault:!0})}))}stored(){if(!i(this,Ue).generated)throw new Error("stored() can only be called after generatedAlwaysAs");return new at(et.cloneWith(i(this,Ue),{generated:ls.cloneWith(i(this,Ue).generated,{stored:!0})}))}modifyFront(e){return new at(et.cloneWithFrontModifier(i(this,Ue),e.toOperationNode()))}nullsNotDistinct(){return new at(et.cloneWith(i(this,Ue),{nullsNotDistinct:!0}))}modifyEnd(e){return new at(et.cloneWithEndModifier(i(this,Ue),e.toOperationNode()))}$call(e){return e(this)}toOperationNode(){return i(this,Ue)}};Ue=new WeakMap;let Xn=at;Se(Xn,"don't await ColumnDefinitionBuilder instances directly.");const Gl=f({is(t){return t.kind==="ModifyColumnNode"},create(t){return f({kind:"ModifyColumnNode",column:t})}}),Cs=f({is(t){return t.kind==="ForeignKeyConstraintNode"},create(t,e,r,n){return f({kind:"ForeignKeyConstraintNode",columns:t,references:cs.create(e,r),name:n?Ye.create(n):void 0})},cloneWith(t,e){return f({...t,...e})}});var _r;const so=class so{constructor(e){B(this,_r,void 0);J(this,_r,e)}onDelete(e){return new so(Cs.cloneWith(i(this,_r),{onDelete:Ts(e)}))}onUpdate(e){return new so(Cs.cloneWith(i(this,_r),{onUpdate:Ts(e)}))}$call(e){return e(this)}toOperationNode(){return i(this,_r)}};_r=new WeakMap;let Ci=so;Se(Ci,"don't await ForeignKeyConstraintBuilder instances directly.");const ds=f({is(t){return t.kind==="AddConstraintNode"},create(t){return f({kind:"AddConstraintNode",constraint:t})}}),ha=f({is(t){return t.kind==="UniqueConstraintNode"},create(t,e,r){return f({kind:"UniqueConstraintNode",columns:f(t.map(ot.create)),name:e?Ye.create(e):void 0,nullsNotDistinct:r})},cloneWith(t,e){return f({...t,...e})}}),fs=f({is(t){return t.kind==="DropConstraintNode"},create(t){return f({kind:"DropConstraintNode",constraintName:Ye.create(t)})},cloneWith(t,e){return f({...t,...e})}}),fi=f({is(t){return t.kind==="AlterColumnNode"},create(t,e,r){return f({kind:"AlterColumnNode",column:ot.create(t),[e]:r})}});var Nn;class pa{constructor(e){B(this,Nn,void 0);J(this,Nn,e)}setDataType(e){return new hi(fi.create(i(this,Nn),"dataType",Nr(e)))}setDefault(e){return new hi(fi.create(i(this,Nn),"setDefault",Jl(e)))}dropDefault(){return new hi(fi.create(i(this,Nn),"dropDefault",!0))}setNotNull(){return new hi(fi.create(i(this,Nn),"setNotNull",!0))}dropNotNull(){return new hi(fi.create(i(this,Nn),"dropNotNull",!0))}$call(e){return e(this)}}Nn=new WeakMap;var Qi;class hi{constructor(e){B(this,Qi,void 0);J(this,Qi,e)}toOperationNode(){return i(this,Qi)}}Qi=new WeakMap;var Yt;class nr{constructor(e){B(this,Yt,void 0);J(this,Yt,f(e))}toOperationNode(){return i(this,Yt).executor.transformQuery(i(this,Yt).node,i(this,Yt).queryId)}compile(){return i(this,Yt).executor.compileQuery(this.toOperationNode(),i(this,Yt).queryId)}async execute(){await i(this,Yt).executor.executeQuery(this.compile(),i(this,Yt).queryId)}}Yt=new WeakMap;Se(nr,"don't await AlterTableExecutor instances directly. To execute the query you need to call `execute`");var Nt;const oo=class oo{constructor(e){B(this,Nt,void 0);J(this,Nt,f(e))}onDelete(e){return new oo({...i(this,Nt),constraintBuilder:i(this,Nt).constraintBuilder.onDelete(e)})}onUpdate(e){return new oo({...i(this,Nt),constraintBuilder:i(this,Nt).constraintBuilder.onUpdate(e)})}$call(e){return e(this)}toOperationNode(){return i(this,Nt).executor.transformQuery(Ve.cloneWithTableProps(i(this,Nt).node,{addConstraint:ds.create(i(this,Nt).constraintBuilder.toOperationNode())}),i(this,Nt).queryId)}compile(){return i(this,Nt).executor.compileQuery(this.toOperationNode(),i(this,Nt).queryId)}async execute(){await i(this,Nt).executor.executeQuery(this.compile(),i(this,Nt).queryId)}};Nt=new WeakMap;let Fs=oo;Se(Fs,"don't await AlterTableAddForeignKeyConstraintBuilder instances directly. To execute the query you need to call `execute`");var lt;const Ni=class Ni{constructor(e){B(this,lt,void 0);J(this,lt,f(e))}ifExists(){return new Ni({...i(this,lt),node:Ve.cloneWithTableProps(i(this,lt).node,{dropConstraint:fs.cloneWith(i(this,lt).node.dropConstraint,{ifExists:!0})})})}cascade(){return new Ni({...i(this,lt),node:Ve.cloneWithTableProps(i(this,lt).node,{dropConstraint:fs.cloneWith(i(this,lt).node.dropConstraint,{modifier:"cascade"})})})}restrict(){return new Ni({...i(this,lt),node:Ve.cloneWithTableProps(i(this,lt).node,{dropConstraint:fs.cloneWith(i(this,lt).node.dropConstraint,{modifier:"restrict"})})})}$call(e){return e(this)}toOperationNode(){return i(this,lt).executor.transformQuery(i(this,lt).node,i(this,lt).queryId)}compile(){return i(this,lt).executor.compileQuery(this.toOperationNode(),i(this,lt).queryId)}async execute(){await i(this,lt).executor.executeQuery(this.compile(),i(this,lt).queryId)}};lt=new WeakMap;let Ps=Ni;Se(Ps,"don't await AlterTableDropConstraintBuilder instances directly. To execute the query you need to call `execute`");const Kl=f({is(t){return t.kind==="PrimaryKeyConstraintNode"},create(t,e){return f({kind:"PrimaryKeyConstraintNode",columns:f(t.map(ot.create)),name:e?Ye.create(e):void 0})}}),Ar=f({is(t){return t.kind==="AddIndexNode"},create(t){return f({kind:"AddIndexNode",name:Ye.create(t)})},cloneWith(t,e){return f({...t,...e})},cloneWithColumns(t,e){return f({...t,columns:[...t.columns||[],...e]})}});var Ge;const sr=class sr{constructor(e){B(this,Ge,void 0);J(this,Ge,f(e))}unique(){return new sr({...i(this,Ge),node:Ve.cloneWithTableProps(i(this,Ge).node,{addIndex:Ar.cloneWith(i(this,Ge).node.addIndex,{unique:!0})})})}column(e){return new sr({...i(this,Ge),node:Ve.cloneWithTableProps(i(this,Ge).node,{addIndex:Ar.cloneWithColumns(i(this,Ge).node.addIndex,[gs(e)])})})}columns(e){return new sr({...i(this,Ge),node:Ve.cloneWithTableProps(i(this,Ge).node,{addIndex:Ar.cloneWithColumns(i(this,Ge).node.addIndex,e.map(gs))})})}expression(e){return new sr({...i(this,Ge),node:Ve.cloneWithTableProps(i(this,Ge).node,{addIndex:Ar.cloneWithColumns(i(this,Ge).node.addIndex,[e.toOperationNode()])})})}using(e){return new sr({...i(this,Ge),node:Ve.cloneWithTableProps(i(this,Ge).node,{addIndex:Ar.cloneWith(i(this,Ge).node.addIndex,{using:bt.createWithSql(e)})})})}$call(e){return e(this)}toOperationNode(){return i(this,Ge).executor.transformQuery(i(this,Ge).node,i(this,Ge).queryId)}compile(){return i(this,Ge).executor.compileQuery(this.toOperationNode(),i(this,Ge).queryId)}async execute(){await i(this,Ge).executor.executeQuery(this.compile(),i(this,Ge).queryId)}};Ge=new WeakMap;let Ws=sr;Se(Ws,"don't await AlterTableAddIndexBuilder instances directly. To execute the query you need to call `execute`");var Kr;const ya=class ya{constructor(e){B(this,Kr,void 0);J(this,Kr,e)}toOperationNode(){return i(this,Kr)}nullsNotDistinct(){return new ya(ha.cloneWith(i(this,Kr),{nullsNotDistinct:!0}))}};Kr=new WeakMap;let Fi=ya;Se(Fi,"don't await UniqueConstraintNodeBuilder instances directly.");var Me;class Xl{constructor(e){B(this,Me,void 0);J(this,Me,f(e))}renameTo(e){return new nr({...i(this,Me),node:Ve.cloneWithTableProps(i(this,Me).node,{renameTo:st(e)})})}setSchema(e){return new nr({...i(this,Me),node:Ve.cloneWithTableProps(i(this,Me).node,{setSchema:Ye.create(e)})})}alterColumn(e,r){const n=r(new pa(e));return new Wn({...i(this,Me),node:Ve.cloneWithColumnAlteration(i(this,Me).node,n.toOperationNode())})}dropColumn(e){return new Wn({...i(this,Me),node:Ve.cloneWithColumnAlteration(i(this,Me).node,$l.create(e))})}renameColumn(e,r){return new Wn({...i(this,Me),node:Ve.cloneWithColumnAlteration(i(this,Me).node,Hl.create(e,r))})}addColumn(e,r,n=$n){const I=n(new Xn(et.create(e,Nr(r))));return new Wn({...i(this,Me),node:Ve.cloneWithColumnAlteration(i(this,Me).node,Vl.create(I.toOperationNode()))})}modifyColumn(e,r,n=$n){const I=n(new Xn(et.create(e,Nr(r))));return new Wn({...i(this,Me),node:Ve.cloneWithColumnAlteration(i(this,Me).node,Gl.create(I.toOperationNode()))})}addUniqueConstraint(e,r,n=$n){const I=n(new Fi(ha.create(r,e)));return new nr({...i(this,Me),node:Ve.cloneWithTableProps(i(this,Me).node,{addConstraint:ds.create(I.toOperationNode())})})}addCheckConstraint(e,r){return new nr({...i(this,Me),node:Ve.cloneWithTableProps(i(this,Me).node,{addConstraint:ds.create(fa.create(r.toOperationNode(),e))})})}addForeignKeyConstraint(e,r,n,I){return new Fs({...i(this,Me),constraintBuilder:new Ci(Cs.create(r.map(ot.create),st(n),I.map(ot.create),e))})}addPrimaryKeyConstraint(e,r){return new nr({...i(this,Me),node:Ve.cloneWithTableProps(i(this,Me).node,{addConstraint:ds.create(Kl.create(r,e))})})}dropConstraint(e){return new Ps({...i(this,Me),node:Ve.cloneWithTableProps(i(this,Me).node,{dropConstraint:fs.create(e)})})}addIndex(e){return new Ws({...i(this,Me),node:Ve.cloneWithTableProps(i(this,Me).node,{addIndex:Ar.create(e)})})}dropIndex(e){return new nr({...i(this,Me),node:Ve.cloneWithTableProps(i(this,Me).node,{dropIndex:pi.create(e)})})}$call(e){return e(this)}}Me=new WeakMap;var it;const or=class or{constructor(e){B(this,it,void 0);J(this,it,f(e))}alterColumn(e,r){const n=r(new pa(e));return new or({...i(this,it),node:Ve.cloneWithColumnAlteration(i(this,it).node,n.toOperationNode())})}dropColumn(e){return new or({...i(this,it),node:Ve.cloneWithColumnAlteration(i(this,it).node,$l.create(e))})}renameColumn(e,r){return new or({...i(this,it),node:Ve.cloneWithColumnAlteration(i(this,it).node,Hl.create(e,r))})}addColumn(e,r,n=$n){const I=n(new Xn(et.create(e,Nr(r))));return new or({...i(this,it),node:Ve.cloneWithColumnAlteration(i(this,it).node,Vl.create(I.toOperationNode()))})}modifyColumn(e,r,n=$n){const I=n(new Xn(et.create(e,Nr(r))));return new or({...i(this,it),node:Ve.cloneWithColumnAlteration(i(this,it).node,Gl.create(I.toOperationNode()))})}toOperationNode(){return i(this,it).executor.transformQuery(i(this,it).node,i(this,it).queryId)}compile(){return i(this,it).executor.compileQuery(this.toOperationNode(),i(this,it).queryId)}async execute(){await i(this,it).executor.executeQuery(this.compile(),i(this,it).queryId)}};it=new WeakMap;let Wn=or;Se(Xl,"don't await AlterTableBuilder instances");Se(pa,"don't await AlterColumnBuilder instances");Se(Wn,"don't await AlterTableColumnAlteringBuilder instances directly. To execute the query you need to call `execute`");class Yl extends ua{transformValue(e){return{...super.transformValue(e),immediate:!0}}}var je;const Jt=class Jt{constructor(e){B(this,je,void 0);J(this,je,f(e))}ifNotExists(){return new Jt({...i(this,je),node:_n.cloneWith(i(this,je).node,{ifNotExists:!0})})}unique(){return new Jt({...i(this,je),node:_n.cloneWith(i(this,je).node,{unique:!0})})}nullsNotDistinct(){return new Jt({...i(this,je),node:_n.cloneWith(i(this,je).node,{nullsNotDistinct:!0})})}on(e){return new Jt({...i(this,je),node:_n.cloneWith(i(this,je).node,{table:st(e)})})}column(e){return new Jt({...i(this,je),node:_n.cloneWithColumns(i(this,je).node,[gs(e)])})}columns(e){return new Jt({...i(this,je),node:_n.cloneWithColumns(i(this,je).node,e.map(gs))})}expression(e){return new Jt({...i(this,je),node:_n.cloneWithColumns(i(this,je).node,[e.toOperationNode()])})}using(e){return new Jt({...i(this,je),node:_n.cloneWith(i(this,je).node,{using:bt.createWithSql(e)})})}where(...e){const r=new Yl;return new Jt({...i(this,je),node:we.cloneWithWhere(i(this,je).node,r.transformNode(qt(e)))})}$call(e){return e(this)}toOperationNode(){return i(this,je).executor.transformQuery(i(this,je).node,i(this,je).queryId)}compile(){return i(this,je).executor.compileQuery(this.toOperationNode(),i(this,je).queryId)}async execute(){await i(this,je).executor.executeQuery(this.compile(),i(this,je).queryId)}};je=new WeakMap;let Ls=Jt;Se(Ls,"don't await CreateIndexBuilder instances directly. To execute the query you need to call `execute`");var Dt;const ga=class ga{constructor(e){B(this,Dt,void 0);J(this,Dt,f(e))}ifNotExists(){return new ga({...i(this,Dt),node:yl.cloneWith(i(this,Dt).node,{ifNotExists:!0})})}$call(e){return e(this)}toOperationNode(){return i(this,Dt).executor.transformQuery(i(this,Dt).node,i(this,Dt).queryId)}compile(){return i(this,Dt).executor.compileQuery(this.toOperationNode(),i(this,Dt).queryId)}async execute(){await i(this,Dt).executor.executeQuery(this.compile(),i(this,Dt).queryId)}};Dt=new WeakMap;let Ds=ga;Se(Ds,"don't await CreateSchemaBuilder instances directly. To execute the query you need to call `execute`");function Vd(t){if(Tc.includes(t))return t;throw new Error(`invalid OnCommitAction ${t}`)}var We;const Lt=class Lt{constructor(e){B(this,We,void 0);J(this,We,f(e))}temporary(){return new Lt({...i(this,We),node:Wt.cloneWith(i(this,We).node,{temporary:!0})})}onCommit(e){return new Lt({...i(this,We),node:Wt.cloneWith(i(this,We).node,{onCommit:Vd(e)})})}ifNotExists(){return new Lt({...i(this,We),node:Wt.cloneWith(i(this,We).node,{ifNotExists:!0})})}addColumn(e,r,n=$n){const I=n(new Xn(et.create(e,Nr(r))));return new Lt({...i(this,We),node:Wt.cloneWithColumn(i(this,We).node,I.toOperationNode())})}addPrimaryKeyConstraint(e,r){return new Lt({...i(this,We),node:Wt.cloneWithConstraint(i(this,We).node,Kl.create(r,e))})}addUniqueConstraint(e,r,n=$n){const I=n(new Fi(ha.create(r,e)));return new Lt({...i(this,We),node:Wt.cloneWithConstraint(i(this,We).node,I.toOperationNode())})}addCheckConstraint(e,r){return new Lt({...i(this,We),node:Wt.cloneWithConstraint(i(this,We).node,fa.create(r.toOperationNode(),e))})}addForeignKeyConstraint(e,r,n,I,Q=$n){const re=Q(new Ci(Cs.create(r.map(ot.create),st(n),I.map(ot.create),e)));return new Lt({...i(this,We),node:Wt.cloneWithConstraint(i(this,We).node,re.toOperationNode())})}modifyFront(e){return new Lt({...i(this,We),node:Wt.cloneWithFrontModifier(i(this,We).node,e.toOperationNode())})}modifyEnd(e){return new Lt({...i(this,We),node:Wt.cloneWithEndModifier(i(this,We).node,e.toOperationNode())})}as(e){return new Lt({...i(this,We),node:Wt.cloneWith(i(this,We).node,{selectQuery:vr(e)})})}$call(e){return e(this)}toOperationNode(){return i(this,We).executor.transformQuery(i(this,We).node,i(this,We).queryId)}compile(){return i(this,We).executor.compileQuery(this.toOperationNode(),i(this,We).queryId)}async execute(){await i(this,We).executor.executeQuery(this.compile(),i(this,We).queryId)}};We=new WeakMap;let Rs=Lt;Se(Rs,"don't await CreateTableBuilder instances directly. To execute the query you need to call `execute`");var yt;const vi=class vi{constructor(e){B(this,yt,void 0);J(this,yt,f(e))}on(e){return new vi({...i(this,yt),node:pi.cloneWith(i(this,yt).node,{table:st(e)})})}ifExists(){return new vi({...i(this,yt),node:pi.cloneWith(i(this,yt).node,{ifExists:!0})})}cascade(){return new vi({...i(this,yt),node:pi.cloneWith(i(this,yt).node,{cascade:!0})})}$call(e){return e(this)}toOperationNode(){return i(this,yt).executor.transformQuery(i(this,yt).node,i(this,yt).queryId)}compile(){return i(this,yt).executor.compileQuery(this.toOperationNode(),i(this,yt).queryId)}async execute(){await i(this,yt).executor.executeQuery(this.compile(),i(this,yt).queryId)}};yt=new WeakMap;let Ms=vi;Se(Ms,"don't await DropIndexBuilder instances directly. To execute the query you need to call `execute`");var St;const ao=class ao{constructor(e){B(this,St,void 0);J(this,St,f(e))}ifExists(){return new ao({...i(this,St),node:Po.cloneWith(i(this,St).node,{ifExists:!0})})}cascade(){return new ao({...i(this,St),node:Po.cloneWith(i(this,St).node,{cascade:!0})})}$call(e){return e(this)}toOperationNode(){return i(this,St).executor.transformQuery(i(this,St).node,i(this,St).queryId)}compile(){return i(this,St).executor.compileQuery(this.toOperationNode(),i(this,St).queryId)}async execute(){await i(this,St).executor.executeQuery(this.compile(),i(this,St).queryId)}};St=new WeakMap;let Bs=ao;Se(Bs,"don't await DropSchemaBuilder instances directly. To execute the query you need to call `execute`");var It;const lo=class lo{constructor(e){B(this,It,void 0);J(this,It,f(e))}ifExists(){return new lo({...i(this,It),node:Wo.cloneWith(i(this,It).node,{ifExists:!0})})}cascade(){return new lo({...i(this,It),node:Wo.cloneWith(i(this,It).node,{cascade:!0})})}$call(e){return e(this)}toOperationNode(){return i(this,It).executor.transformQuery(i(this,It).node,i(this,It).queryId)}compile(){return i(this,It).executor.compileQuery(this.toOperationNode(),i(this,It).queryId)}async execute(){await i(this,It).executor.executeQuery(this.compile(),i(this,It).queryId)}};It=new WeakMap;let Qs=lo;Se(Qs,"don't await DropTableBuilder instances directly. To execute the query you need to call `execute`");const Cn=f({is(t){return t.kind==="CreateViewNode"},create(t){return f({kind:"CreateViewNode",name:Jn.create(t)})},cloneWith(t,e){return f({...t,...e})}});var uo;class $d{constructor(){B(this,uo,new Yl)}transformQuery(e){return i(this,uo).transformNode(e.node)}transformResult(e){return Promise.resolve(e.result)}}uo=new WeakMap;var Ze;const Pn=class Pn{constructor(e){B(this,Ze,void 0);J(this,Ze,f(e))}temporary(){return new Pn({...i(this,Ze),node:Cn.cloneWith(i(this,Ze).node,{temporary:!0})})}materialized(){return new Pn({...i(this,Ze),node:Cn.cloneWith(i(this,Ze).node,{materialized:!0})})}ifNotExists(){return new Pn({...i(this,Ze),node:Cn.cloneWith(i(this,Ze).node,{ifNotExists:!0})})}orReplace(){return new Pn({...i(this,Ze),node:Cn.cloneWith(i(this,Ze).node,{orReplace:!0})})}columns(e){return new Pn({...i(this,Ze),node:Cn.cloneWith(i(this,Ze).node,{columns:e.map(xl)})})}as(e){const r=e.withPlugin(new $d).toOperationNode();return new Pn({...i(this,Ze),node:Cn.cloneWith(i(this,Ze).node,{as:r})})}$call(e){return e(this)}toOperationNode(){return i(this,Ze).executor.transformQuery(i(this,Ze).node,i(this,Ze).queryId)}compile(){return i(this,Ze).executor.compileQuery(this.toOperationNode(),i(this,Ze).queryId)}async execute(){await i(this,Ze).executor.executeQuery(this.compile(),i(this,Ze).queryId)}};Ze=new WeakMap;let Us=Pn;Se(Us,"don't await CreateViewBuilder instances directly. To execute the query you need to call `execute`");const hs=f({is(t){return t.kind==="DropViewNode"},create(t){return f({kind:"DropViewNode",name:Jn.create(t)})},cloneWith(t,e){return f({...t,...e})}});var gt;const xi=class xi{constructor(e){B(this,gt,void 0);J(this,gt,f(e))}materialized(){return new xi({...i(this,gt),node:hs.cloneWith(i(this,gt).node,{materialized:!0})})}ifExists(){return new xi({...i(this,gt),node:hs.cloneWith(i(this,gt).node,{ifExists:!0})})}cascade(){return new xi({...i(this,gt),node:hs.cloneWith(i(this,gt).node,{cascade:!0})})}$call(e){return e(this)}toOperationNode(){return i(this,gt).executor.transformQuery(i(this,gt).node,i(this,gt).queryId)}compile(){return i(this,gt).executor.compileQuery(this.toOperationNode(),i(this,gt).queryId)}async execute(){await i(this,gt).executor.executeQuery(this.compile(),i(this,gt).queryId)}};gt=new WeakMap;let js=xi;Se(js,"don't await DropViewBuilder instances directly. To execute the query you need to call `execute`");const Zl=f({is(t){return t.kind==="CreateTypeNode"},create(t){return f({kind:"CreateTypeNode",name:t})},cloneWithEnum(t,e){return f({...t,enum:ra.create(e.map(r=>dn.createImmediate(r)))})}});var Rt;const wa=class wa{constructor(e){B(this,Rt,void 0);J(this,Rt,f(e))}toOperationNode(){return i(this,Rt).executor.transformQuery(i(this,Rt).node,i(this,Rt).queryId)}asEnum(e){return new wa({...i(this,Rt),node:Zl.cloneWithEnum(i(this,Rt).node,e)})}$call(e){return e(this)}compile(){return i(this,Rt).executor.compileQuery(this.toOperationNode(),i(this,Rt).queryId)}async execute(){await i(this,Rt).executor.executeQuery(this.compile(),i(this,Rt).queryId)}};Rt=new WeakMap;let zs=wa;Se(zs,"don't await CreateTypeBuilder instances directly. To execute the query you need to call `execute`");const eu=f({is(t){return t.kind==="DropTypeNode"},create(t){return f({kind:"DropTypeNode",name:t})},cloneWith(t,e){return f({...t,...e})}});var Mt;const ba=class ba{constructor(e){B(this,Mt,void 0);J(this,Mt,f(e))}ifExists(){return new ba({...i(this,Mt),node:eu.cloneWith(i(this,Mt).node,{ifExists:!0})})}$call(e){return e(this)}toOperationNode(){return i(this,Mt).executor.transformQuery(i(this,Mt).node,i(this,Mt).queryId)}compile(){return i(this,Mt).executor.compileQuery(this.toOperationNode(),i(this,Mt).queryId)}async execute(){await i(this,Mt).executor.executeQuery(this.compile(),i(this,Mt).queryId)}};Mt=new WeakMap;let Vs=ba;Se(Vs,"don't await DropTypeBuilder instances directly. To execute the query you need to call `execute`");function ll(t){const e=".";if(t.includes(e)){const r=t.split(e).map(Hd);if(r.length===2)return Jn.createWithSchema(r[0],r[1]);throw new Error(`invalid schemable identifier ${t}`)}else return Jn.create(t)}function Hd(t){return t.trim()}var mt;const Ei=class Ei{constructor(e){B(this,mt,void 0);J(this,mt,e)}createTable(e){return new Rs({queryId:$e(),executor:i(this,mt),node:Wt.create(st(e))})}dropTable(e){return new Qs({queryId:$e(),executor:i(this,mt),node:Wo.create(st(e))})}createIndex(e){return new Ls({queryId:$e(),executor:i(this,mt),node:_n.create(e)})}dropIndex(e){return new Ms({queryId:$e(),executor:i(this,mt),node:pi.create(e)})}createSchema(e){return new Ds({queryId:$e(),executor:i(this,mt),node:yl.create(e)})}dropSchema(e){return new Bs({queryId:$e(),executor:i(this,mt),node:Po.create(e)})}alterTable(e){return new Xl({queryId:$e(),executor:i(this,mt),node:Ve.create(st(e))})}createView(e){return new Us({queryId:$e(),executor:i(this,mt),node:Cn.create(e)})}dropView(e){return new js({queryId:$e(),executor:i(this,mt),node:hs.create(e)})}createType(e){return new zs({queryId:$e(),executor:i(this,mt),node:Zl.create(ll(e))})}dropType(e){return new Vs({queryId:$e(),executor:i(this,mt),node:eu.create(ll(e))})}withPlugin(e){return new Ei(i(this,mt).withPlugin(e))}withoutPlugins(){return new Ei(i(this,mt).withoutPlugins())}withSchema(e){return new Ei(i(this,mt).withPluginAtFront(new Zi(e)))}};mt=new WeakMap;let $o=Ei;class Jd{ref(e){return new Bc(e)}}var Xr;class Gd{constructor(e){B(this,Xr,void 0);J(this,Xr,e)}async provideConnection(e){const r=await i(this,Xr).acquireConnection();try{return await e(r)}finally{await i(this,Xr).releaseConnection(r)}}}Xr=new WeakMap;var an,ln,vn;const ar=class ar extends Wl{constructor(r,n,I,Q=[]){super(Q);B(this,an,void 0);B(this,ln,void 0);B(this,vn,void 0);J(this,an,r),J(this,ln,n),J(this,vn,I)}get adapter(){return i(this,ln)}compileQuery(r){return i(this,an).compileQuery(r)}provideConnection(r){return i(this,vn).provideConnection(r)}withPlugins(r){return new ar(i(this,an),i(this,ln),i(this,vn),[...this.plugins,...r])}withPlugin(r){return new ar(i(this,an),i(this,ln),i(this,vn),[...this.plugins,r])}withPluginAtFront(r){return new ar(i(this,an),i(this,ln),i(this,vn),[r,...this.plugins])}withConnectionProvider(r){return new ar(i(this,an),i(this,ln),r,[...this.plugins])}withoutPlugins(){return new ar(i(this,an),i(this,ln),i(this,vn),[])}};an=new WeakMap,ln=new WeakMap,vn=new WeakMap;let Ho=ar;function ul(){return typeof performance<"u"&&zt(performance.now)?performance.now():Date.now()}var Zt,Qn,xn,Yr,En,Ui,co,tu,fo,nu,ho,ru,po,iu,ji,Jo;class Kd{constructor(e,r){B(this,co);B(this,fo);B(this,ho);B(this,po);B(this,ji);B(this,Zt,void 0);B(this,Qn,void 0);B(this,xn,void 0);B(this,Yr,void 0);B(this,En,void 0);B(this,Ui,new WeakSet);J(this,Yr,!1),J(this,Zt,e),J(this,Qn,r)}async init(){if(i(this,En))throw new Error("driver has already been destroyed");i(this,xn)||J(this,xn,i(this,Zt).init().then(()=>{J(this,Yr,!0)}).catch(e=>(J(this,xn,void 0),Promise.reject(e)))),await i(this,xn)}async acquireConnection(){if(i(this,En))throw new Error("driver has already been destroyed");i(this,Yr)||await this.init();const e=await i(this,Zt).acquireConnection();return i(this,Ui).has(e)||(ve(this,co,tu).call(this)&&ve(this,fo,nu).call(this,e),i(this,Ui).add(e)),e}async releaseConnection(e){await i(this,Zt).releaseConnection(e)}beginTransaction(e,r){return i(this,Zt).beginTransaction(e,r)}commitTransaction(e){return i(this,Zt).commitTransaction(e)}rollbackTransaction(e){return i(this,Zt).rollbackTransaction(e)}async destroy(){i(this,xn)&&(await i(this,xn),i(this,En)||J(this,En,i(this,Zt).destroy().catch(e=>(J(this,En,void 0),Promise.reject(e)))),await i(this,En))}}Zt=new WeakMap,Qn=new WeakMap,xn=new WeakMap,Yr=new WeakMap,En=new WeakMap,Ui=new WeakMap,co=new WeakSet,tu=function(){return i(this,Qn).isLevelEnabled("query")||i(this,Qn).isLevelEnabled("error")},fo=new WeakSet,nu=function(e){const r=e.executeQuery;e.executeQuery=async n=>{let I;const Q=ul();try{return await r.call(e,n)}catch(re){throw I=re,await ve(this,ho,ru).call(this,re,n,Q),re}finally{I||await ve(this,po,iu).call(this,n,Q)}}},ho=new WeakSet,ru=async function(e,r,n){await i(this,Qn).error(()=>({level:"error",error:e,query:r,queryDurationMillis:ve(this,ji,Jo).call(this,n)}))},po=new WeakSet,iu=async function(e,r){await i(this,Qn).query(()=>({level:"query",query:e,queryDurationMillis:ve(this,ji,Jo).call(this,r)}))},ji=new WeakSet,Jo=function(e){return ul()-e};const Xd=()=>{};var zi,Un,mo,ou;class su{constructor(e){B(this,mo);B(this,zi,void 0);B(this,Un,void 0);J(this,zi,e)}async provideConnection(e){for(;i(this,Un);)await i(this,Un).catch(Xd);return J(this,Un,ve(this,mo,ou).call(this,e).finally(()=>{J(this,Un,void 0)})),i(this,Un)}}zi=new WeakMap,Un=new WeakMap,mo=new WeakSet,ou=async function(e){return await e(i(this,zi))};const Yd=["read uncommitted","read committed","repeatable read","serializable","snapshot"];f(["query","error"]);var jn,yr;class Zd{constructor(e){B(this,jn,void 0);B(this,yr,void 0);zt(e)?(J(this,yr,e),J(this,jn,f({query:!0,error:!0}))):(J(this,yr,ef),J(this,jn,f({query:e.includes("query"),error:e.includes("error")})))}isLevelEnabled(e){return i(this,jn)[e]}async query(e){i(this,jn).query&&await i(this,yr).call(this,e())}async error(e){i(this,jn).error&&await i(this,yr).call(this,e())}}jn=new WeakMap,yr=new WeakMap;function ef(t){t.level==="query"?(console.log(`kysely:query: ${t.query.sql}`),console.log(`kysely:query: duration: ${t.queryDurationMillis.toFixed(1)}ms`)):t.level==="error"&&(t.error instanceof Error?console.error(`kysely:error: ${t.error.stack??t.error.message}`):console.error(`kysely:error: ${JSON.stringify({error:t.error,query:t.query.sql,queryDurationMillis:t.queryDurationMillis})}`))}function tf(t){return un(t)&&zt(t.compile)}var wt;const Tr=class Tr extends As{constructor(r){let n,I;if(nf(r))n={executor:r.executor},I={...r};else{const Q=r.dialect,re=Q.createDriver(),Ie=Q.createQueryCompiler(),ze=Q.createAdapter(),He=new Zd(r.log??[]),ie=new Kd(re,He),be=new Gd(ie),Te=new Ho(Ie,ze,be,r.plugins??[]);n={executor:Te},I={config:r,executor:Te,dialect:Q,driver:ie}}super(n);B(this,wt,void 0);J(this,wt,f(I))}get schema(){return new $o(i(this,wt).executor)}get dynamic(){return new Jd}get introspection(){return i(this,wt).dialect.createIntrospector(this.withoutPlugins())}case(r){return new Bl({node:cn.create(Vn(r)?void 0:vr(r))})}get fn(){return Ml()}transaction(){return new $s({...i(this,wt)})}connection(){return new au({...i(this,wt)})}withPlugin(r){return new Tr({...i(this,wt),executor:i(this,wt).executor.withPlugin(r)})}withoutPlugins(){return new Tr({...i(this,wt),executor:i(this,wt).executor.withoutPlugins()})}withSchema(r){return new Tr({...i(this,wt),executor:i(this,wt).executor.withPluginAtFront(new Zi(r))})}withTables(){return new Tr({...i(this,wt)})}async destroy(){await i(this,wt).driver.destroy()}get isTransaction(){return!1}getExecutor(){return i(this,wt).executor}executeQuery(r,n=$e()){const I=tf(r)?r.compile():r;return this.getExecutor().executeQuery(I,n)}};wt=new WeakMap;let Pi=Tr;var en;const Cr=class Cr extends Pi{constructor(r){super(r);B(this,en,void 0);J(this,en,r)}get isTransaction(){return!0}transaction(){throw new Error("calling the transaction method for a Transaction is not supported")}connection(){throw new Error("calling the connection method for a Transaction is not supported")}async destroy(){throw new Error("calling the destroy method for a Transaction is not supported")}withPlugin(r){return new Cr({...i(this,en),executor:i(this,en).executor.withPlugin(r)})}withoutPlugins(){return new Cr({...i(this,en),executor:i(this,en).executor.withoutPlugins()})}withSchema(r){return new Cr({...i(this,en),executor:i(this,en).executor.withPluginAtFront(new Zi(r))})}withTables(){return new Cr({...i(this,en)})}};en=new WeakMap;let Go=Cr;function nf(t){return un(t)&&un(t.config)&&un(t.driver)&&un(t.executor)&&un(t.dialect)}var gr;class au{constructor(e){B(this,gr,void 0);J(this,gr,f(e))}async execute(e){return i(this,gr).executor.provideConnection(async r=>{const n=i(this,gr).executor.withConnectionProvider(new su(r)),I=new Pi({...i(this,gr),executor:n});return await e(I)})}}gr=new WeakMap;Se(au,"don't await ConnectionBuilder instances directly. To execute the query you need to call the `execute` method");var tn;const qa=class qa{constructor(e){B(this,tn,void 0);J(this,tn,f(e))}setIsolationLevel(e){return new qa({...i(this,tn),isolationLevel:e})}async execute(e){const{isolationLevel:r,...n}=i(this,tn),I={isolationLevel:r};return rf(I),i(this,tn).executor.provideConnection(async Q=>{const re=i(this,tn).executor.withConnectionProvider(new su(Q)),Ie=new Go({...n,executor:re});try{await i(this,tn).driver.beginTransaction(Q,I);const ze=await e(Ie);return await i(this,tn).driver.commitTransaction(Q),ze}catch(ze){throw await i(this,tn).driver.rollbackTransaction(Q),ze}})}};tn=new WeakMap;let $s=qa;Se($s,"don't await TransactionBuilder instances directly. To execute the transaction you need to call the `execute` method");function rf(t){if(t.isolationLevel&&!Yd.includes(t.isolationLevel))throw new Error(`invalid transaction isolation level ${t.isolationLevel}`)}var kt,Zr,ps,Vi,Ko,$i,Xo;const Si=class Si{constructor(e){B(this,Zr);B(this,Vi);B(this,$i);B(this,kt,void 0);J(this,kt,f(e))}get expressionType(){}get isRawBuilder(){return!0}as(e){return new lu(this,e)}$castTo(){return new Si({...i(this,kt)})}$notNull(){return new Si(i(this,kt))}withPlugin(e){return new Si({...i(this,kt),plugins:i(this,kt).plugins!==void 0?f([...i(this,kt).plugins,e]):f([e])})}toOperationNode(){return ve(this,Vi,Ko).call(this,ve(this,Zr,ps).call(this))}compile(e){return ve(this,$i,Xo).call(this,ve(this,Zr,ps).call(this,e))}async execute(e){const r=ve(this,Zr,ps).call(this,e);return r.executeQuery(ve(this,$i,Xo).call(this,r),i(this,kt).queryId)}};kt=new WeakMap,Zr=new WeakSet,ps=function(e){const r=e!==void 0?e.getExecutor():qo;return i(this,kt).plugins!==void 0?r.withPlugins(i(this,kt).plugins):r},Vi=new WeakSet,Ko=function(e){return e.transformQuery(i(this,kt).rawNode,i(this,kt).queryId)},$i=new WeakSet,Xo=function(e){return e.compileQuery(ve(this,Vi,Ko).call(this,e),i(this,kt).queryId)};let Hs=Si;function Tn(t){return new Hs(t)}Se(Hs,"don't await RawBuilder instances directly. To execute the query you need to call `execute`");var wr,zn;class lu{constructor(e,r){B(this,wr,void 0);B(this,zn,void 0);J(this,wr,e),J(this,zn,r)}get expression(){return i(this,wr)}get alias(){return i(this,zn)}get rawBuilder(){return i(this,wr)}toOperationNode(){return Yn.create(i(this,wr).toOperationNode(),Ft(i(this,zn))?i(this,zn).toOperationNode():Ye.create(i(this,zn)))}}wr=new WeakMap,zn=new WeakMap;Se(lu,"don't await AliasedRawBuilder instances directly. AliasedRawBuilder should never be executed directly since it's always a part of another query.");const ft=Object.assign((t,...e)=>Tn({queryId:$e(),rawNode:bt.create(t,e?.map(cl)??[])}),{ref(t){return Tn({queryId:$e(),rawNode:bt.createWithChild(kn(t))})},val(t){return Tn({queryId:$e(),rawNode:bt.createWithChild(ut(t))})},value(t){return this.val(t)},table(t){return Tn({queryId:$e(),rawNode:bt.createWithChild(st(t))})},id(...t){const e=new Array(t.length+1).fill(".");return e[0]="",e[e.length-1]="",Tn({queryId:$e(),rawNode:bt.create(e,t.map(Ye.create))})},lit(t){return Tn({queryId:$e(),rawNode:bt.createWithChild(dn.createImmediate(t))})},literal(t){return this.lit(t)},raw(t){return Tn({queryId:$e(),rawNode:bt.createWithSql(t)})},join(t,e=ft`, `){const r=new Array(2*t.length-1),n=e.toOperationNode();for(let I=0;I<t.length;++I)r[2*I]=cl(t[I]),I!==t.length-1&&(r[2*I+1]=n);return Tn({queryId:$e(),rawNode:bt.createWithChildren(r)})}});function cl(t){return Ft(t)?t.toOperationNode():ut(t)}var _o;class sf{constructor(){Re(this,"nodeStack",[]);B(this,_o,f({AliasNode:this.visitAlias.bind(this),ColumnNode:this.visitColumn.bind(this),IdentifierNode:this.visitIdentifier.bind(this),SchemableIdentifierNode:this.visitSchemableIdentifier.bind(this),RawNode:this.visitRaw.bind(this),ReferenceNode:this.visitReference.bind(this),SelectQueryNode:this.visitSelectQuery.bind(this),SelectionNode:this.visitSelection.bind(this),TableNode:this.visitTable.bind(this),FromNode:this.visitFrom.bind(this),SelectAllNode:this.visitSelectAll.bind(this),AndNode:this.visitAnd.bind(this),OrNode:this.visitOr.bind(this),ValueNode:this.visitValue.bind(this),ValueListNode:this.visitValueList.bind(this),PrimitiveValueListNode:this.visitPrimitiveValueList.bind(this),ParensNode:this.visitParens.bind(this),JoinNode:this.visitJoin.bind(this),OperatorNode:this.visitOperator.bind(this),WhereNode:this.visitWhere.bind(this),InsertQueryNode:this.visitInsertQuery.bind(this),DeleteQueryNode:this.visitDeleteQuery.bind(this),ReturningNode:this.visitReturning.bind(this),CreateTableNode:this.visitCreateTable.bind(this),AddColumnNode:this.visitAddColumn.bind(this),ColumnDefinitionNode:this.visitColumnDefinition.bind(this),DropTableNode:this.visitDropTable.bind(this),DataTypeNode:this.visitDataType.bind(this),OrderByNode:this.visitOrderBy.bind(this),OrderByItemNode:this.visitOrderByItem.bind(this),GroupByNode:this.visitGroupBy.bind(this),GroupByItemNode:this.visitGroupByItem.bind(this),UpdateQueryNode:this.visitUpdateQuery.bind(this),ColumnUpdateNode:this.visitColumnUpdate.bind(this),LimitNode:this.visitLimit.bind(this),OffsetNode:this.visitOffset.bind(this),OnConflictNode:this.visitOnConflict.bind(this),OnDuplicateKeyNode:this.visitOnDuplicateKey.bind(this),CreateIndexNode:this.visitCreateIndex.bind(this),DropIndexNode:this.visitDropIndex.bind(this),ListNode:this.visitList.bind(this),PrimaryKeyConstraintNode:this.visitPrimaryKeyConstraint.bind(this),UniqueConstraintNode:this.visitUniqueConstraint.bind(this),ReferencesNode:this.visitReferences.bind(this),CheckConstraintNode:this.visitCheckConstraint.bind(this),WithNode:this.visitWith.bind(this),CommonTableExpressionNode:this.visitCommonTableExpression.bind(this),CommonTableExpressionNameNode:this.visitCommonTableExpressionName.bind(this),HavingNode:this.visitHaving.bind(this),CreateSchemaNode:this.visitCreateSchema.bind(this),DropSchemaNode:this.visitDropSchema.bind(this),AlterTableNode:this.visitAlterTable.bind(this),DropColumnNode:this.visitDropColumn.bind(this),RenameColumnNode:this.visitRenameColumn.bind(this),AlterColumnNode:this.visitAlterColumn.bind(this),ModifyColumnNode:this.visitModifyColumn.bind(this),AddConstraintNode:this.visitAddConstraint.bind(this),DropConstraintNode:this.visitDropConstraint.bind(this),ForeignKeyConstraintNode:this.visitForeignKeyConstraint.bind(this),CreateViewNode:this.visitCreateView.bind(this),DropViewNode:this.visitDropView.bind(this),GeneratedNode:this.visitGenerated.bind(this),DefaultValueNode:this.visitDefaultValue.bind(this),OnNode:this.visitOn.bind(this),ValuesNode:this.visitValues.bind(this),SelectModifierNode:this.visitSelectModifier.bind(this),CreateTypeNode:this.visitCreateType.bind(this),DropTypeNode:this.visitDropType.bind(this),ExplainNode:this.visitExplain.bind(this),DefaultInsertValueNode:this.visitDefaultInsertValue.bind(this),AggregateFunctionNode:this.visitAggregateFunction.bind(this),OverNode:this.visitOver.bind(this),PartitionByNode:this.visitPartitionBy.bind(this),PartitionByItemNode:this.visitPartitionByItem.bind(this),SetOperationNode:this.visitSetOperation.bind(this),BinaryOperationNode:this.visitBinaryOperation.bind(this),UnaryOperationNode:this.visitUnaryOperation.bind(this),UsingNode:this.visitUsing.bind(this),FunctionNode:this.visitFunction.bind(this),CaseNode:this.visitCase.bind(this),WhenNode:this.visitWhen.bind(this),JSONReferenceNode:this.visitJSONReference.bind(this),JSONPathNode:this.visitJSONPath.bind(this),JSONPathLegNode:this.visitJSONPathLeg.bind(this),JSONOperatorChainNode:this.visitJSONOperatorChain.bind(this),TupleNode:this.visitTuple.bind(this),MergeQueryNode:this.visitMergeQuery.bind(this),MatchedNode:this.visitMatched.bind(this),AddIndexNode:this.visitAddIndex.bind(this),CastNode:this.visitCast.bind(this),FetchNode:this.visitFetch.bind(this),TopNode:this.visitTop.bind(this)}));Re(this,"visitNode",e=>{this.nodeStack.push(e),i(this,_o)[e.kind](e),this.nodeStack.pop()})}get parentNode(){return this.nodeStack[this.nodeStack.length-2]}}_o=new WeakMap;var ei,br;class of extends sf{constructor(){super(...arguments);B(this,ei,"");B(this,br,[])}get numParameters(){return i(this,br).length}compileQuery(r){return J(this,ei,""),J(this,br,[]),this.visitNode(r),f({query:r,sql:this.getSql(),parameters:[...i(this,br)]})}getSql(){return i(this,ei)}visitSelectQuery(r){const n=this.parentNode!==void 0&&!ri.is(this.parentNode)&&!Qt.is(this.parentNode)&&!Wt.is(this.parentNode)&&!Cn.is(this.parentNode)&&!Dl.is(this.parentNode);this.parentNode===void 0&&r.explain&&(this.visitNode(r.explain),this.append(" ")),n&&this.append("("),r.with&&(this.visitNode(r.with),this.append(" ")),this.append("select"),r.distinctOn&&(this.append(" "),this.compileDistinctOn(r.distinctOn)),r.frontModifiers?.length&&(this.append(" "),this.compileList(r.frontModifiers," ")),r.top&&(this.append(" "),this.visitNode(r.top)),r.selections&&(this.append(" "),this.compileList(r.selections)),r.from&&(this.append(" "),this.visitNode(r.from)),r.joins&&(this.append(" "),this.compileList(r.joins," ")),r.where&&(this.append(" "),this.visitNode(r.where)),r.groupBy&&(this.append(" "),this.visitNode(r.groupBy)),r.having&&(this.append(" "),this.visitNode(r.having)),r.setOperations&&(this.append(" "),this.compileList(r.setOperations," ")),r.orderBy&&(this.append(" "),this.visitNode(r.orderBy)),r.limit&&(this.append(" "),this.visitNode(r.limit)),r.offset&&(this.append(" "),this.visitNode(r.offset)),r.fetch&&(this.append(" "),this.visitNode(r.fetch)),r.endModifiers?.length&&(this.append(" "),this.compileList(this.sortSelectModifiers([...r.endModifiers])," ")),n&&this.append(")")}visitFrom(r){this.append("from "),this.compileList(r.froms)}visitSelection(r){this.visitNode(r.selection)}visitColumn(r){this.visitNode(r.column)}compileDistinctOn(r){this.append("distinct on ("),this.compileList(r),this.append(")")}compileList(r,n=", "){const I=r.length-1;for(let Q=0;Q<=I;Q++)this.visitNode(r[Q]),Q<I&&this.append(n)}visitWhere(r){this.append("where "),this.visitNode(r.where)}visitHaving(r){this.append("having "),this.visitNode(r.having)}visitInsertQuery(r){const n=this.nodeStack.find(we.is),I=n!==r;!I&&r.explain&&(this.visitNode(r.explain),this.append(" ")),I&&!Ct.is(n)&&this.append("("),r.with&&(this.visitNode(r.with),this.append(" ")),this.append(r.replace?"replace":"insert"),r.ignore&&this.append(" ignore"),r.top&&(this.append(" "),this.visitNode(r.top)),r.into&&(this.append(" into "),this.visitNode(r.into)),r.columns&&(this.append(" ("),this.compileList(r.columns),this.append(")")),r.values&&(this.append(" "),this.visitNode(r.values)),r.defaultValues&&(this.append(" "),this.append("default values")),r.onConflict&&(this.append(" "),this.visitNode(r.onConflict)),r.onDuplicateKey&&(this.append(" "),this.visitNode(r.onDuplicateKey)),r.returning&&(this.append(" "),this.visitNode(r.returning)),I&&!Ct.is(n)&&this.append(")")}visitValues(r){this.append("values "),this.compileList(r.values)}visitDeleteQuery(r){const n=this.nodeStack.find(we.is)!==r;!n&&r.explain&&(this.visitNode(r.explain),this.append(" ")),n&&this.append("("),r.with&&(this.visitNode(r.with),this.append(" ")),this.append("delete "),r.top&&(this.visitNode(r.top),this.append(" ")),this.visitNode(r.from),r.using&&(this.append(" "),this.visitNode(r.using)),r.joins&&(this.append(" "),this.compileList(r.joins," ")),r.where&&(this.append(" "),this.visitNode(r.where)),r.orderBy&&(this.append(" "),this.visitNode(r.orderBy)),r.limit&&(this.append(" "),this.visitNode(r.limit)),r.returning&&(this.append(" "),this.visitNode(r.returning)),n&&this.append(")")}visitReturning(r){this.append("returning "),this.compileList(r.selections)}visitAlias(r){this.visitNode(r.node),this.append(" as "),this.visitNode(r.alias)}visitReference(r){r.table&&(this.visitNode(r.table),this.append(".")),this.visitNode(r.column)}visitSelectAll(r){this.append("*")}visitIdentifier(r){this.append(this.getLeftIdentifierWrapper()),this.compileUnwrappedIdentifier(r),this.append(this.getRightIdentifierWrapper())}compileUnwrappedIdentifier(r){if(!jt(r.name))throw new Error("a non-string identifier was passed to compileUnwrappedIdentifier.");this.append(this.sanitizeIdentifier(r.name))}visitAnd(r){this.visitNode(r.left),this.append(" and "),this.visitNode(r.right)}visitOr(r){this.visitNode(r.left),this.append(" or "),this.visitNode(r.right)}visitValue(r){r.immediate?this.appendImmediateValue(r.value):this.appendValue(r.value)}visitValueList(r){this.append("("),this.compileList(r.values),this.append(")")}visitTuple(r){this.append("("),this.compileList(r.values),this.append(")")}visitPrimitiveValueList(r){this.append("(");const{values:n}=r;for(let I=0;I<n.length;++I)this.appendValue(n[I]),I!==n.length-1&&this.append(", ");this.append(")")}visitParens(r){this.append("("),this.visitNode(r.node),this.append(")")}visitJoin(r){this.append(lf[r.joinType]),this.append(" "),this.visitNode(r.table),r.on&&(this.append(" "),this.visitNode(r.on))}visitOn(r){this.append("on "),this.visitNode(r.on)}visitRaw(r){const{sqlFragments:n,parameters:I}=r;for(let Q=0;Q<n.length;++Q)this.append(n[Q]),I.length>Q&&this.visitNode(I[Q])}visitOperator(r){this.append(r.operator)}visitTable(r){this.visitNode(r.table)}visitSchemableIdentifier(r){r.schema&&(this.visitNode(r.schema),this.append(".")),this.visitNode(r.identifier)}visitCreateTable(r){this.append("create "),r.frontModifiers&&r.frontModifiers.length>0&&(this.compileList(r.frontModifiers," "),this.append(" ")),r.temporary&&this.append("temporary "),this.append("table "),r.ifNotExists&&this.append("if not exists "),this.visitNode(r.table),r.selectQuery?(this.append(" as "),this.visitNode(r.selectQuery)):(this.append(" ("),this.compileList([...r.columns,...r.constraints??[]]),this.append(")"),r.onCommit&&(this.append(" on commit "),this.append(r.onCommit)),r.endModifiers&&r.endModifiers.length>0&&(this.append(" "),this.compileList(r.endModifiers," ")))}visitColumnDefinition(r){this.visitNode(r.column),this.append(" "),this.visitNode(r.dataType),r.unsigned&&this.append(" unsigned"),r.frontModifiers&&r.frontModifiers.length>0&&(this.append(" "),this.compileList(r.frontModifiers," ")),r.generated&&(this.append(" "),this.visitNode(r.generated)),r.identity&&this.append(" identity"),r.defaultTo&&(this.append(" "),this.visitNode(r.defaultTo)),r.notNull&&this.append(" not null"),r.unique&&this.append(" unique"),r.nullsNotDistinct&&this.append(" nulls not distinct"),r.primaryKey&&this.append(" primary key"),r.autoIncrement&&(this.append(" "),this.append(this.getAutoIncrement())),r.references&&(this.append(" "),this.visitNode(r.references)),r.check&&(this.append(" "),this.visitNode(r.check)),r.endModifiers&&r.endModifiers.length>0&&(this.append(" "),this.compileList(r.endModifiers," "))}getAutoIncrement(){return"auto_increment"}visitReferences(r){this.append("references "),this.visitNode(r.table),this.append(" ("),this.compileList(r.columns),this.append(")"),r.onDelete&&(this.append(" on delete "),this.append(r.onDelete)),r.onUpdate&&(this.append(" on update "),this.append(r.onUpdate))}visitDropTable(r){this.append("drop table "),r.ifExists&&this.append("if exists "),this.visitNode(r.table),r.cascade&&this.append(" cascade")}visitDataType(r){this.append(r.dataType)}visitOrderBy(r){this.append("order by "),this.compileList(r.items)}visitOrderByItem(r){this.visitNode(r.orderBy),r.direction&&(this.append(" "),this.visitNode(r.direction))}visitGroupBy(r){this.append("group by "),this.compileList(r.items)}visitGroupByItem(r){this.visitNode(r.groupBy)}visitUpdateQuery(r){const n=this.nodeStack.find(we.is),I=n!==r;!I&&r.explain&&(this.visitNode(r.explain),this.append(" ")),I&&!Ct.is(n)&&this.append("("),r.with&&(this.visitNode(r.with),this.append(" ")),this.append("update "),r.top&&(this.visitNode(r.top),this.append(" ")),r.table&&(this.visitNode(r.table),this.append(" ")),this.append("set "),r.updates&&this.compileList(r.updates),r.from&&(this.append(" "),this.visitNode(r.from)),r.joins&&(this.append(" "),this.compileList(r.joins," ")),r.where&&(this.append(" "),this.visitNode(r.where)),r.limit&&(this.append(" "),this.visitNode(r.limit)),r.returning&&(this.append(" "),this.visitNode(r.returning)),I&&!Ct.is(n)&&this.append(")")}visitColumnUpdate(r){this.visitNode(r.column),this.append(" = "),this.visitNode(r.value)}visitLimit(r){this.append("limit "),this.visitNode(r.limit)}visitOffset(r){this.append("offset "),this.visitNode(r.offset)}visitOnConflict(r){this.append("on conflict"),r.columns?(this.append(" ("),this.compileList(r.columns),this.append(")")):r.constraint?(this.append(" on constraint "),this.visitNode(r.constraint)):r.indexExpression&&(this.append(" ("),this.visitNode(r.indexExpression),this.append(")")),r.indexWhere&&(this.append(" "),this.visitNode(r.indexWhere)),r.doNothing===!0?this.append(" do nothing"):r.updates&&(this.append(" do update set "),this.compileList(r.updates),r.updateWhere&&(this.append(" "),this.visitNode(r.updateWhere)))}visitOnDuplicateKey(r){this.append("on duplicate key update "),this.compileList(r.updates)}visitCreateIndex(r){this.append("create "),r.unique&&this.append("unique "),this.append("index "),r.ifNotExists&&this.append("if not exists "),this.visitNode(r.name),r.table&&(this.append(" on "),this.visitNode(r.table)),r.using&&(this.append(" using "),this.visitNode(r.using)),r.columns&&(this.append(" ("),this.compileList(r.columns),this.append(")")),r.nullsNotDistinct&&this.append(" nulls not distinct"),r.where&&(this.append(" "),this.visitNode(r.where))}visitDropIndex(r){this.append("drop index "),r.ifExists&&this.append("if exists "),this.visitNode(r.name),r.table&&(this.append(" on "),this.visitNode(r.table)),r.cascade&&this.append(" cascade")}visitCreateSchema(r){this.append("create schema "),r.ifNotExists&&this.append("if not exists "),this.visitNode(r.schema)}visitDropSchema(r){this.append("drop schema "),r.ifExists&&this.append("if exists "),this.visitNode(r.schema),r.cascade&&this.append(" cascade")}visitPrimaryKeyConstraint(r){r.name&&(this.append("constraint "),this.visitNode(r.name),this.append(" ")),this.append("primary key ("),this.compileList(r.columns),this.append(")")}visitUniqueConstraint(r){r.name&&(this.append("constraint "),this.visitNode(r.name),this.append(" ")),this.append("unique"),r.nullsNotDistinct&&this.append(" nulls not distinct"),this.append(" ("),this.compileList(r.columns),this.append(")")}visitCheckConstraint(r){r.name&&(this.append("constraint "),this.visitNode(r.name),this.append(" ")),this.append("check ("),this.visitNode(r.expression),this.append(")")}visitForeignKeyConstraint(r){r.name&&(this.append("constraint "),this.visitNode(r.name),this.append(" ")),this.append("foreign key ("),this.compileList(r.columns),this.append(") "),this.visitNode(r.references),r.onDelete&&(this.append(" on delete "),this.append(r.onDelete)),r.onUpdate&&(this.append(" on update "),this.append(r.onUpdate))}visitList(r){this.compileList(r.items)}visitWith(r){this.append("with "),r.recursive&&this.append("recursive "),this.compileList(r.expressions)}visitCommonTableExpression(r){this.visitNode(r.name),this.append(" as "),_s(r.materialized)&&(r.materialized||this.append("not "),this.append("materialized ")),this.visitNode(r.expression)}visitCommonTableExpressionName(r){this.visitNode(r.table),r.columns&&(this.append("("),this.compileList(r.columns),this.append(")"))}visitAlterTable(r){this.append("alter table "),this.visitNode(r.table),this.append(" "),r.renameTo&&(this.append("rename to "),this.visitNode(r.renameTo)),r.setSchema&&(this.append("set schema "),this.visitNode(r.setSchema)),r.addConstraint&&this.visitNode(r.addConstraint),r.dropConstraint&&this.visitNode(r.dropConstraint),r.columnAlterations&&this.compileColumnAlterations(r.columnAlterations),r.addIndex&&this.visitNode(r.addIndex),r.dropIndex&&this.visitNode(r.dropIndex)}visitAddColumn(r){this.append("add column "),this.visitNode(r.column)}visitRenameColumn(r){this.append("rename column "),this.visitNode(r.column),this.append(" to "),this.visitNode(r.renameTo)}visitDropColumn(r){this.append("drop column "),this.visitNode(r.column)}visitAlterColumn(r){this.append("alter column "),this.visitNode(r.column),this.append(" "),r.dataType&&(this.announcesNewColumnDataType()&&this.append("type "),this.visitNode(r.dataType),r.dataTypeExpression&&(this.append("using "),this.visitNode(r.dataTypeExpression))),r.setDefault&&(this.append("set default "),this.visitNode(r.setDefault)),r.dropDefault&&this.append("drop default"),r.setNotNull&&this.append("set not null"),r.dropNotNull&&this.append("drop not null")}visitModifyColumn(r){this.append("modify column "),this.visitNode(r.column)}visitAddConstraint(r){this.append("add "),this.visitNode(r.constraint)}visitDropConstraint(r){this.append("drop constraint "),r.ifExists&&this.append("if exists "),this.visitNode(r.constraintName),r.modifier==="cascade"?this.append(" cascade"):r.modifier==="restrict"&&this.append(" restrict")}visitSetOperation(r){this.append(r.operator),this.append(" "),r.all&&this.append("all "),this.visitNode(r.expression)}visitCreateView(r){this.append("create "),r.orReplace&&this.append("or replace "),r.materialized&&this.append("materialized "),r.temporary&&this.append("temporary "),this.append("view "),r.ifNotExists&&this.append("if not exists "),this.visitNode(r.name),this.append(" "),r.columns&&(this.append("("),this.compileList(r.columns),this.append(") ")),r.as&&(this.append("as "),this.visitNode(r.as))}visitDropView(r){this.append("drop "),r.materialized&&this.append("materialized "),this.append("view "),r.ifExists&&this.append("if exists "),this.visitNode(r.name),r.cascade&&this.append(" cascade")}visitGenerated(r){this.append("generated "),r.always&&this.append("always "),r.byDefault&&this.append("by default "),this.append("as "),r.identity&&this.append("identity"),r.expression&&(this.append("("),this.visitNode(r.expression),this.append(")")),r.stored&&this.append(" stored")}visitDefaultValue(r){this.append("default "),this.visitNode(r.defaultValue)}visitSelectModifier(r){r.rawModifier?this.visitNode(r.rawModifier):this.append(af[r.modifier]),r.of&&(this.append(" of "),this.compileList(r.of,", "))}visitCreateType(r){this.append("create type "),this.visitNode(r.name),r.enum&&(this.append(" as enum "),this.visitNode(r.enum))}visitDropType(r){this.append("drop type "),r.ifExists&&this.append("if exists "),this.visitNode(r.name)}visitExplain(r){this.append("explain"),(r.options||r.format)&&(this.append(" "),this.append(this.getLeftExplainOptionsWrapper()),r.options&&(this.visitNode(r.options),r.format&&this.append(this.getExplainOptionsDelimiter())),r.format&&(this.append("format"),this.append(this.getExplainOptionAssignment()),this.append(r.format)),this.append(this.getRightExplainOptionsWrapper()))}visitDefaultInsertValue(r){this.append("default")}visitAggregateFunction(r){this.append(r.func),this.append("("),r.distinct&&this.append("distinct "),this.compileList(r.aggregated),this.append(")"),r.filter&&(this.append(" filter("),this.visitNode(r.filter),this.append(")")),r.over&&(this.append(" "),this.visitNode(r.over))}visitOver(r){this.append("over("),r.partitionBy&&(this.visitNode(r.partitionBy),r.orderBy&&this.append(" ")),r.orderBy&&this.visitNode(r.orderBy),this.append(")")}visitPartitionBy(r){this.append("partition by "),this.compileList(r.items)}visitPartitionByItem(r){this.visitNode(r.partitionBy)}visitBinaryOperation(r){this.visitNode(r.leftOperand),this.append(" "),this.visitNode(r.operator),this.append(" "),this.visitNode(r.rightOperand)}visitUnaryOperation(r){this.visitNode(r.operator),this.isMinusOperator(r.operator)||this.append(" "),this.visitNode(r.operand)}isMinusOperator(r){return Kn.is(r)&&r.operator==="-"}visitUsing(r){this.append("using "),this.compileList(r.tables)}visitFunction(r){this.append(r.func),this.append("("),this.compileList(r.arguments),this.append(")")}visitCase(r){this.append("case"),r.value&&(this.append(" "),this.visitNode(r.value)),r.when&&(this.append(" "),this.compileList(r.when," ")),r.else&&(this.append(" else "),this.visitNode(r.else)),this.append(" end"),r.isStatement&&this.append(" case")}visitWhen(r){this.append("when "),this.visitNode(r.condition),r.result&&(this.append(" then "),this.visitNode(r.result))}visitJSONReference(r){this.visitNode(r.reference),this.visitNode(r.traversal)}visitJSONPath(r){r.inOperator&&this.visitNode(r.inOperator),this.append("'$");for(const n of r.pathLegs)this.visitNode(n);this.append("'")}visitJSONPathLeg(r){const n=r.type==="ArrayLocation";this.append(n?"[":"."),this.append(String(r.value)),n&&this.append("]")}visitJSONOperatorChain(r){for(let n=0,I=r.values.length;n<I;n++)n===I-1?this.visitNode(r.operator):this.append("->"),this.visitNode(r.values[n])}visitMergeQuery(r){r.with&&(this.visitNode(r.with),this.append(" ")),this.append("merge "),r.top&&(this.visitNode(r.top),this.append(" ")),this.append("into "),this.visitNode(r.into),r.using&&(this.append(" "),this.visitNode(r.using)),r.whens&&(this.append(" "),this.compileList(r.whens))}visitMatched(r){r.not&&this.append("not "),this.append("matched"),r.bySource&&this.append(" by source")}visitAddIndex(r){this.append("add "),r.unique&&this.append("unique "),this.append("index "),this.visitNode(r.name),r.columns&&(this.append(" ("),this.compileList(r.columns),this.append(")")),r.using&&(this.append(" using "),this.visitNode(r.using))}visitCast(r){this.append("cast("),this.visitNode(r.expression),this.append(" as "),this.visitNode(r.dataType),this.append(")")}visitFetch(r){this.append("fetch next "),this.visitNode(r.rowCount),this.append(` rows ${r.modifier}`)}visitTop(r){this.append(`top(${r.expression})`),r.modifiers&&this.append(` ${r.modifiers}`)}append(r){J(this,ei,i(this,ei)+r)}appendValue(r){this.addParameter(r),this.append(this.getCurrentParameterPlaceholder())}getLeftIdentifierWrapper(){return'"'}getRightIdentifierWrapper(){return'"'}getCurrentParameterPlaceholder(){return"$"+this.numParameters}getLeftExplainOptionsWrapper(){return"("}getExplainOptionAssignment(){return" "}getExplainOptionsDelimiter(){return", "}getRightExplainOptionsWrapper(){return")"}sanitizeIdentifier(r){const n=this.getLeftIdentifierWrapper(),I=this.getRightIdentifierWrapper();let Q="";for(const re of r)Q+=re,re===n?Q+=n:re===I&&(Q+=I);return Q}addParameter(r){i(this,br).push(r)}appendImmediateValue(r){if(jt(r))this.append(`'${r}'`);else if(go(r)||_s(r))this.append(r.toString());else if(Zo(r))this.append("null");else if(Oc(r))this.appendImmediateValue(r.toISOString());else if(ea(r))this.appendImmediateValue(r.toString());else throw new Error(`invalid immediate value ${r}`)}sortSelectModifiers(r){return r.sort((n,I)=>n.modifier&&I.modifier?dl[n.modifier]-dl[I.modifier]:1),f(r)}compileColumnAlterations(r){this.compileList(r)}announcesNewColumnDataType(){return!0}}ei=new WeakMap,br=new WeakMap;const af=f({ForKeyShare:"for key share",ForNoKeyUpdate:"for no key update",ForUpdate:"for update",ForShare:"for share",NoWait:"nowait",SkipLocked:"skip locked",Distinct:"distinct"}),dl=f({ForKeyShare:1,ForNoKeyUpdate:1,ForUpdate:1,ForShare:1,NoWait:2,SkipLocked:2,Distinct:0}),lf=f({InnerJoin:"inner join",LeftJoin:"left join",RightJoin:"right join",FullJoin:"full join",LateralInnerJoin:"inner join lateral",LateralLeftJoin:"left join lateral",Using:"using"}),qr=f({raw(t,e=[]){return f({sql:t,query:bt.createWithSql(t),parameters:f(e)})}});class uf{get supportsCreateIfNotExists(){return!0}get supportsTransactionalDdl(){return!1}get supportsReturning(){return!1}}const cf=/"/g;class df extends of{getCurrentParameterPlaceholder(){return"?"}getLeftExplainOptionsWrapper(){return""}getRightExplainOptionsWrapper(){return""}getLeftIdentifierWrapper(){return'"'}getRightIdentifierWrapper(){return'"'}getAutoIncrement(){return"autoincrement"}sanitizeIdentifier(e){return e.replace(cf,'""')}visitDefaultInsertValue(e){this.append("null")}}const uu="kysely_migration",cu="kysely_migration_lock";f({__noMigrations__:!0});var ti,yo,du;class ff{constructor(e){B(this,yo);B(this,ti,void 0);J(this,ti,e)}async getSchemas(){return[]}async getTables(e={withInternalKyselyTables:!1}){let r=i(this,ti).selectFrom("sqlite_master").where("type","in",["table","view"]).where("name","not like","sqlite_%").select("name").orderBy("name").$castTo();e.withInternalKyselyTables||(r=r.where("name","!=",uu).where("name","!=",cu));const n=await r.execute();return Promise.all(n.map(({name:I})=>ve(this,yo,du).call(this,I)))}async getMetadata(e){return{tables:await this.getTables(e)}}}ti=new WeakMap,yo=new WeakSet,du=async function(e){const r=i(this,ti),n=await r.selectFrom("sqlite_master").where("name","=",e).select(["sql","type"]).$castTo().executeTakeFirstOrThrow(),I=n.sql?.split(/[\(\),]/)?.find(re=>re.toLowerCase().includes("autoincrement"))?.trimStart()?.split(/\s+/)?.[0]?.replace(/["`]/g,""),Q=await r.selectFrom(ft`pragma_table_info(${e})`.as("table_info")).select(["name","type","notnull","dflt_value"]).orderBy("cid").execute();return{name:e,isView:n.type==="view",columns:Q.map(re=>({name:re.name,dataType:re.type,isNullable:!re.notnull,isAutoIncrementing:re.name===I,hasDefaultValue:re.dflt_value!=null,comment:void 0}))}};class hf extends uf{get supportsTransactionalDdl(){return!1}get supportsReturning(){return!0}async acquireMigrationLock(e,r){}async releaseMigrationLock(e,r){}}var pf=class{createQueryCompiler(){return new df}createAdapter(){return new hf}createIntrospector(t){return new ff(t)}},Hi,ml,mf=(ml=class{constructor(){B(this,Hi,new _f);Re(this,"connection")}async acquireConnection(){return await i(this,Hi).lock(),this.connection}async beginTransaction(t){await t.executeQuery(qr.raw("begin"))}async commitTransaction(t){await t.executeQuery(qr.raw("commit"))}async rollbackTransaction(t){await t.executeQuery(qr.raw("rollback"))}async releaseConnection(){i(this,Hi).unlock()}},Hi=new WeakMap,ml),_f=class{constructor(){Re(this,"promise");Re(this,"resolve")}async lock(){for(;this.promise;)await this.promise;this.promise=new Promise(t=>{this.resolve=t})}unlock(){const t=this.resolve;this.promise=void 0,this.resolve=void 0,t?.()}},yf=class{streamQuery(){throw new Error("sqlite-wasm driver doesn't support streaming")}async executeQuery({parameters:t,query:e,sql:r}){const n=await this.query(r,t);return Oe.is(e)||n.length?{rows:n}:{rows:n,...await this.info()}}},gf=class extends mf{constructor(e){super();Re(this,"config");Re(this,"db");this.config=e}async init(){this.db=typeof this.config.database=="function"?await this.config.database():this.config.database,this.connection=new wf(this.db),await this.config.onCreateConnection?.(this.connection)}async destroy(){this.db?.close()}},wf=class extends yf{constructor(e){super();Re(this,"db");this.db=e}async query(e,r){return this.db.selectObjects(e,r)}async info(){return{insertId:BigInt(this.db.selectArray("SELECT last_insert_rowid()")[0]),numAffectedRows:BigInt(this.db.changes(!1,!0))}}},Ji,_l,bf=(_l=class extends pf{constructor(e){super();B(this,Ji,void 0);J(this,Ji,e)}createDriver(){return new gf(i(this,Ji))}},Ji=new WeakMap,_l),ma=(()=>{var t=import.meta.url;return function(e){var r=e||{},n=typeof r<"u"?r:{},I,Q;n.ready=new Promise(function(o,s){I=o,Q=s});const re=globalThis.sqlite3InitModuleState||Object.assign(Object.create(null),{debugModule:()=>{}});delete globalThis.sqlite3InitModuleState,re.debugModule("globalThis.location =",globalThis.location);const Ie="emscripten-bug-17951";n[Ie]=function o(s,l){s.env.foo=function(){};const a=n.locateFile(o.uri,typeof Te>"u"?"":Te);re.debugModule("instantiateWasm() uri =",a);const u=()=>fetch(a,{credentials:"same-origin"});return(WebAssembly.instantiateStreaming?async()=>WebAssembly.instantiateStreaming(u(),s).then(q=>l(q.instance,q.module)):async()=>u().then(q=>q.arrayBuffer()).then(q=>WebAssembly.instantiate(q,s)).then(q=>l(q.instance,q.module)))(),{}},n[Ie].uri="sqlite3.wasm";var ze=Object.assign({},n),He="./this.program",ie=typeof window=="object",be=typeof importScripts=="function";typeof process=="object"&&typeof process.versions=="object"&&process.versions.node;var Te="";function Vt(o){return n.locateFile?n.locateFile(o,Te):Te+o}var Ot,ht,An;(ie||be)&&(be?Te=self.location.href:typeof document<"u"&&document.currentScript&&(Te=document.currentScript.src),t&&(Te=t),Te.indexOf("blob:")!==0?Te=Te.substr(0,Te.replace(/[?#].*/,"").lastIndexOf("/")+1):Te="",Ot=o=>{var s=new XMLHttpRequest;return s.open("GET",o,!1),s.send(null),s.responseText},be&&(An=o=>{var s=new XMLHttpRequest;return s.open("GET",o,!1),s.responseType="arraybuffer",s.send(null),new Uint8Array(s.response)}),ht=(o,s,l)=>{var a=new XMLHttpRequest;a.open("GET",o,!0),a.responseType="arraybuffer",a.onload=()=>{if(a.status==200||a.status==0&&a.response){s(a.response);return}l()},a.onerror=l,a.send(null)});var Le=n.print||console.log.bind(console),Ce=n.printErr||console.warn.bind(console);Object.assign(n,ze),ze=null,n.arguments&&n.arguments,n.thisProgram&&(He=n.thisProgram),n.quit&&n.quit;var $t;n.wasmBinary&&($t=n.wasmBinary),n.noExitRuntime,typeof WebAssembly!="object"&&Sr("no native wasm support detected");var vt,ts=!1;function No(o,s){o||Sr(s)}var On=typeof TextDecoder<"u"?new TextDecoder("utf8"):void 0;function nn(o,s,l){for(var a=s+l,u=s;o[u]&&!(u>=a);)++u;if(u-s>16&&o.buffer&&On)return On.decode(o.subarray(s,u));for(var d="";s<u;){var q=o[s++];if(!(q&128)){d+=String.fromCharCode(q);continue}var k=o[s++]&63;if((q&224)==192){d+=String.fromCharCode((q&31)<<6|k);continue}var D=o[s++]&63;if((q&240)==224?q=(q&15)<<12|k<<6|D:q=(q&7)<<18|k<<12|D<<6|o[s++]&63,q<65536)d+=String.fromCharCode(q);else{var G=q-65536;d+=String.fromCharCode(55296|G>>10,56320|G&1023)}}return d}function vo(o,s){return o?nn(Er,o,s):""}function xr(o,s,l,a){if(!(a>0))return 0;for(var u=l,d=l+a-1,q=0;q<o.length;++q){var k=o.charCodeAt(q);if(k>=55296&&k<=57343){var D=o.charCodeAt(++q);k=65536+((k&1023)<<10)|D&1023}if(k<=127){if(l>=d)break;s[l++]=k}else if(k<=2047){if(l+1>=d)break;s[l++]=192|k>>6,s[l++]=128|k&63}else if(k<=65535){if(l+2>=d)break;s[l++]=224|k>>12,s[l++]=128|k>>6&63,s[l++]=128|k&63}else{if(l+3>=d)break;s[l++]=240|k>>18,s[l++]=128|k>>12&63,s[l++]=128|k>>6&63,s[l++]=128|k&63}}return s[l]=0,l-u}function Na(o,s,l){return xr(o,Er,s,l)}function ui(o){for(var s=0,l=0;l<o.length;++l){var a=o.charCodeAt(l);a<=127?s++:a<=2047?s+=2:a>=55296&&a<=57343?(s+=4,++l):s+=3}return s}var Pt,Er,va,ke,nt;function xa(){var o=vt.buffer;n.HEAP8=Pt=new Int8Array(o),n.HEAP16=va=new Int16Array(o),n.HEAP32=ke=new Int32Array(o),n.HEAPU8=Er=new Uint8Array(o),n.HEAPU16=new Uint16Array(o),n.HEAPU32=nt=new Uint32Array(o),n.HEAPF32=new Float32Array(o),n.HEAPF64=new Float64Array(o),n.HEAP64=new BigInt64Array(o),n.HEAPU64=new BigUint64Array(o)}var Ea=n.INITIAL_MEMORY||16777216;n.wasmMemory?vt=n.wasmMemory:vt=new WebAssembly.Memory({initial:Ea/65536,maximum:2147483648/65536}),xa(),Ea=vt.buffer.byteLength;var Sa=[],Ia=[],ka=[];function wu(){if(n.preRun)for(typeof n.preRun=="function"&&(n.preRun=[n.preRun]);n.preRun.length;)Nu(n.preRun.shift());Eo(Sa)}function bu(){!n.noFSInit&&!c.init.initialized&&c.init(),c.ignorePermissions=!1,Eo(Ia)}function qu(){if(n.postRun)for(typeof n.postRun=="function"&&(n.postRun=[n.postRun]);n.postRun.length;)xu(n.postRun.shift());Eo(ka)}function Nu(o){Sa.unshift(o)}function vu(o){Ia.unshift(o)}function xu(o){ka.unshift(o)}var Zn=0,ci=null;function Hf(o){return o}function xo(o){Zn++,n.monitorRunDependencies&&n.monitorRunDependencies(Zn)}function ns(o){if(Zn--,n.monitorRunDependencies&&n.monitorRunDependencies(Zn),Zn==0&&ci){var s=ci;ci=null,s()}}function Sr(o){n.onAbort&&n.onAbort(o),o="Aborted("+o+")",Ce(o),ts=!0,o+=". Build with -sASSERTIONS for more info.";var s=new WebAssembly.RuntimeError(o);throw Q(s),s}var Eu="data:application/octet-stream;base64,";function Aa(o){return o.startsWith(Eu)}var Ht;n.locateFile?(Ht="sqlite3.wasm",Aa(Ht)||(Ht=Vt(Ht))):Ht=new URL(""+new URL("sqlite3-Dz8YHigf.wasm",import.meta.url).href,import.meta.url).href;function Oa(o){try{if(o==Ht&&$t)return new Uint8Array($t);if(An)return An(o);throw"both async and sync fetching of the wasm failed"}catch(s){Sr(s)}}function Su(){return!$t&&(ie||be)&&typeof fetch=="function"?fetch(Ht,{credentials:"same-origin"}).then(function(o){if(!o.ok)throw"failed to load wasm binary file at '"+Ht+"'";return o.arrayBuffer()}).catch(function(){return Oa(Ht)}):Promise.resolve().then(function(){return Oa(Ht)})}function Iu(){var o={env:La,wasi_snapshot_preview1:La};function s(q,k){var D=q.exports;n.asm=D,n.asm.__indirect_function_table,vu(n.asm.__wasm_call_ctors),ns()}xo();function l(q){s(q.instance)}function a(q){return Su().then(function(k){return WebAssembly.instantiate(k,o)}).then(function(k){return k}).then(q,function(k){Ce("failed to asynchronously prepare wasm: "+k),Sr(k)})}function u(){return!$t&&typeof WebAssembly.instantiateStreaming=="function"&&!Aa(Ht)&&typeof fetch=="function"?fetch(Ht,{credentials:"same-origin"}).then(function(q){var k=WebAssembly.instantiateStreaming(q,o);return k.then(l,function(D){return Ce("wasm streaming compile failed: "+D),Ce("falling back to ArrayBuffer instantiation"),a(l)})}):a(l)}if(n.instantiateWasm)try{var d=n.instantiateWasm(o,s);return d}catch(q){Ce("Module.instantiateWasm callback failed with error: "+q),Q(q)}return u().catch(Q),{}}var Ae,pt;function Eo(o){for(;o.length>0;)o.shift()(n)}var De={isAbs:o=>o.charAt(0)==="/",splitPath:o=>{var s=/^(\/?|)([\s\S]*?)((?:\.{1,2}|[^\/]+?|)(\.[^.\/]*|))(?:[\/]*)$/;return s.exec(o).slice(1)},normalizeArray:(o,s)=>{for(var l=0,a=o.length-1;a>=0;a--){var u=o[a];u==="."?o.splice(a,1):u===".."?(o.splice(a,1),l++):l&&(o.splice(a,1),l--)}if(s)for(;l;l--)o.unshift("..");return o},normalize:o=>{var s=De.isAbs(o),l=o.substr(-1)==="/";return o=De.normalizeArray(o.split("/").filter(a=>!!a),!s).join("/"),!o&&!s&&(o="."),o&&l&&(o+="/"),(s?"/":"")+o},dirname:o=>{var s=De.splitPath(o),l=s[0],a=s[1];return!l&&!a?".":(a&&(a=a.substr(0,a.length-1)),l+a)},basename:o=>{if(o==="/")return"/";o=De.normalize(o),o=o.replace(/\/$/,"");var s=o.lastIndexOf("/");return s===-1?o:o.substr(s+1)},join:function(){var o=Array.prototype.slice.call(arguments);return De.normalize(o.join("/"))},join2:(o,s)=>De.normalize(o+"/"+s)};function ku(){if(typeof crypto=="object"&&typeof crypto.getRandomValues=="function"){var o=new Uint8Array(1);return()=>(crypto.getRandomValues(o),o[0])}else return()=>Sr("randomDevice")}var hn={resolve:function(){for(var o="",s=!1,l=arguments.length-1;l>=-1&&!s;l--){var a=l>=0?arguments[l]:c.cwd();if(typeof a!="string")throw new TypeError("Arguments to path.resolve must be strings");if(!a)return"";o=a+"/"+o,s=De.isAbs(a)}return o=De.normalizeArray(o.split("/").filter(u=>!!u),!s).join("/"),(s?"/":"")+o||"."},relative:(o,s)=>{o=hn.resolve(o).substr(1),s=hn.resolve(s).substr(1);function l(G){for(var ee=0;ee<G.length&&G[ee]==="";ee++);for(var se=G.length-1;se>=0&&G[se]==="";se--);return ee>se?[]:G.slice(ee,se-ee+1)}for(var a=l(o.split("/")),u=l(s.split("/")),d=Math.min(a.length,u.length),q=d,k=0;k<d;k++)if(a[k]!==u[k]){q=k;break}for(var D=[],k=q;k<a.length;k++)D.push("..");return D=D.concat(u.slice(q)),D.join("/")}};function So(o,s,l){var a=l>0?l:ui(o)+1,u=new Array(a),d=xr(o,u,0,u.length);return s&&(u.length=d),u}var er={ttys:[],init:function(){},shutdown:function(){},register:function(o,s){er.ttys[o]={input:[],output:[],ops:s},c.registerDevice(o,er.stream_ops)},stream_ops:{open:function(o){var s=er.ttys[o.node.rdev];if(!s)throw new c.ErrnoError(43);o.tty=s,o.seekable=!1},close:function(o){o.tty.ops.fsync(o.tty)},fsync:function(o){o.tty.ops.fsync(o.tty)},read:function(o,s,l,a,u){if(!o.tty||!o.tty.ops.get_char)throw new c.ErrnoError(60);for(var d=0,q=0;q<a;q++){var k;try{k=o.tty.ops.get_char(o.tty)}catch{throw new c.ErrnoError(29)}if(k===void 0&&d===0)throw new c.ErrnoError(6);if(k==null)break;d++,s[l+q]=k}return d&&(o.node.timestamp=Date.now()),d},write:function(o,s,l,a,u){if(!o.tty||!o.tty.ops.put_char)throw new c.ErrnoError(60);try{for(var d=0;d<a;d++)o.tty.ops.put_char(o.tty,s[l+d])}catch{throw new c.ErrnoError(29)}return a&&(o.node.timestamp=Date.now()),d}},default_tty_ops:{get_char:function(o){if(!o.input.length){var s=null;if(typeof window<"u"&&typeof window.prompt=="function"?(s=window.prompt("Input: "),s!==null&&(s+=`
`)):typeof readline=="function"&&(s=readline(),s!==null&&(s+=`
`)),!s)return null;o.input=So(s,!0)}return o.input.shift()},put_char:function(o,s){s===null||s===10?(Le(nn(o.output,0)),o.output=[]):s!=0&&o.output.push(s)},fsync:function(o){o.output&&o.output.length>0&&(Le(nn(o.output,0)),o.output=[])}},default_tty1_ops:{put_char:function(o,s){s===null||s===10?(Ce(nn(o.output,0)),o.output=[]):s!=0&&o.output.push(s)},fsync:function(o){o.output&&o.output.length>0&&(Ce(nn(o.output,0)),o.output=[])}}};function Au(o,s){return Er.fill(0,o,o+s),o}function Ou(o,s){return Math.ceil(o/s)*s}function Ta(o){o=Ou(o,65536);var s=Ma(65536,o);return s?Au(s,o):0}var xe={ops_table:null,mount:function(o){return xe.createNode(null,"/",16895,0)},createNode:function(o,s,l,a){if(c.isBlkdev(l)||c.isFIFO(l))throw new c.ErrnoError(63);xe.ops_table||(xe.ops_table={dir:{node:{getattr:xe.node_ops.getattr,setattr:xe.node_ops.setattr,lookup:xe.node_ops.lookup,mknod:xe.node_ops.mknod,rename:xe.node_ops.rename,unlink:xe.node_ops.unlink,rmdir:xe.node_ops.rmdir,readdir:xe.node_ops.readdir,symlink:xe.node_ops.symlink},stream:{llseek:xe.stream_ops.llseek}},file:{node:{getattr:xe.node_ops.getattr,setattr:xe.node_ops.setattr},stream:{llseek:xe.stream_ops.llseek,read:xe.stream_ops.read,write:xe.stream_ops.write,allocate:xe.stream_ops.allocate,mmap:xe.stream_ops.mmap,msync:xe.stream_ops.msync}},link:{node:{getattr:xe.node_ops.getattr,setattr:xe.node_ops.setattr,readlink:xe.node_ops.readlink},stream:{}},chrdev:{node:{getattr:xe.node_ops.getattr,setattr:xe.node_ops.setattr},stream:c.chrdev_stream_ops}});var u=c.createNode(o,s,l,a);return c.isDir(u.mode)?(u.node_ops=xe.ops_table.dir.node,u.stream_ops=xe.ops_table.dir.stream,u.contents={}):c.isFile(u.mode)?(u.node_ops=xe.ops_table.file.node,u.stream_ops=xe.ops_table.file.stream,u.usedBytes=0,u.contents=null):c.isLink(u.mode)?(u.node_ops=xe.ops_table.link.node,u.stream_ops=xe.ops_table.link.stream):c.isChrdev(u.mode)&&(u.node_ops=xe.ops_table.chrdev.node,u.stream_ops=xe.ops_table.chrdev.stream),u.timestamp=Date.now(),o&&(o.contents[s]=u,o.timestamp=u.timestamp),u},getFileDataAsTypedArray:function(o){return o.contents?o.contents.subarray?o.contents.subarray(0,o.usedBytes):new Uint8Array(o.contents):new Uint8Array(0)},expandFileStorage:function(o,s){var l=o.contents?o.contents.length:0;if(!(l>=s)){var a=1024*1024;s=Math.max(s,l*(l<a?2:1.125)>>>0),l!=0&&(s=Math.max(s,256));var u=o.contents;o.contents=new Uint8Array(s),o.usedBytes>0&&o.contents.set(u.subarray(0,o.usedBytes),0)}},resizeFileStorage:function(o,s){if(o.usedBytes!=s)if(s==0)o.contents=null,o.usedBytes=0;else{var l=o.contents;o.contents=new Uint8Array(s),l&&o.contents.set(l.subarray(0,Math.min(s,o.usedBytes))),o.usedBytes=s}},node_ops:{getattr:function(o){var s={};return s.dev=c.isChrdev(o.mode)?o.id:1,s.ino=o.id,s.mode=o.mode,s.nlink=1,s.uid=0,s.gid=0,s.rdev=o.rdev,c.isDir(o.mode)?s.size=4096:c.isFile(o.mode)?s.size=o.usedBytes:c.isLink(o.mode)?s.size=o.link.length:s.size=0,s.atime=new Date(o.timestamp),s.mtime=new Date(o.timestamp),s.ctime=new Date(o.timestamp),s.blksize=4096,s.blocks=Math.ceil(s.size/s.blksize),s},setattr:function(o,s){s.mode!==void 0&&(o.mode=s.mode),s.timestamp!==void 0&&(o.timestamp=s.timestamp),s.size!==void 0&&xe.resizeFileStorage(o,s.size)},lookup:function(o,s){throw c.genericErrors[44]},mknod:function(o,s,l,a){return xe.createNode(o,s,l,a)},rename:function(o,s,l){if(c.isDir(o.mode)){var a;try{a=c.lookupNode(s,l)}catch{}if(a)for(var u in a.contents)throw new c.ErrnoError(55)}delete o.parent.contents[o.name],o.parent.timestamp=Date.now(),o.name=l,s.contents[l]=o,s.timestamp=o.parent.timestamp,o.parent=s},unlink:function(o,s){delete o.contents[s],o.timestamp=Date.now()},rmdir:function(o,s){var l=c.lookupNode(o,s);for(var a in l.contents)throw new c.ErrnoError(55);delete o.contents[s],o.timestamp=Date.now()},readdir:function(o){var s=[".",".."];for(var l in o.contents)o.contents.hasOwnProperty(l)&&s.push(l);return s},symlink:function(o,s,l){var a=xe.createNode(o,s,41471,0);return a.link=l,a},readlink:function(o){if(!c.isLink(o.mode))throw new c.ErrnoError(28);return o.link}},stream_ops:{read:function(o,s,l,a,u){var d=o.node.contents;if(u>=o.node.usedBytes)return 0;var q=Math.min(o.node.usedBytes-u,a);if(q>8&&d.subarray)s.set(d.subarray(u,u+q),l);else for(var k=0;k<q;k++)s[l+k]=d[u+k];return q},write:function(o,s,l,a,u,d){if(s.buffer===Pt.buffer&&(d=!1),!a)return 0;var q=o.node;if(q.timestamp=Date.now(),s.subarray&&(!q.contents||q.contents.subarray)){if(d)return q.contents=s.subarray(l,l+a),q.usedBytes=a,a;if(q.usedBytes===0&&u===0)return q.contents=s.slice(l,l+a),q.usedBytes=a,a;if(u+a<=q.usedBytes)return q.contents.set(s.subarray(l,l+a),u),a}if(xe.expandFileStorage(q,u+a),q.contents.subarray&&s.subarray)q.contents.set(s.subarray(l,l+a),u);else for(var k=0;k<a;k++)q.contents[u+k]=s[l+k];return q.usedBytes=Math.max(q.usedBytes,u+a),a},llseek:function(o,s,l){var a=s;if(l===1?a+=o.position:l===2&&c.isFile(o.node.mode)&&(a+=o.node.usedBytes),a<0)throw new c.ErrnoError(28);return a},allocate:function(o,s,l){xe.expandFileStorage(o.node,s+l),o.node.usedBytes=Math.max(o.node.usedBytes,s+l)},mmap:function(o,s,l,a,u){if(!c.isFile(o.node.mode))throw new c.ErrnoError(43);var d,q,k=o.node.contents;if(!(u&2)&&k.buffer===Pt.buffer)q=!1,d=k.byteOffset;else{if((l>0||l+s<k.length)&&(k.subarray?k=k.subarray(l,l+s):k=Array.prototype.slice.call(k,l,l+s)),q=!0,d=Ta(s),!d)throw new c.ErrnoError(48);Pt.set(k,d)}return{ptr:d,allocated:q}},msync:function(o,s,l,a,u){return xe.stream_ops.write(o,s,0,a,l,!1),0}}};function Tu(o,s,l,a){var u=a?"":"al "+o;ht(o,d=>{No(d,'Loading data file "'+o+'" failed (no arrayBuffer).'),s(new Uint8Array(d)),u&&ns()},d=>{if(l)l();else throw'Loading data file "'+o+'" failed.'}),u&&xo()}var c={root:null,mounts:[],devices:{},streams:[],nextInode:1,nameTable:null,currentPath:"/",initialized:!1,ignorePermissions:!0,ErrnoError:null,genericErrors:{},filesystems:null,syncFSRequests:0,lookupPath:(o,s={})=>{if(o=hn.resolve(o),!o)return{path:"",node:null};var l={follow_mount:!0,recurse_count:0};if(s=Object.assign(l,s),s.recurse_count>8)throw new c.ErrnoError(32);for(var a=o.split("/").filter(se=>!!se),u=c.root,d="/",q=0;q<a.length;q++){var k=q===a.length-1;if(k&&s.parent)break;if(u=c.lookupNode(u,a[q]),d=De.join2(d,a[q]),c.isMountpoint(u)&&(!k||k&&s.follow_mount)&&(u=u.mounted.root),!k||s.follow)for(var D=0;c.isLink(u.mode);){var G=c.readlink(d);d=hn.resolve(De.dirname(d),G);var ee=c.lookupPath(d,{recurse_count:s.recurse_count+1});if(u=ee.node,D++>40)throw new c.ErrnoError(32)}}return{path:d,node:u}},getPath:o=>{for(var s;;){if(c.isRoot(o)){var l=o.mount.mountpoint;return s?l[l.length-1]!=="/"?l+"/"+s:l+s:l}s=s?o.name+"/"+s:o.name,o=o.parent}},hashName:(o,s)=>{for(var l=0,a=0;a<s.length;a++)l=(l<<5)-l+s.charCodeAt(a)|0;return(o+l>>>0)%c.nameTable.length},hashAddNode:o=>{var s=c.hashName(o.parent.id,o.name);o.name_next=c.nameTable[s],c.nameTable[s]=o},hashRemoveNode:o=>{var s=c.hashName(o.parent.id,o.name);if(c.nameTable[s]===o)c.nameTable[s]=o.name_next;else for(var l=c.nameTable[s];l;){if(l.name_next===o){l.name_next=o.name_next;break}l=l.name_next}},lookupNode:(o,s)=>{var l=c.mayLookup(o);if(l)throw new c.ErrnoError(l,o);for(var a=c.hashName(o.id,s),u=c.nameTable[a];u;u=u.name_next){var d=u.name;if(u.parent.id===o.id&&d===s)return u}return c.lookup(o,s)},createNode:(o,s,l,a)=>{var u=new c.FSNode(o,s,l,a);return c.hashAddNode(u),u},destroyNode:o=>{c.hashRemoveNode(o)},isRoot:o=>o===o.parent,isMountpoint:o=>!!o.mounted,isFile:o=>(o&61440)===32768,isDir:o=>(o&61440)===16384,isLink:o=>(o&61440)===40960,isChrdev:o=>(o&61440)===8192,isBlkdev:o=>(o&61440)===24576,isFIFO:o=>(o&61440)===4096,isSocket:o=>(o&49152)===49152,flagModes:{r:0,"r+":2,w:577,"w+":578,a:1089,"a+":1090},modeStringToFlags:o=>{var s=c.flagModes[o];if(typeof s>"u")throw new Error("Unknown file open mode: "+o);return s},flagsToPermissionString:o=>{var s=["r","w","rw"][o&3];return o&512&&(s+="w"),s},nodePermissions:(o,s)=>c.ignorePermissions?0:s.includes("r")&&!(o.mode&292)||s.includes("w")&&!(o.mode&146)||s.includes("x")&&!(o.mode&73)?2:0,mayLookup:o=>{var s=c.nodePermissions(o,"x");return s||(o.node_ops.lookup?0:2)},mayCreate:(o,s)=>{try{var l=c.lookupNode(o,s);return 20}catch{}return c.nodePermissions(o,"wx")},mayDelete:(o,s,l)=>{var a;try{a=c.lookupNode(o,s)}catch(d){return d.errno}var u=c.nodePermissions(o,"wx");if(u)return u;if(l){if(!c.isDir(a.mode))return 54;if(c.isRoot(a)||c.getPath(a)===c.cwd())return 10}else if(c.isDir(a.mode))return 31;return 0},mayOpen:(o,s)=>o?c.isLink(o.mode)?32:c.isDir(o.mode)&&(c.flagsToPermissionString(s)!=="r"||s&512)?31:c.nodePermissions(o,c.flagsToPermissionString(s)):44,MAX_OPEN_FDS:4096,nextfd:(o=0,s=c.MAX_OPEN_FDS)=>{for(var l=o;l<=s;l++)if(!c.streams[l])return l;throw new c.ErrnoError(33)},getStream:o=>c.streams[o],createStream:(o,s,l)=>{c.FSStream||(c.FSStream=function(){this.shared={}},c.FSStream.prototype={},Object.defineProperties(c.FSStream.prototype,{object:{get:function(){return this.node},set:function(u){this.node=u}},isRead:{get:function(){return(this.flags&2097155)!==1}},isWrite:{get:function(){return(this.flags&2097155)!==0}},isAppend:{get:function(){return this.flags&1024}},flags:{get:function(){return this.shared.flags},set:function(u){this.shared.flags=u}},position:{get:function(){return this.shared.position},set:function(u){this.shared.position=u}}})),o=Object.assign(new c.FSStream,o);var a=c.nextfd(s,l);return o.fd=a,c.streams[a]=o,o},closeStream:o=>{c.streams[o]=null},chrdev_stream_ops:{open:o=>{var s=c.getDevice(o.node.rdev);o.stream_ops=s.stream_ops,o.stream_ops.open&&o.stream_ops.open(o)},llseek:()=>{throw new c.ErrnoError(70)}},major:o=>o>>8,minor:o=>o&255,makedev:(o,s)=>o<<8|s,registerDevice:(o,s)=>{c.devices[o]={stream_ops:s}},getDevice:o=>c.devices[o],getMounts:o=>{for(var s=[],l=[o];l.length;){var a=l.pop();s.push(a),l.push.apply(l,a.mounts)}return s},syncfs:(o,s)=>{typeof o=="function"&&(s=o,o=!1),c.syncFSRequests++,c.syncFSRequests>1&&Ce("warning: "+c.syncFSRequests+" FS.syncfs operations in flight at once, probably just doing extra work");var l=c.getMounts(c.root.mount),a=0;function u(q){return c.syncFSRequests--,s(q)}function d(q){if(q)return d.errored?void 0:(d.errored=!0,u(q));++a>=l.length&&u(null)}l.forEach(q=>{if(!q.type.syncfs)return d(null);q.type.syncfs(q,o,d)})},mount:(o,s,l)=>{var a=l==="/",u=!l,d;if(a&&c.root)throw new c.ErrnoError(10);if(!a&&!u){var q=c.lookupPath(l,{follow_mount:!1});if(l=q.path,d=q.node,c.isMountpoint(d))throw new c.ErrnoError(10);if(!c.isDir(d.mode))throw new c.ErrnoError(54)}var k={type:o,opts:s,mountpoint:l,mounts:[]},D=o.mount(k);return D.mount=k,k.root=D,a?c.root=D:d&&(d.mounted=k,d.mount&&d.mount.mounts.push(k)),D},unmount:o=>{var s=c.lookupPath(o,{follow_mount:!1});if(!c.isMountpoint(s.node))throw new c.ErrnoError(28);var l=s.node,a=l.mounted,u=c.getMounts(a);Object.keys(c.nameTable).forEach(q=>{for(var k=c.nameTable[q];k;){var D=k.name_next;u.includes(k.mount)&&c.destroyNode(k),k=D}}),l.mounted=null;var d=l.mount.mounts.indexOf(a);l.mount.mounts.splice(d,1)},lookup:(o,s)=>o.node_ops.lookup(o,s),mknod:(o,s,l)=>{var a=c.lookupPath(o,{parent:!0}),u=a.node,d=De.basename(o);if(!d||d==="."||d==="..")throw new c.ErrnoError(28);var q=c.mayCreate(u,d);if(q)throw new c.ErrnoError(q);if(!u.node_ops.mknod)throw new c.ErrnoError(63);return u.node_ops.mknod(u,d,s,l)},create:(o,s)=>(s=s!==void 0?s:438,s&=4095,s|=32768,c.mknod(o,s,0)),mkdir:(o,s)=>(s=s!==void 0?s:511,s&=1023,s|=16384,c.mknod(o,s,0)),mkdirTree:(o,s)=>{for(var l=o.split("/"),a="",u=0;u<l.length;++u)if(l[u]){a+="/"+l[u];try{c.mkdir(a,s)}catch(d){if(d.errno!=20)throw d}}},mkdev:(o,s,l)=>(typeof l>"u"&&(l=s,s=438),s|=8192,c.mknod(o,s,l)),symlink:(o,s)=>{if(!hn.resolve(o))throw new c.ErrnoError(44);var l=c.lookupPath(s,{parent:!0}),a=l.node;if(!a)throw new c.ErrnoError(44);var u=De.basename(s),d=c.mayCreate(a,u);if(d)throw new c.ErrnoError(d);if(!a.node_ops.symlink)throw new c.ErrnoError(63);return a.node_ops.symlink(a,u,o)},rename:(o,s)=>{var l=De.dirname(o),a=De.dirname(s),u=De.basename(o),d=De.basename(s),q,k,D;if(q=c.lookupPath(o,{parent:!0}),k=q.node,q=c.lookupPath(s,{parent:!0}),D=q.node,!k||!D)throw new c.ErrnoError(44);if(k.mount!==D.mount)throw new c.ErrnoError(75);var G=c.lookupNode(k,u),ee=hn.relative(o,a);if(ee.charAt(0)!==".")throw new c.ErrnoError(28);if(ee=hn.relative(s,l),ee.charAt(0)!==".")throw new c.ErrnoError(55);var se;try{se=c.lookupNode(D,d)}catch{}if(G!==se){var F=c.isDir(G.mode),y=c.mayDelete(k,u,F);if(y)throw new c.ErrnoError(y);if(y=se?c.mayDelete(D,d,F):c.mayCreate(D,d),y)throw new c.ErrnoError(y);if(!k.node_ops.rename)throw new c.ErrnoError(63);if(c.isMountpoint(G)||se&&c.isMountpoint(se))throw new c.ErrnoError(10);if(D!==k&&(y=c.nodePermissions(k,"w"),y))throw new c.ErrnoError(y);c.hashRemoveNode(G);try{k.node_ops.rename(G,D,d)}catch(g){throw g}finally{c.hashAddNode(G)}}},rmdir:o=>{var s=c.lookupPath(o,{parent:!0}),l=s.node,a=De.basename(o),u=c.lookupNode(l,a),d=c.mayDelete(l,a,!0);if(d)throw new c.ErrnoError(d);if(!l.node_ops.rmdir)throw new c.ErrnoError(63);if(c.isMountpoint(u))throw new c.ErrnoError(10);l.node_ops.rmdir(l,a),c.destroyNode(u)},readdir:o=>{var s=c.lookupPath(o,{follow:!0}),l=s.node;if(!l.node_ops.readdir)throw new c.ErrnoError(54);return l.node_ops.readdir(l)},unlink:o=>{var s=c.lookupPath(o,{parent:!0}),l=s.node;if(!l)throw new c.ErrnoError(44);var a=De.basename(o),u=c.lookupNode(l,a),d=c.mayDelete(l,a,!1);if(d)throw new c.ErrnoError(d);if(!l.node_ops.unlink)throw new c.ErrnoError(63);if(c.isMountpoint(u))throw new c.ErrnoError(10);l.node_ops.unlink(l,a),c.destroyNode(u)},readlink:o=>{var s=c.lookupPath(o),l=s.node;if(!l)throw new c.ErrnoError(44);if(!l.node_ops.readlink)throw new c.ErrnoError(28);return hn.resolve(c.getPath(l.parent),l.node_ops.readlink(l))},stat:(o,s)=>{var l=c.lookupPath(o,{follow:!s}),a=l.node;if(!a)throw new c.ErrnoError(44);if(!a.node_ops.getattr)throw new c.ErrnoError(63);return a.node_ops.getattr(a)},lstat:o=>c.stat(o,!0),chmod:(o,s,l)=>{var a;if(typeof o=="string"){var u=c.lookupPath(o,{follow:!l});a=u.node}else a=o;if(!a.node_ops.setattr)throw new c.ErrnoError(63);a.node_ops.setattr(a,{mode:s&4095|a.mode&-4096,timestamp:Date.now()})},lchmod:(o,s)=>{c.chmod(o,s,!0)},fchmod:(o,s)=>{var l=c.getStream(o);if(!l)throw new c.ErrnoError(8);c.chmod(l.node,s)},chown:(o,s,l,a)=>{var u;if(typeof o=="string"){var d=c.lookupPath(o,{follow:!a});u=d.node}else u=o;if(!u.node_ops.setattr)throw new c.ErrnoError(63);u.node_ops.setattr(u,{timestamp:Date.now()})},lchown:(o,s,l)=>{c.chown(o,s,l,!0)},fchown:(o,s,l)=>{var a=c.getStream(o);if(!a)throw new c.ErrnoError(8);c.chown(a.node,s,l)},truncate:(o,s)=>{if(s<0)throw new c.ErrnoError(28);var l;if(typeof o=="string"){var a=c.lookupPath(o,{follow:!0});l=a.node}else l=o;if(!l.node_ops.setattr)throw new c.ErrnoError(63);if(c.isDir(l.mode))throw new c.ErrnoError(31);if(!c.isFile(l.mode))throw new c.ErrnoError(28);var u=c.nodePermissions(l,"w");if(u)throw new c.ErrnoError(u);l.node_ops.setattr(l,{size:s,timestamp:Date.now()})},ftruncate:(o,s)=>{var l=c.getStream(o);if(!l)throw new c.ErrnoError(8);if(!(l.flags&2097155))throw new c.ErrnoError(28);c.truncate(l.node,s)},utime:(o,s,l)=>{var a=c.lookupPath(o,{follow:!0}),u=a.node;u.node_ops.setattr(u,{timestamp:Math.max(s,l)})},open:(o,s,l)=>{if(o==="")throw new c.ErrnoError(44);s=typeof s=="string"?c.modeStringToFlags(s):s,l=typeof l>"u"?438:l,s&64?l=l&4095|32768:l=0;var a;if(typeof o=="object")a=o;else{o=De.normalize(o);try{var u=c.lookupPath(o,{follow:!(s&131072)});a=u.node}catch{}}var d=!1;if(s&64)if(a){if(s&128)throw new c.ErrnoError(20)}else a=c.mknod(o,l,0),d=!0;if(!a)throw new c.ErrnoError(44);if(c.isChrdev(a.mode)&&(s&=-513),s&65536&&!c.isDir(a.mode))throw new c.ErrnoError(54);if(!d){var q=c.mayOpen(a,s);if(q)throw new c.ErrnoError(q)}s&512&&!d&&c.truncate(a,0),s&=-131713;var k=c.createStream({node:a,path:c.getPath(a),flags:s,seekable:!0,position:0,stream_ops:a.stream_ops,ungotten:[],error:!1});return k.stream_ops.open&&k.stream_ops.open(k),n.logReadFiles&&!(s&1)&&(c.readFiles||(c.readFiles={}),o in c.readFiles||(c.readFiles[o]=1)),k},close:o=>{if(c.isClosed(o))throw new c.ErrnoError(8);o.getdents&&(o.getdents=null);try{o.stream_ops.close&&o.stream_ops.close(o)}catch(s){throw s}finally{c.closeStream(o.fd)}o.fd=null},isClosed:o=>o.fd===null,llseek:(o,s,l)=>{if(c.isClosed(o))throw new c.ErrnoError(8);if(!o.seekable||!o.stream_ops.llseek)throw new c.ErrnoError(70);if(l!=0&&l!=1&&l!=2)throw new c.ErrnoError(28);return o.position=o.stream_ops.llseek(o,s,l),o.ungotten=[],o.position},read:(o,s,l,a,u)=>{if(a<0||u<0)throw new c.ErrnoError(28);if(c.isClosed(o))throw new c.ErrnoError(8);if((o.flags&2097155)===1)throw new c.ErrnoError(8);if(c.isDir(o.node.mode))throw new c.ErrnoError(31);if(!o.stream_ops.read)throw new c.ErrnoError(28);var d=typeof u<"u";if(!d)u=o.position;else if(!o.seekable)throw new c.ErrnoError(70);var q=o.stream_ops.read(o,s,l,a,u);return d||(o.position+=q),q},write:(o,s,l,a,u,d)=>{if(a<0||u<0)throw new c.ErrnoError(28);if(c.isClosed(o))throw new c.ErrnoError(8);if(!(o.flags&2097155))throw new c.ErrnoError(8);if(c.isDir(o.node.mode))throw new c.ErrnoError(31);if(!o.stream_ops.write)throw new c.ErrnoError(28);o.seekable&&o.flags&1024&&c.llseek(o,0,2);var q=typeof u<"u";if(!q)u=o.position;else if(!o.seekable)throw new c.ErrnoError(70);var k=o.stream_ops.write(o,s,l,a,u,d);return q||(o.position+=k),k},allocate:(o,s,l)=>{if(c.isClosed(o))throw new c.ErrnoError(8);if(s<0||l<=0)throw new c.ErrnoError(28);if(!(o.flags&2097155))throw new c.ErrnoError(8);if(!c.isFile(o.node.mode)&&!c.isDir(o.node.mode))throw new c.ErrnoError(43);if(!o.stream_ops.allocate)throw new c.ErrnoError(138);o.stream_ops.allocate(o,s,l)},mmap:(o,s,l,a,u)=>{if(a&2&&!(u&2)&&(o.flags&2097155)!==2)throw new c.ErrnoError(2);if((o.flags&2097155)===1)throw new c.ErrnoError(2);if(!o.stream_ops.mmap)throw new c.ErrnoError(43);return o.stream_ops.mmap(o,s,l,a,u)},msync:(o,s,l,a,u)=>o.stream_ops.msync?o.stream_ops.msync(o,s,l,a,u):0,munmap:o=>0,ioctl:(o,s,l)=>{if(!o.stream_ops.ioctl)throw new c.ErrnoError(59);return o.stream_ops.ioctl(o,s,l)},readFile:(o,s={})=>{if(s.flags=s.flags||0,s.encoding=s.encoding||"binary",s.encoding!=="utf8"&&s.encoding!=="binary")throw new Error('Invalid encoding type "'+s.encoding+'"');var l,a=c.open(o,s.flags),u=c.stat(o),d=u.size,q=new Uint8Array(d);return c.read(a,q,0,d,0),s.encoding==="utf8"?l=nn(q,0):s.encoding==="binary"&&(l=q),c.close(a),l},writeFile:(o,s,l={})=>{l.flags=l.flags||577;var a=c.open(o,l.flags,l.mode);if(typeof s=="string"){var u=new Uint8Array(ui(s)+1),d=xr(s,u,0,u.length);c.write(a,u,0,d,void 0,l.canOwn)}else if(ArrayBuffer.isView(s))c.write(a,s,0,s.byteLength,void 0,l.canOwn);else throw new Error("Unsupported data type");c.close(a)},cwd:()=>c.currentPath,chdir:o=>{var s=c.lookupPath(o,{follow:!0});if(s.node===null)throw new c.ErrnoError(44);if(!c.isDir(s.node.mode))throw new c.ErrnoError(54);var l=c.nodePermissions(s.node,"x");if(l)throw new c.ErrnoError(l);c.currentPath=s.path},createDefaultDirectories:()=>{c.mkdir("/tmp"),c.mkdir("/home"),c.mkdir("/home/web_user")},createDefaultDevices:()=>{c.mkdir("/dev"),c.registerDevice(c.makedev(1,3),{read:()=>0,write:(s,l,a,u,d)=>u}),c.mkdev("/dev/null",c.makedev(1,3)),er.register(c.makedev(5,0),er.default_tty_ops),er.register(c.makedev(6,0),er.default_tty1_ops),c.mkdev("/dev/tty",c.makedev(5,0)),c.mkdev("/dev/tty1",c.makedev(6,0));var o=ku();c.createDevice("/dev","random",o),c.createDevice("/dev","urandom",o),c.mkdir("/dev/shm"),c.mkdir("/dev/shm/tmp")},createSpecialDirectories:()=>{c.mkdir("/proc");var o=c.mkdir("/proc/self");c.mkdir("/proc/self/fd"),c.mount({mount:()=>{var s=c.createNode(o,"fd",16895,73);return s.node_ops={lookup:(l,a)=>{var u=+a,d=c.getStream(u);if(!d)throw new c.ErrnoError(8);var q={parent:null,mount:{mountpoint:"fake"},node_ops:{readlink:()=>d.path}};return q.parent=q,q}},s}},{},"/proc/self/fd")},createStandardStreams:()=>{n.stdin?c.createDevice("/dev","stdin",n.stdin):c.symlink("/dev/tty","/dev/stdin"),n.stdout?c.createDevice("/dev","stdout",null,n.stdout):c.symlink("/dev/tty","/dev/stdout"),n.stderr?c.createDevice("/dev","stderr",null,n.stderr):c.symlink("/dev/tty1","/dev/stderr"),c.open("/dev/stdin",0),c.open("/dev/stdout",1),c.open("/dev/stderr",1)},ensureErrnoError:()=>{c.ErrnoError||(c.ErrnoError=function(s,l){this.node=l,this.setErrno=function(a){this.errno=a},this.setErrno(s),this.message="FS error"},c.ErrnoError.prototype=new Error,c.ErrnoError.prototype.constructor=c.ErrnoError,[44].forEach(o=>{c.genericErrors[o]=new c.ErrnoError(o),c.genericErrors[o].stack="<generic error, no stack>"}))},staticInit:()=>{c.ensureErrnoError(),c.nameTable=new Array(4096),c.mount(xe,{},"/"),c.createDefaultDirectories(),c.createDefaultDevices(),c.createSpecialDirectories(),c.filesystems={MEMFS:xe}},init:(o,s,l)=>{c.init.initialized=!0,c.ensureErrnoError(),n.stdin=o||n.stdin,n.stdout=s||n.stdout,n.stderr=l||n.stderr,c.createStandardStreams()},quit:()=>{c.init.initialized=!1;for(var o=0;o<c.streams.length;o++){var s=c.streams[o];s&&c.close(s)}},getMode:(o,s)=>{var l=0;return o&&(l|=365),s&&(l|=146),l},findObject:(o,s)=>{var l=c.analyzePath(o,s);return l.exists?l.object:null},analyzePath:(o,s)=>{try{var l=c.lookupPath(o,{follow:!s});o=l.path}catch{}var a={isRoot:!1,exists:!1,error:0,name:null,path:null,object:null,parentExists:!1,parentPath:null,parentObject:null};try{var l=c.lookupPath(o,{parent:!0});a.parentExists=!0,a.parentPath=l.path,a.parentObject=l.node,a.name=De.basename(o),l=c.lookupPath(o,{follow:!s}),a.exists=!0,a.path=l.path,a.object=l.node,a.name=l.node.name,a.isRoot=l.path==="/"}catch(u){a.error=u.errno}return a},createPath:(o,s,l,a)=>{o=typeof o=="string"?o:c.getPath(o);for(var u=s.split("/").reverse();u.length;){var d=u.pop();if(d){var q=De.join2(o,d);try{c.mkdir(q)}catch{}o=q}}return q},createFile:(o,s,l,a,u)=>{var d=De.join2(typeof o=="string"?o:c.getPath(o),s),q=c.getMode(a,u);return c.create(d,q)},createDataFile:(o,s,l,a,u,d)=>{var q=s;o&&(o=typeof o=="string"?o:c.getPath(o),q=s?De.join2(o,s):o);var k=c.getMode(a,u),D=c.create(q,k);if(l){if(typeof l=="string"){for(var G=new Array(l.length),ee=0,se=l.length;ee<se;++ee)G[ee]=l.charCodeAt(ee);l=G}c.chmod(D,k|146);var F=c.open(D,577);c.write(F,l,0,l.length,0,d),c.close(F),c.chmod(D,k)}return D},createDevice:(o,s,l,a)=>{var u=De.join2(typeof o=="string"?o:c.getPath(o),s),d=c.getMode(!!l,!!a);c.createDevice.major||(c.createDevice.major=64);var q=c.makedev(c.createDevice.major++,0);return c.registerDevice(q,{open:k=>{k.seekable=!1},close:k=>{a&&a.buffer&&a.buffer.length&&a(10)},read:(k,D,G,ee,se)=>{for(var F=0,y=0;y<ee;y++){var g;try{g=l()}catch{throw new c.ErrnoError(29)}if(g===void 0&&F===0)throw new c.ErrnoError(6);if(g==null)break;F++,D[G+y]=g}return F&&(k.node.timestamp=Date.now()),F},write:(k,D,G,ee,se)=>{for(var F=0;F<ee;F++)try{a(D[G+F])}catch{throw new c.ErrnoError(29)}return ee&&(k.node.timestamp=Date.now()),F}}),c.mkdev(u,d,q)},forceLoadFile:o=>{if(o.isDevice||o.isFolder||o.link||o.contents)return!0;if(typeof XMLHttpRequest<"u")throw new Error("Lazy loading should have been performed (contents set) in createLazyFile, but it was not. Lazy loading only works in web workers. Use --embed-file or --preload-file in emcc on the main thread.");if(Ot)try{o.contents=So(Ot(o.url),!0),o.usedBytes=o.contents.length}catch{throw new c.ErrnoError(29)}else throw new Error("Cannot load without read() or XMLHttpRequest.")},createLazyFile:(o,s,l,a,u)=>{function d(){this.lengthKnown=!1,this.chunks=[]}if(d.prototype.get=function(y){if(!(y>this.length-1||y<0)){var g=y%this.chunkSize,E=y/this.chunkSize|0;return this.getter(E)[g]}},d.prototype.setDataGetter=function(y){this.getter=y},d.prototype.cacheLength=function(){var y=new XMLHttpRequest;if(y.open("HEAD",l,!1),y.send(null),!(y.status>=200&&y.status<300||y.status===304))throw new Error("Couldn't load "+l+". Status: "+y.status);var g=Number(y.getResponseHeader("Content-length")),E,O=(E=y.getResponseHeader("Accept-Ranges"))&&E==="bytes",N=(E=y.getResponseHeader("Content-Encoding"))&&E==="gzip",j=1024*1024;O||(j=g);var H=(U,he)=>{if(U>he)throw new Error("invalid range ("+U+", "+he+") or no bytes requested!");if(he>g-1)throw new Error("only "+g+" bytes available! programmer error!");var _=new XMLHttpRequest;if(_.open("GET",l,!1),g!==j&&_.setRequestHeader("Range","bytes="+U+"-"+he),_.responseType="arraybuffer",_.overrideMimeType&&_.overrideMimeType("text/plain; charset=x-user-defined"),_.send(null),!(_.status>=200&&_.status<300||_.status===304))throw new Error("Couldn't load "+l+". Status: "+_.status);return _.response!==void 0?new Uint8Array(_.response||[]):So(_.responseText||"",!0)},K=this;K.setDataGetter(U=>{var he=U*j,_=(U+1)*j-1;if(_=Math.min(_,g-1),typeof K.chunks[U]>"u"&&(K.chunks[U]=H(he,_)),typeof K.chunks[U]>"u")throw new Error("doXHR failed!");return K.chunks[U]}),(N||!g)&&(j=g=1,g=this.getter(0).length,j=g,Le("LazyFiles on gzip forces download of the whole file when length is accessed")),this._length=g,this._chunkSize=j,this.lengthKnown=!0},typeof XMLHttpRequest<"u"){if(!be)throw"Cannot do synchronous binary XHRs outside webworkers in modern browsers. Use --embed-file or --preload-file in emcc";var q=new d;Object.defineProperties(q,{length:{get:function(){return this.lengthKnown||this.cacheLength(),this._length}},chunkSize:{get:function(){return this.lengthKnown||this.cacheLength(),this._chunkSize}}});var k={isDevice:!1,contents:q}}else var k={isDevice:!1,url:l};var D=c.createFile(o,s,k,a,u);k.contents?D.contents=k.contents:k.url&&(D.contents=null,D.url=k.url),Object.defineProperties(D,{usedBytes:{get:function(){return this.contents.length}}});var G={},ee=Object.keys(D.stream_ops);ee.forEach(F=>{var y=D.stream_ops[F];G[F]=function(){return c.forceLoadFile(D),y.apply(null,arguments)}});function se(F,y,g,E,O){var N=F.node.contents;if(O>=N.length)return 0;var j=Math.min(N.length-O,E);if(N.slice)for(var H=0;H<j;H++)y[g+H]=N[O+H];else for(var H=0;H<j;H++)y[g+H]=N.get(O+H);return j}return G.read=(F,y,g,E,O)=>(c.forceLoadFile(D),se(F,y,g,E,O)),G.mmap=(F,y,g,E,O)=>{c.forceLoadFile(D);var N=Ta(y);if(!N)throw new c.ErrnoError(48);return se(F,Pt,N,y,g),{ptr:N,allocated:!0}},D.stream_ops=G,D},createPreloadedFile:(o,s,l,a,u,d,q,k,D,G)=>{var ee=s?hn.resolve(De.join2(o,s)):o;function se(F){function y(g){G&&G(),k||c.createDataFile(o,s,g,a,u,D),d&&d(),ns()}Browser.handledByPreloadPlugin(F,ee,y,()=>{q&&q(),ns()})||y(F)}xo(),typeof l=="string"?Tu(l,F=>se(F),q):se(l)},indexedDB:()=>window.indexedDB||window.mozIndexedDB||window.webkitIndexedDB||window.msIndexedDB,DB_NAME:()=>"EM_FS_"+window.location.pathname,DB_VERSION:20,DB_STORE_NAME:"FILE_DATA",saveFilesToDB:(o,s,l)=>{s=s||(()=>{}),l=l||(()=>{});var a=c.indexedDB();try{var u=a.open(c.DB_NAME(),c.DB_VERSION)}catch(d){return l(d)}u.onupgradeneeded=()=>{Le("creating db");var d=u.result;d.createObjectStore(c.DB_STORE_NAME)},u.onsuccess=()=>{var d=u.result,q=d.transaction([c.DB_STORE_NAME],"readwrite"),k=q.objectStore(c.DB_STORE_NAME),D=0,G=0,ee=o.length;function se(){G==0?s():l()}o.forEach(F=>{var y=k.put(c.analyzePath(F).object.contents,F);y.onsuccess=()=>{D++,D+G==ee&&se()},y.onerror=()=>{G++,D+G==ee&&se()}}),q.onerror=l},u.onerror=l},loadFilesFromDB:(o,s,l)=>{s=s||(()=>{}),l=l||(()=>{});var a=c.indexedDB();try{var u=a.open(c.DB_NAME(),c.DB_VERSION)}catch(d){return l(d)}u.onupgradeneeded=l,u.onsuccess=()=>{var d=u.result;try{var q=d.transaction([c.DB_STORE_NAME],"readonly")}catch(F){l(F);return}var k=q.objectStore(c.DB_STORE_NAME),D=0,G=0,ee=o.length;function se(){G==0?s():l()}o.forEach(F=>{var y=k.get(F);y.onsuccess=()=>{c.analyzePath(F).exists&&c.unlink(F),c.createDataFile(De.dirname(F),De.basename(F),y.result,!0,!0,!0),D++,D+G==ee&&se()},y.onerror=()=>{G++,D+G==ee&&se()}}),q.onerror=l},u.onerror=l}},ge={DEFAULT_POLLMASK:5,calculateAt:function(o,s,l){if(De.isAbs(s))return s;var a;if(o===-100)a=c.cwd();else{var u=ge.getStreamFromFD(o);a=u.path}if(s.length==0){if(!l)throw new c.ErrnoError(44);return a}return De.join2(a,s)},doStat:function(o,s,l){try{var a=o(s)}catch(k){if(k&&k.node&&De.normalize(s)!==De.normalize(c.getPath(k.node)))return-54;throw k}ke[l>>2]=a.dev,ke[l+8>>2]=a.ino,ke[l+12>>2]=a.mode,nt[l+16>>2]=a.nlink,ke[l+20>>2]=a.uid,ke[l+24>>2]=a.gid,ke[l+28>>2]=a.rdev,pt=[a.size>>>0,(Ae=a.size,+Math.abs(Ae)>=1?Ae>0?(Math.min(+Math.floor(Ae/4294967296),4294967295)|0)>>>0:~~+Math.ceil((Ae-+(~~Ae>>>0))/4294967296)>>>0:0)],ke[l+40>>2]=pt[0],ke[l+44>>2]=pt[1],ke[l+48>>2]=4096,ke[l+52>>2]=a.blocks;var u=a.atime.getTime(),d=a.mtime.getTime(),q=a.ctime.getTime();return pt=[Math.floor(u/1e3)>>>0,(Ae=Math.floor(u/1e3),+Math.abs(Ae)>=1?Ae>0?(Math.min(+Math.floor(Ae/4294967296),4294967295)|0)>>>0:~~+Math.ceil((Ae-+(~~Ae>>>0))/4294967296)>>>0:0)],ke[l+56>>2]=pt[0],ke[l+60>>2]=pt[1],nt[l+64>>2]=u%1e3*1e3,pt=[Math.floor(d/1e3)>>>0,(Ae=Math.floor(d/1e3),+Math.abs(Ae)>=1?Ae>0?(Math.min(+Math.floor(Ae/4294967296),4294967295)|0)>>>0:~~+Math.ceil((Ae-+(~~Ae>>>0))/4294967296)>>>0:0)],ke[l+72>>2]=pt[0],ke[l+76>>2]=pt[1],nt[l+80>>2]=d%1e3*1e3,pt=[Math.floor(q/1e3)>>>0,(Ae=Math.floor(q/1e3),+Math.abs(Ae)>=1?Ae>0?(Math.min(+Math.floor(Ae/4294967296),4294967295)|0)>>>0:~~+Math.ceil((Ae-+(~~Ae>>>0))/4294967296)>>>0:0)],ke[l+88>>2]=pt[0],ke[l+92>>2]=pt[1],nt[l+96>>2]=q%1e3*1e3,pt=[a.ino>>>0,(Ae=a.ino,+Math.abs(Ae)>=1?Ae>0?(Math.min(+Math.floor(Ae/4294967296),4294967295)|0)>>>0:~~+Math.ceil((Ae-+(~~Ae>>>0))/4294967296)>>>0:0)],ke[l+104>>2]=pt[0],ke[l+108>>2]=pt[1],0},doMsync:function(o,s,l,a,u){if(!c.isFile(s.node.mode))throw new c.ErrnoError(43);if(a&2)return 0;var d=Er.slice(o,o+l);c.msync(s,d,u,l,a)},varargs:void 0,get:function(){ge.varargs+=4;var o=ke[ge.varargs-4>>2];return o},getStr:function(o){var s=vo(o);return s},getStreamFromFD:function(o){var s=c.getStream(o);if(!s)throw new c.ErrnoError(8);return s}};function Cu(o,s){try{return o=ge.getStr(o),c.chmod(o,s),0}catch(l){if(typeof c>"u"||!(l instanceof c.ErrnoError))throw l;return-l.errno}}function Fu(o,s,l,a){try{if(s=ge.getStr(s),s=ge.calculateAt(o,s),l&-8)return-28;var u=c.lookupPath(s,{follow:!0}),d=u.node;if(!d)return-44;var q="";return l&4&&(q+="r"),l&2&&(q+="w"),l&1&&(q+="x"),q&&c.nodePermissions(d,q)?-2:0}catch(k){if(typeof c>"u"||!(k instanceof c.ErrnoError))throw k;return-k.errno}}function Pu(o,s){try{return c.fchmod(o,s),0}catch(l){if(typeof c>"u"||!(l instanceof c.ErrnoError))throw l;return-l.errno}}function Wu(o,s,l){try{return c.fchown(o,s,l),0}catch(a){if(typeof c>"u"||!(a instanceof c.ErrnoError))throw a;return-a.errno}}function Lu(o){return ke[Da()>>2]=o,o}function Du(o,s,l){ge.varargs=l;try{var a=ge.getStreamFromFD(o);switch(s){case 0:{var u=ge.get();if(u<0)return-28;var d;return d=c.createStream(a,u),d.fd}case 1:case 2:return 0;case 3:return a.flags;case 4:{var u=ge.get();return a.flags|=u,0}case 5:{var u=ge.get(),q=0;return va[u+q>>1]=2,0}case 6:case 7:return 0;case 16:case 8:return-28;case 9:return Lu(28),-1;default:return-28}}catch(k){if(typeof c>"u"||!(k instanceof c.ErrnoError))throw k;return-k.errno}}function Ru(o,s){try{var l=ge.getStreamFromFD(o);return ge.doStat(c.stat,l.path,s)}catch(a){if(typeof c>"u"||!(a instanceof c.ErrnoError))throw a;return-a.errno}}var Mu=9007199254740992,Bu=-9007199254740992;function Ca(o){return o<Bu||o>Mu?NaN:Number(o)}function Qu(o,s){try{return s=Ca(s),isNaN(s)?-61:(c.ftruncate(o,s),0)}catch(l){if(typeof c>"u"||!(l instanceof c.ErrnoError))throw l;return-l.errno}}function Uu(o,s){try{if(s===0)return-28;var l=c.cwd(),a=ui(l)+1;return s<a?-68:(Na(l,o,s),a)}catch(u){if(typeof c>"u"||!(u instanceof c.ErrnoError))throw u;return-u.errno}}function ju(o,s,l){ge.varargs=l;try{var a=ge.getStreamFromFD(o);switch(s){case 21509:case 21505:return a.tty?0:-59;case 21510:case 21511:case 21512:case 21506:case 21507:case 21508:return a.tty?0:-59;case 21519:{if(!a.tty)return-59;var u=ge.get();return ke[u>>2]=0,0}case 21520:return a.tty?-28:-59;case 21531:{var u=ge.get();return c.ioctl(a,s,u)}case 21523:return a.tty?0:-59;case 21524:return a.tty?0:-59;default:return-28}}catch(d){if(typeof c>"u"||!(d instanceof c.ErrnoError))throw d;return-d.errno}}function zu(o,s){try{return o=ge.getStr(o),ge.doStat(c.lstat,o,s)}catch(l){if(typeof c>"u"||!(l instanceof c.ErrnoError))throw l;return-l.errno}}function Vu(o,s,l){try{return s=ge.getStr(s),s=ge.calculateAt(o,s),s=De.normalize(s),s[s.length-1]==="/"&&(s=s.substr(0,s.length-1)),c.mkdir(s,l,0),0}catch(a){if(typeof c>"u"||!(a instanceof c.ErrnoError))throw a;return-a.errno}}function $u(o,s,l,a){try{s=ge.getStr(s);var u=a&256,d=a&4096;return a=a&-6401,s=ge.calculateAt(o,s,d),ge.doStat(u?c.lstat:c.stat,s,l)}catch(q){if(typeof c>"u"||!(q instanceof c.ErrnoError))throw q;return-q.errno}}function Hu(o,s,l,a){ge.varargs=a;try{s=ge.getStr(s),s=ge.calculateAt(o,s);var u=a?ge.get():0;return c.open(s,l,u).fd}catch(d){if(typeof c>"u"||!(d instanceof c.ErrnoError))throw d;return-d.errno}}function Ju(o,s,l,a){try{if(s=ge.getStr(s),s=ge.calculateAt(o,s),a<=0)return-28;var u=c.readlink(s),d=Math.min(a,ui(u)),q=Pt[l+d];return Na(u,l,a+1),Pt[l+d]=q,d}catch(k){if(typeof c>"u"||!(k instanceof c.ErrnoError))throw k;return-k.errno}}function Gu(o){try{return o=ge.getStr(o),c.rmdir(o),0}catch(s){if(typeof c>"u"||!(s instanceof c.ErrnoError))throw s;return-s.errno}}function Ku(o,s){try{return o=ge.getStr(o),ge.doStat(c.stat,o,s)}catch(l){if(typeof c>"u"||!(l instanceof c.ErrnoError))throw l;return-l.errno}}function Xu(o,s,l){try{return s=ge.getStr(s),s=ge.calculateAt(o,s),l===0?c.unlink(s):l===512?c.rmdir(s):Sr("Invalid flags passed to unlinkat"),0}catch(a){if(typeof c>"u"||!(a instanceof c.ErrnoError))throw a;return-a.errno}}function Io(o){return nt[o>>2]+ke[o+4>>2]*4294967296}function Yu(o,s,l,a){try{if(s=ge.getStr(s),s=ge.calculateAt(o,s,!0),l){var q=Io(l),k=ke[l+8>>2];u=q*1e3+k/(1e3*1e3),l+=16,q=Io(l),k=ke[l+8>>2],d=q*1e3+k/(1e3*1e3)}else var u=Date.now(),d=u;return c.utime(s,u,d),0}catch(D){if(typeof c>"u"||!(D instanceof c.ErrnoError))throw D;return-D.errno}}var Zu=!0;function ec(){return Zu}function tc(o){return o%4===0&&(o%100!==0||o%400===0)}var nc=[0,31,60,91,121,152,182,213,244,274,305,335],rc=[0,31,59,90,120,151,181,212,243,273,304,334];function ic(o){var s=tc(o.getFullYear()),l=s?nc:rc,a=l[o.getMonth()]+o.getDate()-1;return a}function sc(o,s){var l=new Date(Io(o)*1e3);ke[s>>2]=l.getSeconds(),ke[s+4>>2]=l.getMinutes(),ke[s+8>>2]=l.getHours(),ke[s+12>>2]=l.getDate(),ke[s+16>>2]=l.getMonth(),ke[s+20>>2]=l.getFullYear()-1900,ke[s+24>>2]=l.getDay();var a=ic(l)|0;ke[s+28>>2]=a,ke[s+36>>2]=-(l.getTimezoneOffset()*60);var u=new Date(l.getFullYear(),0,1),d=new Date(l.getFullYear(),6,1).getTimezoneOffset(),q=u.getTimezoneOffset(),k=(d!=q&&l.getTimezoneOffset()==Math.min(q,d))|0;ke[s+32>>2]=k}function oc(o,s,l,a,u,d,q){try{var k=ge.getStreamFromFD(a),D=c.mmap(k,o,u,s,l),G=D.ptr;return ke[d>>2]=D.allocated,nt[q>>2]=G,0}catch(ee){if(typeof c>"u"||!(ee instanceof c.ErrnoError))throw ee;return-ee.errno}}function ac(o,s,l,a,u,d){try{var q=ge.getStreamFromFD(u);l&2&&ge.doMsync(o,q,s,a,d),c.munmap(q)}catch(k){if(typeof c>"u"||!(k instanceof c.ErrnoError))throw k;return-k.errno}}function Fa(o){var s=ui(o)+1,l=Ra(s);return l&&xr(o,Pt,l,s),l}function lc(o,s,l){var a=new Date().getFullYear(),u=new Date(a,0,1),d=new Date(a,6,1),q=u.getTimezoneOffset(),k=d.getTimezoneOffset(),D=Math.max(q,k);nt[o>>2]=D*60,ke[s>>2]=+(q!=k);function G(g){var E=g.toTimeString().match(/\(([A-Za-z ]+)\)$/);return E?E[1]:"GMT"}var ee=G(u),se=G(d),F=Fa(ee),y=Fa(se);k<q?(nt[l>>2]=F,nt[l+4>>2]=y):(nt[l>>2]=y,nt[l+4>>2]=F)}function uc(){return Date.now()}var Pa;Pa=()=>performance.now();function cc(){return 2147483648}function dc(o){var s=vt.buffer;try{return vt.grow(o-s.byteLength+65535>>>16),xa(),1}catch{}}function fc(o){var s=Er.length;o=o>>>0;var l=cc();if(o>l)return!1;let a=(D,G)=>D+(G-D%G)%G;for(var u=1;u<=4;u*=2){var d=s*(1+.2/u);d=Math.min(d,o+100663296);var q=Math.min(l,a(Math.max(o,d),65536)),k=dc(q);if(k)return!0}return!1}var ko={};function hc(){return He||"./this.program"}function di(){if(!di.strings){var o=(typeof navigator=="object"&&navigator.languages&&navigator.languages[0]||"C").replace("-","_")+".UTF-8",s={USER:"web_user",LOGNAME:"web_user",PATH:"/",PWD:"/",HOME:"/home/web_user",LANG:o,_:hc()};for(var l in ko)ko[l]===void 0?delete s[l]:s[l]=ko[l];var a=[];for(var l in s)a.push(l+"="+s[l]);di.strings=a}return di.strings}function pc(o,s,l){for(var a=0;a<o.length;++a)Pt[s++>>0]=o.charCodeAt(a);l||(Pt[s>>0]=0)}function mc(o,s){var l=0;return di().forEach(function(a,u){var d=s+l;nt[o+u*4>>2]=d,pc(a,d),l+=a.length+1}),0}function _c(o,s){var l=di();nt[o>>2]=l.length;var a=0;return l.forEach(function(u){a+=u.length+1}),nt[s>>2]=a,0}function yc(o){try{var s=ge.getStreamFromFD(o);return c.close(s),0}catch(l){if(typeof c>"u"||!(l instanceof c.ErrnoError))throw l;return l.errno}}function gc(o,s){try{var l=ge.getStreamFromFD(o),a=l.tty?2:c.isDir(l.mode)?3:c.isLink(l.mode)?7:4;return Pt[s>>0]=a,0}catch(u){if(typeof c>"u"||!(u instanceof c.ErrnoError))throw u;return u.errno}}function wc(o,s,l,a){for(var u=0,d=0;d<l;d++){var q=nt[s>>2],k=nt[s+4>>2];s+=8;var D=c.read(o,Pt,q,k,a);if(D<0)return-1;if(u+=D,D<k)break;typeof a<"u"&&(a+=D)}return u}function bc(o,s,l,a){try{var u=ge.getStreamFromFD(o),d=wc(u,s,l);return nt[a>>2]=d,0}catch(q){if(typeof c>"u"||!(q instanceof c.ErrnoError))throw q;return q.errno}}function qc(o,s,l,a){try{if(s=Ca(s),isNaN(s))return 61;var u=ge.getStreamFromFD(o);return c.llseek(u,s,l),pt=[u.position>>>0,(Ae=u.position,+Math.abs(Ae)>=1?Ae>0?(Math.min(+Math.floor(Ae/4294967296),4294967295)|0)>>>0:~~+Math.ceil((Ae-+(~~Ae>>>0))/4294967296)>>>0:0)],ke[a>>2]=pt[0],ke[a+4>>2]=pt[1],u.getdents&&s===0&&l===0&&(u.getdents=null),0}catch(d){if(typeof c>"u"||!(d instanceof c.ErrnoError))throw d;return d.errno}}function Nc(o){try{var s=ge.getStreamFromFD(o);return s.stream_ops&&s.stream_ops.fsync?s.stream_ops.fsync(s):0}catch(l){if(typeof c>"u"||!(l instanceof c.ErrnoError))throw l;return l.errno}}function vc(o,s,l,a){for(var u=0,d=0;d<l;d++){var q=nt[s>>2],k=nt[s+4>>2];s+=8;var D=c.write(o,Pt,q,k,a);if(D<0)return-1;u+=D,typeof a<"u"&&(a+=D)}return u}function xc(o,s,l,a){try{var u=ge.getStreamFromFD(o),d=vc(u,s,l);return nt[a>>2]=d,0}catch(q){if(typeof c>"u"||!(q instanceof c.ErrnoError))throw q;return q.errno}}var Wa=function(o,s,l,a){o||(o=this),this.parent=o,this.mount=o.mount,this.mounted=null,this.id=c.nextInode++,this.name=s,this.mode=l,this.node_ops={},this.stream_ops={},this.rdev=a},rs=365,is=146;Object.defineProperties(Wa.prototype,{read:{get:function(){return(this.mode&rs)===rs},set:function(o){o?this.mode|=rs:this.mode&=~rs}},write:{get:function(){return(this.mode&is)===is},set:function(o){o?this.mode|=is:this.mode&=~is}},isFolder:{get:function(){return c.isDir(this.mode)}},isDevice:{get:function(){return c.isChrdev(this.mode)}}}),c.FSNode=Wa,c.staticInit();var La={__syscall_chmod:Cu,__syscall_faccessat:Fu,__syscall_fchmod:Pu,__syscall_fchown32:Wu,__syscall_fcntl64:Du,__syscall_fstat64:Ru,__syscall_ftruncate64:Qu,__syscall_getcwd:Uu,__syscall_ioctl:ju,__syscall_lstat64:zu,__syscall_mkdirat:Vu,__syscall_newfstatat:$u,__syscall_openat:Hu,__syscall_readlinkat:Ju,__syscall_rmdir:Gu,__syscall_stat64:Ku,__syscall_unlinkat:Xu,__syscall_utimensat:Yu,_emscripten_get_now_is_monotonic:ec,_localtime_js:sc,_mmap_js:oc,_munmap_js:ac,_tzset_js:lc,emscripten_date_now:uc,emscripten_get_now:Pa,emscripten_resize_heap:fc,environ_get:mc,environ_sizes_get:_c,fd_close:yc,fd_fdstat_get:gc,fd_read:bc,fd_seek:qc,fd_sync:Nc,fd_write:xc,memory:vt};Iu(),n.___wasm_call_ctors=function(){return(n.___wasm_call_ctors=n.asm.__wasm_call_ctors).apply(null,arguments)},n._sqlite3_status64=function(){return(n._sqlite3_status64=n.asm.sqlite3_status64).apply(null,arguments)},n._sqlite3_status=function(){return(n._sqlite3_status=n.asm.sqlite3_status).apply(null,arguments)},n._sqlite3_db_status=function(){return(n._sqlite3_db_status=n.asm.sqlite3_db_status).apply(null,arguments)},n._sqlite3_msize=function(){return(n._sqlite3_msize=n.asm.sqlite3_msize).apply(null,arguments)},n._sqlite3_vfs_find=function(){return(n._sqlite3_vfs_find=n.asm.sqlite3_vfs_find).apply(null,arguments)},n._sqlite3_initialize=function(){return(n._sqlite3_initialize=n.asm.sqlite3_initialize).apply(null,arguments)},n._sqlite3_malloc=function(){return(n._sqlite3_malloc=n.asm.sqlite3_malloc).apply(null,arguments)},n._sqlite3_free=function(){return(n._sqlite3_free=n.asm.sqlite3_free).apply(null,arguments)},n._sqlite3_vfs_register=function(){return(n._sqlite3_vfs_register=n.asm.sqlite3_vfs_register).apply(null,arguments)},n._sqlite3_vfs_unregister=function(){return(n._sqlite3_vfs_unregister=n.asm.sqlite3_vfs_unregister).apply(null,arguments)},n._sqlite3_malloc64=function(){return(n._sqlite3_malloc64=n.asm.sqlite3_malloc64).apply(null,arguments)},n._sqlite3_realloc=function(){return(n._sqlite3_realloc=n.asm.sqlite3_realloc).apply(null,arguments)},n._sqlite3_realloc64=function(){return(n._sqlite3_realloc64=n.asm.sqlite3_realloc64).apply(null,arguments)},n._sqlite3_value_text=function(){return(n._sqlite3_value_text=n.asm.sqlite3_value_text).apply(null,arguments)},n._sqlite3_randomness=function(){return(n._sqlite3_randomness=n.asm.sqlite3_randomness).apply(null,arguments)},n._sqlite3_stricmp=function(){return(n._sqlite3_stricmp=n.asm.sqlite3_stricmp).apply(null,arguments)},n._sqlite3_strnicmp=function(){return(n._sqlite3_strnicmp=n.asm.sqlite3_strnicmp).apply(null,arguments)},n._sqlite3_uri_parameter=function(){return(n._sqlite3_uri_parameter=n.asm.sqlite3_uri_parameter).apply(null,arguments)};var Da=n.___errno_location=function(){return(Da=n.___errno_location=n.asm.__errno_location).apply(null,arguments)};n._sqlite3_uri_boolean=function(){return(n._sqlite3_uri_boolean=n.asm.sqlite3_uri_boolean).apply(null,arguments)},n._sqlite3_serialize=function(){return(n._sqlite3_serialize=n.asm.sqlite3_serialize).apply(null,arguments)},n._sqlite3_prepare_v2=function(){return(n._sqlite3_prepare_v2=n.asm.sqlite3_prepare_v2).apply(null,arguments)},n._sqlite3_step=function(){return(n._sqlite3_step=n.asm.sqlite3_step).apply(null,arguments)},n._sqlite3_column_int64=function(){return(n._sqlite3_column_int64=n.asm.sqlite3_column_int64).apply(null,arguments)},n._sqlite3_reset=function(){return(n._sqlite3_reset=n.asm.sqlite3_reset).apply(null,arguments)},n._sqlite3_exec=function(){return(n._sqlite3_exec=n.asm.sqlite3_exec).apply(null,arguments)},n._sqlite3_column_int=function(){return(n._sqlite3_column_int=n.asm.sqlite3_column_int).apply(null,arguments)},n._sqlite3_finalize=function(){return(n._sqlite3_finalize=n.asm.sqlite3_finalize).apply(null,arguments)},n._sqlite3_file_control=function(){return(n._sqlite3_file_control=n.asm.sqlite3_file_control).apply(null,arguments)},n._sqlite3_column_name=function(){return(n._sqlite3_column_name=n.asm.sqlite3_column_name).apply(null,arguments)},n._sqlite3_column_text=function(){return(n._sqlite3_column_text=n.asm.sqlite3_column_text).apply(null,arguments)},n._sqlite3_column_type=function(){return(n._sqlite3_column_type=n.asm.sqlite3_column_type).apply(null,arguments)},n._sqlite3_errmsg=function(){return(n._sqlite3_errmsg=n.asm.sqlite3_errmsg).apply(null,arguments)},n._sqlite3_deserialize=function(){return(n._sqlite3_deserialize=n.asm.sqlite3_deserialize).apply(null,arguments)},n._sqlite3_clear_bindings=function(){return(n._sqlite3_clear_bindings=n.asm.sqlite3_clear_bindings).apply(null,arguments)},n._sqlite3_value_blob=function(){return(n._sqlite3_value_blob=n.asm.sqlite3_value_blob).apply(null,arguments)},n._sqlite3_value_bytes=function(){return(n._sqlite3_value_bytes=n.asm.sqlite3_value_bytes).apply(null,arguments)},n._sqlite3_value_double=function(){return(n._sqlite3_value_double=n.asm.sqlite3_value_double).apply(null,arguments)},n._sqlite3_value_int=function(){return(n._sqlite3_value_int=n.asm.sqlite3_value_int).apply(null,arguments)},n._sqlite3_value_int64=function(){return(n._sqlite3_value_int64=n.asm.sqlite3_value_int64).apply(null,arguments)},n._sqlite3_value_subtype=function(){return(n._sqlite3_value_subtype=n.asm.sqlite3_value_subtype).apply(null,arguments)},n._sqlite3_value_pointer=function(){return(n._sqlite3_value_pointer=n.asm.sqlite3_value_pointer).apply(null,arguments)},n._sqlite3_value_type=function(){return(n._sqlite3_value_type=n.asm.sqlite3_value_type).apply(null,arguments)},n._sqlite3_value_nochange=function(){return(n._sqlite3_value_nochange=n.asm.sqlite3_value_nochange).apply(null,arguments)},n._sqlite3_value_frombind=function(){return(n._sqlite3_value_frombind=n.asm.sqlite3_value_frombind).apply(null,arguments)},n._sqlite3_value_dup=function(){return(n._sqlite3_value_dup=n.asm.sqlite3_value_dup).apply(null,arguments)},n._sqlite3_value_free=function(){return(n._sqlite3_value_free=n.asm.sqlite3_value_free).apply(null,arguments)},n._sqlite3_result_blob=function(){return(n._sqlite3_result_blob=n.asm.sqlite3_result_blob).apply(null,arguments)},n._sqlite3_result_error_toobig=function(){return(n._sqlite3_result_error_toobig=n.asm.sqlite3_result_error_toobig).apply(null,arguments)},n._sqlite3_result_error_nomem=function(){return(n._sqlite3_result_error_nomem=n.asm.sqlite3_result_error_nomem).apply(null,arguments)},n._sqlite3_result_double=function(){return(n._sqlite3_result_double=n.asm.sqlite3_result_double).apply(null,arguments)},n._sqlite3_result_error=function(){return(n._sqlite3_result_error=n.asm.sqlite3_result_error).apply(null,arguments)},n._sqlite3_result_int=function(){return(n._sqlite3_result_int=n.asm.sqlite3_result_int).apply(null,arguments)},n._sqlite3_result_int64=function(){return(n._sqlite3_result_int64=n.asm.sqlite3_result_int64).apply(null,arguments)},n._sqlite3_result_null=function(){return(n._sqlite3_result_null=n.asm.sqlite3_result_null).apply(null,arguments)},n._sqlite3_result_pointer=function(){return(n._sqlite3_result_pointer=n.asm.sqlite3_result_pointer).apply(null,arguments)},n._sqlite3_result_subtype=function(){return(n._sqlite3_result_subtype=n.asm.sqlite3_result_subtype).apply(null,arguments)},n._sqlite3_result_text=function(){return(n._sqlite3_result_text=n.asm.sqlite3_result_text).apply(null,arguments)},n._sqlite3_result_zeroblob=function(){return(n._sqlite3_result_zeroblob=n.asm.sqlite3_result_zeroblob).apply(null,arguments)},n._sqlite3_result_zeroblob64=function(){return(n._sqlite3_result_zeroblob64=n.asm.sqlite3_result_zeroblob64).apply(null,arguments)},n._sqlite3_result_error_code=function(){return(n._sqlite3_result_error_code=n.asm.sqlite3_result_error_code).apply(null,arguments)},n._sqlite3_user_data=function(){return(n._sqlite3_user_data=n.asm.sqlite3_user_data).apply(null,arguments)},n._sqlite3_context_db_handle=function(){return(n._sqlite3_context_db_handle=n.asm.sqlite3_context_db_handle).apply(null,arguments)},n._sqlite3_vtab_nochange=function(){return(n._sqlite3_vtab_nochange=n.asm.sqlite3_vtab_nochange).apply(null,arguments)},n._sqlite3_vtab_in_first=function(){return(n._sqlite3_vtab_in_first=n.asm.sqlite3_vtab_in_first).apply(null,arguments)},n._sqlite3_vtab_in_next=function(){return(n._sqlite3_vtab_in_next=n.asm.sqlite3_vtab_in_next).apply(null,arguments)},n._sqlite3_aggregate_context=function(){return(n._sqlite3_aggregate_context=n.asm.sqlite3_aggregate_context).apply(null,arguments)},n._sqlite3_get_auxdata=function(){return(n._sqlite3_get_auxdata=n.asm.sqlite3_get_auxdata).apply(null,arguments)},n._sqlite3_set_auxdata=function(){return(n._sqlite3_set_auxdata=n.asm.sqlite3_set_auxdata).apply(null,arguments)},n._sqlite3_column_count=function(){return(n._sqlite3_column_count=n.asm.sqlite3_column_count).apply(null,arguments)},n._sqlite3_data_count=function(){return(n._sqlite3_data_count=n.asm.sqlite3_data_count).apply(null,arguments)},n._sqlite3_column_blob=function(){return(n._sqlite3_column_blob=n.asm.sqlite3_column_blob).apply(null,arguments)},n._sqlite3_column_bytes=function(){return(n._sqlite3_column_bytes=n.asm.sqlite3_column_bytes).apply(null,arguments)},n._sqlite3_column_double=function(){return(n._sqlite3_column_double=n.asm.sqlite3_column_double).apply(null,arguments)},n._sqlite3_column_value=function(){return(n._sqlite3_column_value=n.asm.sqlite3_column_value).apply(null,arguments)},n._sqlite3_bind_blob=function(){return(n._sqlite3_bind_blob=n.asm.sqlite3_bind_blob).apply(null,arguments)},n._sqlite3_bind_double=function(){return(n._sqlite3_bind_double=n.asm.sqlite3_bind_double).apply(null,arguments)},n._sqlite3_bind_int=function(){return(n._sqlite3_bind_int=n.asm.sqlite3_bind_int).apply(null,arguments)},n._sqlite3_bind_int64=function(){return(n._sqlite3_bind_int64=n.asm.sqlite3_bind_int64).apply(null,arguments)},n._sqlite3_bind_null=function(){return(n._sqlite3_bind_null=n.asm.sqlite3_bind_null).apply(null,arguments)},n._sqlite3_bind_pointer=function(){return(n._sqlite3_bind_pointer=n.asm.sqlite3_bind_pointer).apply(null,arguments)},n._sqlite3_bind_text=function(){return(n._sqlite3_bind_text=n.asm.sqlite3_bind_text).apply(null,arguments)},n._sqlite3_bind_parameter_count=function(){return(n._sqlite3_bind_parameter_count=n.asm.sqlite3_bind_parameter_count).apply(null,arguments)},n._sqlite3_bind_parameter_index=function(){return(n._sqlite3_bind_parameter_index=n.asm.sqlite3_bind_parameter_index).apply(null,arguments)},n._sqlite3_db_handle=function(){return(n._sqlite3_db_handle=n.asm.sqlite3_db_handle).apply(null,arguments)},n._sqlite3_stmt_readonly=function(){return(n._sqlite3_stmt_readonly=n.asm.sqlite3_stmt_readonly).apply(null,arguments)},n._sqlite3_stmt_isexplain=function(){return(n._sqlite3_stmt_isexplain=n.asm.sqlite3_stmt_isexplain).apply(null,arguments)},n._sqlite3_stmt_status=function(){return(n._sqlite3_stmt_status=n.asm.sqlite3_stmt_status).apply(null,arguments)},n._sqlite3_sql=function(){return(n._sqlite3_sql=n.asm.sqlite3_sql).apply(null,arguments)},n._sqlite3_expanded_sql=function(){return(n._sqlite3_expanded_sql=n.asm.sqlite3_expanded_sql).apply(null,arguments)},n._sqlite3_preupdate_old=function(){return(n._sqlite3_preupdate_old=n.asm.sqlite3_preupdate_old).apply(null,arguments)},n._sqlite3_preupdate_count=function(){return(n._sqlite3_preupdate_count=n.asm.sqlite3_preupdate_count).apply(null,arguments)},n._sqlite3_preupdate_depth=function(){return(n._sqlite3_preupdate_depth=n.asm.sqlite3_preupdate_depth).apply(null,arguments)},n._sqlite3_preupdate_blobwrite=function(){return(n._sqlite3_preupdate_blobwrite=n.asm.sqlite3_preupdate_blobwrite).apply(null,arguments)},n._sqlite3_preupdate_new=function(){return(n._sqlite3_preupdate_new=n.asm.sqlite3_preupdate_new).apply(null,arguments)},n._sqlite3_value_numeric_type=function(){return(n._sqlite3_value_numeric_type=n.asm.sqlite3_value_numeric_type).apply(null,arguments)},n._sqlite3_set_authorizer=function(){return(n._sqlite3_set_authorizer=n.asm.sqlite3_set_authorizer).apply(null,arguments)},n._sqlite3_strglob=function(){return(n._sqlite3_strglob=n.asm.sqlite3_strglob).apply(null,arguments)},n._sqlite3_strlike=function(){return(n._sqlite3_strlike=n.asm.sqlite3_strlike).apply(null,arguments)},n._sqlite3_auto_extension=function(){return(n._sqlite3_auto_extension=n.asm.sqlite3_auto_extension).apply(null,arguments)},n._sqlite3_cancel_auto_extension=function(){return(n._sqlite3_cancel_auto_extension=n.asm.sqlite3_cancel_auto_extension).apply(null,arguments)},n._sqlite3_reset_auto_extension=function(){return(n._sqlite3_reset_auto_extension=n.asm.sqlite3_reset_auto_extension).apply(null,arguments)},n._sqlite3_prepare_v3=function(){return(n._sqlite3_prepare_v3=n.asm.sqlite3_prepare_v3).apply(null,arguments)},n._sqlite3_create_module=function(){return(n._sqlite3_create_module=n.asm.sqlite3_create_module).apply(null,arguments)},n._sqlite3_create_module_v2=function(){return(n._sqlite3_create_module_v2=n.asm.sqlite3_create_module_v2).apply(null,arguments)},n._sqlite3_drop_modules=function(){return(n._sqlite3_drop_modules=n.asm.sqlite3_drop_modules).apply(null,arguments)},n._sqlite3_declare_vtab=function(){return(n._sqlite3_declare_vtab=n.asm.sqlite3_declare_vtab).apply(null,arguments)},n._sqlite3_vtab_on_conflict=function(){return(n._sqlite3_vtab_on_conflict=n.asm.sqlite3_vtab_on_conflict).apply(null,arguments)},n._sqlite3_vtab_collation=function(){return(n._sqlite3_vtab_collation=n.asm.sqlite3_vtab_collation).apply(null,arguments)},n._sqlite3_vtab_in=function(){return(n._sqlite3_vtab_in=n.asm.sqlite3_vtab_in).apply(null,arguments)},n._sqlite3_vtab_rhs_value=function(){return(n._sqlite3_vtab_rhs_value=n.asm.sqlite3_vtab_rhs_value).apply(null,arguments)},n._sqlite3_vtab_distinct=function(){return(n._sqlite3_vtab_distinct=n.asm.sqlite3_vtab_distinct).apply(null,arguments)},n._sqlite3_keyword_name=function(){return(n._sqlite3_keyword_name=n.asm.sqlite3_keyword_name).apply(null,arguments)},n._sqlite3_keyword_count=function(){return(n._sqlite3_keyword_count=n.asm.sqlite3_keyword_count).apply(null,arguments)},n._sqlite3_keyword_check=function(){return(n._sqlite3_keyword_check=n.asm.sqlite3_keyword_check).apply(null,arguments)},n._sqlite3_complete=function(){return(n._sqlite3_complete=n.asm.sqlite3_complete).apply(null,arguments)},n._sqlite3_libversion=function(){return(n._sqlite3_libversion=n.asm.sqlite3_libversion).apply(null,arguments)},n._sqlite3_libversion_number=function(){return(n._sqlite3_libversion_number=n.asm.sqlite3_libversion_number).apply(null,arguments)},n._sqlite3_shutdown=function(){return(n._sqlite3_shutdown=n.asm.sqlite3_shutdown).apply(null,arguments)},n._sqlite3_last_insert_rowid=function(){return(n._sqlite3_last_insert_rowid=n.asm.sqlite3_last_insert_rowid).apply(null,arguments)},n._sqlite3_set_last_insert_rowid=function(){return(n._sqlite3_set_last_insert_rowid=n.asm.sqlite3_set_last_insert_rowid).apply(null,arguments)},n._sqlite3_changes64=function(){return(n._sqlite3_changes64=n.asm.sqlite3_changes64).apply(null,arguments)},n._sqlite3_changes=function(){return(n._sqlite3_changes=n.asm.sqlite3_changes).apply(null,arguments)},n._sqlite3_total_changes64=function(){return(n._sqlite3_total_changes64=n.asm.sqlite3_total_changes64).apply(null,arguments)},n._sqlite3_total_changes=function(){return(n._sqlite3_total_changes=n.asm.sqlite3_total_changes).apply(null,arguments)},n._sqlite3_txn_state=function(){return(n._sqlite3_txn_state=n.asm.sqlite3_txn_state).apply(null,arguments)},n._sqlite3_close_v2=function(){return(n._sqlite3_close_v2=n.asm.sqlite3_close_v2).apply(null,arguments)},n._sqlite3_busy_handler=function(){return(n._sqlite3_busy_handler=n.asm.sqlite3_busy_handler).apply(null,arguments)},n._sqlite3_progress_handler=function(){return(n._sqlite3_progress_handler=n.asm.sqlite3_progress_handler).apply(null,arguments)},n._sqlite3_busy_timeout=function(){return(n._sqlite3_busy_timeout=n.asm.sqlite3_busy_timeout).apply(null,arguments)},n._sqlite3_create_function=function(){return(n._sqlite3_create_function=n.asm.sqlite3_create_function).apply(null,arguments)},n._sqlite3_create_function_v2=function(){return(n._sqlite3_create_function_v2=n.asm.sqlite3_create_function_v2).apply(null,arguments)},n._sqlite3_create_window_function=function(){return(n._sqlite3_create_window_function=n.asm.sqlite3_create_window_function).apply(null,arguments)},n._sqlite3_overload_function=function(){return(n._sqlite3_overload_function=n.asm.sqlite3_overload_function).apply(null,arguments)},n._sqlite3_trace_v2=function(){return(n._sqlite3_trace_v2=n.asm.sqlite3_trace_v2).apply(null,arguments)},n._sqlite3_commit_hook=function(){return(n._sqlite3_commit_hook=n.asm.sqlite3_commit_hook).apply(null,arguments)},n._sqlite3_update_hook=function(){return(n._sqlite3_update_hook=n.asm.sqlite3_update_hook).apply(null,arguments)},n._sqlite3_rollback_hook=function(){return(n._sqlite3_rollback_hook=n.asm.sqlite3_rollback_hook).apply(null,arguments)},n._sqlite3_preupdate_hook=function(){return(n._sqlite3_preupdate_hook=n.asm.sqlite3_preupdate_hook).apply(null,arguments)},n._sqlite3_error_offset=function(){return(n._sqlite3_error_offset=n.asm.sqlite3_error_offset).apply(null,arguments)},n._sqlite3_errcode=function(){return(n._sqlite3_errcode=n.asm.sqlite3_errcode).apply(null,arguments)},n._sqlite3_extended_errcode=function(){return(n._sqlite3_extended_errcode=n.asm.sqlite3_extended_errcode).apply(null,arguments)},n._sqlite3_errstr=function(){return(n._sqlite3_errstr=n.asm.sqlite3_errstr).apply(null,arguments)},n._sqlite3_limit=function(){return(n._sqlite3_limit=n.asm.sqlite3_limit).apply(null,arguments)},n._sqlite3_open=function(){return(n._sqlite3_open=n.asm.sqlite3_open).apply(null,arguments)},n._sqlite3_open_v2=function(){return(n._sqlite3_open_v2=n.asm.sqlite3_open_v2).apply(null,arguments)},n._sqlite3_create_collation=function(){return(n._sqlite3_create_collation=n.asm.sqlite3_create_collation).apply(null,arguments)},n._sqlite3_create_collation_v2=function(){return(n._sqlite3_create_collation_v2=n.asm.sqlite3_create_collation_v2).apply(null,arguments)},n._sqlite3_collation_needed=function(){return(n._sqlite3_collation_needed=n.asm.sqlite3_collation_needed).apply(null,arguments)},n._sqlite3_get_autocommit=function(){return(n._sqlite3_get_autocommit=n.asm.sqlite3_get_autocommit).apply(null,arguments)},n._sqlite3_table_column_metadata=function(){return(n._sqlite3_table_column_metadata=n.asm.sqlite3_table_column_metadata).apply(null,arguments)},n._sqlite3_extended_result_codes=function(){return(n._sqlite3_extended_result_codes=n.asm.sqlite3_extended_result_codes).apply(null,arguments)},n._sqlite3_uri_key=function(){return(n._sqlite3_uri_key=n.asm.sqlite3_uri_key).apply(null,arguments)},n._sqlite3_uri_int64=function(){return(n._sqlite3_uri_int64=n.asm.sqlite3_uri_int64).apply(null,arguments)},n._sqlite3_db_name=function(){return(n._sqlite3_db_name=n.asm.sqlite3_db_name).apply(null,arguments)},n._sqlite3_db_filename=function(){return(n._sqlite3_db_filename=n.asm.sqlite3_db_filename).apply(null,arguments)},n._sqlite3_compileoption_used=function(){return(n._sqlite3_compileoption_used=n.asm.sqlite3_compileoption_used).apply(null,arguments)},n._sqlite3_compileoption_get=function(){return(n._sqlite3_compileoption_get=n.asm.sqlite3_compileoption_get).apply(null,arguments)},n._sqlite3session_diff=function(){return(n._sqlite3session_diff=n.asm.sqlite3session_diff).apply(null,arguments)},n._sqlite3session_attach=function(){return(n._sqlite3session_attach=n.asm.sqlite3session_attach).apply(null,arguments)},n._sqlite3session_create=function(){return(n._sqlite3session_create=n.asm.sqlite3session_create).apply(null,arguments)},n._sqlite3session_delete=function(){return(n._sqlite3session_delete=n.asm.sqlite3session_delete).apply(null,arguments)},n._sqlite3session_table_filter=function(){return(n._sqlite3session_table_filter=n.asm.sqlite3session_table_filter).apply(null,arguments)},n._sqlite3session_changeset=function(){return(n._sqlite3session_changeset=n.asm.sqlite3session_changeset).apply(null,arguments)},n._sqlite3session_changeset_strm=function(){return(n._sqlite3session_changeset_strm=n.asm.sqlite3session_changeset_strm).apply(null,arguments)},n._sqlite3session_patchset_strm=function(){return(n._sqlite3session_patchset_strm=n.asm.sqlite3session_patchset_strm).apply(null,arguments)},n._sqlite3session_patchset=function(){return(n._sqlite3session_patchset=n.asm.sqlite3session_patchset).apply(null,arguments)},n._sqlite3session_enable=function(){return(n._sqlite3session_enable=n.asm.sqlite3session_enable).apply(null,arguments)},n._sqlite3session_indirect=function(){return(n._sqlite3session_indirect=n.asm.sqlite3session_indirect).apply(null,arguments)},n._sqlite3session_isempty=function(){return(n._sqlite3session_isempty=n.asm.sqlite3session_isempty).apply(null,arguments)},n._sqlite3session_memory_used=function(){return(n._sqlite3session_memory_used=n.asm.sqlite3session_memory_used).apply(null,arguments)},n._sqlite3session_object_config=function(){return(n._sqlite3session_object_config=n.asm.sqlite3session_object_config).apply(null,arguments)},n._sqlite3session_changeset_size=function(){return(n._sqlite3session_changeset_size=n.asm.sqlite3session_changeset_size).apply(null,arguments)},n._sqlite3changeset_start=function(){return(n._sqlite3changeset_start=n.asm.sqlite3changeset_start).apply(null,arguments)},n._sqlite3changeset_start_v2=function(){return(n._sqlite3changeset_start_v2=n.asm.sqlite3changeset_start_v2).apply(null,arguments)},n._sqlite3changeset_start_strm=function(){return(n._sqlite3changeset_start_strm=n.asm.sqlite3changeset_start_strm).apply(null,arguments)},n._sqlite3changeset_start_v2_strm=function(){return(n._sqlite3changeset_start_v2_strm=n.asm.sqlite3changeset_start_v2_strm).apply(null,arguments)},n._sqlite3changeset_next=function(){return(n._sqlite3changeset_next=n.asm.sqlite3changeset_next).apply(null,arguments)},n._sqlite3changeset_op=function(){return(n._sqlite3changeset_op=n.asm.sqlite3changeset_op).apply(null,arguments)},n._sqlite3changeset_pk=function(){return(n._sqlite3changeset_pk=n.asm.sqlite3changeset_pk).apply(null,arguments)},n._sqlite3changeset_old=function(){return(n._sqlite3changeset_old=n.asm.sqlite3changeset_old).apply(null,arguments)},n._sqlite3changeset_new=function(){return(n._sqlite3changeset_new=n.asm.sqlite3changeset_new).apply(null,arguments)},n._sqlite3changeset_conflict=function(){return(n._sqlite3changeset_conflict=n.asm.sqlite3changeset_conflict).apply(null,arguments)},n._sqlite3changeset_fk_conflicts=function(){return(n._sqlite3changeset_fk_conflicts=n.asm.sqlite3changeset_fk_conflicts).apply(null,arguments)},n._sqlite3changeset_finalize=function(){return(n._sqlite3changeset_finalize=n.asm.sqlite3changeset_finalize).apply(null,arguments)},n._sqlite3changeset_invert=function(){return(n._sqlite3changeset_invert=n.asm.sqlite3changeset_invert).apply(null,arguments)},n._sqlite3changeset_invert_strm=function(){return(n._sqlite3changeset_invert_strm=n.asm.sqlite3changeset_invert_strm).apply(null,arguments)},n._sqlite3changeset_apply_v2=function(){return(n._sqlite3changeset_apply_v2=n.asm.sqlite3changeset_apply_v2).apply(null,arguments)},n._sqlite3changeset_apply=function(){return(n._sqlite3changeset_apply=n.asm.sqlite3changeset_apply).apply(null,arguments)},n._sqlite3changeset_apply_v2_strm=function(){return(n._sqlite3changeset_apply_v2_strm=n.asm.sqlite3changeset_apply_v2_strm).apply(null,arguments)},n._sqlite3changeset_apply_strm=function(){return(n._sqlite3changeset_apply_strm=n.asm.sqlite3changeset_apply_strm).apply(null,arguments)},n._sqlite3changegroup_new=function(){return(n._sqlite3changegroup_new=n.asm.sqlite3changegroup_new).apply(null,arguments)},n._sqlite3changegroup_add=function(){return(n._sqlite3changegroup_add=n.asm.sqlite3changegroup_add).apply(null,arguments)},n._sqlite3changegroup_output=function(){return(n._sqlite3changegroup_output=n.asm.sqlite3changegroup_output).apply(null,arguments)},n._sqlite3changegroup_add_strm=function(){return(n._sqlite3changegroup_add_strm=n.asm.sqlite3changegroup_add_strm).apply(null,arguments)},n._sqlite3changegroup_output_strm=function(){return(n._sqlite3changegroup_output_strm=n.asm.sqlite3changegroup_output_strm).apply(null,arguments)},n._sqlite3changegroup_delete=function(){return(n._sqlite3changegroup_delete=n.asm.sqlite3changegroup_delete).apply(null,arguments)},n._sqlite3changeset_concat=function(){return(n._sqlite3changeset_concat=n.asm.sqlite3changeset_concat).apply(null,arguments)},n._sqlite3changeset_concat_strm=function(){return(n._sqlite3changeset_concat_strm=n.asm.sqlite3changeset_concat_strm).apply(null,arguments)},n._sqlite3session_config=function(){return(n._sqlite3session_config=n.asm.sqlite3session_config).apply(null,arguments)},n._sqlite3_sourceid=function(){return(n._sqlite3_sourceid=n.asm.sqlite3_sourceid).apply(null,arguments)},n._sqlite3_wasm_pstack_ptr=function(){return(n._sqlite3_wasm_pstack_ptr=n.asm.sqlite3_wasm_pstack_ptr).apply(null,arguments)},n._sqlite3_wasm_pstack_restore=function(){return(n._sqlite3_wasm_pstack_restore=n.asm.sqlite3_wasm_pstack_restore).apply(null,arguments)},n._sqlite3_wasm_pstack_alloc=function(){return(n._sqlite3_wasm_pstack_alloc=n.asm.sqlite3_wasm_pstack_alloc).apply(null,arguments)},n._sqlite3_wasm_pstack_remaining=function(){return(n._sqlite3_wasm_pstack_remaining=n.asm.sqlite3_wasm_pstack_remaining).apply(null,arguments)},n._sqlite3_wasm_pstack_quota=function(){return(n._sqlite3_wasm_pstack_quota=n.asm.sqlite3_wasm_pstack_quota).apply(null,arguments)},n._sqlite3_wasm_db_error=function(){return(n._sqlite3_wasm_db_error=n.asm.sqlite3_wasm_db_error).apply(null,arguments)},n._sqlite3_wasm_test_struct=function(){return(n._sqlite3_wasm_test_struct=n.asm.sqlite3_wasm_test_struct).apply(null,arguments)},n._sqlite3_wasm_enum_json=function(){return(n._sqlite3_wasm_enum_json=n.asm.sqlite3_wasm_enum_json).apply(null,arguments)},n._sqlite3_wasm_vfs_unlink=function(){return(n._sqlite3_wasm_vfs_unlink=n.asm.sqlite3_wasm_vfs_unlink).apply(null,arguments)},n._sqlite3_wasm_db_vfs=function(){return(n._sqlite3_wasm_db_vfs=n.asm.sqlite3_wasm_db_vfs).apply(null,arguments)},n._sqlite3_wasm_db_reset=function(){return(n._sqlite3_wasm_db_reset=n.asm.sqlite3_wasm_db_reset).apply(null,arguments)},n._sqlite3_wasm_db_export_chunked=function(){return(n._sqlite3_wasm_db_export_chunked=n.asm.sqlite3_wasm_db_export_chunked).apply(null,arguments)},n._sqlite3_wasm_db_serialize=function(){return(n._sqlite3_wasm_db_serialize=n.asm.sqlite3_wasm_db_serialize).apply(null,arguments)},n._sqlite3_wasm_vfs_create_file=function(){return(n._sqlite3_wasm_vfs_create_file=n.asm.sqlite3_wasm_vfs_create_file).apply(null,arguments)},n._sqlite3_wasm_posix_create_file=function(){return(n._sqlite3_wasm_posix_create_file=n.asm.sqlite3_wasm_posix_create_file).apply(null,arguments)},n._sqlite3_wasm_kvvfsMakeKeyOnPstack=function(){return(n._sqlite3_wasm_kvvfsMakeKeyOnPstack=n.asm.sqlite3_wasm_kvvfsMakeKeyOnPstack).apply(null,arguments)},n._sqlite3_wasm_kvvfs_methods=function(){return(n._sqlite3_wasm_kvvfs_methods=n.asm.sqlite3_wasm_kvvfs_methods).apply(null,arguments)},n._sqlite3_wasm_vtab_config=function(){return(n._sqlite3_wasm_vtab_config=n.asm.sqlite3_wasm_vtab_config).apply(null,arguments)},n._sqlite3_wasm_db_config_ip=function(){return(n._sqlite3_wasm_db_config_ip=n.asm.sqlite3_wasm_db_config_ip).apply(null,arguments)},n._sqlite3_wasm_db_config_pii=function(){return(n._sqlite3_wasm_db_config_pii=n.asm.sqlite3_wasm_db_config_pii).apply(null,arguments)},n._sqlite3_wasm_db_config_s=function(){return(n._sqlite3_wasm_db_config_s=n.asm.sqlite3_wasm_db_config_s).apply(null,arguments)},n._sqlite3_wasm_config_i=function(){return(n._sqlite3_wasm_config_i=n.asm.sqlite3_wasm_config_i).apply(null,arguments)},n._sqlite3_wasm_config_ii=function(){return(n._sqlite3_wasm_config_ii=n.asm.sqlite3_wasm_config_ii).apply(null,arguments)},n._sqlite3_wasm_config_j=function(){return(n._sqlite3_wasm_config_j=n.asm.sqlite3_wasm_config_j).apply(null,arguments)},n._sqlite3_wasm_init_wasmfs=function(){return(n._sqlite3_wasm_init_wasmfs=n.asm.sqlite3_wasm_init_wasmfs).apply(null,arguments)},n._sqlite3_wasm_test_intptr=function(){return(n._sqlite3_wasm_test_intptr=n.asm.sqlite3_wasm_test_intptr).apply(null,arguments)},n._sqlite3_wasm_test_voidptr=function(){return(n._sqlite3_wasm_test_voidptr=n.asm.sqlite3_wasm_test_voidptr).apply(null,arguments)},n._sqlite3_wasm_test_int64_max=function(){return(n._sqlite3_wasm_test_int64_max=n.asm.sqlite3_wasm_test_int64_max).apply(null,arguments)},n._sqlite3_wasm_test_int64_min=function(){return(n._sqlite3_wasm_test_int64_min=n.asm.sqlite3_wasm_test_int64_min).apply(null,arguments)},n._sqlite3_wasm_test_int64_times2=function(){return(n._sqlite3_wasm_test_int64_times2=n.asm.sqlite3_wasm_test_int64_times2).apply(null,arguments)},n._sqlite3_wasm_test_int64_minmax=function(){return(n._sqlite3_wasm_test_int64_minmax=n.asm.sqlite3_wasm_test_int64_minmax).apply(null,arguments)},n._sqlite3_wasm_test_int64ptr=function(){return(n._sqlite3_wasm_test_int64ptr=n.asm.sqlite3_wasm_test_int64ptr).apply(null,arguments)},n._sqlite3_wasm_test_stack_overflow=function(){return(n._sqlite3_wasm_test_stack_overflow=n.asm.sqlite3_wasm_test_stack_overflow).apply(null,arguments)},n._sqlite3_wasm_test_str_hello=function(){return(n._sqlite3_wasm_test_str_hello=n.asm.sqlite3_wasm_test_str_hello).apply(null,arguments)},n._sqlite3_wasm_SQLTester_strglob=function(){return(n._sqlite3_wasm_SQLTester_strglob=n.asm.sqlite3_wasm_SQLTester_strglob).apply(null,arguments)};var Ra=n._malloc=function(){return(Ra=n._malloc=n.asm.malloc).apply(null,arguments)};n._free=function(){return(n._free=n.asm.free).apply(null,arguments)},n._realloc=function(){return(n._realloc=n.asm.realloc).apply(null,arguments)};var Ma=n._emscripten_builtin_memalign=function(){return(Ma=n._emscripten_builtin_memalign=n.asm.emscripten_builtin_memalign).apply(null,arguments)};n.stackSave=function(){return(n.stackSave=n.asm.stackSave).apply(null,arguments)},n.stackRestore=function(){return(n.stackRestore=n.asm.stackRestore).apply(null,arguments)},n.stackAlloc=function(){return(n.stackAlloc=n.asm.stackAlloc).apply(null,arguments)},n.wasmMemory=vt;var ss;ci=function o(){ss||Ba(),ss||(ci=o)};function Ba(o){if(Zn>0||(wu(),Zn>0))return;function s(){ss||(ss=!0,n.calledRun=!0,!ts&&(bu(),I(n),n.onRuntimeInitialized&&n.onRuntimeInitialized(),qu()))}n.setStatus?(n.setStatus("Running..."),setTimeout(function(){setTimeout(function(){n.setStatus("")},1),s()},1)):s()}if(n.preInit)for(typeof n.preInit=="function"&&(n.preInit=[n.preInit]);n.preInit.length>0;)n.preInit.pop()();return Ba(),n.postRun||(n.postRun=[]),n.postRun.push(function(o){if(globalThis.sqlite3ApiBootstrap=function s(l=globalThis.sqlite3ApiConfig||s.defaultConfig){if(s.sqlite3)return console.warn("sqlite3ApiBootstrap() called multiple times.","Config and external initializers are ignored on calls after the first."),s.sqlite3;const a=Object.assign(Object.create(null),{exports:void 0,memory:void 0,bigIntEnabled:typeof o<"u"?!!o.HEAPU64:!!globalThis.BigInt64Array,debug:console.debug.bind(console),warn:console.warn.bind(console),error:console.error.bind(console),log:console.log.bind(console),wasmfsOpfsDir:"/opfs",useStdAlloc:!1},l||{});Object.assign(a,{allocExportName:a.useStdAlloc?"malloc":"sqlite3_malloc",deallocExportName:a.useStdAlloc?"free":"sqlite3_free",reallocExportName:a.useStdAlloc?"realloc":"sqlite3_realloc"},a),["exports","memory","wasmfsOpfsDir"].forEach(h=>{typeof a[h]=="function"&&(a[h]=a[h]())});const u=Object.create(null),d=Object.create(null),q=h=>u.sqlite3_js_rc_str&&u.sqlite3_js_rc_str(h)||"Unknown result code #"+h,k=h=>typeof h=="number"&&h===(h|0);class D extends Error{constructor(...p){let m;if(p.length)if(k(p[0]))if(m=p[0],p.length===1)super(q(p[0]));else{const L=q(m);typeof p[1]=="object"?super(L,p[1]):(p[0]=L+":",super(p.join(" ")))}else p.length===2&&typeof p[1]=="object"?super(...p):super(p.join(" "));this.resultCode=m||u.SQLITE_ERROR,this.name="SQLite3Error"}}D.toss=(...h)=>{throw new D(...h)};const G=D.toss;a.wasmfsOpfsDir&&!/^\/[^/]+$/.test(a.wasmfsOpfsDir)&&G("config.wasmfsOpfsDir must be falsy or in the form '/dir-name'.");const ee=h=>typeof h!="bigint"&&h===(h|0)&&h<=2147483647&&h>=-2147483648,se=function h(p){return h._max||(h._max=BigInt("0x7fffffffffffffff"),h._min=~h._max),p>=h._min&&p<=h._max},F=h=>h>=-0x7fffffffn-1n&&h<=0x7fffffffn,y=function h(p){return h._min||(h._min=Number.MIN_SAFE_INTEGER,h._max=Number.MAX_SAFE_INTEGER),p>=h._min&&p<=h._max},g=h=>h&&h.constructor&&ee(h.constructor.BYTES_PER_ELEMENT)?h:!1,E=typeof SharedArrayBuffer>"u"?function(){}:SharedArrayBuffer,O=h=>h.buffer instanceof E,N=(h,p,m)=>O(h)?h.slice(p,m):h.subarray(p,m),j=h=>h&&(h instanceof Uint8Array||h instanceof Int8Array||h instanceof ArrayBuffer),H=h=>h&&(h instanceof Uint8Array||h instanceof Int8Array||h instanceof ArrayBuffer),K=h=>j(h)||G("Value is not of a supported TypedArray type."),U=new TextDecoder("utf-8"),he=function(h,p,m){return U.decode(N(h,p,m))},_=function(h){return H(h)?he(h instanceof ArrayBuffer?new Uint8Array(h):h):Array.isArray(h)?h.join(""):(d.isPtr(h)&&(h=d.cstrToJs(h)),h)};class S extends Error{constructor(...p){p.length===2&&typeof p[1]=="object"?super(...p):p.length?super(p.join(" ")):super("Allocation failed."),this.resultCode=u.SQLITE_NOMEM,this.name="WasmAllocError"}}S.toss=(...h)=>{throw new S(...h)},Object.assign(u,{sqlite3_bind_blob:void 0,sqlite3_bind_text:void 0,sqlite3_create_function_v2:(h,p,m,L,X,oe,ue,_e,pe)=>{},sqlite3_create_function:(h,p,m,L,X,oe,ue,_e)=>{},sqlite3_create_window_function:(h,p,m,L,X,oe,ue,_e,pe,ce)=>{},sqlite3_prepare_v3:(h,p,m,L,X,oe)=>{},sqlite3_prepare_v2:(h,p,m,L,X)=>{},sqlite3_exec:(h,p,m,L,X)=>{},sqlite3_randomness:(h,p)=>{}});const T={affirmBindableTypedArray:K,flexibleString:_,bigIntFits32:F,bigIntFits64:se,bigIntFitsDouble:y,isBindableTypedArray:j,isInt32:ee,isSQLableTypedArray:H,isTypedArray:g,typedArrayToString:he,isUIThread:()=>globalThis.window===globalThis&&!!globalThis.document,isSharedTypedArray:O,toss:function(...h){throw new Error(h.join(" "))},toss3:G,typedArrayPart:N,affirmDbHeader:function(h){h instanceof ArrayBuffer&&(h=new Uint8Array(h));const p="SQLite format 3";p.length>h.byteLength&&G("Input does not contain an SQLite3 database header.");for(let m=0;m<p.length;++m)p.charCodeAt(m)!==h[m]&&G("Input does not contain an SQLite3 database header.")},affirmIsDb:function(h){h instanceof ArrayBuffer&&(h=new Uint8Array(h));const p=h.byteLength;(p<512||p%512!==0)&&G("Byte array size",p,"is invalid for an SQLite3 db."),T.affirmDbHeader(h)}};Object.assign(d,{ptrSizeof:a.wasmPtrSizeof||4,ptrIR:a.wasmPtrIR||"i32",bigIntEnabled:!!a.bigIntEnabled,exports:a.exports||G("Missing API config.exports (WASM module exports)."),memory:a.memory||a.exports.memory||G("API config object requires a WebAssembly.Memory object","in either config.exports.memory (exported)","or config.memory (imported)."),alloc:void 0,realloc:void 0,dealloc:void 0}),d.allocFromTypedArray=function(h){h instanceof ArrayBuffer&&(h=new Uint8Array(h)),K(h);const p=d.alloc(h.byteLength||1);return d.heapForSize(h.constructor).set(h.byteLength?h:[0],p),p};{const h=a.allocExportName,p=a.deallocExportName,m=a.reallocExportName;for(const L of[h,p,m])d.exports[L]instanceof Function||G("Missing required exports[",L,"] function.");d.alloc=function L(X){return L.impl(X)||S.toss("Failed to allocate",X," bytes.")},d.alloc.impl=d.exports[h],d.realloc=function L(X,oe){const ue=L.impl(X,oe);return oe?ue||S.toss("Failed to reallocate",oe," bytes."):0},d.realloc.impl=d.exports[m],d.dealloc=d.exports[p]}d.compileOptionUsed=function h(p){if(arguments.length){if(Array.isArray(p)){const m={};return p.forEach(L=>{m[L]=u.sqlite3_compileoption_used(L)}),m}else if(typeof p=="object")return Object.keys(p).forEach(m=>{p[m]=u.sqlite3_compileoption_used(m)}),p}else{if(h._result)return h._result;h._opt||(h._rx=/^([^=]+)=(.+)/,h._rxInt=/^-?\d+$/,h._opt=function(ue,_e){const pe=h._rx.exec(ue);_e[0]=pe?pe[1]:ue,_e[1]=pe?h._rxInt.test(pe[2])?+pe[2]:pe[2]:!0});const m={},L=[0,0];let X=0,oe;for(;oe=u.sqlite3_compileoption_get(X++);)h._opt(oe,L),m[L[0]]=L[1];return h._result=m}return typeof p=="string"?!!u.sqlite3_compileoption_used(p):!1},d.pstack=Object.assign(Object.create(null),{restore:d.exports.sqlite3_wasm_pstack_restore,alloc:function(h){return typeof h=="string"&&!(h=d.sizeofIR(h))&&S.toss("Invalid value for pstack.alloc(",arguments[0],")"),d.exports.sqlite3_wasm_pstack_alloc(h)||S.toss("Could not allocate",h,"bytes from the pstack.")},allocChunks:function(h,p){typeof p=="string"&&!(p=d.sizeofIR(p))&&S.toss("Invalid size value for allocChunks(",arguments[1],")");const m=d.pstack.alloc(h*p),L=[];let X=0,oe=0;for(;X<h;++X,oe+=p)L.push(m+oe);return L},allocPtr:(h=1,p=!0)=>h===1?d.pstack.alloc(p?8:d.ptrSizeof):d.pstack.allocChunks(h,p?8:d.ptrSizeof),call:function(h){const p=d.pstack.pointer;try{return h(x)}finally{d.pstack.restore(p)}}}),Object.defineProperties(d.pstack,{pointer:{configurable:!1,iterable:!0,writeable:!1,get:d.exports.sqlite3_wasm_pstack_ptr},quota:{configurable:!1,iterable:!0,writeable:!1,get:d.exports.sqlite3_wasm_pstack_quota},remaining:{configurable:!1,iterable:!0,writeable:!1,get:d.exports.sqlite3_wasm_pstack_remaining}}),u.sqlite3_randomness=(...h)=>{if(h.length===1&&T.isTypedArray(h[0])&&h[0].BYTES_PER_ELEMENT===1){const p=h[0];if(p.byteLength===0)return d.exports.sqlite3_randomness(0,0),p;const m=d.pstack.pointer;try{let L=p.byteLength,X=0;const oe=d.exports.sqlite3_randomness,ue=d.heap8u(),_e=L<512?L:512,pe=d.pstack.alloc(_e);do{const ce=L>_e?_e:L;oe(ce,pe),p.set(N(ue,pe,pe+ce),X),L-=ce,X+=ce}while(L>0)}catch(L){console.error("Highly unexpected (and ignored!) exception in sqlite3_randomness():",L)}finally{d.pstack.restore(m)}return p}d.exports.sqlite3_randomness(...h)};let $;if(u.sqlite3_wasmfs_opfs_dir=function(){if($!==void 0)return $;const h=a.wasmfsOpfsDir;if(!h||!globalThis.FileSystemHandle||!globalThis.FileSystemDirectoryHandle||!globalThis.FileSystemFileHandle)return $="";try{return h&&d.xCallWrapped("sqlite3_wasm_init_wasmfs","i32",["string"],h)===0?$=h:$=""}catch{return $=""}},u.sqlite3_wasmfs_filename_is_persistent=function(h){const p=u.sqlite3_wasmfs_opfs_dir();return p&&h?h.startsWith(p+"/"):!1},u.sqlite3_js_db_uses_vfs=function(h,p,m=0){try{const L=u.sqlite3_vfs_find(p);return L?h?L===u.sqlite3_js_db_vfs(h,m)?L:!1:L===u.sqlite3_vfs_find(0)?L:!1:!1}catch{return!1}},u.sqlite3_js_vfs_list=function(){const h=[];let p=u.sqlite3_vfs_find(0);for(;p;){const m=new u.sqlite3_vfs(p);h.push(d.cstrToJs(m.$zName)),p=m.$pNext,m.dispose()}return h},u.sqlite3_js_db_export=function(h,p=0){h=d.xWrap.testConvertArg("sqlite3*",h),h||G("Invalid sqlite3* argument."),d.bigIntEnabled||G("BigInt64 support is not enabled.");const m=d.scopedAllocPush();let L;try{const X=d.scopedAlloc(8+d.ptrSizeof),oe=X+8,ue=p?d.isPtr(p)?p:d.scopedAllocCString(""+p):0;let _e=d.exports.sqlite3_wasm_db_serialize(h,ue,oe,X,0);_e&&G("Database serialization failed with code",x.capi.sqlite3_js_rc_str(_e)),L=d.peekPtr(oe);const pe=d.peek(X,"i64");return _e=pe?d.heap8u().slice(L,L+Number(pe)):new Uint8Array,_e}finally{L&&d.exports.sqlite3_free(L),d.scopedAllocPop(m)}},u.sqlite3_js_db_vfs=(h,p=0)=>d.sqlite3_wasm_db_vfs(h,p),u.sqlite3_js_aggregate_context=(h,p)=>u.sqlite3_aggregate_context(h,p)||(p?S.toss("Cannot allocate",p,"bytes for sqlite3_aggregate_context()"):0),u.sqlite3_js_posix_create_file=function(h,p,m){let L;p&&d.isPtr(p)?L=p:p instanceof ArrayBuffer||p instanceof Uint8Array?(L=d.allocFromTypedArray(p),(arguments.length<3||!T.isInt32(m)||m<0)&&(m=p.byteLength)):D.toss("Invalid 2nd argument for sqlite3_js_posix_create_file().");try{(!T.isInt32(m)||m<0)&&D.toss("Invalid 3rd argument for sqlite3_js_posix_create_file().");const X=d.sqlite3_wasm_posix_create_file(h,L,m);X&&D.toss("Creation of file failed with sqlite3 result code",u.sqlite3_js_rc_str(X))}finally{d.dealloc(L)}},u.sqlite3_js_vfs_create_file=function(h,p,m,L){a.warn("sqlite3_js_vfs_create_file() is deprecated and","should be avoided because it can lead to C-level crashes.","See its documentation for alternative options.");let X;m?(d.isPtr(m)?X=m:m instanceof ArrayBuffer&&(m=new Uint8Array(m)),m instanceof Uint8Array?(X=d.allocFromTypedArray(m),(arguments.length<4||!T.isInt32(L)||L<0)&&(L=m.byteLength)):D.toss("Invalid 3rd argument type for sqlite3_js_vfs_create_file().")):X=0,(!T.isInt32(L)||L<0)&&(d.dealloc(X),D.toss("Invalid 4th argument for sqlite3_js_vfs_create_file()."));try{const oe=d.sqlite3_wasm_vfs_create_file(h,p,X,L);oe&&D.toss("Creation of file failed with sqlite3 result code",u.sqlite3_js_rc_str(oe))}finally{d.dealloc(X)}},u.sqlite3_js_sql_to_string=h=>{if(typeof h=="string")return h;const p=_(v);return p===v?void 0:p},T.isUIThread()){const h=function(p){const m=Object.create(null);return m.prefix="kvvfs-"+p,m.stores=[],(p==="session"||p==="")&&m.stores.push(globalThis.sessionStorage),(p==="local"||p==="")&&m.stores.push(globalThis.localStorage),m};u.sqlite3_js_kvvfs_clear=function(p=""){let m=0;const L=h(p);return L.stores.forEach(X=>{const oe=[];let ue;for(ue=0;ue<X.length;++ue){const _e=X.key(ue);_e.startsWith(L.prefix)&&oe.push(_e)}oe.forEach(_e=>X.removeItem(_e)),m+=oe.length}),m},u.sqlite3_js_kvvfs_size=function(p=""){let m=0;const L=h(p);return L.stores.forEach(X=>{let oe;for(oe=0;oe<X.length;++oe){const ue=X.key(oe);ue.startsWith(L.prefix)&&(m+=ue.length,m+=X.getItem(ue).length)}}),m*2}}u.sqlite3_db_config=function(h,p,...m){switch(this.s||(this.s=d.xWrap("sqlite3_wasm_db_config_s","int",["sqlite3*","int","string:static"]),this.pii=d.xWrap("sqlite3_wasm_db_config_pii","int",["sqlite3*","int","*","int","int"]),this.ip=d.xWrap("sqlite3_wasm_db_config_ip","int",["sqlite3*","int","int","*"])),p){case u.SQLITE_DBCONFIG_ENABLE_FKEY:case u.SQLITE_DBCONFIG_ENABLE_TRIGGER:case u.SQLITE_DBCONFIG_ENABLE_FTS3_TOKENIZER:case u.SQLITE_DBCONFIG_ENABLE_LOAD_EXTENSION:case u.SQLITE_DBCONFIG_NO_CKPT_ON_CLOSE:case u.SQLITE_DBCONFIG_ENABLE_QPSG:case u.SQLITE_DBCONFIG_TRIGGER_EQP:case u.SQLITE_DBCONFIG_RESET_DATABASE:case u.SQLITE_DBCONFIG_DEFENSIVE:case u.SQLITE_DBCONFIG_WRITABLE_SCHEMA:case u.SQLITE_DBCONFIG_LEGACY_ALTER_TABLE:case u.SQLITE_DBCONFIG_DQS_DML:case u.SQLITE_DBCONFIG_DQS_DDL:case u.SQLITE_DBCONFIG_ENABLE_VIEW:case u.SQLITE_DBCONFIG_LEGACY_FILE_FORMAT:case u.SQLITE_DBCONFIG_TRUSTED_SCHEMA:case u.SQLITE_DBCONFIG_STMT_SCANSTATUS:case u.SQLITE_DBCONFIG_REVERSE_SCANORDER:return this.ip(h,p,m[0],m[1]||0);case u.SQLITE_DBCONFIG_LOOKASIDE:return this.pii(h,p,m[0],m[1],m[2]);case u.SQLITE_DBCONFIG_MAINDBNAME:return this.s(h,p,m[0]);default:return u.SQLITE_MISUSE}}.bind(Object.create(null)),u.sqlite3_value_to_js=function(h,p=!0){let m;const L=u.sqlite3_value_type(h);switch(L){case u.SQLITE_INTEGER:d.bigIntEnabled?(m=u.sqlite3_value_int64(h),T.bigIntFitsDouble(m)&&(m=Number(m))):m=u.sqlite3_value_double(h);break;case u.SQLITE_FLOAT:m=u.sqlite3_value_double(h);break;case u.SQLITE_TEXT:m=u.sqlite3_value_text(h);break;case u.SQLITE_BLOB:{const X=u.sqlite3_value_bytes(h),oe=u.sqlite3_value_blob(h);X&&!oe&&x.WasmAllocError.toss("Cannot allocate memory for blob argument of",X,"byte(s)"),m=X?d.heap8u().slice(oe,oe+Number(X)):null;break}case u.SQLITE_NULL:m=null;break;default:p&&G(u.SQLITE_MISMATCH,"Unhandled sqlite3_value_type():",L),m=void 0}return m},u.sqlite3_values_to_js=function(h,p,m=!0){let L;const X=[];for(L=0;L<h;++L)X.push(u.sqlite3_value_to_js(d.peekPtr(p+d.ptrSizeof*L),m));return X},u.sqlite3_result_error_js=function(h,p){p instanceof S?u.sqlite3_result_error_nomem(h):u.sqlite3_result_error(h,""+p,-1)},u.sqlite3_result_js=function(h,p){if(p instanceof Error){u.sqlite3_result_error_js(h,p);return}try{switch(typeof p){case"undefined":break;case"boolean":u.sqlite3_result_int(h,p?1:0);break;case"bigint":T.bigIntFits32(p)?u.sqlite3_result_int(h,Number(p)):T.bigIntFitsDouble(p)?u.sqlite3_result_double(h,Number(p)):d.bigIntEnabled?T.bigIntFits64(p)?u.sqlite3_result_int64(h,p):G("BigInt value",p.toString(),"is too BigInt for int64."):G("BigInt value",p.toString(),"is too BigInt.");break;case"number":{let m;T.isInt32(p)?m=u.sqlite3_result_int:d.bigIntEnabled&&Number.isInteger(p)&&T.bigIntFits64(BigInt(p))?m=u.sqlite3_result_int64:m=u.sqlite3_result_double,m(h,p);break}case"string":{const[m,L]=d.allocCString(p,!0);u.sqlite3_result_text(h,m,L,u.SQLITE_WASM_DEALLOC);break}case"object":if(p===null){u.sqlite3_result_null(h);break}else if(T.isBindableTypedArray(p)){const m=d.allocFromTypedArray(p);u.sqlite3_result_blob(h,m,p.byteLength,u.SQLITE_WASM_DEALLOC);break}default:G("Don't not how to handle this UDF result value:",typeof p,p)}}catch(m){u.sqlite3_result_error_js(h,m)}},u.sqlite3_column_js=function(h,p,m=!0){const L=u.sqlite3_column_value(h,p);return L===0?void 0:u.sqlite3_value_to_js(L,m)};const w=function(h,p,m){m=u[m],this.ptr?d.pokePtr(this.ptr,0):this.ptr=d.allocPtr();const L=m(h,p,this.ptr);if(L)return D.toss(L,arguments[2]+"() failed with code "+L);const X=d.peekPtr(this.ptr);return X?u.sqlite3_value_to_js(X,!0):void 0}.bind(Object.create(null));u.sqlite3_preupdate_new_js=(h,p)=>w(h,p,"sqlite3_preupdate_new"),u.sqlite3_preupdate_old_js=(h,p)=>w(h,p,"sqlite3_preupdate_old"),u.sqlite3changeset_new_js=(h,p)=>w(h,p,"sqlite3changeset_new"),u.sqlite3changeset_old_js=(h,p)=>w(h,p,"sqlite3changeset_old");const x={WasmAllocError:S,SQLite3Error:D,capi:u,util:T,wasm:d,config:a,version:Object.create(null),client:void 0,asyncPostInit:async function h(){if(h.isReady instanceof Promise)return h.isReady;let p=s.initializersAsync;delete s.initializersAsync;const m=async()=>(x.__isUnderTest||(delete x.util,delete x.StructBinder),x),L=oe=>{throw a.error("an async sqlite3 initializer failed:",oe),oe};if(!p||!p.length)return h.isReady=m().catch(L);p=p.map(oe=>oe instanceof Function?async ue=>oe(x):oe),p.push(m);let X=Promise.resolve(x);for(;p.length;)X=X.then(p.shift());return h.isReady=X.catch(L)},scriptInfo:void 0};try{s.initializers.forEach(h=>{h(x)})}catch(h){throw console.error("sqlite3 bootstrap initializer threw:",h),h}return delete s.initializers,s.sqlite3=x,x},globalThis.sqlite3ApiBootstrap.initializers=[],globalThis.sqlite3ApiBootstrap.initializersAsync=[],globalThis.sqlite3ApiBootstrap.defaultConfig=Object.create(null),globalThis.sqlite3ApiBootstrap.sqlite3=void 0,globalThis.WhWasmUtilInstaller=function(s){s.bigIntEnabled===void 0&&(s.bigIntEnabled=!!globalThis.BigInt64Array);const l=(..._)=>{throw new Error(_.join(" "))};s.exports||Object.defineProperty(s,"exports",{enumerable:!0,configurable:!0,get:()=>s.instance&&s.instance.exports});const a=s.pointerIR||"i32",u=s.ptrSizeof=a==="i32"?4:a==="i64"?8:l("Unhandled ptrSizeof:",a),d=Object.create(null);d.heapSize=0,d.memory=null,d.freeFuncIndexes=[],d.scopedAlloc=[],d.utf8Decoder=new TextDecoder,d.utf8Encoder=new TextEncoder("utf-8"),s.sizeofIR=_=>{switch(_){case"i8":return 1;case"i16":return 2;case"i32":case"f32":case"float":return 4;case"i64":case"f64":case"double":return 8;case"*":return u;default:return(""+_).endsWith("*")?u:void 0}};const q=function(){if(!d.memory)d.memory=s.memory instanceof WebAssembly.Memory?s.memory:s.exports.memory;else if(d.heapSize===d.memory.buffer.byteLength)return d;const _=d.memory.buffer;return d.HEAP8=new Int8Array(_),d.HEAP8U=new Uint8Array(_),d.HEAP16=new Int16Array(_),d.HEAP16U=new Uint16Array(_),d.HEAP32=new Int32Array(_),d.HEAP32U=new Uint32Array(_),s.bigIntEnabled&&(d.HEAP64=new BigInt64Array(_),d.HEAP64U=new BigUint64Array(_)),d.HEAP32F=new Float32Array(_),d.HEAP64F=new Float64Array(_),d.heapSize=_.byteLength,d};s.heap8=()=>q().HEAP8,s.heap8u=()=>q().HEAP8U,s.heap16=()=>q().HEAP16,s.heap16u=()=>q().HEAP16U,s.heap32=()=>q().HEAP32,s.heap32u=()=>q().HEAP32U,s.heapForSize=function(_,S=!0){const T=d.memory&&d.heapSize===d.memory.buffer.byteLength?d:q();switch(_){case Int8Array:return T.HEAP8;case Uint8Array:return T.HEAP8U;case Int16Array:return T.HEAP16;case Uint16Array:return T.HEAP16U;case Int32Array:return T.HEAP32;case Uint32Array:return T.HEAP32U;case 8:return S?T.HEAP8U:T.HEAP8;case 16:return S?T.HEAP16U:T.HEAP16;case 32:return S?T.HEAP32U:T.HEAP32;case 64:if(T.HEAP64)return S?T.HEAP64U:T.HEAP64;break;default:if(s.bigIntEnabled){if(_===globalThis.BigUint64Array)return T.HEAP64U;if(_===globalThis.BigInt64Array)return T.HEAP64;break}}l("Invalid heapForSize() size: expecting 8, 16, 32,","or (if BigInt is enabled) 64.")},s.functionTable=function(){return s.exports.__indirect_function_table},s.functionEntry=function(_){const S=s.functionTable();return _<S.length?S.get(_):void 0},s.jsFuncToWasm=function _(S,T){if(_._||(_._={sigTypes:Object.assign(Object.create(null),{i:"i32",p:"i32",P:"i32",s:"i32",j:"i64",f:"f32",d:"f64"}),typeCodes:Object.assign(Object.create(null),{f64:124,f32:125,i64:126,i32:127}),uleb128Encode:function(x,h,p){p<128?x[h](p):x[h](p%128|128,p>>7)},rxJSig:/^(\w)\((\w*)\)$/,sigParams:function(x){const h=_._.rxJSig.exec(x);return h?h[2]:x.substr(1)},letterType:x=>_._.sigTypes[x]||l("Invalid signature letter:",x),pushSigType:(x,h)=>x.push(_._.typeCodes[_._.letterType(h)])}),typeof S=="string"){const x=T;T=S,S=x}const $=_._.sigParams(T),w=[1,96];_._.uleb128Encode(w,"push",$.length);for(const x of $)_._.pushSigType(w,x);return T[0]==="v"?w.push(0):(w.push(1),_._.pushSigType(w,T[0])),_._.uleb128Encode(w,"unshift",w.length),w.unshift(0,97,115,109,1,0,0,0,1),w.push(2,7,1,1,101,1,102,0,0,7,5,1,1,102,0,0),new WebAssembly.Instance(new WebAssembly.Module(new Uint8Array(w)),{e:{f:S}}).exports.f};const k=function(S,T,$){if($&&!d.scopedAlloc.length&&l("No scopedAllocPush() scope is active."),typeof S=="string"){const p=T;T=S,S=p}(typeof T!="string"||!(S instanceof Function))&&l("Invalid arguments: expecting (function,signature) or (signature,function).");const w=s.functionTable(),x=w.length;let h;for(;d.freeFuncIndexes.length&&(h=d.freeFuncIndexes.pop(),w.get(h));){h=null;continue}h||(h=x,w.grow(1));try{return w.set(h,S),$&&d.scopedAlloc[d.scopedAlloc.length-1].push(h),h}catch(p){if(!(p instanceof TypeError))throw h===x&&d.freeFuncIndexes.push(x),p}try{const p=s.jsFuncToWasm(S,T);w.set(h,p),$&&d.scopedAlloc[d.scopedAlloc.length-1].push(h)}catch(p){throw h===x&&d.freeFuncIndexes.push(x),p}return h};s.installFunction=(_,S)=>k(_,S,!1),s.scopedInstallFunction=(_,S)=>k(_,S,!0),s.uninstallFunction=function(_){if(!_&&_!==0)return;const S=d.freeFuncIndexes,T=s.functionTable();S.push(_);const $=T.get(_);return T.set(_,null),$},s.peek=function(S,T="i8"){T.endsWith("*")&&(T=a);const $=d.memory&&d.heapSize===d.memory.buffer.byteLength?d:q(),w=Array.isArray(S)?[]:void 0;let x;do{switch(w&&(S=arguments[0].shift()),T){case"i1":case"i8":x=$.HEAP8[S>>0];break;case"i16":x=$.HEAP16[S>>1];break;case"i32":x=$.HEAP32[S>>2];break;case"float":case"f32":x=$.HEAP32F[S>>2];break;case"double":case"f64":x=Number($.HEAP64F[S>>3]);break;case"i64":if(s.bigIntEnabled){x=BigInt($.HEAP64[S>>3]);break}default:l("Invalid type for peek():",T)}w&&w.push(x)}while(w&&arguments[0].length);return w||x},s.poke=function(_,S,T="i8"){T.endsWith("*")&&(T=a);const $=d.memory&&d.heapSize===d.memory.buffer.byteLength?d:q();for(const w of Array.isArray(_)?_:[_])switch(T){case"i1":case"i8":$.HEAP8[w>>0]=S;continue;case"i16":$.HEAP16[w>>1]=S;continue;case"i32":$.HEAP32[w>>2]=S;continue;case"float":case"f32":$.HEAP32F[w>>2]=S;continue;case"double":case"f64":$.HEAP64F[w>>3]=S;continue;case"i64":if($.HEAP64){$.HEAP64[w>>3]=BigInt(S);continue}default:l("Invalid type for poke(): "+T)}return this},s.peekPtr=(..._)=>s.peek(_.length===1?_[0]:_,a),s.pokePtr=(_,S=0)=>s.poke(_,S,a),s.peek8=(..._)=>s.peek(_.length===1?_[0]:_,"i8"),s.poke8=(_,S)=>s.poke(_,S,"i8"),s.peek16=(..._)=>s.peek(_.length===1?_[0]:_,"i16"),s.poke16=(_,S)=>s.poke(_,S,"i16"),s.peek32=(..._)=>s.peek(_.length===1?_[0]:_,"i32"),s.poke32=(_,S)=>s.poke(_,S,"i32"),s.peek64=(..._)=>s.peek(_.length===1?_[0]:_,"i64"),s.poke64=(_,S)=>s.poke(_,S,"i64"),s.peek32f=(..._)=>s.peek(_.length===1?_[0]:_,"f32"),s.poke32f=(_,S)=>s.poke(_,S,"f32"),s.peek64f=(..._)=>s.peek(_.length===1?_[0]:_,"f64"),s.poke64f=(_,S)=>s.poke(_,S,"f64"),s.getMemValue=s.peek,s.getPtrValue=s.peekPtr,s.setMemValue=s.poke,s.setPtrValue=s.pokePtr,s.isPtr32=_=>typeof _=="number"&&_===(_|0)&&_>=0,s.isPtr=s.isPtr32,s.cstrlen=function(_){if(!_||!s.isPtr(_))return null;const S=q().HEAP8U;let T=_;for(;S[T]!==0;++T);return T-_};const D=typeof SharedArrayBuffer>"u"?function(){}:SharedArrayBuffer,G=function(_,S,T){return d.utf8Decoder.decode(_.buffer instanceof D?_.slice(S,T):_.subarray(S,T))};s.cstrToJs=function(_){const S=s.cstrlen(_);return S?G(q().HEAP8U,_,_+S):S===null?S:""},s.jstrlen=function(_){if(typeof _!="string")return null;const S=_.length;let T=0;for(let $=0;$<S;++$){let w=_.charCodeAt($);w>=55296&&w<=57343&&(w=65536+((w&1023)<<10)|_.charCodeAt(++$)&1023),w<=127?++T:w<=2047?T+=2:w<=65535?T+=3:T+=4}return T},s.jstrcpy=function(_,S,T=0,$=-1,w=!0){if((!S||!(S instanceof Int8Array)&&!(S instanceof Uint8Array))&&l("jstrcpy() target must be an Int8Array or Uint8Array."),$<0&&($=S.length-T),!($>0)||!(T>=0))return 0;let x=0,h=_.length;const p=T,m=T+$-(w?1:0);for(;x<h&&T<m;++x){let L=_.charCodeAt(x);if(L>=55296&&L<=57343&&(L=65536+((L&1023)<<10)|_.charCodeAt(++x)&1023),L<=127){if(T>=m)break;S[T++]=L}else if(L<=2047){if(T+1>=m)break;S[T++]=192|L>>6,S[T++]=128|L&63}else if(L<=65535){if(T+2>=m)break;S[T++]=224|L>>12,S[T++]=128|L>>6&63,S[T++]=128|L&63}else{if(T+3>=m)break;S[T++]=240|L>>18,S[T++]=128|L>>12&63,S[T++]=128|L>>6&63,S[T++]=128|L&63}}return w&&(S[T++]=0),T-p},s.cstrncpy=function(_,S,T){if((!_||!S)&&l("cstrncpy() does not accept NULL strings."),T<0)T=s.cstrlen(strPtr)+1;else if(!(T>0))return 0;const $=s.heap8u();let w=0,x;for(;w<T&&(x=$[S+w]);++w)$[_+w]=x;return w<T&&($[_+w++]=0),w},s.jstrToUintArray=(_,S=!1)=>d.utf8Encoder.encode(S?_+"\0":_);const ee=(_,S)=>{(!(_.alloc instanceof Function)||!(_.dealloc instanceof Function))&&l("Object is missing alloc() and/or dealloc() function(s)","required by",S+"().")},se=function(_,S,T,$){if(ee(s,$),typeof _!="string")return null;{const w=d.utf8Encoder.encode(_),x=T(w.length+1),h=q().HEAP8U;return h.set(w,x),h[x+w.length]=0,S?[x,w.length]:x}};s.allocCString=(_,S=!1)=>se(_,S,s.alloc,"allocCString()"),s.scopedAllocPush=function(){ee(s,"scopedAllocPush");const _=[];return d.scopedAlloc.push(_),_},s.scopedAllocPop=function(_){ee(s,"scopedAllocPop");const S=arguments.length?d.scopedAlloc.indexOf(_):d.scopedAlloc.length-1;S<0&&l("Invalid state object for scopedAllocPop()."),arguments.length===0&&(_=d.scopedAlloc[S]),d.scopedAlloc.splice(S,1);for(let T;T=_.pop();)s.functionEntry(T)?s.uninstallFunction(T):s.dealloc(T)},s.scopedAlloc=function(_){d.scopedAlloc.length||l("No scopedAllocPush() scope is active.");const S=s.alloc(_);return d.scopedAlloc[d.scopedAlloc.length-1].push(S),S},Object.defineProperty(s.scopedAlloc,"level",{configurable:!1,enumerable:!1,get:()=>d.scopedAlloc.length,set:()=>l("The 'active' property is read-only.")}),s.scopedAllocCString=(_,S=!1)=>se(_,S,s.scopedAlloc,"scopedAllocCString()");const F=function(_,S){const T=s[_?"scopedAlloc":"alloc"]((S.length+1)*s.ptrSizeof);let $=0;return S.forEach(w=>{s.pokePtr(T+s.ptrSizeof*$++,s[_?"scopedAllocCString":"allocCString"](""+w))}),s.pokePtr(T+s.ptrSizeof*$,0),T};s.scopedAllocMainArgv=_=>F(!0,_),s.allocMainArgv=_=>F(!1,_),s.cArgvToJs=(_,S)=>{const T=[];for(let $=0;$<_;++$){const w=s.peekPtr(S+s.ptrSizeof*$);T.push(w?s.cstrToJs(w):null)}return T},s.scopedAllocCall=function(_){s.scopedAllocPush();try{return _()}finally{s.scopedAllocPop()}};const y=function(_,S,T){ee(s,T);const $=S?"i64":a;let w=s[T](_*(S?8:u));if(s.poke(w,0,$),_===1)return w;const x=[w];for(let h=1;h<_;++h)w+=S?8:u,x[h]=w,s.poke(w,0,$);return x};s.allocPtr=(_=1,S=!0)=>y(_,S,"alloc"),s.scopedAllocPtr=(_=1,S=!0)=>y(_,S,"scopedAlloc"),s.xGet=function(_){return s.exports[_]||l("Cannot find exported symbol:",_)};const g=(_,S)=>l(_+"() requires",S,"argument(s).");s.xCall=function(_,...S){const T=s.xGet(_);return T instanceof Function||l("Exported symbol",_,"is not a function."),T.length!==S.length&&g(_,T.length),arguments.length===2&&Array.isArray(arguments[1])?T.apply(null,arguments[1]):T.apply(null,S)},d.xWrap=Object.create(null),d.xWrap.convert=Object.create(null),d.xWrap.convert.arg=new Map,d.xWrap.convert.result=new Map;const E=d.xWrap.convert.arg,O=d.xWrap.convert.result;s.bigIntEnabled&&E.set("i64",_=>BigInt(_));const N=a==="i32"?_=>_|0:_=>BigInt(_)|BigInt(0);E.set("i32",N).set("i16",_=>(_|0)&65535).set("i8",_=>(_|0)&255).set("f32",_=>Number(_).valueOf()).set("float",E.get("f32")).set("f64",E.get("f32")).set("double",E.get("f64")).set("int",E.get("i32")).set("null",_=>_).set(null,E.get("null")).set("**",N).set("*",N),O.set("*",N).set("pointer",N).set("number",_=>Number(_)).set("void",_=>{}).set("null",_=>_).set(null,O.get("null"));{const _=["i8","i16","i32","int","f32","float","f64","double"];s.bigIntEnabled&&_.push("i64");const S=E.get(a);for(const T of _)E.set(T+"*",S),O.set(T+"*",S),O.set(T,E.get(T)||l("Missing arg converter:",T))}const j=function(_){return typeof _=="string"?s.scopedAllocCString(_):_?N(_):null};E.set("string",j).set("utf8",j).set("pointer",j),O.set("string",_=>s.cstrToJs(_)).set("utf8",O.get("string")).set("string:dealloc",_=>{try{return _?s.cstrToJs(_):null}finally{s.dealloc(_)}}).set("utf8:dealloc",O.get("string:dealloc")).set("json",_=>JSON.parse(s.cstrToJs(_))).set("json:dealloc",_=>{try{return _?JSON.parse(s.cstrToJs(_)):null}finally{s.dealloc(_)}});const H=class{constructor(_){this.name=_.name||"unnamed adapter"}convertArg(_,S,T){l("AbstractArgAdapter must be subclassed.")}};E.FuncPtrAdapter=class yn extends H{constructor(S){super(S),E.FuncPtrAdapter.warnOnUse&&console.warn("xArg.FuncPtrAdapter is an internal-only API","and is not intended to be invoked from","client-level code. Invoked with:",S),this.name=S.name||"unnamed",this.signature=S.signature,S.contextKey instanceof Function&&(this.contextKey=S.contextKey,S.bindScope||(S.bindScope="context")),this.bindScope=S.bindScope||l("FuncPtrAdapter options requires a bindScope (explicit or implied)."),yn.bindScopes.indexOf(S.bindScope)<0&&l("Invalid options.bindScope ("+S.bindMod+") for FuncPtrAdapter. Expecting one of: ("+yn.bindScopes.join(", ")+")"),this.isTransient=this.bindScope==="transient",this.isContext=this.bindScope==="context",this.isPermanent=this.bindScope==="permanent",this.singleton=this.bindScope==="singleton"?[]:void 0,this.callProxy=S.callProxy instanceof Function?S.callProxy:void 0}contextKey(S,T){return this}contextMap(S){const T=this.__cmap||(this.__cmap=new Map);let $=T.get(S);return $===void 0&&T.set(S,$=[]),$}convertArg(S,T,$){let w=this.singleton;if(!w&&this.isContext&&(w=this.contextMap(this.contextKey(T,$))),w&&w[0]===S)return w[1];if(S instanceof Function){this.callProxy&&(S=this.callProxy(S));const x=k(S,this.signature,this.isTransient);if(yn.debugFuncInstall&&yn.debugOut("FuncPtrAdapter installed",this,this.contextKey(T,$),"@"+x,S),w){if(w[1]){yn.debugFuncInstall&&yn.debugOut("FuncPtrAdapter uninstalling",this,this.contextKey(T,$),"@"+w[1],S);try{d.scopedAlloc[d.scopedAlloc.length-1].push(w[1])}catch{}}w[0]=S,w[1]=x}return x}else if(s.isPtr(S)||S===null||S===void 0){if(w&&w[1]&&w[1]!==S){yn.debugFuncInstall&&yn.debugOut("FuncPtrAdapter uninstalling",this,this.contextKey(T,$),"@"+w[1],S);try{d.scopedAlloc[d.scopedAlloc.length-1].push(w[1])}catch{}w[0]=w[1]=S|0}return S||0}else throw new TypeError("Invalid FuncPtrAdapter argument type. Expecting a function pointer or a "+(this.name?this.name+" ":"")+"function matching signature "+this.signature+".")}},E.FuncPtrAdapter.warnOnUse=!1,E.FuncPtrAdapter.debugFuncInstall=!1,E.FuncPtrAdapter.debugOut=console.debug.bind(console),E.FuncPtrAdapter.bindScopes=["transient","context","singleton","permanent"];const K=_=>E.get(_)||l("Argument adapter not found:",_),U=_=>O.get(_)||l("Result adapter not found:",_);d.xWrap.convertArg=(_,...S)=>K(_)(...S),d.xWrap.convertArgNoCheck=(_,...S)=>E.get(_)(...S),d.xWrap.convertResult=(_,S)=>_===null?S:_?U(_)(S):void 0,d.xWrap.convertResultNoCheck=(_,S)=>_===null?S:_?O.get(_)(S):void 0,s.xWrap=function(_,S,...T){arguments.length===3&&Array.isArray(arguments[2])&&(T=arguments[2]),s.isPtr(_)&&(_=s.functionEntry(_)||l("Function pointer not found in WASM function table."));const $=_ instanceof Function,w=$?_:s.xGet(_);if($&&(_=w.name||"unnamed function"),T.length!==w.length&&g(_,w.length),S===null&&w.length===0)return w;S!=null&&U(S);for(const h of T)h instanceof H?E.set(h,(...p)=>h.convertArg(...p)):K(h);const x=d.xWrap;return w.length===0?(...h)=>h.length?g(_,w.length):x.convertResult(S,w.call(null)):function(...h){h.length!==w.length&&g(_,w.length);const p=s.scopedAllocPush();try{for(const m in h)h[m]=x.convertArgNoCheck(T[m],h[m],h,m);return x.convertResultNoCheck(S,w.apply(null,h))}finally{s.scopedAllocPop(p)}}};const he=function(_,S,T,$,w,x){if(typeof T=="string"){if(S===1)return x.get(T);if(S===2){if($)$ instanceof Function||l(w,"requires a function argument.");else return delete x.get(T),_;return x.set(T,$),_}}l("Invalid arguments to",w)};return s.xWrap.resultAdapter=function _(S,T){return he(_,arguments.length,S,T,"resultAdapter()",O)},s.xWrap.argAdapter=function _(S,T){return he(_,arguments.length,S,T,"argAdapter()",E)},s.xWrap.FuncPtrAdapter=E.FuncPtrAdapter,s.xCallWrapped=function(_,S,T,...$){return Array.isArray(arguments[3])&&($=arguments[3]),s.xWrap(_,S,T||[]).apply(null,$||[])},s.xWrap.testConvertArg=d.xWrap.convertArg,s.xWrap.testConvertResult=d.xWrap.convertResult,s},globalThis.WhWasmUtilInstaller.yawl=function(s){const l=()=>fetch(s.uri,{credentials:"same-origin"}),a=this,u=function(q){if(s.wasmUtilTarget){const k=(...G)=>{throw new Error(G.join(" "))},D=s.wasmUtilTarget;if(D.module=q.module,D.instance=q.instance,D.instance.exports.memory||(D.memory=s.imports&&s.imports.env&&s.imports.env.memory||k("Missing 'memory' object!")),!D.alloc&&q.instance.exports.malloc){const G=q.instance.exports;D.alloc=function(ee){return G.malloc(ee)||k("Allocation of",ee,"bytes failed.")},D.dealloc=function(ee){G.free(ee)}}a(D)}return s.onload&&s.onload(q,s),q};return WebAssembly.instantiateStreaming?function(){return WebAssembly.instantiateStreaming(l(),s.imports||{}).then(u)}:function(){return l().then(k=>k.arrayBuffer()).then(k=>WebAssembly.instantiate(k,s.imports||{})).then(u)}}.bind(globalThis.WhWasmUtilInstaller),globalThis.Jaccwabyt=function s(l){const a=(...b)=>{throw new Error(b.join(" "))};!(l.heap instanceof WebAssembly.Memory)&&!(l.heap instanceof Function)&&a("config.heap must be WebAssembly.Memory instance or a function."),["alloc","dealloc"].forEach(function(b){l[b]instanceof Function||a("Config option '"+b+"' must be a function.")});const u=s,d=l.heap instanceof Function?l.heap:()=>new Uint8Array(l.heap.buffer),q=l.alloc,k=l.dealloc,D=l.log||console.log.bind(console),G=l.memberPrefix||"",ee=l.memberSuffix||"",se=l.bigIntEnabled===void 0?!!globalThis.BigInt64Array:!!l.bigIntEnabled,F=globalThis.BigInt,y=globalThis.BigInt64Array,g=l.ptrSizeof||4,E=l.ptrIR||"i32";u.debugFlags||(u.__makeDebugFlags=function(b=null){b&&b.__flags&&(b=b.__flags);const C=function W(M){return arguments.length===0?W.__flags:(M<0?(delete W.__flags.getter,delete W.__flags.setter,delete W.__flags.alloc,delete W.__flags.dealloc):(W.__flags.getter=(1&M)!==0,W.__flags.setter=(2&M)!==0,W.__flags.alloc=(4&M)!==0,W.__flags.dealloc=(8&M)!==0),W._flags)};return Object.defineProperty(C,"__flags",{iterable:!1,writable:!1,value:Object.create(b)}),b||C(0),C},u.debugFlags=u.__makeDebugFlags());const O=function(){const b=new ArrayBuffer(2);return new DataView(b).setInt16(0,256,!0),new Int16Array(b)[0]===256}(),N=b=>b[1]==="(",j=b=>b==="P",H=b=>N(b)?"p":b[0],K=function(b){switch(H(b)){case"c":case"C":return"i8";case"i":return"i32";case"p":case"P":case"s":return E;case"j":return"i64";case"f":return"float";case"d":return"double"}a("Unhandled signature IR:",b)},U=y?()=>!0:()=>a("BigInt64Array is not available."),he=function(b){switch(H(b)){case"p":case"P":case"s":{switch(g){case 4:return"getInt32";case 8:return U()&&"getBigInt64"}break}case"i":return"getInt32";case"c":return"getInt8";case"C":return"getUint8";case"j":return U()&&"getBigInt64";case"f":return"getFloat32";case"d":return"getFloat64"}a("Unhandled DataView getter for signature:",b)},_=function(b){switch(H(b)){case"p":case"P":case"s":{switch(g){case 4:return"setInt32";case 8:return U()&&"setBigInt64"}break}case"i":return"setInt32";case"c":return"setInt8";case"C":return"setUint8";case"j":return U()&&"setBigInt64";case"f":return"setFloat32";case"d":return"setFloat64"}a("Unhandled DataView setter for signature:",b)},S=function(b){switch(H(b)){case"i":case"f":case"c":case"C":case"d":return Number;case"j":return U()&&F;case"p":case"P":case"s":switch(g){case 4:return Number;case 8:return U()&&F}break}a("Unhandled DataView set wrapper for signature:",b)},T=(b,C)=>b+"::"+C,$=function(b,C){return()=>a(T(b,C),"is read-only.")},w=new WeakMap,x="(pointer-is-external)",h=function(b,C,W){if(W||(W=w.get(C)),W){if(w.delete(C),Array.isArray(C.ondispose)){let M;for(;M=C.ondispose.shift();)try{M instanceof Function?M.call(C):M instanceof ae?M.dispose():typeof M=="number"&&k(M)}catch(ne){console.warn("ondispose() for",b.structName,"@",W,"threw. NOT propagating it.",ne)}}else if(C.ondispose instanceof Function)try{C.ondispose()}catch(M){console.warn("ondispose() for",b.structName,"@",W,"threw. NOT propagating it.",M)}delete C.ondispose,b.debugFlags.__flags.dealloc&&D("debug.dealloc:",C[x]?"EXTERNAL":"",b.structName,"instance:",b.structInfo.sizeof,"bytes @"+W),C[x]||k(W)}},p=b=>({configurable:!1,writable:!1,iterable:!1,value:b}),m=function(b,C,W){let M=!W;W?Object.defineProperty(C,x,p(W)):(W=q(b.structInfo.sizeof),W||a("Allocation of",b.structName,"structure failed."));try{b.debugFlags.__flags.alloc&&D("debug.alloc:",M?"":"EXTERNAL",b.structName,"instance:",b.structInfo.sizeof,"bytes @"+W),M&&d().fill(0,W,W+b.structInfo.sizeof),w.set(C,W)}catch(ne){throw h(b,C,W),ne}},L=function(){const b=this.pointer;return b?new Uint8Array(d().slice(b,b+this.structInfo.sizeof)):null},oe=p(b=>G+b+ee),ue=function(b,C,W=!0){let M=b.members[C];if(!M&&(G||ee)){for(const ne of Object.values(b.members))if(ne.key===C){M=ne;break}!M&&W&&a(T(b.name,C),"is not a mapped struct member.")}return M},_e=function b(C,W,M=!1){b._||(b._=fe=>fe.replace(/[^vipPsjrdcC]/g,"").replace(/[pPscC]/g,"i"));const ne=ue(C.structInfo,W,!0);return M?b._(ne.signature):ne.signature},pe={configurable:!1,enumerable:!1,get:function(){return w.get(this)},set:()=>a("Cannot assign the 'pointer' property of a struct.")},ce=p(function(){const b=[];for(const C of Object.keys(this.structInfo.members))b.push(this.memberKey(C));return b}),Ee=new TextDecoder("utf-8"),Fe=new TextEncoder,Pe=typeof SharedArrayBuffer>"u"?function(){}:SharedArrayBuffer,rt=function(b,C,W){return Ee.decode(b.buffer instanceof Pe?b.slice(C,W):b.subarray(C,W))},_t=function(b,C,W=!1){const M=ue(b.structInfo,C,W);return M&&M.signature.length===1&&M.signature[0]==="s"?M:!1},P=function(b){b.signature!=="s"&&a("Invalid member type signature for C-string value:",JSON.stringify(b))},V=function(C,W){const M=ue(C.structInfo,W,!0);P(M);const ne=C[M.key];if(!ne)return null;let fe=ne;const qe=d();for(;qe[fe]!==0;++fe);return ne===fe?"":rt(qe,ne,fe)},z=function(b,...C){b.ondispose?Array.isArray(b.ondispose)||(b.ondispose=[b.ondispose]):b.ondispose=[],b.ondispose.push(...C)},te=function(b){const C=Fe.encode(b),W=q(C.length+1);W||a("Allocation error while duplicating string:",b);const M=d();return M.set(C,W),M[W+C.length]=0,W},Z=function(b,C,W){const M=ue(b.structInfo,C,!0);P(M);const ne=te(W);return b[M.key]=ne,z(b,ne),b},ae=function(C,W){arguments[2]!==p&&a("Do not call the StructType constructor","from client-level code."),Object.defineProperties(this,{structName:p(C),structInfo:p(W)})};ae.prototype=Object.create(null,{dispose:p(function(){h(this.constructor,this)}),lookupMember:p(function(b,C=!0){return ue(this.structInfo,b,C)}),memberToJsString:p(function(b){return V(this,b)}),memberIsString:p(function(b,C=!0){return _t(this,b,C)}),memberKey:oe,memberKeys:ce,memberSignature:p(function(b,C=!1){return _e(this,b,C)}),memoryDump:p(L),pointer:pe,setMemberCString:p(function(b,C){return Z(this,b,C)})}),Object.assign(ae.prototype,{addOnDispose:function(...b){return z(this,...b),this}}),Object.defineProperties(ae,{allocCString:p(te),isA:p(b=>b instanceof ae),hasExternalPointer:p(b=>b instanceof ae&&!!b[x]),memberKey:oe});const le=b=>Number.isFinite(b)||b instanceof(F||Number),R=function b(C,W,M){if(!b._){b._={getters:{},setters:{},sw:{}};const xt=["i","c","C","p","P","s","f","d","v()"];se&&xt.push("j"),xt.forEach(function(rn){b._.getters[rn]=he(rn),b._.setters[rn]=_(rn),b._.sw[rn]=S(rn)});const Ec=/^[ipPsjfdcC]$/,Sc=/^[vipPsjfdcC]\([ipPsjfdcC]*\)$/;b.sigCheck=function(rn,Ic,Qa,Ao){Object.prototype.hasOwnProperty.call(rn,Qa)&&a(rn.structName,"already has a property named",Qa+"."),Ec.test(Ao)||Sc.test(Ao)||a("Malformed signature for",T(rn.structName,Ic)+":",Ao)}}const ne=C.memberKey(W);b.sigCheck(C.prototype,W,ne,M.signature),M.key=ne,M.name=W;const fe=H(M.signature),qe=T(C.prototype.structName,ne),Be=C.prototype.debugFlags.__flags,pn=Object.create(null);pn.configurable=!1,pn.enumerable=!1,pn.get=function(){Be.getter&&D("debug.getter:",b._.getters[fe],"for",K(fe),qe,"@",this.pointer,"+",M.offset,"sz",M.sizeof);let xt=new DataView(d().buffer,this.pointer+M.offset,M.sizeof)[b._.getters[fe]](0,O);return Be.getter&&D("debug.getter:",qe,"result =",xt),xt},M.readOnly?pn.set=$(C.prototype.structName,ne):pn.set=function(xt){if(Be.setter&&D("debug.setter:",b._.setters[fe],"for",K(fe),qe,"@",this.pointer,"+",M.offset,"sz",M.sizeof,xt),this.pointer||a("Cannot set struct property on disposed instance."),xt===null)xt=0;else for(;!le(xt);){if(j(M.signature)&&xt instanceof ae){xt=xt.pointer||0,Be.setter&&D("debug.setter:",qe,"resolved to",xt);break}a("Invalid value for pointer-type",qe+".")}new DataView(d().buffer,this.pointer+M.offset,M.sizeof)[b._.setters[fe]](0,b._.sw[fe](xt),O)},Object.defineProperty(C.prototype,ne,pn)},A=function b(C,W){arguments.length===1?(W=C,C=W.name):W.name||(W.name=C),C||a("Struct name is required.");let M=!1;Object.keys(W.members).forEach(qe=>{const Be=W.members[qe];Be.sizeof?Be.sizeof===1?Be.signature==="c"||Be.signature==="C"||a("Unexpected sizeof==1 member",T(W.name,qe),"with signature",Be.signature):(Be.sizeof%4!==0&&(console.warn("Invalid struct member description =",Be,"from",W),a(C,"member",qe,"sizeof is not aligned. sizeof="+Be.sizeof)),Be.offset%4!==0&&(console.warn("Invalid struct member description =",Be,"from",W),a(C,"member",qe,"offset is not aligned. offset="+Be.offset))):a(C,"member",qe,"is missing sizeof."),(!M||M.offset<Be.offset)&&(M=Be)}),M?W.sizeof<M.offset+M.sizeof&&a("Invalid struct config:",C,"max member offset ("+M.offset+") ","extends past end of struct (sizeof="+W.sizeof+")."):a("No member property descriptions found.");const ne=p(u.__makeDebugFlags(b.debugFlags)),fe=function qe(Be){this instanceof qe?arguments.length?((Be!==(Be|0)||Be<=0)&&a("Invalid pointer value for",C,"constructor."),m(qe,this,Be)):m(qe,this):a("The",C,"constructor may only be called via 'new'.")};return Object.defineProperties(fe,{debugFlags:ne,isA:p(qe=>qe instanceof fe),memberKey:oe,memberKeys:ce,methodInfoForKey:p(function(qe){}),structInfo:p(W),structName:p(C)}),fe.prototype=new ae(C,W,p),Object.defineProperties(fe.prototype,{debugFlags:ne,constructor:p(fe)}),Object.keys(W.members).forEach(qe=>R(fe,qe,W.members[qe])),fe};return A.StructType=ae,A.config=l,A.allocCString=te,A.debugFlags||(A.debugFlags=u.__makeDebugFlags(u.debugFlags)),A},globalThis.sqlite3ApiBootstrap.initializers.push(function(s){const l=(...F)=>{throw new Error(F.join(" "))};s.SQLite3Error.toss;const a=s.capi,u=s.wasm,d=s.util;if(globalThis.WhWasmUtilInstaller(u),delete globalThis.WhWasmUtilInstaller,u.bindingSignatures=[["sqlite3_aggregate_context","void*","sqlite3_context*","int"],["sqlite3_bind_double","int","sqlite3_stmt*","int","f64"],["sqlite3_bind_int","int","sqlite3_stmt*","int","int"],["sqlite3_bind_null",void 0,"sqlite3_stmt*","int"],["sqlite3_bind_parameter_count","int","sqlite3_stmt*"],["sqlite3_bind_parameter_index","int","sqlite3_stmt*","string"],["sqlite3_bind_pointer","int","sqlite3_stmt*","int","*","string:static","*"],["sqlite3_busy_handler","int",["sqlite3*",new u.xWrap.FuncPtrAdapter({signature:"i(pi)",contextKey:(F,y)=>F[0]}),"*"]],["sqlite3_busy_timeout","int","sqlite3*","int"],["sqlite3_changes","int","sqlite3*"],["sqlite3_clear_bindings","int","sqlite3_stmt*"],["sqlite3_collation_needed","int","sqlite3*","*","*"],["sqlite3_column_blob","*","sqlite3_stmt*","int"],["sqlite3_column_bytes","int","sqlite3_stmt*","int"],["sqlite3_column_count","int","sqlite3_stmt*"],["sqlite3_column_double","f64","sqlite3_stmt*","int"],["sqlite3_column_int","int","sqlite3_stmt*","int"],["sqlite3_column_name","string","sqlite3_stmt*","int"],["sqlite3_column_text","string","sqlite3_stmt*","int"],["sqlite3_column_type","int","sqlite3_stmt*","int"],["sqlite3_column_value","sqlite3_value*","sqlite3_stmt*","int"],["sqlite3_commit_hook","void*",["sqlite3*",new u.xWrap.FuncPtrAdapter({name:"sqlite3_commit_hook",signature:"i(p)",contextKey:F=>F[0]}),"*"]],["sqlite3_compileoption_get","string","int"],["sqlite3_compileoption_used","int","string"],["sqlite3_complete","int","string:flexible"],["sqlite3_context_db_handle","sqlite3*","sqlite3_context*"],["sqlite3_data_count","int","sqlite3_stmt*"],["sqlite3_db_filename","string","sqlite3*","string"],["sqlite3_db_handle","sqlite3*","sqlite3_stmt*"],["sqlite3_db_name","string","sqlite3*","int"],["sqlite3_db_status","int","sqlite3*","int","*","*","int"],["sqlite3_errcode","int","sqlite3*"],["sqlite3_errmsg","string","sqlite3*"],["sqlite3_error_offset","int","sqlite3*"],["sqlite3_errstr","string","int"],["sqlite3_exec","int",["sqlite3*","string:flexible",new u.xWrap.FuncPtrAdapter({signature:"i(pipp)",bindScope:"transient",callProxy:F=>{let y;return(g,E,O,N)=>{try{const j=u.cArgvToJs(E,O);return y||(y=u.cArgvToJs(E,N)),F(j,y)|0}catch(j){return j.resultCode||a.SQLITE_ERROR}}}}),"*","**"]],["sqlite3_expanded_sql","string","sqlite3_stmt*"],["sqlite3_extended_errcode","int","sqlite3*"],["sqlite3_extended_result_codes","int","sqlite3*","int"],["sqlite3_file_control","int","sqlite3*","string","int","*"],["sqlite3_finalize","int","sqlite3_stmt*"],["sqlite3_free",void 0,"*"],["sqlite3_get_autocommit","int","sqlite3*"],["sqlite3_get_auxdata","*","sqlite3_context*","int"],["sqlite3_initialize",void 0],["sqlite3_keyword_count","int"],["sqlite3_keyword_name","int",["int","**","*"]],["sqlite3_keyword_check","int",["string","int"]],["sqlite3_libversion","string"],["sqlite3_libversion_number","int"],["sqlite3_limit","int",["sqlite3*","int","int"]],["sqlite3_malloc","*","int"],["sqlite3_open","int","string","*"],["sqlite3_open_v2","int","string","*","int","string"],["sqlite3_progress_handler",void 0,["sqlite3*","int",new u.xWrap.FuncPtrAdapter({name:"xProgressHandler",signature:"i(p)",bindScope:"context",contextKey:(F,y)=>F[0]}),"*"]],["sqlite3_realloc","*","*","int"],["sqlite3_reset","int","sqlite3_stmt*"],["sqlite3_result_blob",void 0,"sqlite3_context*","*","int","*"],["sqlite3_result_double",void 0,"sqlite3_context*","f64"],["sqlite3_result_error",void 0,"sqlite3_context*","string","int"],["sqlite3_result_error_code",void 0,"sqlite3_context*","int"],["sqlite3_result_error_nomem",void 0,"sqlite3_context*"],["sqlite3_result_error_toobig",void 0,"sqlite3_context*"],["sqlite3_result_int",void 0,"sqlite3_context*","int"],["sqlite3_result_null",void 0,"sqlite3_context*"],["sqlite3_result_pointer",void 0,"sqlite3_context*","*","string:static","*"],["sqlite3_result_subtype",void 0,"sqlite3_value*","int"],["sqlite3_result_text",void 0,"sqlite3_context*","string","int","*"],["sqlite3_result_zeroblob",void 0,"sqlite3_context*","int"],["sqlite3_rollback_hook","void*",["sqlite3*",new u.xWrap.FuncPtrAdapter({name:"sqlite3_rollback_hook",signature:"v(p)",contextKey:F=>F[0]}),"*"]],["sqlite3_set_authorizer","int",["sqlite3*",new u.xWrap.FuncPtrAdapter({name:"sqlite3_set_authorizer::xAuth",signature:"i(pissss)",contextKey:(F,y)=>F[0],callProxy:F=>(y,g,E,O,N,j)=>{try{return E=E&&u.cstrToJs(E),O=O&&u.cstrToJs(O),N=N&&u.cstrToJs(N),j=j&&u.cstrToJs(j),F(y,g,E,O,N,j)||0}catch(H){return H.resultCode||a.SQLITE_ERROR}}}),"*"]],["sqlite3_set_auxdata",void 0,["sqlite3_context*","int","*",new u.xWrap.FuncPtrAdapter({name:"xDestroyAuxData",signature:"v(*)",contextKey:(F,y)=>F[0]})]],["sqlite3_shutdown",void 0],["sqlite3_sourceid","string"],["sqlite3_sql","string","sqlite3_stmt*"],["sqlite3_status","int","int","*","*","int"],["sqlite3_step","int","sqlite3_stmt*"],["sqlite3_stmt_isexplain","int",["sqlite3_stmt*"]],["sqlite3_stmt_readonly","int",["sqlite3_stmt*"]],["sqlite3_stmt_status","int","sqlite3_stmt*","int","int"],["sqlite3_strglob","int","string","string"],["sqlite3_stricmp","int","string","string"],["sqlite3_strlike","int","string","string","int"],["sqlite3_strnicmp","int","string","string","int"],["sqlite3_table_column_metadata","int","sqlite3*","string","string","string","**","**","*","*","*"],["sqlite3_total_changes","int","sqlite3*"],["sqlite3_trace_v2","int",["sqlite3*","int",new u.xWrap.FuncPtrAdapter({name:"sqlite3_trace_v2::callback",signature:"i(ippp)",contextKey:(F,y)=>F[0]}),"*"]],["sqlite3_txn_state","int",["sqlite3*","string"]],["sqlite3_uri_boolean","int","sqlite3_filename","string","int"],["sqlite3_uri_key","string","sqlite3_filename","int"],["sqlite3_uri_parameter","string","sqlite3_filename","string"],["sqlite3_user_data","void*","sqlite3_context*"],["sqlite3_value_blob","*","sqlite3_value*"],["sqlite3_value_bytes","int","sqlite3_value*"],["sqlite3_value_double","f64","sqlite3_value*"],["sqlite3_value_dup","sqlite3_value*","sqlite3_value*"],["sqlite3_value_free",void 0,"sqlite3_value*"],["sqlite3_value_frombind","int","sqlite3_value*"],["sqlite3_value_int","int","sqlite3_value*"],["sqlite3_value_nochange","int","sqlite3_value*"],["sqlite3_value_numeric_type","int","sqlite3_value*"],["sqlite3_value_pointer","*","sqlite3_value*","string:static"],["sqlite3_value_subtype","int","sqlite3_value*"],["sqlite3_value_text","string","sqlite3_value*"],["sqlite3_value_type","int","sqlite3_value*"],["sqlite3_vfs_find","*","string"],["sqlite3_vfs_register","int","sqlite3_vfs*","int"],["sqlite3_vfs_unregister","int","sqlite3_vfs*"]],u.exports.sqlite3_activate_see instanceof Function&&u.bindingSignatures.push(["sqlite3_key","int","sqlite3*","string","int"],["sqlite3_key_v2","int","sqlite3*","string","*","int"],["sqlite3_rekey","int","sqlite3*","string","int"],["sqlite3_rekey_v2","int","sqlite3*","string","*","int"],["sqlite3_activate_see",void 0,"string"]),u.bindingSignatures.int64=[["sqlite3_bind_int64","int",["sqlite3_stmt*","int","i64"]],["sqlite3_changes64","i64",["sqlite3*"]],["sqlite3_column_int64","i64",["sqlite3_stmt*","int"]],["sqlite3_create_module","int",["sqlite3*","string","sqlite3_module*","*"]],["sqlite3_create_module_v2","int",["sqlite3*","string","sqlite3_module*","*","*"]],["sqlite3_declare_vtab","int",["sqlite3*","string:flexible"]],["sqlite3_deserialize","int","sqlite3*","string","*","i64","i64","int"],["sqlite3_drop_modules","int",["sqlite3*","**"]],["sqlite3_last_insert_rowid","i64",["sqlite3*"]],["sqlite3_malloc64","*","i64"],["sqlite3_msize","i64","*"],["sqlite3_overload_function","int",["sqlite3*","string","int"]],["sqlite3_preupdate_blobwrite","int","sqlite3*"],["sqlite3_preupdate_count","int","sqlite3*"],["sqlite3_preupdate_depth","int","sqlite3*"],["sqlite3_preupdate_hook","*",["sqlite3*",new u.xWrap.FuncPtrAdapter({name:"sqlite3_preupdate_hook",signature:"v(ppippjj)",contextKey:F=>F[0],callProxy:F=>(y,g,E,O,N,j,H)=>{F(y,g,E,u.cstrToJs(O),u.cstrToJs(N),j,H)}}),"*"]],["sqlite3_preupdate_new","int",["sqlite3*","int","**"]],["sqlite3_preupdate_old","int",["sqlite3*","int","**"]],["sqlite3_realloc64","*","*","i64"],["sqlite3_result_int64",void 0,"*","i64"],["sqlite3_result_zeroblob64","int","*","i64"],["sqlite3_serialize","*","sqlite3*","string","*","int"],["sqlite3_set_last_insert_rowid",void 0,["sqlite3*","i64"]],["sqlite3_status64","int","int","*","*","int"],["sqlite3_total_changes64","i64",["sqlite3*"]],["sqlite3_update_hook","*",["sqlite3*",new u.xWrap.FuncPtrAdapter({name:"sqlite3_update_hook",signature:"v(iippj)",contextKey:F=>F[0],callProxy:F=>(y,g,E,O,N)=>{F(y,g,u.cstrToJs(E),u.cstrToJs(O),N)}}),"*"]],["sqlite3_uri_int64","i64",["sqlite3_filename","string","i64"]],["sqlite3_value_int64","i64","sqlite3_value*"],["sqlite3_vtab_collation","string","sqlite3_index_info*","int"],["sqlite3_vtab_distinct","int","sqlite3_index_info*"],["sqlite3_vtab_in","int","sqlite3_index_info*","int","int"],["sqlite3_vtab_in_first","int","sqlite3_value*","**"],["sqlite3_vtab_in_next","int","sqlite3_value*","**"],["sqlite3_vtab_nochange","int","sqlite3_context*"],["sqlite3_vtab_on_conflict","int","sqlite3*"],["sqlite3_vtab_rhs_value","int","sqlite3_index_info*","int","**"]],u.bigIntEnabled&&u.exports.sqlite3changegroup_add){const F={signature:"i(ps)",callProxy:y=>(g,E)=>{try{return y(g,u.cstrToJs(E))|0}catch(O){return O.resultCode||a.SQLITE_ERROR}}};u.bindingSignatures.int64.push(["sqlite3changegroup_add","int",["sqlite3_changegroup*","int","void*"]],["sqlite3changegroup_add_strm","int",["sqlite3_changegroup*",new u.xWrap.FuncPtrAdapter({name:"xInput",signature:"i(ppp)",bindScope:"transient"}),"void*"]],["sqlite3changegroup_delete",void 0,["sqlite3_changegroup*"]],["sqlite3changegroup_new","int",["**"]],["sqlite3changegroup_output","int",["sqlite3_changegroup*","int*","**"]],["sqlite3changegroup_output_strm","int",["sqlite3_changegroup*",new u.xWrap.FuncPtrAdapter({name:"xOutput",signature:"i(ppi)",bindScope:"transient"}),"void*"]],["sqlite3changeset_apply","int",["sqlite3*","int","void*",new u.xWrap.FuncPtrAdapter({name:"xFilter",bindScope:"transient",...F}),new u.xWrap.FuncPtrAdapter({name:"xConflict",signature:"i(pip)",bindScope:"transient"}),"void*"]],["sqlite3changeset_apply_strm","int",["sqlite3*",new u.xWrap.FuncPtrAdapter({name:"xInput",signature:"i(ppp)",bindScope:"transient"}),"void*",new u.xWrap.FuncPtrAdapter({name:"xFilter",bindScope:"transient",...F}),new u.xWrap.FuncPtrAdapter({name:"xConflict",signature:"i(pip)",bindScope:"transient"}),"void*"]],["sqlite3changeset_apply_v2","int",["sqlite3*","int","void*",new u.xWrap.FuncPtrAdapter({name:"xFilter",bindScope:"transient",...F}),new u.xWrap.FuncPtrAdapter({name:"xConflict",signature:"i(pip)",bindScope:"transient"}),"void*","**","int*","int"]],["sqlite3changeset_apply_v2_strm","int",["sqlite3*",new u.xWrap.FuncPtrAdapter({name:"xInput",signature:"i(ppp)",bindScope:"transient"}),"void*",new u.xWrap.FuncPtrAdapter({name:"xFilter",bindScope:"transient",...F}),new u.xWrap.FuncPtrAdapter({name:"xConflict",signature:"i(pip)",bindScope:"transient"}),"void*","**","int*","int"]],["sqlite3changeset_concat","int",["int","void*","int","void*","int*","**"]],["sqlite3changeset_concat_strm","int",[new u.xWrap.FuncPtrAdapter({name:"xInputA",signature:"i(ppp)",bindScope:"transient"}),"void*",new u.xWrap.FuncPtrAdapter({name:"xInputB",signature:"i(ppp)",bindScope:"transient"}),"void*",new u.xWrap.FuncPtrAdapter({name:"xOutput",signature:"i(ppi)",bindScope:"transient"}),"void*"]],["sqlite3changeset_conflict","int",["sqlite3_changeset_iter*","int","**"]],["sqlite3changeset_finalize","int",["sqlite3_changeset_iter*"]],["sqlite3changeset_fk_conflicts","int",["sqlite3_changeset_iter*","int*"]],["sqlite3changeset_invert","int",["int","void*","int*","**"]],["sqlite3changeset_invert_strm","int",[new u.xWrap.FuncPtrAdapter({name:"xInput",signature:"i(ppp)",bindScope:"transient"}),"void*",new u.xWrap.FuncPtrAdapter({name:"xOutput",signature:"i(ppi)",bindScope:"transient"}),"void*"]],["sqlite3changeset_new","int",["sqlite3_changeset_iter*","int","**"]],["sqlite3changeset_next","int",["sqlite3_changeset_iter*"]],["sqlite3changeset_old","int",["sqlite3_changeset_iter*","int","**"]],["sqlite3changeset_op","int",["sqlite3_changeset_iter*","**","int*","int*","int*"]],["sqlite3changeset_pk","int",["sqlite3_changeset_iter*","**","int*"]],["sqlite3changeset_start","int",["**","int","*"]],["sqlite3changeset_start_strm","int",["**",new u.xWrap.FuncPtrAdapter({name:"xInput",signature:"i(ppp)",bindScope:"transient"}),"void*"]],["sqlite3changeset_start_v2","int",["**","int","*","int"]],["sqlite3changeset_start_v2_strm","int",["**",new u.xWrap.FuncPtrAdapter({name:"xInput",signature:"i(ppp)",bindScope:"transient"}),"void*","int"]],["sqlite3session_attach","int",["sqlite3_session*","string"]],["sqlite3session_changeset","int",["sqlite3_session*","int*","**"]],["sqlite3session_changeset_size","i64",["sqlite3_session*"]],["sqlite3session_changeset_strm","int",["sqlite3_session*",new u.xWrap.FuncPtrAdapter({name:"xOutput",signature:"i(ppp)",bindScope:"transient"}),"void*"]],["sqlite3session_config","int",["int","void*"]],["sqlite3session_create","int",["sqlite3*","string","**"]],["sqlite3session_diff","int",["sqlite3_session*","string","string","**"]],["sqlite3session_enable","int",["sqlite3_session*","int"]],["sqlite3session_indirect","int",["sqlite3_session*","int"]],["sqlite3session_isempty","int",["sqlite3_session*"]],["sqlite3session_memory_used","i64",["sqlite3_session*"]],["sqlite3session_object_config","int",["sqlite3_session*","int","void*"]],["sqlite3session_patchset","int",["sqlite3_session*","*","**"]],["sqlite3session_patchset_strm","int",["sqlite3_session*",new u.xWrap.FuncPtrAdapter({name:"xOutput",signature:"i(ppp)",bindScope:"transient"}),"void*"]],["sqlite3session_table_filter",void 0,["sqlite3_session*",new u.xWrap.FuncPtrAdapter({name:"xFilter",...F,contextKey:(y,g)=>y[0]}),"*"]])}u.bindingSignatures.wasm=[["sqlite3_wasm_db_reset","int","sqlite3*"],["sqlite3_wasm_db_vfs","sqlite3_vfs*","sqlite3*","string"],["sqlite3_wasm_vfs_create_file","int","sqlite3_vfs*","string","*","int"],["sqlite3_wasm_posix_create_file","int","string","*","int"],["sqlite3_wasm_vfs_unlink","int","sqlite3_vfs*","string"]],s.StructBinder=globalThis.Jaccwabyt({heap:u.heap8u,alloc:u.alloc,dealloc:u.dealloc,bigIntEnabled:u.bigIntEnabled,memberPrefix:"$"}),delete globalThis.Jaccwabyt;{const F=u.xWrap.argAdapter("string");u.xWrap.argAdapter("string:flexible",N=>F(d.flexibleString(N))),u.xWrap.argAdapter("string:static",function(N){return u.isPtr(N)?N:(N=""+N,this[N]||(this[N]=u.allocCString(N)))}.bind(Object.create(null)));const y=u.xWrap.argAdapter("*"),g=function(){};u.xWrap.argAdapter("sqlite3_filename",y)("sqlite3_context*",y)("sqlite3_value*",y)("void*",y)("sqlite3_changegroup*",y)("sqlite3_changeset_iter*",y)("sqlite3_session*",y)("sqlite3_stmt*",N=>y(N instanceof(s?.oo1?.Stmt||g)?N.pointer:N))("sqlite3*",N=>y(N instanceof(s?.oo1?.DB||g)?N.pointer:N))("sqlite3_index_info*",N=>y(N instanceof(a.sqlite3_index_info||g)?N.pointer:N))("sqlite3_module*",N=>y(N instanceof(a.sqlite3_module||g)?N.pointer:N))("sqlite3_vfs*",N=>typeof N=="string"?a.sqlite3_vfs_find(N)||s.SQLite3Error.toss(a.SQLITE_NOTFOUND,"Unknown sqlite3_vfs name:",N):y(N instanceof(a.sqlite3_vfs||g)?N.pointer:N));const E=u.xWrap.resultAdapter("*");u.xWrap.resultAdapter("sqlite3*",E)("sqlite3_context*",E)("sqlite3_stmt*",E)("sqlite3_value*",E)("sqlite3_vfs*",E)("void*",E),u.exports.sqlite3_step.length===0&&(u.xWrap.doArgcCheck=!1,s.config.warn("Disabling sqlite3.wasm.xWrap.doArgcCheck due to environmental quirks."));for(const N of u.bindingSignatures)a[N[0]]=u.xWrap.apply(null,N);for(const N of u.bindingSignatures.wasm)u[N[0]]=u.xWrap.apply(null,N);const O=function(N){return()=>l(N+"() is unavailable due to lack","of BigInt support in this build.")};for(const N of u.bindingSignatures.int64)a[N[0]]=u.bigIntEnabled?u.xWrap.apply(null,N):O(N[0]);if(delete u.bindingSignatures,u.exports.sqlite3_wasm_db_error){const N=u.xWrap("sqlite3_wasm_db_error","int","sqlite3*","int","string");d.sqlite3_wasm_db_error=function(j,H,K){return H instanceof s.WasmAllocError?(H=a.SQLITE_NOMEM,K=0):H instanceof Error&&(K=K||""+H,H=H.resultCode||a.SQLITE_ERROR),j?N(j,H,K):H}}else d.sqlite3_wasm_db_error=function(N,j,H){return console.warn("sqlite3_wasm_db_error() is not exported.",arguments),j}}{const F=u.xCall("sqlite3_wasm_enum_json");F||l("Maintenance required: increase sqlite3_wasm_enum_json()'s","static buffer size!"),u.ctype=JSON.parse(u.cstrToJs(F));const y=["access","authorizer","blobFinalizers","changeset","config","dataTypes","dbConfig","dbStatus","encodings","fcntl","flock","ioCap","limits","openFlags","prepareFlags","resultCodes","sqlite3Status","stmtStatus","syncFlags","trace","txnState","udfFlags","version"];u.bigIntEnabled&&y.push("serialize","session","vtab");for(const O of y)for(const N of Object.entries(u.ctype[O]))a[N[0]]=N[1];u.functionEntry(a.SQLITE_WASM_DEALLOC)||l("Internal error: cannot resolve exported function","entry SQLITE_WASM_DEALLOC (=="+a.SQLITE_WASM_DEALLOC+").");const g=Object.create(null);for(const O of["resultCodes"])for(const N of Object.entries(u.ctype[O]))g[N[1]]=N[0];a.sqlite3_js_rc_str=O=>g[O];const E=Object.assign(Object.create(null),{WasmTestStruct:!0,sqlite3_kvvfs_methods:!d.isUIThread(),sqlite3_index_info:!u.bigIntEnabled,sqlite3_index_constraint:!u.bigIntEnabled,sqlite3_index_orderby:!u.bigIntEnabled,sqlite3_index_constraint_usage:!u.bigIntEnabled});for(const O of u.ctype.structs)E[O.name]||(a[O.name]=s.StructBinder(O));if(a.sqlite3_index_info){for(const O of["sqlite3_index_constraint","sqlite3_index_orderby","sqlite3_index_constraint_usage"])a.sqlite3_index_info[O]=a[O],delete a[O];a.sqlite3_vtab_config=u.xWrap("sqlite3_wasm_vtab_config","int",["sqlite3*","int","int"])}}const q=(F,y,g)=>d.sqlite3_wasm_db_error(F,a.SQLITE_MISUSE,y+"() requires "+g+" argument"+(g===1?"":"s")+"."),k=F=>d.sqlite3_wasm_db_error(F,a.SQLITE_FORMAT,"SQLITE_UTF8 is the only supported encoding."),D=F=>u.xWrap.argAdapter("sqlite3*")(F),G=F=>u.isPtr(F)?u.cstrToJs(F):F,ee=function(F,y){F=D(F);let g=this.dbMap.get(F);if(y)!g&&y>0&&this.dbMap.set(F,g=Object.create(null));else return this.dbMap.delete(F),g;return g}.bind(Object.assign(Object.create(null),{dbMap:new Map}));ee.addCollation=function(F,y){const g=ee(F,1);g.collation||(g.collation=new Set),g.collation.add(G(y).toLowerCase())},ee._addUDF=function(F,y,g,E){y=G(y).toLowerCase();let O=E.get(y);O||E.set(y,O=new Set),O.add(g<0?-1:g)},ee.addFunction=function(F,y,g){const E=ee(F,1);E.udf||(E.udf=new Map),this._addUDF(F,y,g,E.udf)},ee.addWindowFunc=function(F,y,g){const E=ee(F,1);E.wudf||(E.wudf=new Map),this._addUDF(F,y,g,E.wudf)},ee.cleanup=function(F){F=D(F);const y=[F];for(const O of["sqlite3_busy_handler","sqlite3_commit_hook","sqlite3_preupdate_hook","sqlite3_progress_handler","sqlite3_rollback_hook","sqlite3_set_authorizer","sqlite3_trace_v2","sqlite3_update_hook"]){const N=u.exports[O];y.length=N.length;try{a[O](...y)}catch(j){console.warn("close-time call of",O+"(",y,") threw:",j)}}const g=ee(F,0);if(!g)return;if(g.collation){for(const O of g.collation)try{a.sqlite3_create_collation_v2(F,O,a.SQLITE_UTF8,0,0,0)}catch{}delete g.collation}let E;for(E=0;E<2;++E){const O=E?g.wudf:g.udf;if(!O)continue;const N=E?a.sqlite3_create_window_function:a.sqlite3_create_function_v2;for(const j of O){const H=j[0],K=j[1],U=[F,H,0,a.SQLITE_UTF8,0,0,0,0,0];E&&U.push(0);for(const he of K)try{U[2]=he,N.apply(null,U)}catch{}K.clear()}O.clear()}delete g.udf,delete g.wudf};{const F=u.xWrap("sqlite3_close_v2","int","sqlite3*");a.sqlite3_close_v2=function(y){if(arguments.length!==1)return q(y,"sqlite3_close_v2",1);if(y)try{ee.cleanup(y)}catch{}return F(y)}}if(a.sqlite3session_table_filter){const F=u.xWrap("sqlite3session_delete",void 0,["sqlite3_session*"]);a.sqlite3session_delete=function(y){if(arguments.length!==1)return q(pDb,"sqlite3session_delete",1);y&&a.sqlite3session_table_filter(y,0,0),F(y)}}{const F=(g,E)=>"argv["+E+"]:"+g[0]+":"+u.cstrToJs(g[1]).toLowerCase(),y=u.xWrap("sqlite3_create_collation_v2","int",["sqlite3*","string","int","*",new u.xWrap.FuncPtrAdapter({name:"xCompare",signature:"i(pipip)",contextKey:F}),new u.xWrap.FuncPtrAdapter({name:"xDestroy",signature:"v(p)",contextKey:F})]);a.sqlite3_create_collation_v2=function(g,E,O,N,j,H){if(arguments.length!==6)return q(g,"sqlite3_create_collation_v2",6);if(!(O&15))O|=a.SQLITE_UTF8;else if(a.SQLITE_UTF8!==(O&15))return k(g);try{const K=y(g,E,O,N,j,H);return K===0&&j instanceof Function&&ee.addCollation(g,E),K}catch(K){return d.sqlite3_wasm_db_error(g,K)}},a.sqlite3_create_collation=(g,E,O,N,j)=>arguments.length===5?a.sqlite3_create_collation_v2(g,E,O,N,j,0):q(g,"sqlite3_create_collation",5)}{const F=function(O,N){return O[0]+":"+(O[2]<0?-1:O[2])+":"+N+":"+u.cstrToJs(O[1]).toLowerCase()},y=Object.assign(Object.create(null),{xInverseAndStep:{signature:"v(pip)",contextKey:F,callProxy:O=>(N,j,H)=>{try{O(N,...a.sqlite3_values_to_js(j,H))}catch(K){a.sqlite3_result_error_js(N,K)}}},xFinalAndValue:{signature:"v(p)",contextKey:F,callProxy:O=>N=>{try{a.sqlite3_result_js(N,O(N))}catch(j){a.sqlite3_result_error_js(N,j)}}},xFunc:{signature:"v(pip)",contextKey:F,callProxy:O=>(N,j,H)=>{try{a.sqlite3_result_js(N,O(N,...a.sqlite3_values_to_js(j,H)))}catch(K){a.sqlite3_result_error_js(N,K)}}},xDestroy:{signature:"v(p)",contextKey:F,callProxy:O=>N=>{try{O(N)}catch(j){console.error("UDF xDestroy method threw:",j)}}}}),g=u.xWrap("sqlite3_create_function_v2","int",["sqlite3*","string","int","int","*",new u.xWrap.FuncPtrAdapter({name:"xFunc",...y.xFunc}),new u.xWrap.FuncPtrAdapter({name:"xStep",...y.xInverseAndStep}),new u.xWrap.FuncPtrAdapter({name:"xFinal",...y.xFinalAndValue}),new u.xWrap.FuncPtrAdapter({name:"xDestroy",...y.xDestroy})]),E=u.xWrap("sqlite3_create_window_function","int",["sqlite3*","string","int","int","*",new u.xWrap.FuncPtrAdapter({name:"xStep",...y.xInverseAndStep}),new u.xWrap.FuncPtrAdapter({name:"xFinal",...y.xFinalAndValue}),new u.xWrap.FuncPtrAdapter({name:"xValue",...y.xFinalAndValue}),new u.xWrap.FuncPtrAdapter({name:"xInverse",...y.xInverseAndStep}),new u.xWrap.FuncPtrAdapter({name:"xDestroy",...y.xDestroy})]);a.sqlite3_create_function_v2=function O(N,j,H,K,U,he,_,S,T){if(O.length!==arguments.length)return q(N,"sqlite3_create_function_v2",O.length);if(!(K&15))K|=a.SQLITE_UTF8;else if(a.SQLITE_UTF8!==(K&15))return k(N);try{const $=g(N,j,H,K,U,he,_,S,T);return $===0&&(he instanceof Function||_ instanceof Function||S instanceof Function||T instanceof Function)&&ee.addFunction(N,j,H),$}catch($){return console.error("sqlite3_create_function_v2() setup threw:",$),d.sqlite3_wasm_db_error(N,$,"Creation of UDF threw: "+$)}},a.sqlite3_create_function=function O(N,j,H,K,U,he,_,S){return O.length===arguments.length?a.sqlite3_create_function_v2(N,j,H,K,U,he,_,S,0):q(N,"sqlite3_create_function",O.length)},a.sqlite3_create_window_function=function O(N,j,H,K,U,he,_,S,T,$){if(O.length!==arguments.length)return q(N,"sqlite3_create_window_function",O.length);if(!(K&15))K|=a.SQLITE_UTF8;else if(a.SQLITE_UTF8!==(K&15))return k(N);try{const w=E(N,j,H,K,U,he,_,S,T,$);return w===0&&(he instanceof Function||_ instanceof Function||S instanceof Function||T instanceof Function||$ instanceof Function)&&ee.addWindowFunc(N,j,H),w}catch(w){return console.error("sqlite3_create_window_function() setup threw:",w),d.sqlite3_wasm_db_error(N,w,"Creation of UDF threw: "+w)}},a.sqlite3_create_function_v2.udfSetResult=a.sqlite3_create_function.udfSetResult=a.sqlite3_create_window_function.udfSetResult=a.sqlite3_result_js,a.sqlite3_create_function_v2.udfConvertArgs=a.sqlite3_create_function.udfConvertArgs=a.sqlite3_create_window_function.udfConvertArgs=a.sqlite3_values_to_js,a.sqlite3_create_function_v2.udfSetError=a.sqlite3_create_function.udfSetError=a.sqlite3_create_window_function.udfSetError=a.sqlite3_result_error_js}{const F=(g,E)=>(typeof g=="string"?E=-1:d.isSQLableTypedArray(g)?(E=g.byteLength,g=d.typedArrayToString(g instanceof ArrayBuffer?new Uint8Array(g):g)):Array.isArray(g)&&(g=g.join(""),E=-1),[g,E]),y={basic:u.xWrap("sqlite3_prepare_v3","int",["sqlite3*","string","int","int","**","**"]),full:u.xWrap("sqlite3_prepare_v3","int",["sqlite3*","*","int","int","**","**"])};a.sqlite3_prepare_v3=function g(E,O,N,j,H,K){if(g.length!==arguments.length)return q(E,"sqlite3_prepare_v3",g.length);const[U,he]=F(O,N);switch(typeof U){case"string":return y.basic(E,U,he,j,H,null);case"number":return y.full(E,U,he,j,H,K);default:return d.sqlite3_wasm_db_error(E,a.SQLITE_MISUSE,"Invalid SQL argument type for sqlite3_prepare_v2/v3().")}},a.sqlite3_prepare_v2=function g(E,O,N,j,H){return g.length===arguments.length?a.sqlite3_prepare_v3(E,O,N,0,j,H):q(E,"sqlite3_prepare_v2",g.length)}}{const F=u.xWrap("sqlite3_bind_text","int",["sqlite3_stmt*","int","string","int","*"]),y=u.xWrap("sqlite3_bind_blob","int",["sqlite3_stmt*","int","*","int","*"]);a.sqlite3_bind_text=function g(E,O,N,j,H){if(g.length!==arguments.length)return q(a.sqlite3_db_handle(E),"sqlite3_bind_text",g.length);if(u.isPtr(N)||N===null)return F(E,O,N,j,H);N instanceof ArrayBuffer?N=new Uint8Array(N):Array.isArray(pMem)&&(N=pMem.join(""));let K,U;try{if(d.isSQLableTypedArray(N))K=u.allocFromTypedArray(N),U=N.byteLength;else if(typeof N=="string")[K,U]=u.allocCString(N);else return d.sqlite3_wasm_db_error(a.sqlite3_db_handle(E),a.SQLITE_MISUSE,"Invalid 3rd argument type for sqlite3_bind_text().");return F(E,O,K,U,a.SQLITE_WASM_DEALLOC)}catch(he){return u.dealloc(K),d.sqlite3_wasm_db_error(a.sqlite3_db_handle(E),he)}},a.sqlite3_bind_blob=function g(E,O,N,j,H){if(g.length!==arguments.length)return q(a.sqlite3_db_handle(E),"sqlite3_bind_blob",g.length);if(u.isPtr(N)||N===null)return y(E,O,N,j,H);N instanceof ArrayBuffer?N=new Uint8Array(N):Array.isArray(N)&&(N=N.join(""));let K,U;try{if(d.isBindableTypedArray(N))K=u.allocFromTypedArray(N),U=j>=0?j:N.byteLength;else if(typeof N=="string")[K,U]=u.allocCString(N);else return d.sqlite3_wasm_db_error(a.sqlite3_db_handle(E),a.SQLITE_MISUSE,"Invalid 3rd argument type for sqlite3_bind_blob().");return y(E,O,K,U,a.SQLITE_WASM_DEALLOC)}catch(he){return u.dealloc(K),d.sqlite3_wasm_db_error(a.sqlite3_db_handle(E),he)}}}a.sqlite3_config=function(F,...y){if(arguments.length<2)return a.SQLITE_MISUSE;switch(F){case a.SQLITE_CONFIG_COVERING_INDEX_SCAN:case a.SQLITE_CONFIG_MEMSTATUS:case a.SQLITE_CONFIG_SMALL_MALLOC:case a.SQLITE_CONFIG_SORTERREF_SIZE:case a.SQLITE_CONFIG_STMTJRNL_SPILL:case a.SQLITE_CONFIG_URI:return u.exports.sqlite3_wasm_config_i(F,y[0]);case a.SQLITE_CONFIG_LOOKASIDE:return u.exports.sqlite3_wasm_config_ii(F,y[0],y[1]);case a.SQLITE_CONFIG_MEMDB_MAXSIZE:return u.exports.sqlite3_wasm_config_j(F,y[0]);case a.SQLITE_CONFIG_GETMALLOC:case a.SQLITE_CONFIG_GETMUTEX:case a.SQLITE_CONFIG_GETPCACHE2:case a.SQLITE_CONFIG_GETPCACHE:case a.SQLITE_CONFIG_HEAP:case a.SQLITE_CONFIG_LOG:case a.SQLITE_CONFIG_MALLOC:case a.SQLITE_CONFIG_MMAP_SIZE:case a.SQLITE_CONFIG_MULTITHREAD:case a.SQLITE_CONFIG_MUTEX:case a.SQLITE_CONFIG_PAGECACHE:case a.SQLITE_CONFIG_PCACHE2:case a.SQLITE_CONFIG_PCACHE:case a.SQLITE_CONFIG_PCACHE_HDRSZ:case a.SQLITE_CONFIG_PMASZ:case a.SQLITE_CONFIG_SERIALIZED:case a.SQLITE_CONFIG_SINGLETHREAD:case a.SQLITE_CONFIG_SQLLOG:case a.SQLITE_CONFIG_WIN32_HEAPSIZE:default:return a.SQLITE_NOTFOUND}};{const F=new Set;a.sqlite3_auto_extension=function(y){if(y instanceof Function)y=u.installFunction("i(ppp)",y);else if(arguments.length!==1||!u.isPtr(y))return a.SQLITE_MISUSE;const g=u.exports.sqlite3_auto_extension(y);return y!==arguments[0]&&(g===0?F.add(y):u.uninstallFunction(y)),g},a.sqlite3_cancel_auto_extension=function(y){return!y||arguments.length!==1||!u.isPtr(y)?0:u.exports.sqlite3_cancel_auto_extension(y)},a.sqlite3_reset_auto_extension=function(){u.exports.sqlite3_reset_auto_extension();for(const y of F)u.uninstallFunction(y);F.clear()}}const se=a.sqlite3_vfs_find("kvvfs");if(se)if(d.isUIThread()){const F=new a.sqlite3_kvvfs_methods(u.exports.sqlite3_wasm_kvvfs_methods());delete a.sqlite3_kvvfs_methods;const y=u.exports.sqlite3_wasm_kvvfsMakeKeyOnPstack,g=u.pstack,E=N=>u.peek(N)===115?sessionStorage:localStorage,O={xRead:(N,j,H,K)=>{const U=g.pointer,he=u.scopedAllocPush();try{const _=y(N,j);if(!_)return-3;const S=u.cstrToJs(_),T=E(N).getItem(S);if(!T)return-1;const $=T.length;if(K<=0)return $;if(K===1)return u.poke(H,0),$;const w=u.scopedAllocCString(T);return K>$+1&&(K=$+1),u.heap8u().copyWithin(H,w,w+K-1),u.poke(H+K-1,0),K-1}catch(_){return console.error("kvstorageRead()",_),-2}finally{g.restore(U),u.scopedAllocPop(he)}},xWrite:(N,j,H)=>{const K=g.pointer;try{const U=y(N,j);if(!U)return 1;const he=u.cstrToJs(U);return E(N).setItem(he,u.cstrToJs(H)),0}catch(U){return console.error("kvstorageWrite()",U),a.SQLITE_IOERR}finally{g.restore(K)}},xDelete:(N,j)=>{const H=g.pointer;try{const K=y(N,j);return K?(E(N).removeItem(u.cstrToJs(K)),0):1}catch(K){return console.error("kvstorageDelete()",K),a.SQLITE_IOERR}finally{g.restore(H)}}};for(const N of Object.keys(O))F[F.memberKey(N)]=u.installFunction(F.memberSignature(N),O[N])}else a.sqlite3_vfs_unregister(se);u.xWrap.FuncPtrAdapter.warnOnUse=!0}),globalThis.sqlite3ApiBootstrap.initializers.push(function(s){s.version={libVersion:"3.45.2",libVersionNumber:3045002,sourceId:"2024-03-12 11:06:23 d8cd6d49b46a395b13955387d05e9e1a2a47e54fb99f3c9b59835bbefad6af77",downloadVersion:3450200}}),globalThis.sqlite3ApiBootstrap.initializers.push(function(s){const l=(...w)=>{throw new s.SQLite3Error(...w)},a=s.capi,u=s.wasm,d=s.util,q=new WeakMap,k=new WeakMap,D=(w,x,h)=>{const p=Object.getOwnPropertyDescriptor(w,x);return p?p.value:h},G=function(w,x){return x&&(w instanceof y&&(w=w.pointer),l(x,"sqlite3 result code",x+":",w?a.sqlite3_errmsg(w):a.sqlite3_errstr(x))),arguments[0]},ee=u.installFunction("i(ippp)",function(w,x,h,p){a.SQLITE_TRACE_STMT===w&&console.log("SQL TRACE #"+ ++this.counter+" via sqlite3@"+x+":",u.cstrToJs(p))}.bind({counter:0})),se=Object.create(null),F=function w(...x){if(!w._name2vfs){w._name2vfs=Object.create(null);const ce=typeof importScripts=="function"?Ee=>l("The VFS for",Ee,"is only available in the main window thread."):!1;w._name2vfs[":localStorage:"]={vfs:"kvvfs",filename:ce||(()=>"local")},w._name2vfs[":sessionStorage:"]={vfs:"kvvfs",filename:ce||(()=>"session")}}const h=w.normalizeArgs(...x);let p=h.filename,m=h.vfs,L=h.flags;(typeof p!="string"&&typeof p!="number"||typeof L!="string"||m&&typeof m!="string"&&typeof m!="number")&&(s.config.error("Invalid DB ctor args",h,arguments),l("Invalid arguments for DB constructor."));let X=typeof p=="number"?u.cstrToJs(p):p;const oe=w._name2vfs[X];oe&&(m=oe.vfs,p=X=oe.filename(X));let ue,_e=0;L.indexOf("c")>=0&&(_e|=a.SQLITE_OPEN_CREATE|a.SQLITE_OPEN_READWRITE),L.indexOf("w")>=0&&(_e|=a.SQLITE_OPEN_READWRITE),_e===0&&(_e|=a.SQLITE_OPEN_READONLY),_e|=a.SQLITE_OPEN_EXRESCODE;const pe=u.pstack.pointer;try{const ce=u.pstack.allocPtr();let Ee=a.sqlite3_open_v2(p,ce,_e,m||0);ue=u.peekPtr(ce),G(ue,Ee),a.sqlite3_extended_result_codes(ue,1),L.indexOf("t")>=0&&a.sqlite3_trace_v2(ue,a.SQLITE_TRACE_STMT,ee,ue)}catch(ce){throw ue&&a.sqlite3_close_v2(ue),ce}finally{u.pstack.restore(pe)}this.filename=X,q.set(this,ue),k.set(this,Object.create(null));try{const ce=a.sqlite3_js_db_vfs(ue);ce||l("Internal error: cannot get VFS for new db handle.");const Ee=se[ce];Ee instanceof Function?Ee(this,s):Ee&&G(ue,a.sqlite3_exec(ue,Ee,0,0,0))}catch(ce){throw this.close(),ce}};F.setVfsPostOpenSql=function(w,x){se[w]=x},F.normalizeArgs=function(w=":memory:",x="c",h=null){const p={};return arguments.length===1&&arguments[0]&&typeof arguments[0]=="object"?(Object.assign(p,arguments[0]),p.flags===void 0&&(p.flags="c"),p.vfs===void 0&&(p.vfs=null),p.filename===void 0&&(p.filename=":memory:")):(p.filename=w,p.flags=x,p.vfs=h),p};const y=function(...w){F.apply(this,w)};y.dbCtorHelper=F;const g={null:1,number:2,string:3,boolean:4,blob:5};g.undefined==g.null,u.bigIntEnabled&&(g.bigint=g.number);const E=function(){g!==arguments[2]&&l(a.SQLITE_MISUSE,"Do not call the Stmt constructor directly. Use DB.prepare()."),this.db=arguments[0],q.set(this,arguments[1]),this.parameterCount=a.sqlite3_bind_parameter_count(this.pointer)},O=function(w){return w.pointer||l("DB has been closed."),w},N=function(w,x){return(x!==(x|0)||x<0||x>=w.columnCount)&&l("Column index",x,"is out of range."),w},j=function(w,x){const h=Object.create(null);switch(h.opt=Object.create(null),x.length){case 1:typeof x[0]=="string"||d.isSQLableTypedArray(x[0])||Array.isArray(x[0])?h.sql=x[0]:x[0]&&typeof x[0]=="object"&&(h.opt=x[0],h.sql=h.opt.sql);break;case 2:h.sql=x[0],h.opt=x[1];break;default:l("Invalid argument count for exec().")}h.sql=d.flexibleString(h.sql),typeof h.sql!="string"&&l("Missing SQL argument or unsupported SQL value type.");const p=h.opt;switch(p.returnValue){case"resultRows":p.resultRows||(p.resultRows=[]),h.returnVal=()=>p.resultRows;break;case"saveSql":p.saveSql||(p.saveSql=[]),h.returnVal=()=>p.saveSql;break;case void 0:case"this":h.returnVal=()=>w;break;default:l("Invalid returnValue value:",p.returnValue)}if(!p.callback&&!p.returnValue&&p.rowMode!==void 0&&(p.resultRows||(p.resultRows=[]),h.returnVal=()=>p.resultRows),p.callback||p.resultRows)switch(p.rowMode===void 0?"array":p.rowMode){case"object":h.cbArg=m=>m.get(Object.create(null));break;case"array":h.cbArg=m=>m.get([]);break;case"stmt":Array.isArray(p.resultRows)&&l("exec(): invalid rowMode for a resultRows array: must","be one of 'array', 'object',","a result column number, or column name reference."),h.cbArg=m=>m;break;default:if(d.isInt32(p.rowMode)){h.cbArg=m=>m.get(p.rowMode);break}else if(typeof p.rowMode=="string"&&p.rowMode.length>1&&p.rowMode[0]==="$"){const m=p.rowMode.substr(1);h.cbArg=L=>{const X=L.get(Object.create(null))[m];return X===void 0?l(a.SQLITE_NOTFOUND,"exec(): unknown result column:",m):X};break}l("Invalid rowMode:",p.rowMode)}return h},H=(w,x,h,...p)=>{const m=w.prepare(x);try{const L=m.bind(h).step()?m.get(...p):void 0;return m.reset(),L}finally{m.finalize()}},K=(w,x,h,p)=>w.exec({sql:x,bind:h,rowMode:p,returnValue:"resultRows"});y.checkRc=(w,x)=>G(w,x),y.prototype={isOpen:function(){return!!this.pointer},affirmOpen:function(){return O(this)},close:function(){if(this.pointer){if(this.onclose&&this.onclose.before instanceof Function)try{this.onclose.before(this)}catch{}const w=this.pointer;if(Object.keys(k.get(this)).forEach((x,h)=>{if(h&&h.pointer)try{h.finalize()}catch{}}),q.delete(this),k.delete(this),a.sqlite3_close_v2(w),this.onclose&&this.onclose.after instanceof Function)try{this.onclose.after(this)}catch{}delete this.filename}},changes:function(w=!1,x=!1){const h=O(this).pointer;return w?x?a.sqlite3_total_changes64(h):a.sqlite3_total_changes(h):x?a.sqlite3_changes64(h):a.sqlite3_changes(h)},dbFilename:function(w="main"){return a.sqlite3_db_filename(O(this).pointer,w)},dbName:function(w=0){return a.sqlite3_db_name(O(this).pointer,w)},dbVfsName:function(w=0){let x;const h=a.sqlite3_js_db_vfs(O(this).pointer,w);if(h){const p=new a.sqlite3_vfs(h);try{x=u.cstrToJs(p.$zName)}finally{p.dispose()}}return x},prepare:function(w){O(this);const x=u.pstack.pointer;let h,p;try{h=u.pstack.alloc(8),y.checkRc(this,a.sqlite3_prepare_v2(this.pointer,w,-1,h,null)),p=u.peekPtr(h)}finally{u.pstack.restore(x)}p||l("Cannot prepare empty SQL.");const m=new E(this,p,g);return k.get(this)[p]=m,m},exec:function(){O(this);const w=j(this,arguments);if(!w.sql)return l("exec() requires an SQL string.");const x=w.opt,h=x.callback,p=Array.isArray(x.resultRows)?x.resultRows:void 0;let m,L=x.bind,X=!!(w.cbArg||x.columnNames||p);const oe=u.scopedAllocPush(),ue=Array.isArray(x.saveSql)?x.saveSql:void 0;try{const _e=d.isSQLableTypedArray(w.sql);let pe=_e?w.sql.byteLength:u.jstrlen(w.sql);const ce=u.scopedAlloc(2*u.ptrSizeof+(pe+1)),Ee=ce+u.ptrSizeof;let Fe=Ee+u.ptrSizeof;const Pe=Fe+pe;for(_e?u.heap8().set(w.sql,Fe):u.jstrcpy(w.sql,u.heap8(),Fe,pe,!1),u.poke(Fe+pe,0);Fe&&u.peek(Fe,"i8");){u.pokePtr([ce,Ee],0),y.checkRc(this,a.sqlite3_prepare_v3(this.pointer,Fe,pe,0,ce,Ee));const rt=u.peekPtr(ce);if(Fe=u.peekPtr(Ee),pe=Pe-Fe,!!rt){if(ue&&ue.push(a.sqlite3_sql(rt).trim()),m=new E(this,rt,g),L&&m.parameterCount&&(m.bind(L),L=null),X&&m.columnCount){let _t=Array.isArray(x.columnNames)?0:1;if(X=!1,w.cbArg||p){for(;m.step();m._lockedByExec=!1){_t++===0&&m.getColumnNames(x.columnNames),m._lockedByExec=!0;const P=w.cbArg(m);if(p&&p.push(P),h&&h.call(x,P,m)===!1)break}m._lockedByExec=!1}_t===0&&m.getColumnNames(x.columnNames)}else m.step();m.reset().finalize(),m=null}}}finally{u.scopedAllocPop(oe),m&&(delete m._lockedByExec,m.finalize())}return w.returnVal()},createFunction:function(x,h,p){const m=P=>P instanceof Function;switch(arguments.length){case 1:p=x,x=p.name,h=p.xFunc||0;break;case 2:m(h)||(p=h,h=p.xFunc||0);break}p||(p={}),typeof x!="string"&&l("Invalid arguments: missing function name.");let L=p.xStep||0,X=p.xFinal||0;const oe=p.xValue||0,ue=p.xInverse||0;let _e;m(h)?(_e=!1,(m(L)||m(X))&&l("Ambiguous arguments: scalar or aggregate?"),L=X=null):m(L)?(m(X)||l("Missing xFinal() callback for aggregate or window UDF."),h=null):m(X)?l("Missing xStep() callback for aggregate or window UDF."):l("Missing function-type properties."),_e===!1?(m(oe)||m(ue))&&l("xValue and xInverse are not permitted for non-window UDFs."):m(oe)?(m(ue)||l("xInverse must be provided if xValue is."),_e=!0):m(ue)&&l("xValue must be provided if xInverse is.");const pe=p.pApp;pe!=null&&(typeof pe!="number"||!d.isInt32(pe))&&l("Invalid value for pApp property. Must be a legal WASM pointer value.");const ce=p.xDestroy||0;ce&&!m(ce)&&l("xDestroy property must be a function.");let Ee=0;D(p,"deterministic")&&(Ee|=a.SQLITE_DETERMINISTIC),D(p,"directOnly")&&(Ee|=a.SQLITE_DIRECTONLY),D(p,"innocuous")&&(Ee|=a.SQLITE_INNOCUOUS),x=x.toLowerCase();const Fe=h||L,Pe=D(p,"arity"),rt=typeof Pe=="number"?Pe:Fe.length?Fe.length-1:0;let _t;return _e?_t=a.sqlite3_create_window_function(this.pointer,x,rt,a.SQLITE_UTF8|Ee,pe||0,L,X,oe,ue,ce):_t=a.sqlite3_create_function_v2(this.pointer,x,rt,a.SQLITE_UTF8|Ee,pe||0,h,L,X,ce),y.checkRc(this,_t),this},selectValue:function(w,x,h){return H(this,w,x,0,h)},selectValues:function(w,x,h){const p=this.prepare(w),m=[];try{for(p.bind(x);p.step();)m.push(p.get(0,h));p.reset()}finally{p.finalize()}return m},selectArray:function(w,x){return H(this,w,x,[])},selectObject:function(w,x){return H(this,w,x,{})},selectArrays:function(w,x){return K(this,w,x,"array")},selectObjects:function(w,x){return K(this,w,x,"object")},openStatementCount:function(){return this.pointer?Object.keys(k.get(this)).length:0},transaction:function(w){let x="BEGIN";arguments.length>1&&(/[^a-zA-Z]/.test(arguments[0])&&l(a.SQLITE_MISUSE,"Invalid argument for BEGIN qualifier."),x+=" "+arguments[0],w=arguments[1]),O(this).exec(x);try{const h=w(this);return this.exec("COMMIT"),h}catch(h){throw this.exec("ROLLBACK"),h}},savepoint:function(w){O(this).exec("SAVEPOINT oo1");try{const x=w(this);return this.exec("RELEASE oo1"),x}catch(x){throw this.exec("ROLLBACK to SAVEPOINT oo1; RELEASE SAVEPOINT oo1"),x}},checkRc:function(w){return G(this,w)}};const U=function(w){return w.pointer||l("Stmt has been closed."),w},he=function(w){let x=g[w==null?"null":typeof w];switch(x){case g.boolean:case g.null:case g.number:case g.string:return x;case g.bigint:if(u.bigIntEnabled)return x;default:return d.isBindableTypedArray(w)?g.blob:void 0}},_=function(w){return he(w)||l("Unsupported bind() argument type:",typeof w)},S=function(w,x){const h=typeof x=="number"?x:a.sqlite3_bind_parameter_index(w.pointer,x);return h===0||!d.isInt32(h)?l("Invalid bind() parameter name: "+x):(h<1||h>w.parameterCount)&&l("Bind index",x,"is out of range."),h},T=function(w,x){return w._lockedByExec&&l("Operation is illegal when statement is locked:",x),w},$=function w(x,h,p,m){T(U(x),"bind()"),w._||(w._tooBigInt=X=>l("BigInt value is too big to store without precision loss:",X),w._={string:function(X,oe,ue,_e){const[pe,ce]=u.allocCString(ue,!0);return(_e?a.sqlite3_bind_blob:a.sqlite3_bind_text)(X.pointer,oe,pe,ce,a.SQLITE_WASM_DEALLOC)}}),_(m),h=S(x,h);let L=0;switch(m==null?g.null:p){case g.null:L=a.sqlite3_bind_null(x.pointer,h);break;case g.string:L=w._.string(x,h,m,!1);break;case g.number:{let X;d.isInt32(m)?X=a.sqlite3_bind_int:typeof m=="bigint"?d.bigIntFits64(m)?u.bigIntEnabled?X=a.sqlite3_bind_int64:d.bigIntFitsDouble(m)?(m=Number(m),X=a.sqlite3_bind_double):w._tooBigInt(m):w._tooBigInt(m):(m=Number(m),u.bigIntEnabled&&Number.isInteger(m)?X=a.sqlite3_bind_int64:X=a.sqlite3_bind_double),L=X(x.pointer,h,m);break}case g.boolean:L=a.sqlite3_bind_int(x.pointer,h,m?1:0);break;case g.blob:{if(typeof m=="string"){L=w._.string(x,h,m,!0);break}else m instanceof ArrayBuffer?m=new Uint8Array(m):d.isBindableTypedArray(m)||l("Binding a value as a blob requires","that it be a string, Uint8Array, Int8Array, or ArrayBuffer.");const X=u.alloc(m.byteLength||1);u.heap8().set(m.byteLength?m:[0],X),L=a.sqlite3_bind_blob(x.pointer,h,X,m.byteLength,a.SQLITE_WASM_DEALLOC);break}default:s.config.warn("Unsupported bind() argument type:",m),l("Unsupported bind() argument type: "+typeof m)}return L&&y.checkRc(x.db.pointer,L),x._mayGet=!1,x};E.prototype={finalize:function(){if(this.pointer){T(this,"finalize()");const w=a.sqlite3_finalize(this.pointer);return delete k.get(this.db)[this.pointer],q.delete(this),delete this._mayGet,delete this.parameterCount,delete this._lockedByExec,delete this.db,w}},clearBindings:function(){return T(U(this),"clearBindings()"),a.sqlite3_clear_bindings(this.pointer),this._mayGet=!1,this},reset:function(w){T(this,"reset()"),w&&this.clearBindings();const x=a.sqlite3_reset(U(this).pointer);return this._mayGet=!1,G(this.db,x),this},bind:function(){U(this);let w,x;switch(arguments.length){case 1:w=1,x=arguments[0];break;case 2:w=arguments[0],x=arguments[1];break;default:l("Invalid bind() arguments.")}return x===void 0?this:(this.parameterCount||l("This statement has no bindable parameters."),this._mayGet=!1,x===null?$(this,w,g.null,x):Array.isArray(x)?(arguments.length!==1&&l("When binding an array, an index argument is not permitted."),x.forEach((h,p)=>$(this,p+1,_(h),h)),this):(x instanceof ArrayBuffer&&(x=new Uint8Array(x)),typeof x=="object"&&!d.isBindableTypedArray(x)?(arguments.length!==1&&l("When binding an object, an index argument is not permitted."),Object.keys(x).forEach(h=>$(this,h,_(x[h]),x[h])),this):$(this,w,_(x),x)))},bindAsBlob:function(w,x){U(this),arguments.length===1&&(x=w,w=1);const h=_(x);return g.string!==h&&g.blob!==h&&g.null!==h&&l("Invalid value type for bindAsBlob()"),$(this,w,g.blob,x)},step:function(){T(this,"step()");const w=a.sqlite3_step(U(this).pointer);switch(w){case a.SQLITE_DONE:return this._mayGet=!1;case a.SQLITE_ROW:return this._mayGet=!0;default:this._mayGet=!1,s.config.warn("sqlite3_step() rc=",w,a.sqlite3_js_rc_str(w),"SQL =",a.sqlite3_sql(this.pointer)),y.checkRc(this.db.pointer,w)}},stepReset:function(){return this.step(),this.reset()},stepFinalize:function(){try{const w=this.step();return this.reset(),w}finally{try{this.finalize()}catch{}}},get:function(w,x){if(U(this)._mayGet||l("Stmt.step() has not (recently) returned true."),Array.isArray(w)){let h=0;const p=this.columnCount;for(;h<p;)w[h]=this.get(h++);return w}else if(w&&typeof w=="object"){let h=0;const p=this.columnCount;for(;h<p;)w[a.sqlite3_column_name(this.pointer,h)]=this.get(h++);return w}switch(N(this,w),x===void 0?a.sqlite3_column_type(this.pointer,w):x){case a.SQLITE_NULL:return null;case a.SQLITE_INTEGER:if(u.bigIntEnabled){const h=a.sqlite3_column_int64(this.pointer,w);return h>=Number.MIN_SAFE_INTEGER&&h<=Number.MAX_SAFE_INTEGER?Number(h).valueOf():h}else{const h=a.sqlite3_column_double(this.pointer,w);return(h>Number.MAX_SAFE_INTEGER||h<Number.MIN_SAFE_INTEGER)&&l("Integer is out of range for JS integer range: "+h),d.isInt32(h)?h|0:h}case a.SQLITE_FLOAT:return a.sqlite3_column_double(this.pointer,w);case a.SQLITE_TEXT:return a.sqlite3_column_text(this.pointer,w);case a.SQLITE_BLOB:{const h=a.sqlite3_column_bytes(this.pointer,w),p=a.sqlite3_column_blob(this.pointer,w),m=new Uint8Array(h);return h&&m.set(u.heap8u().slice(p,p+h),0),h&&this.db._blobXfer instanceof Array&&this.db._blobXfer.push(m.buffer),m}default:l("Don't know how to translate","type of result column #"+w+".")}l("Not reached.")},getInt:function(w){return this.get(w,a.SQLITE_INTEGER)},getFloat:function(w){return this.get(w,a.SQLITE_FLOAT)},getString:function(w){return this.get(w,a.SQLITE_TEXT)},getBlob:function(w){return this.get(w,a.SQLITE_BLOB)},getJSON:function(w){const x=this.get(w,a.SQLITE_STRING);return x===null?x:JSON.parse(x)},getColumnName:function(w){return a.sqlite3_column_name(N(U(this),w).pointer,w)},getColumnNames:function(w=[]){N(U(this),0);const x=this.columnCount;for(let h=0;h<x;++h)w.push(a.sqlite3_column_name(this.pointer,h));return w},getParamIndex:function(w){return U(this).parameterCount?a.sqlite3_bind_parameter_index(this.pointer,w):void 0}};{const w={enumerable:!0,get:function(){return q.get(this)},set:()=>l("The pointer property is read-only.")};Object.defineProperty(E.prototype,"pointer",w),Object.defineProperty(y.prototype,"pointer",w)}if(Object.defineProperty(E.prototype,"columnCount",{enumerable:!1,get:function(){return a.sqlite3_column_count(this.pointer)},set:()=>l("The columnCount property is read-only.")}),s.oo1={DB:y,Stmt:E},d.isUIThread()){s.oo1.JsStorageDb=function(x="session"){x!=="session"&&x!=="local"&&l("JsStorageDb db name must be one of 'session' or 'local'."),F.call(this,{filename:x,flags:"c",vfs:"kvvfs"})};const w=s.oo1.JsStorageDb;w.prototype=Object.create(y.prototype),w.clearStorage=a.sqlite3_js_kvvfs_clear,w.prototype.clearStorage=function(){return w.clearStorage(O(this).filename)},w.storageSize=a.sqlite3_js_kvvfs_size,w.prototype.storageSize=function(){return w.storageSize(O(this).filename)}}}),globalThis.sqlite3ApiBootstrap.initializers.push(function(s){s.initWorker1API=function(){const l=(...y)=>{throw new Error(y.join(" "))};globalThis.WorkerGlobalScope instanceof Function||l("initWorker1API() must be run from a Worker thread.");const a=this.sqlite3||l("Missing this.sqlite3 object."),u=a.oo1.DB,d=function(y){let g=q.idMap.get(y);return g||(g="db#"+ ++q.idSeq+"@"+y.pointer,q.idMap.set(y,g),g)},q={dbList:[],idSeq:0,idMap:new WeakMap,xfer:[],open:function(y){const g=new u(y);return this.dbs[d(g)]=g,this.dbList.indexOf(g)<0&&this.dbList.push(g),g},close:function(y,g){if(y){delete this.dbs[d(y)];const E=y.filename,O=a.wasm.sqlite3_wasm_db_vfs(y.pointer,0);y.close();const N=this.dbList.indexOf(y);N>=0&&this.dbList.splice(N,1),g&&E&&O&&a.wasm.sqlite3_wasm_vfs_unlink(O,E)}},post:function(y,g){g&&g.length?(globalThis.postMessage(y,Array.from(g)),g.length=0):globalThis.postMessage(y)},dbs:Object.create(null),getDb:function(y,g=!0){return this.dbs[y]||(g?l("Unknown (or closed) DB ID:",y):void 0)}},k=function(y=q.dbList[0]){return y&&y.pointer?y:l("DB is not opened.")},D=function(y,g=!0){const E=q.getDb(y.dbId,!1)||q.dbList[0];return g?k(E):E},G=function(){return q.dbList[0]&&d(q.dbList[0])},ee=function(y){const g=/^file:.+(vfs=(\w+))/.exec(y);return a.capi.sqlite3_vfs_find(g?g[2]:0)},se=y=>y===""||y[0]===":",F={open:function(y){const g=Object.create(null),E=y.args||Object.create(null);E.simulateError&&l("Throwing because of simulateError flag.");const O=Object.create(null);let N,j;if(g.vfs=E.vfs,se(E.filename)?g.filename=E.filename||"":(g.filename=E.filename,N=E.byteArray,N&&(j=ee(E.filename))),j){let K;try{K=a.wasm.allocFromTypedArray(N);const U=a.wasm.sqlite3_wasm_vfs_create_file(j,g.filename,K,N.byteLength);U&&a.SQLite3Error.toss(U)}catch(U){throw new a.SQLite3Error(U.name+" creating "+E.filename+": "+U.message,{cause:U})}finally{K&&a.wasm.dealloc(K)}}const H=q.open(g);return O.filename=H.filename,O.persistent=!!a.capi.sqlite3_js_db_uses_vfs(H.pointer,"opfs"),O.dbId=d(H),O.vfs=H.dbVfsName(),O},close:function(y){const g=D(y,!1),E={filename:g&&g.filename};if(g){const O=y.args&&typeof y.args=="object"?!!y.args.unlink:!1;q.close(g,O)}return E},exec:function(y){const g=typeof y.args=="string"?{sql:y.args}:y.args||Object.create(null);g.rowMode==="stmt"?l("Invalid rowMode for 'exec': stmt mode","does not work in the Worker API."):g.sql||l("'exec' requires input SQL.");const E=D(y);(g.callback||Array.isArray(g.resultRows))&&(E._blobXfer=q.xfer);const O=g.callback;let N=0;const j=!!g.columnNames;typeof O=="string"&&(j||(g.columnNames=[]),g.callback=function(H,K){q.post({type:O,columnNames:g.columnNames,rowNumber:++N,row:H},q.xfer)});try{const H=g.countChanges?E.changes(!0,g.countChanges===64):void 0;E.exec(g),H!==void 0&&(g.changeCount=E.changes(!0,g.countChanges===64)-H),g.callback instanceof Function&&(g.callback=O,q.post({type:O,columnNames:g.columnNames,rowNumber:null,row:void 0}))}finally{delete E._blobXfer,g.callback&&(g.callback=O)}return g},"config-get":function(){const y=Object.create(null),g=a.config;return["bigIntEnabled"].forEach(function(E){Object.getOwnPropertyDescriptor(g,E)&&(y[E]=g[E])}),y.version=a.version,y.vfsList=a.capi.sqlite3_js_vfs_list(),y.opfsEnabled=!!a.opfs,y},export:function(y){const g=D(y),E={byteArray:a.capi.sqlite3_js_db_export(g.pointer),filename:g.filename,mimetype:"application/x-sqlite3"};return q.xfer.push(E.byteArray.buffer),E},toss:function(y){l("Testing worker exception")},"opfs-tree":async function(y){return a.opfs||l("OPFS support is unavailable."),await a.opfs.treeList()}};globalThis.onmessage=async function(y){y=y.data;let g,E=y.dbId,O=y.type;const N=performance.now();try{F.hasOwnProperty(O)&&F[O]instanceof Function?g=await F[O](y):l("Unknown db worker message type:",y.type)}catch(j){O="error",g={operation:y.type,message:j.message,errorClass:j.name,input:y},j.stack&&(g.stack=typeof j.stack=="string"?j.stack.split(/\n\s*/):j.stack)}E||(E=g.dbId||G()),q.post({type:O,dbId:E,messageId:y.messageId,workerReceivedTime:N,workerRespondTime:performance.now(),departureTime:y.departureTime,result:g},q.xfer)},globalThis.postMessage({type:"sqlite3-api",result:"worker1-ready"})}.bind({sqlite3:s})}),globalThis.sqlite3ApiBootstrap.initializers.push(function(s){const l=s.wasm,a=s.capi,u=s.util.toss3,d=Object.create(null),q=Object.create(null),k=s.StructBinder;s.vfs=d,s.vtab=q;const D=a.sqlite3_index_info;D.prototype.nthConstraint=function(y,g=!1){if(y<0||y>=this.$nConstraint)return!1;const E=this.$aConstraint+D.sqlite3_index_constraint.structInfo.sizeof*y;return g?E:new D.sqlite3_index_constraint(E)},D.prototype.nthConstraintUsage=function(y,g=!1){if(y<0||y>=this.$nConstraint)return!1;const E=this.$aConstraintUsage+D.sqlite3_index_constraint_usage.structInfo.sizeof*y;return g?E:new D.sqlite3_index_constraint_usage(E)},D.prototype.nthOrderBy=function(y,g=!1){if(y<0||y>=this.$nOrderBy)return!1;const E=this.$aOrderBy+D.sqlite3_index_orderby.structInfo.sizeof*y;return g?E:new D.sqlite3_index_orderby(E)};const G=function y(g,E,O,N=y.installMethodArgcCheck){if(g instanceof k.StructType?!(O instanceof Function)&&!l.isPtr(O)&&u("Usage errror: expecting a Function or WASM pointer to one."):u("Usage error: target object is-not-a StructType."),arguments.length===1)return(U,he)=>y(g,U,he,N);y.argcProxy||(y.argcProxy=function(U,he,_,S){return function(...T){return _.length!==arguments.length&&u("Argument mismatch for",U.structInfo.name+"::"+he+": Native signature is:",S),_.apply(this,T)}},y.removeFuncList=function(){this.ondispose.__removeFuncList&&(this.ondispose.__removeFuncList.forEach((U,he)=>{if(typeof U=="number")try{l.uninstallFunction(U)}catch{}}),delete this.ondispose.__removeFuncList)});const j=g.memberSignature(E);j.length<2&&u("Member",E,"does not have a function pointer signature:",j);const H=g.memberKey(E),K=N&&!l.isPtr(O)?y.argcProxy(g,H,O,j):O;if(l.isPtr(K))K&&!l.functionEntry(K)&&u("Pointer",K,"is not a WASM function table entry."),g[H]=K;else{const U=l.installFunction(K,g.memberSignature(E,!0));g[H]=U,(!g.ondispose||!g.ondispose.__removeFuncList)&&(g.addOnDispose("ondispose.__removeFuncList handler",y.removeFuncList),g.ondispose.__removeFuncList=[]),g.ondispose.__removeFuncList.push(H,U)}return(U,he)=>y(g,U,he,N)};G.installMethodArgcCheck=!1;const ee=function(y,g,E=G.installMethodArgcCheck){const O=new Map;for(const N of Object.keys(g)){const j=g[N],H=O.get(j);if(H){const K=y.memberKey(N);y[K]=y[y.memberKey(H)]}else G(y,N,j,E),O.set(j,N)}return y};k.StructType.prototype.installMethod=function(g,E,O=G.installMethodArgcCheck){return arguments.length<3&&g&&typeof g=="object"?ee(this,...arguments):G(this,...arguments)},k.StructType.prototype.installMethods=function(y,g=G.installMethodArgcCheck){return ee(this,y,g)},a.sqlite3_vfs.prototype.registerVfs=function(y=!1){this instanceof s.capi.sqlite3_vfs||u("Expecting a sqlite3_vfs-type argument.");const g=a.sqlite3_vfs_register(this,y?1:0);return g&&u("sqlite3_vfs_register(",this,") failed with rc",g),this.pointer!==a.sqlite3_vfs_find(this.$zName)&&u("BUG: sqlite3_vfs_find(vfs.$zName) failed for just-installed VFS",this),this},d.installVfs=function(y){let g=0;const E=["io","vfs"];for(const O of E){const N=y[O];N&&(++g,ee(N.struct,N.methods,!!N.applyArgcCheck),O==="vfs"&&(!N.struct.$zName&&typeof N.name=="string"&&N.struct.addOnDispose(N.struct.$zName=l.allocCString(N.name)),N.struct.registerVfs(!!N.asDefault)))}return g||u("Misuse: installVfs() options object requires at least","one of:",E),this};const se=function(y,g){return function(E,O=!1){if(arguments.length===0&&(E=new g),E instanceof g)return this.set(E.pointer,E),E;l.isPtr(E)||s.SQLite3Error.toss("Invalid argument to",y+"()");let N=this.get(E);return O&&this.delete(E),N}.bind(new Map)},F=function(y,g){const E=se(y,g);return Object.assign(Object.create(null),{StructType:g,create:O=>{const N=E();return l.pokePtr(O,N.pointer),N},get:O=>E(O),unget:O=>E(O,!0),dispose:O=>{const N=E(O,!0);N&&N.dispose()}})};q.xVtab=F("xVtab",a.sqlite3_vtab),q.xCursor=F("xCursor",a.sqlite3_vtab_cursor),q.xIndexInfo=y=>new a.sqlite3_index_info(y),q.xError=function y(g,E,O){if(y.errorReporter instanceof Function)try{y.errorReporter("sqlite3_module::"+g+"(): "+E.message)}catch{}let N;return E instanceof s.WasmAllocError?N=a.SQLITE_NOMEM:arguments.length>2?N=O:E instanceof s.SQLite3Error&&(N=E.resultCode),N||a.SQLITE_ERROR},q.xError.errorReporter=console.error.bind(console),q.xRowid=(y,g)=>l.poke(y,g,"i64"),q.setupModule=function(y){let g=!1;const E=this instanceof a.sqlite3_module?this:y.struct||(g=new a.sqlite3_module);try{const O=y.methods||u("Missing 'methods' object.");for(const N of Object.entries({xConnect:"xCreate",xDisconnect:"xDestroy"})){const j=N[0],H=N[1];O[j]===!0?O[j]=O[H]:O[H]===!0&&(O[H]=O[j])}if(y.catchExceptions){const N=function(K,U){return["xConnect","xCreate"].indexOf(K)>=0?function(he,_,S,T,$,w){try{return U(...arguments)||0}catch(x){return x instanceof s.WasmAllocError||(l.dealloc(l.peekPtr(w)),l.pokePtr(w,l.allocCString(x.message))),q.xError(K,x)}}:function(...he){try{return U(...he)||0}catch(_){return q.xError(K,_)}}},j=["xCreate","xConnect","xBestIndex","xDisconnect","xDestroy","xOpen","xClose","xFilter","xNext","xEof","xColumn","xRowid","xUpdate","xBegin","xSync","xCommit","xRollback","xFindFunction","xRename","xSavepoint","xRelease","xRollbackTo","xShadowName"],H=Object.create(null);for(const K of j){const U=O[K];if(U instanceof Function)K==="xConnect"&&O.xCreate===U?H[K]=O.xCreate:K==="xCreate"&&O.xConnect===U?H[K]=O.xConnect:H[K]=N(K,U);else continue}ee(E,H,!1)}else ee(E,O,!!y.applyArgcCheck);if(E.$iVersion===0){let N;typeof y.iVersion=="number"?N=y.iVersion:E.$xShadowName?N=3:E.$xSavePoint||E.$xRelease||E.$xRollbackTo?N=2:N=1,E.$iVersion=N}}catch(O){throw g&&g.dispose(),O}return E},a.sqlite3_module.prototype.setupModule=function(y){return q.setupModule.call(this,y)}}),globalThis.sqlite3ApiBootstrap.initializers.push(function(s){const l=function a(u){if(!globalThis.SharedArrayBuffer||!globalThis.Atomics)return Promise.reject(new Error("Cannot install OPFS: Missing SharedArrayBuffer and/or Atomics. The server must emit the COOP/COEP response headers to enable those. See https://sqlite.org/wasm/doc/trunk/persistence.md#coop-coep"));if(typeof WorkerGlobalScope>"u")return Promise.reject(new Error("The OPFS sqlite3_vfs cannot run in the main thread because it requires Atomics.wait()."));if(!globalThis.FileSystemHandle||!globalThis.FileSystemDirectoryHandle||!globalThis.FileSystemFileHandle||!globalThis.FileSystemFileHandle.prototype.createSyncAccessHandle||!navigator?.storage?.getDirectory)return Promise.reject(new Error("Missing required OPFS APIs."));(!u||typeof u!="object")&&(u=Object.create(null));const d=new URL(globalThis.location.href).searchParams;return d.has("opfs-disable")?Promise.resolve(s):(u.verbose===void 0&&(u.verbose=d.has("opfs-verbose")?+d.get("opfs-verbose")||2:1),u.sanityChecks===void 0&&(u.sanityChecks=d.has("opfs-sanity-check")),u.proxyUri===void 0&&(u.proxyUri=a.defaultProxyUri),typeof u.proxyUri=="function"&&(u.proxyUri=u.proxyUri()),new Promise(function(k,D){const G=[s.config.error,s.config.warn,s.config.log],ee=(P,...V)=>{u.verbose>P&&G[P]("OPFS syncer:",...V)},se=(...P)=>ee(2,...P),F=(...P)=>ee(1,...P),y=(...P)=>ee(0,...P),g=s.util.toss,E=s.capi,O=s.util,N=s.wasm,j=E.sqlite3_vfs,H=E.sqlite3_file,K=E.sqlite3_io_methods,U=Object.create(null),he=()=>globalThis.FileSystemHandle&&globalThis.FileSystemDirectoryHandle&&globalThis.FileSystemFileHandle&&globalThis.FileSystemFileHandle.prototype.createSyncAccessHandle&&navigator?.storage?.getDirectory;U.metrics={dump:function(){let P,V=0,z=0,te=0;for(P in m.opIds){const Z=L[P];V+=Z.count,z+=Z.time,te+=Z.wait,Z.avgTime=Z.count&&Z.time?Z.time/Z.count:0,Z.avgWait=Z.count&&Z.wait?Z.wait/Z.count:0}s.config.log(globalThis.location.href,"metrics for",globalThis.location.href,":",L,`
Total of`,V,"op(s) for",z,"ms (incl. "+te+" ms of waiting on the async side)"),s.config.log("Serialization metrics:",L.s11n),x.postMessage({type:"opfs-async-metrics"})},reset:function(){let P;const V=te=>te.count=te.time=te.wait=0;for(P in m.opIds)V(L[P]=Object.create(null));let z=L.s11n=Object.create(null);z=z.serialize=Object.create(null),z.count=z.time=0,z=L.s11n.deserialize=Object.create(null),z.count=z.time=0}};const _=new K,S=new j().addOnDispose(()=>_.dispose());let T;const $=P=>(T=!0,S.dispose(),D(P)),w=()=>(T=!1,k(s)),x=new Worker(new URL(""+new URL("sqlite3-opfs-async-proxy-B1_8Cb2N.js",import.meta.url).href,import.meta.url));setTimeout(()=>{T===void 0&&$(new Error("Timeout while waiting for OPFS async proxy worker."))},4e3),x._originalOnError=x.onerror,x.onerror=function(P){y("Error initializing OPFS asyncer:",P),$(new Error("Loading OPFS async Worker failed for unknown reasons."))};const h=E.sqlite3_vfs_find(null),p=h?new j(h):null;_.$iVersion=1,S.$iVersion=2,S.$szOsFile=E.sqlite3_file.structInfo.sizeof,S.$mxPathname=1024,S.$zName=N.allocCString("opfs"),S.$xDlOpen=S.$xDlError=S.$xDlSym=S.$xDlClose=null,S.addOnDispose("$zName",S.$zName,"cleanup default VFS wrapper",()=>p?p.dispose():null);const m=Object.create(null);m.verbose=u.verbose,m.littleEndian=(()=>{const P=new ArrayBuffer(2);return new DataView(P).setInt16(0,256,!0),new Int16Array(P)[0]===256})(),m.asyncIdleWaitTime=150,m.asyncS11nExceptions=1,m.fileBufferSize=1024*64,m.sabS11nOffset=m.fileBufferSize,m.sabS11nSize=S.$mxPathname*2,m.sabIO=new SharedArrayBuffer(m.fileBufferSize+m.sabS11nSize),m.opIds=Object.create(null);const L=Object.create(null);{let P=0;m.opIds.whichOp=P++,m.opIds.rc=P++,m.opIds.xAccess=P++,m.opIds.xClose=P++,m.opIds.xDelete=P++,m.opIds.xDeleteNoWait=P++,m.opIds.xFileSize=P++,m.opIds.xLock=P++,m.opIds.xOpen=P++,m.opIds.xRead=P++,m.opIds.xSleep=P++,m.opIds.xSync=P++,m.opIds.xTruncate=P++,m.opIds.xUnlock=P++,m.opIds.xWrite=P++,m.opIds.mkdir=P++,m.opIds["opfs-async-metrics"]=P++,m.opIds["opfs-async-shutdown"]=P++,m.opIds.retry=P++,m.sabOP=new SharedArrayBuffer(P*4),U.metrics.reset()}m.sq3Codes=Object.create(null),["SQLITE_ACCESS_EXISTS","SQLITE_ACCESS_READWRITE","SQLITE_BUSY","SQLITE_ERROR","SQLITE_IOERR","SQLITE_IOERR_ACCESS","SQLITE_IOERR_CLOSE","SQLITE_IOERR_DELETE","SQLITE_IOERR_FSYNC","SQLITE_IOERR_LOCK","SQLITE_IOERR_READ","SQLITE_IOERR_SHORT_READ","SQLITE_IOERR_TRUNCATE","SQLITE_IOERR_UNLOCK","SQLITE_IOERR_WRITE","SQLITE_LOCK_EXCLUSIVE","SQLITE_LOCK_NONE","SQLITE_LOCK_PENDING","SQLITE_LOCK_RESERVED","SQLITE_LOCK_SHARED","SQLITE_LOCKED","SQLITE_MISUSE","SQLITE_NOTFOUND","SQLITE_OPEN_CREATE","SQLITE_OPEN_DELETEONCLOSE","SQLITE_OPEN_MAIN_DB","SQLITE_OPEN_READONLY"].forEach(P=>{(m.sq3Codes[P]=E[P])===void 0&&g("Maintenance required: not found:",P)}),m.opfsFlags=Object.assign(Object.create(null),{OPFS_UNLOCK_ASAP:1,defaultUnlockAsap:!1});const X=(P,...V)=>{const z=m.opIds[P]||g("Invalid op ID:",P);m.s11n.serialize(...V),Atomics.store(m.sabOPView,m.opIds.rc,-1),Atomics.store(m.sabOPView,m.opIds.whichOp,z),Atomics.notify(m.sabOPView,m.opIds.whichOp);const te=performance.now();Atomics.wait(m.sabOPView,m.opIds.rc,-1);const Z=Atomics.load(m.sabOPView,m.opIds.rc);if(L[P].wait+=performance.now()-te,Z&&m.asyncS11nExceptions){const ae=m.s11n.deserialize();ae&&y(P+"() async error:",...ae)}return Z};U.debug={asyncShutdown:()=>{F("Shutting down OPFS async listener. The OPFS VFS will no longer work."),X("opfs-async-shutdown")},asyncRestart:()=>{F("Attempting to restart OPFS VFS async listener. Might work, might not."),x.postMessage({type:"opfs-async-restart"})}};const oe=()=>{if(m.s11n)return m.s11n;const P=new TextDecoder,V=new TextEncoder("utf-8"),z=new Uint8Array(m.sabIO,m.sabS11nOffset,m.sabS11nSize),te=new DataView(m.sabIO,m.sabS11nOffset,m.sabS11nSize);m.s11n=Object.create(null);const Z=Object.create(null);Z.number={id:1,size:8,getter:"getFloat64",setter:"setFloat64"},Z.bigint={id:2,size:8,getter:"getBigInt64",setter:"setBigInt64"},Z.boolean={id:3,size:4,getter:"getInt32",setter:"setInt32"},Z.string={id:4};const ae=R=>Z[typeof R]||g("Maintenance required: this value type cannot be serialized.",R),le=R=>{switch(R){case Z.number.id:return Z.number;case Z.bigint.id:return Z.bigint;case Z.boolean.id:return Z.boolean;case Z.string.id:return Z.string;default:g("Invalid type ID:",R)}};return m.s11n.deserialize=function(R=!1){++L.s11n.deserialize.count;const A=performance.now(),b=z[0],C=b?[]:null;if(b){const W=[];let M=1,ne,fe,qe;for(ne=0;ne<b;++ne,++M)W.push(le(z[M]));for(ne=0;ne<b;++ne){const Be=W[ne];Be.getter?(qe=te[Be.getter](M,m.littleEndian),M+=Be.size):(fe=te.getInt32(M,m.littleEndian),M+=4,qe=P.decode(z.slice(M,M+fe)),M+=fe),C.push(qe)}}return R&&(z[0]=0),L.s11n.deserialize.time+=performance.now()-A,C},m.s11n.serialize=function(...R){const A=performance.now();if(++L.s11n.serialize.count,R.length){const b=[];let C=0,W=1;for(z[0]=R.length&255;C<R.length;++C,++W)b.push(ae(R[C])),z[W]=b[C].id;for(C=0;C<R.length;++C){const M=b[C];if(M.setter)te[M.setter](W,R[C],m.littleEndian),W+=M.size;else{const ne=V.encode(R[C]);te.setInt32(W,ne.byteLength,m.littleEndian),W+=4,z.set(ne,W),W+=ne.byteLength}}}else z[0]=0;L.s11n.serialize.time+=performance.now()-A},m.s11n},ue=function P(V=16){P._chars||(P._chars="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ012346789",P._n=P._chars.length);const z=[];let te=0;for(;te<V;++te){const Z=Math.random()*(P._n*64)%P._n|0;z[te]=P._chars[Z]}return z.join("")},_e=Object.create(null),pe=Object.create(null);pe.op=void 0,pe.start=void 0;const ce=P=>{pe.start=performance.now(),pe.op=P,++L[P].count},Ee=()=>L[pe.op].time+=performance.now()-pe.start,Fe={xCheckReservedLock:function(P,V){const z=_e[P];return N.poke(V,z.lockType?1:0,"i32"),0},xClose:function(P){ce("xClose");let V=0;const z=_e[P];return z&&(delete _e[P],V=X("xClose",P),z.sq3File&&z.sq3File.dispose()),Ee(),V},xDeviceCharacteristics:function(P){return E.SQLITE_IOCAP_UNDELETABLE_WHEN_OPEN},xFileControl:function(P,V,z){return E.SQLITE_NOTFOUND},xFileSize:function(P,V){ce("xFileSize");let z=X("xFileSize",P);if(z==0)try{const te=m.s11n.deserialize()[0];N.poke(V,te,"i64")}catch(te){y("Unexpected error reading xFileSize() result:",te),z=m.sq3Codes.SQLITE_IOERR}return Ee(),z},xLock:function(P,V){ce("xLock");const z=_e[P];let te=0;return z.lockType?z.lockType=V:(te=X("xLock",P,V),te===0&&(z.lockType=V)),Ee(),te},xRead:function(P,V,z,te){ce("xRead");const Z=_e[P];let ae;try{ae=X("xRead",P,z,Number(te)),(ae===0||E.SQLITE_IOERR_SHORT_READ===ae)&&N.heap8u().set(Z.sabView.subarray(0,z),V)}catch(le){y("xRead(",arguments,") failed:",le,Z),ae=E.SQLITE_IOERR_READ}return Ee(),ae},xSync:function(P,V){ce("xSync"),++L.xSync.count;const z=X("xSync",P,V);return Ee(),z},xTruncate:function(P,V){ce("xTruncate");const z=X("xTruncate",P,Number(V));return Ee(),z},xUnlock:function(P,V){ce("xUnlock");const z=_e[P];let te=0;return E.SQLITE_LOCK_NONE===V&&z.lockType&&(te=X("xUnlock",P,V)),te===0&&(z.lockType=V),Ee(),te},xWrite:function(P,V,z,te){ce("xWrite");const Z=_e[P];let ae;try{Z.sabView.set(N.heap8u().subarray(V,V+z)),ae=X("xWrite",P,z,Number(te))}catch(le){y("xWrite(",arguments,") failed:",le,Z),ae=E.SQLITE_IOERR_WRITE}return Ee(),ae}},Pe={xAccess:function(P,V,z,te){ce("xAccess");const Z=X("xAccess",N.cstrToJs(V));return N.poke(te,Z?0:1,"i32"),Ee(),0},xCurrentTime:function(P,V){return N.poke(V,24405875e-1+new Date().getTime()/864e5,"double"),0},xCurrentTimeInt64:function(P,V){return N.poke(V,24405875e-1*864e5+new Date().getTime(),"i64"),0},xDelete:function(P,V,z){ce("xDelete");const te=X("xDelete",N.cstrToJs(V),z,!1);return Ee(),te},xFullPathname:function(P,V,z,te){return N.cstrncpy(te,V,z)<z?0:E.SQLITE_CANTOPEN},xGetLastError:function(P,V,z){return F("OPFS xGetLastError() has nothing sensible to return."),0},xOpen:function(V,z,te,Z,ae){ce("xOpen");let le=0;z===0?z=ue():typeof z=="number"&&(E.sqlite3_uri_boolean(z,"opfs-unlock-asap",0)&&(le|=m.opfsFlags.OPFS_UNLOCK_ASAP),z=N.cstrToJs(z));const R=Object.create(null);R.fid=te,R.filename=z,R.sab=new SharedArrayBuffer(m.fileBufferSize),R.flags=Z;const A=X("xOpen",te,z,Z,le);return A||(R.readOnly&&N.poke(ae,E.SQLITE_OPEN_READONLY,"i32"),_e[te]=R,R.sabView=m.sabFileBufView,R.sq3File=new H(te),R.sq3File.$pMethods=_.pointer,R.lockType=E.SQLITE_LOCK_NONE),Ee(),A}};p&&(S.$xRandomness=p.$xRandomness,S.$xSleep=p.$xSleep),S.$xRandomness||(Pe.xRandomness=function(P,V,z){const te=N.heap8u();let Z=0;for(;Z<V;++Z)te[z+Z]=Math.random()*255e3&255;return Z}),S.$xSleep||(Pe.xSleep=function(P,V){return Atomics.wait(m.sabOPView,m.opIds.xSleep,0,V),0}),U.getResolvedPath=function(P,V){const z=new URL(P,"file://irrelevant").pathname;return V?z.split("/").filter(te=>!!te):z},U.getDirForFilename=async function(V,z=!1){const te=U.getResolvedPath(V,!0),Z=te.pop();let ae=U.rootDirectory;for(const le of te)le&&(ae=await ae.getDirectoryHandle(le,{create:!!z}));return[ae,Z]},U.mkdir=async function(P){try{return await U.getDirForFilename(P+"/filepart",!0),!0}catch{return!1}},U.entryExists=async function(P){try{const[V,z]=await U.getDirForFilename(P);return await V.getFileHandle(z),!0}catch{return!1}},U.randomFilename=ue,U.registerVfs=(P=!1)=>N.exports.sqlite3_vfs_register(S.pointer,P?1:0),U.treeList=async function(){const P=async function z(te,Z){Z.name=te.name,Z.dirs=[],Z.files=[];for await(const ae of te.values())if(ae.kind==="directory"){const le=Object.create(null);Z.dirs.push(le),await z(ae,le)}else Z.files.push(ae.name)},V=Object.create(null);return await P(U.rootDirectory,V),V},U.rmfr=async function(){const P=U.rootDirectory,V={recurse:!0};for await(const z of P.values())P.removeEntry(z.name,V)},U.unlink=async function(P,V=!1,z=!1){try{const[te,Z]=await U.getDirForFilename(P,!1);return await te.removeEntry(Z,{recursive:V}),!0}catch(te){if(z)throw new Error("unlink(",arguments[0],") failed: "+te.message,{cause:te});return!1}},U.traverse=async function(P){const V={recursive:!0,directory:U.rootDirectory};typeof P=="function"&&(P={callback:P}),P=Object.assign(V,P||{}),async function te(Z,ae){for await(const le of Z.values()){if(P.callback(le,Z,ae)===!1)return!1;if(P.recursive&&le.kind==="directory"&&await te(le,ae+1)===!1)break}}(P.directory,0)};const rt=async function(P,V){const[z,te]=await U.getDirForFilename(P,!0);let ae=await(await z.getFileHandle(te,{create:!0})).createSyncAccessHandle(),le=0,R,A=!1;try{for(ae.truncate(0);(R=await V())!==void 0;)R instanceof ArrayBuffer&&(R=new Uint8Array(R)),le===0&&R.byteLength>=15&&(O.affirmDbHeader(R),A=!0),ae.write(R,{at:le}),le+=R.byteLength;if((le<512||le%512!==0)&&g("Input size",le,"is not correct for an SQLite database."),!A){const b=new Uint8Array(20);ae.read(b,{at:0}),O.affirmDbHeader(b)}return ae.write(new Uint8Array([1,1]),{at:18}),le}catch(b){throw await ae.close(),ae=void 0,await z.removeEntry(te).catch(()=>{}),b}finally{ae&&await ae.close()}};if(U.importDb=async function(P,V){if(V instanceof Function)return rt(P,V);V instanceof ArrayBuffer&&(V=new Uint8Array(V)),O.affirmIsDb(V);const z=V.byteLength,[te,Z]=await U.getDirForFilename(P,!0);let ae,le=0;try{return ae=await(await te.getFileHandle(Z,{create:!0})).createSyncAccessHandle(),ae.truncate(0),le=ae.write(V,{at:0}),le!=z&&g("Expected to write "+z+" bytes but wrote "+le+"."),ae.write(new Uint8Array([1,1]),{at:18}),le}catch(R){throw ae&&(await ae.close(),ae=void 0),await te.removeEntry(Z).catch(()=>{}),R}finally{ae&&await ae.close()}},s.oo1){const P=function(...V){const z=s.oo1.DB.dbCtorHelper.normalizeArgs(...V);z.vfs=S.$zName,s.oo1.DB.dbCtorHelper.call(this,z)};P.prototype=Object.create(s.oo1.DB.prototype),s.oo1.OpfsDb=P,P.importDb=U.importDb,s.oo1.DB.dbCtorHelper.setVfsPostOpenSql(S.pointer,function(V,z){z.capi.sqlite3_busy_timeout(V,1e4),z.capi.sqlite3_exec(V,["pragma journal_mode=DELETE;","pragma cache_size=-16384;"],0,0,0)})}const _t=function(){const P=N.scopedAllocPush(),V=new H;try{const z=V.pointer,te=E.SQLITE_OPEN_CREATE|E.SQLITE_OPEN_READWRITE|E.SQLITE_OPEN_MAIN_DB,Z=N.scopedAlloc(8),ae="/sanity/check/file"+ue(8),le=N.scopedAllocCString(ae);let R;if(m.s11n.serialize("This is ä string."),R=m.s11n.deserialize(),se("deserialize() says:",R),R[0]!=="This is ä string."&&g("String d13n error."),Pe.xAccess(S.pointer,le,0,Z),R=N.peek(Z,"i32"),se("xAccess(",ae,") exists ?=",R),R=Pe.xOpen(S.pointer,le,z,te,Z),se("open rc =",R,"state.sabOPView[xOpen] =",m.sabOPView[m.opIds.xOpen]),R!==0){y("open failed with code",R);return}Pe.xAccess(S.pointer,le,0,Z),R=N.peek(Z,"i32"),R||g("xAccess() failed to detect file."),R=Fe.xSync(V.pointer,0),R&&g("sync failed w/ rc",R),R=Fe.xTruncate(V.pointer,1024),R&&g("truncate failed w/ rc",R),N.poke(Z,0,"i64"),R=Fe.xFileSize(V.pointer,Z),R&&g("xFileSize failed w/ rc",R),se("xFileSize says:",N.peek(Z,"i64")),R=Fe.xWrite(V.pointer,le,10,1),R&&g("xWrite() failed!");const A=N.scopedAlloc(16);R=Fe.xRead(V.pointer,A,6,2),N.poke(A+6,0);let b=N.cstrToJs(A);se("xRead() got:",b),b!=="sanity"&&g("Unexpected xRead() value."),Pe.xSleep&&(se("xSleep()ing before close()ing..."),Pe.xSleep(S.pointer,2e3),se("waking up from xSleep()")),R=Fe.xClose(z),se("xClose rc =",R,"sabOPView =",m.sabOPView),se("Deleting file:",ae),Pe.xDelete(S.pointer,le,4660),Pe.xAccess(S.pointer,le,0,Z),R=N.peek(Z,"i32"),R&&g("Expecting 0 from xAccess(",ae,") after xDelete()."),F("End of OPFS sanity checks.")}finally{V.dispose(),N.scopedAllocPop(P)}};x.onmessage=function({data:P}){switch(P.type){case"opfs-unavailable":$(new Error(P.payload.join(" ")));break;case"opfs-async-loaded":x.postMessage({type:"opfs-async-init",args:m});break;case"opfs-async-inited":{if(T===!0)break;try{s.vfs.installVfs({io:{struct:_,methods:Fe},vfs:{struct:S,methods:Pe}}),m.sabOPView=new Int32Array(m.sabOP),m.sabFileBufView=new Uint8Array(m.sabIO,0,m.fileBufferSize),m.sabS11nView=new Uint8Array(m.sabIO,m.sabS11nOffset,m.sabS11nSize),oe(),u.sanityChecks&&(F("Running sanity checks because of opfs-sanity-check URL arg..."),_t()),he()?navigator.storage.getDirectory().then(V=>{x.onerror=x._originalOnError,delete x._originalOnError,s.opfs=U,U.rootDirectory=V,se("End of OPFS sqlite3_vfs setup.",S),w()}).catch($):w()}catch(V){y(V),$(V)}break}default:{const V="Unexpected message from the OPFS async worker: "+JSON.stringify(P);y(V),$(new Error(V));break}}}}))};l.defaultProxyUri="sqlite3-opfs-async-proxy.js",globalThis.sqlite3ApiBootstrap.initializersAsync.push(async a=>{try{let u=l.defaultProxyUri;return a.scriptInfo.sqlite3Dir&&(l.defaultProxyUri=a.scriptInfo.sqlite3Dir+u),l().catch(d=>{a.config.warn("Ignoring inability to install OPFS sqlite3_vfs:",d.message)})}catch(u){return a.config.error("installOpfsVfs() exception:",u),Promise.reject(u)}})}),globalThis.sqlite3ApiBootstrap.initializers.push(function(s){var pe,ce,Ee,Fe,Pe,rt,_t,P,V,z,te,Z,ms,le;const l=s.util.toss,a=s.util.toss3,u=Object.create(null),d=s.capi,q=s.util,k=s.wasm,D=4096,G=512,ee=4,se=8,F=G+ee,y=G,g=F,E=D,O=d.SQLITE_OPEN_MAIN_DB|d.SQLITE_OPEN_MAIN_JOURNAL|d.SQLITE_OPEN_SUPER_JOURNAL|d.SQLITE_OPEN_WAL,N=".opaque",j=()=>Math.random().toString(36).slice(2),H=new TextDecoder,K=new TextEncoder,U=Object.assign(Object.create(null),{name:"opfs-sahpool",directory:void 0,initialCapacity:6,clearOnInit:!1,verbosity:2}),he=[s.config.error,s.config.warn,s.config.log];s.config.log;const _=s.config.warn;s.config.error;const S=new Map,T=R=>S.get(R),$=(R,A)=>{A?S.set(R,A):S.delete(R)},w=new Map,x=R=>w.get(R),h=(R,A)=>{A?w.set(R,A):w.delete(R)},p={xCheckReservedLock:function(R,A){const b=x(R);return b.log("xCheckReservedLock"),b.storeErr(),k.poke32(A,1),0},xClose:function(R){const A=x(R);A.storeErr();const b=A.getOFileForS3File(R);if(b)try{A.log(`xClose ${b.path}`),A.mapS3FileToOFile(R,!1),b.sah.flush(),b.flags&d.SQLITE_OPEN_DELETEONCLOSE&&A.deletePath(b.path)}catch(C){return A.storeErr(C,d.SQLITE_IOERR)}return 0},xDeviceCharacteristics:function(R){return d.SQLITE_IOCAP_UNDELETABLE_WHEN_OPEN},xFileControl:function(R,A,b){return d.SQLITE_NOTFOUND},xFileSize:function(R,A){const b=x(R);b.log("xFileSize");const W=b.getOFileForS3File(R).sah.getSize()-E;return k.poke64(A,BigInt(W)),0},xLock:function(R,A){const b=x(R);b.log(`xLock ${A}`),b.storeErr();const C=b.getOFileForS3File(R);return C.lockType=A,0},xRead:function(R,A,b,C){const W=x(R);W.storeErr();const M=W.getOFileForS3File(R);W.log(`xRead ${M.path} ${b} @ ${C}`);try{const ne=M.sah.read(k.heap8u().subarray(A,A+b),{at:E+Number(C)});return ne<b?(k.heap8u().fill(0,A+ne,A+b),d.SQLITE_IOERR_SHORT_READ):0}catch(ne){return W.storeErr(ne,d.SQLITE_IOERR)}},xSectorSize:function(R){return D},xSync:function(R,A){const b=x(R);b.log(`xSync ${A}`),b.storeErr();const C=b.getOFileForS3File(R);try{return C.sah.flush(),0}catch(W){return b.storeErr(W,d.SQLITE_IOERR)}},xTruncate:function(R,A){const b=x(R);b.log(`xTruncate ${A}`),b.storeErr();const C=b.getOFileForS3File(R);try{return C.sah.truncate(E+Number(A)),0}catch(W){return b.storeErr(W,d.SQLITE_IOERR)}},xUnlock:function(R,A){const b=x(R);b.log("xUnlock");const C=b.getOFileForS3File(R);return C.lockType=A,0},xWrite:function(R,A,b,C){const W=x(R);W.storeErr();const M=W.getOFileForS3File(R);W.log(`xWrite ${M.path} ${b} ${C}`);try{const ne=M.sah.write(k.heap8u().subarray(A,A+b),{at:E+Number(C)});return b===ne?0:l("Unknown write() failure.")}catch(ne){return W.storeErr(ne,d.SQLITE_IOERR)}}},m=new d.sqlite3_io_methods;m.$iVersion=1,s.vfs.installVfs({io:{struct:m,methods:p}});const L={xAccess:function(R,A,b,C){const W=T(R);W.storeErr();try{const M=W.getPath(A);k.poke32(C,W.hasFilename(M)?1:0)}catch{k.poke32(C,0)}return 0},xCurrentTime:function(R,A){return k.poke(A,24405875e-1+new Date().getTime()/864e5,"double"),0},xCurrentTimeInt64:function(R,A){return k.poke(A,24405875e-1*864e5+new Date().getTime(),"i64"),0},xDelete:function(R,A,b){const C=T(R);C.log(`xDelete ${k.cstrToJs(A)}`),C.storeErr();try{return C.deletePath(C.getPath(A)),0}catch(W){return C.storeErr(W),d.SQLITE_IOERR_DELETE}},xFullPathname:function(R,A,b,C){return k.cstrncpy(C,A,b)<b?0:d.SQLITE_CANTOPEN},xGetLastError:function(R,A,b){const C=T(R),W=C.popErr();if(C.log(`xGetLastError ${A} e =`,W),W){const M=k.scopedAllocPush();try{const[ne,fe]=k.scopedAllocCString(W.message,!0);k.cstrncpy(b,ne,A),fe>A&&k.poke8(b+A-1,0)}catch{return d.SQLITE_NOMEM}finally{k.scopedAllocPop(M)}}return W?W.sqlite3Rc||d.SQLITE_IOERR:0},xOpen:function(A,b,C,W,M){const ne=T(A);try{ne.log(`xOpen ${k.cstrToJs(b)} ${W}`);const fe=b&&k.peek8(b)?ne.getPath(b):j();let qe=ne.getSAHForPath(fe);!qe&&W&d.SQLITE_OPEN_CREATE&&(ne.getFileCount()<ne.getCapacity()?(qe=ne.nextAvailableSAH(),ne.setAssociatedPath(qe,fe,W)):l("SAH pool is full. Cannot create file",fe)),qe||l("file not found:",fe);const Be={path:fe,flags:W,sah:qe};ne.mapS3FileToOFile(C,Be),Be.lockType=d.SQLITE_LOCK_NONE;const pn=new d.sqlite3_file(C);return pn.$pMethods=m.pointer,pn.dispose(),k.poke32(M,W),0}catch(fe){return ne.storeErr(fe),d.SQLITE_CANTOPEN}}},X=function(R){s.capi.sqlite3_vfs_find(R)&&a("VFS name is already registered:",R);const A=new d.sqlite3_vfs,b=d.sqlite3_vfs_find(null),C=b?new d.sqlite3_vfs(b):null;return A.$iVersion=2,A.$szOsFile=d.sqlite3_file.structInfo.sizeof,A.$mxPathname=G,A.addOnDispose(A.$zName=k.allocCString(R),()=>$(A.pointer,0)),C&&(A.$xRandomness=C.$xRandomness,A.$xSleep=C.$xSleep,C.dispose()),!A.$xRandomness&&!L.xRandomness&&(L.xRandomness=function(W,M,ne){const fe=k.heap8u();let qe=0;for(;qe<M;++qe)fe[ne+qe]=Math.random()*255e3&255;return qe}),!A.$xSleep&&!L.xSleep&&(L.xSleep=(W,M)=>0),s.vfs.installVfs({vfs:{struct:A,methods:L}}),A};class oe{constructor(A=Object.create(null)){B(this,Z);Re(this,"vfsDir");B(this,pe,void 0);B(this,ce,void 0);B(this,Ee,void 0);B(this,Fe,new Map);B(this,Pe,new Map);B(this,rt,new Set);B(this,_t,new Map);B(this,P,new Uint8Array(F));B(this,V,void 0);B(this,z,void 0);B(this,te,void 0);J(this,te,A.verbosity??U.verbosity),this.vfsName=A.name||U.name,J(this,z,X(this.vfsName)),$(i(this,z).pointer,this),this.vfsDir=A.directory||"."+this.vfsName,J(this,V,new DataView(i(this,P).buffer,i(this,P).byteOffset)),this.isReady=this.reset(!!(A.clearOnInit??U.clearOnInit)).then(()=>{if(this.$error)throw this.$error;return this.getCapacity()?Promise.resolve(void 0):this.addCapacity(A.initialCapacity||U.initialCapacity)})}log(...A){ve(this,Z,ms).call(this,2,...A)}warn(...A){ve(this,Z,ms).call(this,1,...A)}error(...A){ve(this,Z,ms).call(this,0,...A)}getVfs(){return i(this,z)}getCapacity(){return i(this,Fe).size}getFileCount(){return i(this,Pe).size}getFileNames(){const A=[],b=i(this,Pe).keys();for(const C of b)A.push(C);return A}async addCapacity(A){for(let b=0;b<A;++b){const C=j(),M=await(await i(this,ce).getFileHandle(C,{create:!0})).createSyncAccessHandle();i(this,Fe).set(M,C),this.setAssociatedPath(M,"",0)}return this.getCapacity()}async reduceCapacity(A){let b=0;for(const C of Array.from(i(this,rt))){if(b===A||this.getFileCount()===this.getCapacity())break;const W=i(this,Fe).get(C);C.close(),await i(this,ce).removeEntry(W),i(this,Fe).delete(C),i(this,rt).delete(C),++b}return b}releaseAccessHandles(){for(const A of i(this,Fe).keys())A.close();i(this,Fe).clear(),i(this,Pe).clear(),i(this,rt).clear()}async acquireAccessHandles(A){const b=[];for await(const[C,W]of i(this,ce))W.kind==="file"&&b.push([C,W]);return Promise.all(b.map(async([C,W])=>{try{const M=await W.createSyncAccessHandle();if(i(this,Fe).set(M,C),A)M.truncate(E),this.setAssociatedPath(M,"",0);else{const ne=this.getAssociatedPath(M);ne?i(this,Pe).set(ne,M):i(this,rt).add(M)}}catch(M){throw this.storeErr(M),this.releaseAccessHandles(),M}}))}getAssociatedPath(A){A.read(i(this,P),{at:0});const b=i(this,V).getUint32(y);if(i(this,P)[0]&&(b&d.SQLITE_OPEN_DELETEONCLOSE||!(b&O)))return _(`Removing file with unexpected flags ${b.toString(16)}`,i(this,P)),this.setAssociatedPath(A,"",0),"";const C=new Uint32Array(se/4);A.read(C,{at:g});const W=this.computeDigest(i(this,P));if(C.every((M,ne)=>M===W[ne])){const M=i(this,P).findIndex(ne=>ne===0);return M===0&&A.truncate(E),M?H.decode(i(this,P).subarray(0,M)):""}else return _("Disassociating file with bad digest."),this.setAssociatedPath(A,"",0),""}setAssociatedPath(A,b,C){const W=K.encodeInto(b,i(this,P));G<=W.written+1&&l("Path too long:",b),i(this,P).fill(0,W.written,G),i(this,V).setUint32(y,C);const M=this.computeDigest(i(this,P));A.write(i(this,P),{at:0}),A.write(M,{at:g}),A.flush(),b?(i(this,Pe).set(b,A),i(this,rt).delete(A)):(A.truncate(E),i(this,rt).add(A))}computeDigest(A){let b=3735928559,C=1103547991;for(const W of A)b=31*b+W*307,C=31*C+W*307;return new Uint32Array([b>>>0,C>>>0])}async reset(A){await this.isReady;let b=await navigator.storage.getDirectory(),C;for(const W of this.vfsDir.split("/"))W&&(C=b,b=await b.getDirectoryHandle(W,{create:!0}));return J(this,pe,b),J(this,Ee,C),J(this,ce,await i(this,pe).getDirectoryHandle(N,{create:!0})),this.releaseAccessHandles(),this.acquireAccessHandles(A)}getPath(A){return k.isPtr(A)&&(A=k.cstrToJs(A)),(A instanceof URL?A:new URL(A,"file://localhost/")).pathname}deletePath(A){const b=i(this,Pe).get(A);return b&&(i(this,Pe).delete(A),this.setAssociatedPath(b,"",0)),!!b}storeErr(A,b){return A&&(A.sqlite3Rc=b||d.SQLITE_IOERR,this.error(A)),this.$error=A,b}popErr(){const A=this.$error;return this.$error=void 0,A}nextAvailableSAH(){const[A]=i(this,rt).keys();return A}getOFileForS3File(A){return i(this,_t).get(A)}mapS3FileToOFile(A,b){b?(i(this,_t).set(A,b),h(A,this)):(i(this,_t).delete(A),h(A,!1))}hasFilename(A){return i(this,Pe).has(A)}getSAHForPath(A){return i(this,Pe).get(A)}async removeVfs(){if(!i(this,z).pointer||!i(this,ce))return!1;d.sqlite3_vfs_unregister(i(this,z).pointer),i(this,z).dispose();try{this.releaseAccessHandles(),await i(this,pe).removeEntry(N,{recursive:!0}),J(this,ce,void 0),await i(this,Ee).removeEntry(i(this,pe).name,{recursive:!0}),J(this,pe,J(this,Ee,void 0))}catch(A){s.config.error(this.vfsName,"removeVfs() failed:",A)}return!0}exportFile(A){const b=i(this,Pe).get(A)||l("File not found:",A),C=b.getSize()-E,W=new Uint8Array(C>0?C:0);if(C>0){const M=b.read(W,{at:E});M!=C&&l("Expected to read "+C+" bytes but read "+M+".")}return W}async importDbChunked(A,b){const C=i(this,Pe).get(A)||this.nextAvailableSAH()||l("No available handles to import to.");C.truncate(0);let W=0,M,ne=!1;try{for(;(M=await b())!==void 0;)M instanceof ArrayBuffer&&(M=new Uint8Array(M)),W===0&&M.byteLength>=15&&(q.affirmDbHeader(M),ne=!0),C.write(M,{at:E+W}),W+=M.byteLength;if((W<512||W%512!==0)&&l("Input size",W,"is not correct for an SQLite database."),!ne){const fe=new Uint8Array(20);C.read(fe,{at:0}),q.affirmDbHeader(fe)}C.write(new Uint8Array([1,1]),{at:E+18})}catch(fe){throw this.setAssociatedPath(C,"",0),fe}return this.setAssociatedPath(C,A,d.SQLITE_OPEN_MAIN_DB),W}importDb(A,b){if(b instanceof ArrayBuffer)b=new Uint8Array(b);else if(b instanceof Function)return this.importDbChunked(A,b);const C=i(this,Pe).get(A)||this.nextAvailableSAH()||l("No available handles to import to."),W=b.byteLength;(W<512||W%512!=0)&&l("Byte array size is invalid for an SQLite db.");const M="SQLite format 3";for(let fe=0;fe<M.length;++fe)M.charCodeAt(fe)!==b[fe]&&l("Input does not contain an SQLite database header.");const ne=C.write(b,{at:E});return ne!=W?(this.setAssociatedPath(C,"",0),l("Expected to write "+W+" bytes but wrote "+ne+".")):(C.write(new Uint8Array([1,1]),{at:E+18}),this.setAssociatedPath(C,A,d.SQLITE_OPEN_MAIN_DB)),ne}}pe=new WeakMap,ce=new WeakMap,Ee=new WeakMap,Fe=new WeakMap,Pe=new WeakMap,rt=new WeakMap,_t=new WeakMap,P=new WeakMap,V=new WeakMap,z=new WeakMap,te=new WeakMap,Z=new WeakSet,ms=function(A,...b){i(this,te)>A&&he[A](this.vfsName+":",...b)};class ue{constructor(A){B(this,le,void 0);J(this,le,A),this.vfsName=A.vfsName}async addCapacity(A){return i(this,le).addCapacity(A)}async reduceCapacity(A){return i(this,le).reduceCapacity(A)}getCapacity(){return i(this,le).getCapacity(i(this,le))}getFileCount(){return i(this,le).getFileCount()}getFileNames(){return i(this,le).getFileNames()}async reserveMinimumCapacity(A){const b=i(this,le).getCapacity();return b<A?i(this,le).addCapacity(A-b):b}exportFile(A){return i(this,le).exportFile(A)}importDb(A,b){return i(this,le).importDb(A,b)}async wipeFiles(){return i(this,le).reset(!0)}unlink(A){return i(this,le).deletePath(A)}async removeVfs(){return i(this,le).removeVfs()}}le=new WeakMap;const _e=async()=>{const R=await navigator.storage.getDirectory(),A=".opfs-sahpool-sync-check-"+j(),W=(await(await R.getFileHandle(A,{create:!0})).createSyncAccessHandle()).close();return await W,await R.removeEntry(A),W?.then&&l("The local OPFS API is too old for opfs-sahpool:","it has an async FileSystemSyncAccessHandle.close() method."),!0};s.installOpfsSAHPoolVfs=async function(R=Object.create(null)){const A=R.name||U.name;return u[A]?u[A]:!globalThis.FileSystemHandle||!globalThis.FileSystemDirectoryHandle||!globalThis.FileSystemFileHandle||!globalThis.FileSystemFileHandle.prototype.createSyncAccessHandle||!navigator?.storage?.getDirectory?u[A]=Promise.reject(new Error("Missing required OPFS APIs.")):u[A]=_e().then(async function(){if(R.$testThrowInInit)throw R.$testThrowInInit;const b=new oe(R);return b.isReady.then(async()=>{const C=new ue(b);if(s.oo1){const W=s.oo1,M=b.getVfs(),ne=function(...fe){const qe=W.DB.dbCtorHelper.normalizeArgs(...fe);qe.vfs=M.$zName,W.DB.dbCtorHelper.call(this,qe)};ne.prototype=Object.create(W.DB.prototype),C.OpfsSAHPoolDb=ne,W.DB.dbCtorHelper.setVfsPostOpenSql(M.pointer,function(fe,qe){qe.capi.sqlite3_exec(fe,["pragma journal_mode=DELETE;","pragma cache_size=-16384;"],0,0,0)})}return b.log("VFS initialized."),C}).catch(async C=>(await b.removeVfs().catch(()=>{}),C))}).catch(b=>u[A]=Promise.reject(b))}}),typeof o<"u"){const s=Object.assign(Object.create(null),{exports:typeof wasmExports>"u"?o.asm:wasmExports,memory:o.wasmMemory},globalThis.sqlite3ApiConfig||{});globalThis.sqlite3ApiConfig=s;let l;try{l=globalThis.sqlite3ApiBootstrap()}catch(a){throw console.error("sqlite3ApiBootstrap() error:",a),a}finally{delete globalThis.sqlite3ApiBootstrap,delete globalThis.sqlite3ApiConfig}o.sqlite3=l}else console.warn("This is not running in an Emscripten module context, so","globalThis.sqlite3ApiBootstrap() is _not_ being called due to lack","of config info for the WASM environment.","It must be called manually.")}),r.ready}})();const qf=function(){const t=ma;if(!t)throw new Error("Expecting globalThis.sqlite3InitModule to be defined by the Emscripten build.");const e=globalThis.sqlite3InitModuleState=Object.assign(Object.create(null),{moduleScript:globalThis?.document?.currentScript,isWorker:typeof WorkerGlobalScope<"u",location:globalThis.location,urlParams:globalThis?.location?.href?new URL(globalThis.location.href).searchParams:new URLSearchParams});if(e.debugModule=e.urlParams.has("sqlite3.debugModule")?(...r)=>console.warn("sqlite3.debugModule:",...r):()=>{},e.urlParams.has("sqlite3.dir"))e.sqlite3Dir=e.urlParams.get("sqlite3.dir")+"/";else if(e.moduleScript){const r=e.moduleScript.src.split("/");r.pop(),e.sqlite3Dir=r.join("/")+"/"}if(globalThis.sqlite3InitModule=function r(...n){return t(...n).then(I=>{const Q=I.sqlite3;Q.scriptInfo=e,r.__isUnderTest&&(Q.__isUnderTest=!0);const re=Q.asyncPostInit;return delete Q.asyncPostInit,re()}).catch(I=>{throw console.error("Exception loading sqlite3 module:",I),I})},globalThis.sqlite3InitModule.ready=t.ready,globalThis.sqlite3InitModuleState.moduleScript){const r=globalThis.sqlite3InitModuleState;let n=r.moduleScript.src.split("/");n.pop(),r.scriptDir=n.join("/")+"/"}return e.debugModule("sqlite3InitModuleState =",e),globalThis.sqlite3InitModule}();ma=qf;var Nf=ma;globalThis.sqlite3Worker1Promiser=function t(e=t.defaultConfig){if(arguments.length===1&&typeof arguments[0]=="function"){const ie=e;e=Object.assign(Object.create(null),t.defaultConfig),e.onready=ie}else e=Object.assign(Object.create(null),t.defaultConfig,e);const r=Object.create(null),n=function(){},I=e.onerror||n,Q=e.debug||n,re=e.generateMessageId?void 0:Object.create(null),Ie=e.generateMessageId||function(ie){return ie.type+"#"+(re[ie.type]=(re[ie.type]||0)+1)},ze=(...ie)=>{throw new Error(ie.join(" "))};e.worker||(e.worker=t.defaultConfig.worker),typeof e.worker=="function"&&(e.worker=e.worker());let He;return e.worker.onmessage=function(ie){ie=ie.data,Q("worker1.onmessage",ie);let be=r[ie.messageId];if(!be){if(ie&&ie.type==="sqlite3-api"&&ie.result==="worker1-ready"){e.onready&&e.onready();return}if(be=r[ie.type],be&&be.onrow){be.onrow(ie);return}e.onunhandled?e.onunhandled(arguments[0]):I("sqlite3Worker1Promiser() unhandled worker message:",ie);return}switch(delete r[ie.messageId],ie.type){case"error":be.reject(ie);return;case"open":He||(He=ie.dbId);break;case"close":ie.dbId===He&&(He=void 0);break}try{be.resolve(ie)}catch(Te){be.reject(Te)}},function(){let ie;arguments.length===1?ie=arguments[0]:arguments.length===2?(ie=Object.create(null),ie.type=arguments[0],ie.args=arguments[1],ie.dbId=ie.args.dbId):ze("Invalid arugments for sqlite3Worker1Promiser()-created factory."),!ie.dbId&&ie.type!=="open"&&(ie.dbId=He),ie.messageId=Ie(ie),ie.departureTime=performance.now();const be=Object.create(null);be.message=ie;let Te;ie.type==="exec"&&ie.args&&(typeof ie.args.callback=="function"?(Te=ie.messageId+":row",be.onrow=ie.args.callback,ie.args.callback=Te,r[Te]=be):typeof ie.args.callback=="string"&&ze("exec callback may not be a string when using the Promise interface."));let Vt=new Promise(function(Ot,ht){be.resolve=Ot,be.reject=ht,r[ie.messageId]=be,Q("Posting",ie.type,"message to Worker dbId="+(He||"default")+":",ie),e.worker.postMessage(ie)});return Te&&(Vt=Vt.finally(()=>delete r[Te])),Vt}};globalThis.sqlite3Worker1Promiser.defaultConfig={worker:function(){return new Worker(new URL(""+new URL("sqlite3-worker1-bundler-friendly-IVoUF4Jv.js",import.meta.url).href,import.meta.url),{type:"module"})},onerror:(...t)=>console.error("worker1 promiser error",...t)};var vf=class extends ua{constructor(e){super();Re(this,"serializer");this.serializer=e}transformPrimitiveValueList(e){return{...e,values:e.values.map(this.serializer)}}transformColumnUpdate(e){const{value:r}=e;if(r.kind!=="ValueNode")return super.transformColumnUpdate(e);const{value:n,...I}=r,Q=this.serializer(n);return n===Q?super.transformColumnUpdate(e):super.transformColumnUpdate({...e,value:{...I,value:Q}})}transformValue(e){return{...e,value:this.serializer(e.value)}}},fu=t=>{if(hu(t)||typeof t=="string")return t;if(typeof t=="boolean")return""+t;if(t instanceof Date)return t.toISOString();try{return JSON.stringify(t)}catch{return t}},xf=/^\d{4}-\d{2}-\d{2}[T ]\d{2}:\d{2}:\d{2}(?:\.\d+)?Z?$/,Ef=t=>{if(hu(t))return t;if(typeof t=="string"){if(t==="true")return!0;if(t==="false")return!1;if(xf.test(t))return new Date(t);if(t[0]==="{"&&t[t.length-1]==="}"||t[0]==="["&&t[t.length-1]==="]")try{return JSON.parse(t)}catch{}return t}};function hu(t){return t==null||typeof t=="bigint"||typeof t=="number"||typeof t=="object"&&"buffer"in t}var Sf=class{constructor(t={}){Re(this,"transformer");Re(this,"deserializer");Re(this,"skipNodeSet");Re(this,"ctx");const{deserializer:e=Ef,serializer:r=fu,skipNodeKind:n=[]}=t;this.transformer=new vf(r),this.deserializer=e,n.length&&(this.skipNodeSet=new Set(n),this.ctx=new WeakSet)}transformQuery({node:t,queryId:e}){return this.skipNodeSet?.has(t.kind)?(this.ctx?.add(e),t):this.transformer.transformNode(t)}async transformResult({result:t,queryId:e}){return this.ctx?.has(e)?t:{...t,rows:this.parseRows(t.rows)}}parseRows(t){const e=[];for(const r of t){const n={};for(const[I,Q]of Object.entries(r))n[I]=this.deserializer(Q);e.push(n)}return e}};function fl(t){const{logger:e,merge:r,logQueryNode:n}=t;return I=>{const{level:Q,queryDurationMillis:re,query:{parameters:Ie,sql:ze,query:He}}=I,ie="__Q__",be=Q==="error"?I.error:void 0;let Te=ze.replace(/\r?\n/g," ").replace(/\s+/g," ");r&&Ie.forEach(Ot=>{let ht=Ot;Ot instanceof Date&&(ht=Ot.toLocaleString()),typeof ht=="string"&&(ht=`'${ht}'`.replace(/\?/g,ie)),Te=Te.replace(/\?/,ht)});const Vt={sql:Te.replace(new RegExp(ie,"g"),"?"),params:Ie,duration:re,error:be};n&&(Vt.queryNode=He),e(Vt)}}async function If(t){const{rows:e}=await t.executeQuery(qr.raw("PRAGMA integrity_check"));if(!e.length)throw new Error("fail to check integrity");return e[0].integrity_check==="ok"}async function hl(t,e){if(e)return await t.executeQuery(qr.raw(`PRAGMA user_version = ${e}`)),e;const{rows:r}=await t.executeQuery(qr.raw("PRAGMA user_version"));if(!r.length)throw new Error("fail to get DBVersion");return r[0].user_version}function kf(t){return`__pre_${t}`}function Af(t){return typeof t=="string"&&t.startsWith("__pre_")?t.slice(6):void 0}async function Of(t,e){const r=e||`sp_${Date.now()%1e8}`;return await ft`savepoint ${ft.raw(r)}`.execute(t),{release:async()=>{await ft`release savepoint ${ft.raw(r)}`.execute(t)},rollback:async()=>{await ft`rollback to savepoint ${ft.raw(r)}`.execute(t)}}}async function Tf(t,e,r){const{release:n,rollback:I}=await Of(t,r);try{const Q=await e(t);return await n(),Q}catch(Q){throw await I(),Q}}function Cf(t){return{selectFrom:e=>t().selectFrom(e),insertInto:e=>t().insertInto(e),updateTable:e=>t().updateTable(e),deleteFrom:e=>t().deleteFrom(e)}}var Ff=class extends Error{constructor(){super("db file maybe broken")}};function Pf(t){return t.toOperationNode().kind==="SelectQueryNode"}var Wf=class{constructor(t){Re(this,"_kysely");Re(this,"trxCount",0);Re(this,"trx");Re(this,"logger");Re(this,"executor");Re(this,"serializer",fu);const{dialect:e,logger:r,onQuery:n,plugins:I=[],serializerPluginOptions:Q,executorFn:re=Cf}=t;this.logger=r,Q?.serializer&&(this.serializer=Q.serializer),I.push(new Sf(Q));let Ie;n===!0?Ie=fl({logger:this.logger?.debug||console.log,merge:!0}):n&&(Ie=fl(n)),this._kysely=new Pi({dialect:e,log:Ie,plugins:I}),this.executor=re(()=>this.kysely)}get kysely(){return this.trx||this._kysely}async syncDB(t,e){try{if(e&&!await If(this._kysely))return this.logger?.error("integrity check fail"),{ready:!1,error:new Ff};const r=await t(this._kysely,this.logger);return this.logger?.info("table updated"),r}catch(r){return this.logError(r,"sync table fail"),{ready:!1,error:r}}}logError(t,e){e&&this.logger?.error(e,t instanceof Error?t:void 0)}async transaction(t,e={}){return this.trx?(this.trxCount++,this.logger?.debug(`run in savepoint: sp_${this.trxCount}`),await Tf(this.trx,t,`sp_${this.trxCount}`).then(async r=>(await e.onCommit?.(r),r)).catch(async r=>{await e.onRollback?.(r),this.logError(r,e.errorMsg)}).finally(()=>this.trxCount--)):await this._kysely.transaction().execute(async r=>(this.trx=r,this.logger?.debug("run in transaction"),await t(r))).then(async r=>(await e.onCommit?.(r),r)).catch(async r=>{await e.onRollback?.(r),this.logError(r,e.errorMsg)}).finally(()=>this.trx=void 0)}async execute(t){return typeof t=="function"?await t(this.executor).execute():await this.kysely.executeQuery(t)}async executeTakeFirst(t){let e=t(this.executor);return Pf(e)&&(e=e.limit(1)),await e.executeTakeFirst()}precompile(t=e=>({kind:e.kind})){return this.logger?.debug?.("precompile"),{build:e=>{let r;const n=()=>r=null;return{[Symbol.dispose]:n,dispose:n,compile:I=>{if(!r){const{parameters:Q,sql:re,query:Ie}=e(this.executor,kf).compile();r={sql:re,query:t(Ie),parameters:Q}}return{...r,parameters:r.parameters.map(Q=>{const re=Af(Q);return re?this.serializer(I[re]):Q})}}}}}}async raw(t,e){return typeof t=="string"?await this.kysely.executeQuery(qr.raw(t,e)):await t.execute(this.kysely)}async optimize(t){await this.raw(t?"vacuum":"pragma optimize")}async destroy(){this.logger?.info("destroyed"),await this._kysely.destroy(),this.trx=void 0}},pu="__TIME_TRIGGER__";function Lf(t,e){const{create:r,update:n}=e?.timeTrigger||{},I={type:"date",defaultTo:pu};r===!0?t.createAt=I:r&&(t[r]=I),n===!0?t.updateAt={...I,notNull:!0}:n&&(t[n]={...I,notNull:!0});const Q=e?.softDelete,re={type:"int",defaultTo:0};return Q===!0?t.isDeleted=re:Q&&(t[Q]=re),{columns:t,...e}}function mu(t){let e="text",r=!1;switch(t){case"boolean":case"date":case"object":case"string":e="text";break;case"float":e="real";break;case"increments":r=!0;case"int":e="integer";break;default:e=t}return{dataType:e,isIncrements:r}}function Yo(t){return Array.isArray(t)?t:[t]}function Df(t){return typeof t=="function"}async function Fo(t,e){await t.schema.dropTable(e).execute()}async function pl(t,e,r){const{index:n,...I}=r,Q=await yu(t,e,I);await gu(t,e,Q),await _u(t,e,n)}async function _u(t,e,r){for(const n of r||[]){const I=Yo(n);await t.schema.createIndex(`idx_${e}_${I.join("_")}`).on(e).columns(I).ifNotExists().execute()}}async function yu(t,e,{columns:r,primary:n,timeTrigger:I,unique:Q},re=!1){const Ie=I?{triggerKey:"rowid",update:void 0}:void 0;let ze=!1,He=t.schema.createTable(e);re&&(He=He.temporary());for(const[ie,be]of Object.entries(r)){let Te="text";const{type:Vt,notNull:Ot,defaultTo:ht}=be,An=mu(Vt);Te=An.dataType,He=He.addColumn(ie,Te,Le=>An.isIncrements?(ze=!0,Ie&&(Ie.triggerKey=ie),Le.autoIncrement().primaryKey()):ht===pu?(Ie&&Ot&&(Ie.update=ie),Le.defaultTo(ft`CURRENT_TIMESTAMP`)):(Ot===!0&&(Le=Le.notNull()),ht!==void 0&&(Le=Le.defaultTo(Df(ht)?ht(ft):ht)),Le))}if(!ze&&n){const ie=Yo(n);He=He.addPrimaryKeyConstraint(`pk#${ie.join("#")}`,ie)}for(const ie of Q||[]){const be=Yo(ie);He=He.addUniqueConstraint(`un#${be.join("#")}`,be)}return await He.ifNotExists().execute(),Ie}async function gu(t,e,r){if(!r||!r.update)return;const{triggerKey:n,update:I}=r,Q=`tgr_${e}_${I}`;await ft`create trigger if not exists ${ft.ref(Q)}
after update
on ${ft.table(e)}
begin
  update ${ft.table(e)}
  set ${ft.ref(I)} = CURRENT_TIMESTAMP
  where ${ft.ref(n)} = NEW.${ft.ref(n)};
end`.execute(t)}async function Rf(t,e,r){await t.schema.alterTable(e).renameTo(r).execute()}function Mf(t){const e=/create table (?:if not exist)?\s*"([^"]+)".*?\((.*)\)/i,r=/"([^"]+)"\s+(\w+)\s?(not null)?/gi,[,n,I]=t.replace(/\r?\n/g,"").match(e),Q={columns:{},name:n,primary:void 0,unique:[]},re=I.matchAll(r);for(const Ie of re){const[,ze,He,ie]=Ie;if(ze.startsWith("pk#")){const[,...be]=ze.split("#");Q.primary=be}else if(ze.startsWith("un#")){const[,...be]=ze.split("#");Q.unique.push(be)}else Q.columns[ze]={type:He,notNull:!!ie}}return Q}async function Bf(t,e=[]){const r=await t.selectFrom("sqlite_master").where("type","in",["table","trigger","index"]).where("name","!=",uu).where("name","!=",cu).where("name","not like","sqlite_%").$if(!!e.length,I=>I.where(Q=>Q.and(e.map(re=>Q("name","not like",`${re}%`))))).select(["name","sql","type"]).$castTo().execute(),n={existTables:{},indexList:[],triggerList:[]};for(const{name:I,sql:Q,type:re}of r)Q&&(re==="table"?n.existTables[I]=Mf(Q):re==="index"?n.indexList.push(I):n.triggerList.push(I));return n}async function Qf(t,e,r={},n){const{truncateIfExists:I=[],log:Q,version:{current:re,skipSyncWhenSame:Ie}={},excludeTablePrefix:ze,onSyncSuccess:He,onSyncFail:ie}=r;if(re){if(Ie&&re===await hl(t))return{ready:!0};await hl(t,re)}const be=Le=>Q&&n?.debug(Le),{existTables:Te,indexList:Vt,triggerList:Ot}=await Bf(t,ze);be("====== update tables start ======");const ht=new Set(Array.isArray(I)?I:I?Object.keys(Te):[]);return await t.transaction().execute(async Le=>{for(const Ce of Vt)await Le.schema.dropIndex(Ce).ifExists().execute();for(const Ce of Ot)await ft`drop trigger if exists ${ft.ref(Ce)}`.execute(Le);for(const[Ce,$t]of Object.entries(Te))if(!(Ce in e))be(`remove table: ${Ce}`),await Fo(Le,Ce);else{be(`diff table: ${Ce}`);try{await An(Le,Ce,$t,e[Ce])}catch(vt){throw n?.error(`fail to sync ${Ce}`,vt),vt}}for(const[Ce,$t]of Object.entries(e))Ce in Te||(be(`create table: ${Ce}`),await pl(Le,Ce,$t))}).then(()=>(He?.(t),be("======= update tables success ======="),{ready:!0})).catch(Le=>(ie?.(Le),be("======= update tables fail ======="),{ready:!1,error:Le}));async function An(Le,Ce,$t,vt){if(ht.has(Ce)){await Fo(Le,Ce),await pl(Le,Ce,vt),be("clear and sync structure");return}const{index:ts,...No}=vt,On=Uf($t.columns,vt.columns);if(On.length===Object.keys($t.columns).length){be("same table structure, skip");return}be("different table structure, update");const nn=`_temp_${Ce}`,vo=await yu(Le,nn,No);On.length&&await Le.insertInto(nn).columns(On).expression(xr=>xr.selectFrom(Ce).select(On)).execute(),await Fo(Le,Ce),await Rf(Le,nn,Ce),await _u(Le,Ce,ts),await gu(Le,Ce,vo),be(`restore columns: ${On}`)}}function Uf(t,e){const r=[];for(const[n,I]of Object.entries(e))n in t&&mu(I.type).dataType===t[n].type&&(I.notNull||!1)===(t[n].notNull||!1)&&r.push(n);return r}function jf(t,e={}){const{log:r}=e;return(n,I)=>Qf(n,t,e,r?I:void 0)}const zf={test:Lf({id:{type:"increments"},name:{type:"string"},blobtest:{type:"blob"}},{timeTrigger:{create:!0,update:!0}})};async function Vf(t){const e=new Wf({dialect:t}),r=await e.syncDB(jf(zf));if(!r.ready)throw r.error;console.log(await e.raw("PRAGMA table_info('test')"));for(let n=0;n<10;n++)await e.transaction(async()=>{await e.transaction(async()=>{if(n>8)throw console.log("test rollback"),new Error("test rollback");await e.execute(I=>I.insertInto("test").values({name:`test at ${Date.now()}`,blobtest:Uint8Array.from([2,3,4,5,6,7,8])}))})});return e.execute(n=>n.selectFrom("test").selectAll()).then(async n=>(await e.destroy(),console.log(n),n))}const $f=new bf({database:async()=>{const t=(await Nf()).oo1;if(!t)return Promise.reject("fail to load sqlite");const e="/test.db";return t.OpfsDb?(console.log("support OPFS"),new t.OpfsDb(e)):(console.log("doesn't support OPFS"),new t.DB(e))}});onmessage=()=>{console.log("start official wasm test"),Vf($f).then(t=>{t?.forEach(e=>console.log("[official wasm]",e))})};
