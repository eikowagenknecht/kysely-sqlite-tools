var hi=Object.defineProperty;var di=(f,s,i)=>s in f?hi(f,s,{enumerable:!0,configurable:!0,writable:!0,value:i}):f[s]=i;var Nn=(f,s,i)=>(di(f,typeof s!="symbol"?s+"":s,i),i),Ut=(f,s,i)=>{if(!s.has(f))throw TypeError("Cannot "+i)};var w=(f,s,i)=>(Ut(f,s,"read from private field"),i?i.call(f):s.get(f)),D=(f,s,i)=>{if(s.has(f))throw TypeError("Cannot add the same private member more than once");s instanceof WeakSet?s.add(f):s.set(f,i)},P=(f,s,i,_)=>(Ut(f,s,"write to private field"),_?_.call(f,i):s.set(f,i),i);var J=(f,s,i)=>(Ut(f,s,"access private method"),i);import{B as wi}from"./chunk-4SDTIXLM-jINDC4AW.js";import{S as bi,a as _i,b as $,c as pi,d as mi,e as ie,f as yi,g as Ie,h as vi,i as gi,j as Ei,k as xi,l as Si,m as Le,n as Ri,o as Ai,p as bt,q as _t,r as Ci}from"./worker-Cs2xuRzF.js";var qi=(()=>{var f=import.meta.url;return function(s={}){var i=s,_,h;i.ready=new Promise((e,t)=>{_=e,h=t});var g=Object.assign({},i),C="./this.program",q=(e,t)=>{throw t},Y=typeof window=="object",B=typeof importScripts=="function",H="",G;(Y||B)&&(B?H=self.location.href:typeof document<"u"&&document.currentScript&&(H=document.currentScript.src),f&&(H=f),H.indexOf("blob:")!==0?H=H.substr(0,H.replace(/[?#].*/,"").lastIndexOf("/")+1):H="",B&&(G=e=>{var t=new XMLHttpRequest;return t.open("GET",e,!1),t.responseType="arraybuffer",t.send(null),new Uint8Array(t.response)}));var xe=i.print||console.log.bind(console),Z=i.printErr||console.error.bind(console);Object.assign(i,g),g=null,i.thisProgram&&(C=i.thisProgram),i.quit&&(q=i.quit);var we;i.wasmBinary&&(we=i.wasmBinary),typeof WebAssembly!="object"&&se("no native wasm support detected");var te,z=!1,ue,L,E,Fe,S,N,xt,St;function Ft(){var e=te.buffer;i.HEAP8=L=new Int8Array(e),i.HEAP16=Fe=new Int16Array(e),i.HEAPU8=E=new Uint8Array(e),i.HEAPU16=new Uint16Array(e),i.HEAP32=S=new Int32Array(e),i.HEAPU32=N=new Uint32Array(e),i.HEAPF32=xt=new Float32Array(e),i.HEAPF64=St=new Float64Array(e)}var Qt=[],jt=[],jn=[],Ht=[];function Hn(){var e=i.preRun.shift();Qt.unshift(e)}var Se=0,Qe=null;function se(e){throw i.onAbort&&i.onAbort(e),e="Aborted("+e+")",Z(e),z=!0,ue=1,e=new WebAssembly.RuntimeError(e+". Build with -sASSERTIONS for more info."),h(e),e}var Wt=e=>e.startsWith("data:application/octet-stream;base64,"),Re;if(i.locateFile){if(Re="wa-sqlite-async.wasm",!Wt(Re)){var Kt=Re;Re=i.locateFile?i.locateFile(Kt,H):H+Kt}}else Re=new URL(""+new URL("wa-sqlite-async-5YBo1gYB.wasm",import.meta.url).href,import.meta.url).href;function Xt(e){if(e==Re&&we)return new Uint8Array(we);if(G)return G(e);throw"both async and sync fetching of the wasm failed"}function Wn(e){return we||!Y&&!B||typeof fetch!="function"?Promise.resolve().then(()=>Xt(e)):fetch(e,{credentials:"same-origin"}).then(t=>{if(!t.ok)throw"failed to load wasm binary file at '"+e+"'";return t.arrayBuffer()}).catch(()=>Xt(e))}function Yt(e,t,r){return Wn(e).then(n=>WebAssembly.instantiate(n,t)).then(n=>n).then(r,n=>{Z(`failed to asynchronously prepare wasm: ${n}`),se(n)})}function Kn(e,t){var r=Re;return we||typeof WebAssembly.instantiateStreaming!="function"||Wt(r)||typeof fetch!="function"?Yt(r,e,t):fetch(r,{credentials:"same-origin"}).then(n=>WebAssembly.instantiateStreaming(n,e).then(t,function(o){return Z(`wasm streaming compile failed: ${o}`),Z("falling back to ArrayBuffer instantiation"),Yt(r,e,t)}))}var x,k;function Zt(e){this.name="ExitStatus",this.message=`Program terminated with exit(${e})`,this.status=e}var et=e=>{for(;0<e.length;)e.shift()(i)};function F(e,t="i8"){switch(t.endsWith("*")&&(t="*"),t){case"i1":return L[e>>0];case"i8":return L[e>>0];case"i16":return Fe[e>>1];case"i32":return S[e>>2];case"i64":se("to do getValue(i64) use WASM_BIGINT");case"float":return xt[e>>2];case"double":return St[e>>3];case"*":return N[e>>2];default:se(`invalid type for getValue: ${t}`)}}var Jt=i.noExitRuntime||!0;function ce(e,t,r="i8"){switch(r.endsWith("*")&&(r="*"),r){case"i1":L[e>>0]=t;break;case"i8":L[e>>0]=t;break;case"i16":Fe[e>>1]=t;break;case"i32":S[e>>2]=t;break;case"i64":se("to do setValue(i64) use WASM_BIGINT");case"float":xt[e>>2]=t;break;case"double":St[e>>3]=t;break;case"*":N[e>>2]=t;break;default:se(`invalid type for setValue: ${r}`)}}var Gt=typeof TextDecoder<"u"?new TextDecoder("utf8"):void 0,M=(e,t,r)=>{var n=t+r;for(r=t;e[r]&&!(r>=n);)++r;if(16<r-t&&e.buffer&&Gt)return Gt.decode(e.subarray(t,r));for(n="";t<r;){var o=e[t++];if(o&128){var u=e[t++]&63;if((o&224)==192)n+=String.fromCharCode((o&31)<<6|u);else{var a=e[t++]&63;o=(o&240)==224?(o&15)<<12|u<<6|a:(o&7)<<18|u<<12|a<<6|e[t++]&63,65536>o?n+=String.fromCharCode(o):(o-=65536,n+=String.fromCharCode(55296|o>>10,56320|o&1023))}}else n+=String.fromCharCode(o)}return n},er=(e,t)=>{for(var r=0,n=e.length-1;0<=n;n--){var o=e[n];o==="."?e.splice(n,1):o===".."?(e.splice(n,1),r++):r&&(e.splice(n,1),r--)}if(t)for(;r;r--)e.unshift("..");return e},_e=e=>{var t=e.charAt(0)==="/",r=e.substr(-1)==="/";return(e=er(e.split("/").filter(n=>!!n),!t).join("/"))||t||(e="."),e&&r&&(e+="/"),(t?"/":"")+e},Xn=e=>{var t=/^(\/?|)([\s\S]*?)((?:\.{1,2}|[^\/]+?|)(\.[^.\/]*|))(?:[\/]*)$/.exec(e).slice(1);return e=t[0],t=t[1],!e&&!t?".":(t&&(t=t.substr(0,t.length-1)),e+t)},tt=e=>{if(e==="/")return"/";e=_e(e),e=e.replace(/\/$/,"");var t=e.lastIndexOf("/");return t===-1?e:e.substr(t+1)},Yn=()=>{if(typeof crypto=="object"&&typeof crypto.getRandomValues=="function")return e=>crypto.getRandomValues(e);se("initRandomDevice")},tr=e=>(tr=Yn())(e);function rt(){for(var e="",t=!1,r=arguments.length-1;-1<=r&&!t;r--){if(t=0<=r?arguments[r]:"/",typeof t!="string")throw new TypeError("Arguments to path.resolve must be strings");if(!t)return"";e=t+"/"+e,t=t.charAt(0)==="/"}return e=er(e.split("/").filter(n=>!!n),!t).join("/"),(t?"/":"")+e||"."}var Rt=[],Ae=e=>{for(var t=0,r=0;r<e.length;++r){var n=e.charCodeAt(r);127>=n?t++:2047>=n?t+=2:55296<=n&&57343>=n?(t+=4,++r):t+=3}return t},Ce=(e,t,r,n)=>{if(!(0<n))return 0;var o=r;n=r+n-1;for(var u=0;u<e.length;++u){var a=e.charCodeAt(u);if(55296<=a&&57343>=a){var b=e.charCodeAt(++u);a=65536+((a&1023)<<10)|b&1023}if(127>=a){if(r>=n)break;t[r++]=a}else{if(2047>=a){if(r+1>=n)break;t[r++]=192|a>>6}else{if(65535>=a){if(r+2>=n)break;t[r++]=224|a>>12}else{if(r+3>=n)break;t[r++]=240|a>>18,t[r++]=128|a>>12&63}t[r++]=128|a>>6&63}t[r++]=128|a&63}}return t[r]=0,r-o},rr=[];function nr(e,t){rr[e]={input:[],Rb:[],bc:t},Mt(e,Zn)}var Zn={open(e){var t=rr[e.node.ec];if(!t)throw new p(43);e.Sb=t,e.seekable=!1},close(e){e.Sb.bc.ic(e.Sb)},ic(e){e.Sb.bc.ic(e.Sb)},read(e,t,r,n){if(!e.Sb||!e.Sb.bc.xc)throw new p(60);for(var o=0,u=0;u<n;u++){try{var a=e.Sb.bc.xc(e.Sb)}catch{throw new p(29)}if(a===void 0&&o===0)throw new p(6);if(a==null)break;o++,t[r+u]=a}return o&&(e.node.timestamp=Date.now()),o},write(e,t,r,n){if(!e.Sb||!e.Sb.bc.rc)throw new p(60);try{for(var o=0;o<n;o++)e.Sb.bc.rc(e.Sb,t[r+o])}catch{throw new p(29)}return n&&(e.node.timestamp=Date.now()),o}},Jn={xc(){e:{if(!Rt.length){var e=null;if(typeof window<"u"&&typeof window.prompt=="function"?(e=window.prompt("Input: "),e!==null&&(e+=`
`)):typeof readline=="function"&&(e=readline(),e!==null&&(e+=`
`)),!e){var t=null;break e}t=Array(Ae(e)+1),e=Ce(e,t,0,t.length),t.length=e,Rt=t}t=Rt.shift()}return t},rc(e,t){t===null||t===10?(xe(M(e.Rb,0)),e.Rb=[]):t!=0&&e.Rb.push(t)},ic(e){e.Rb&&0<e.Rb.length&&(xe(M(e.Rb,0)),e.Rb=[])},Yc(){return{Uc:25856,Wc:5,Tc:191,Vc:35387,Sc:[3,28,127,21,4,0,1,0,17,19,26,0,18,15,23,22,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]}},Zc(){return 0},$c(){return[24,80]}},Gn={rc(e,t){t===null||t===10?(Z(M(e.Rb,0)),e.Rb=[]):t!=0&&e.Rb.push(t)},ic(e){e.Rb&&0<e.Rb.length&&(Z(M(e.Rb,0)),e.Rb=[])}};function ir(e,t){var r=e.Nb?e.Nb.length:0;r>=t||(t=Math.max(t,r*(1048576>r?2:1.125)>>>0),r!=0&&(t=Math.max(t,256)),r=e.Nb,e.Nb=new Uint8Array(t),0<e.Pb&&e.Nb.set(r.subarray(0,e.Pb),0))}var A={Vb:null,Ub(){return A.createNode(null,"/",16895,0)},createNode(e,t,r,n){if((r&61440)===24576||(r&61440)===4096)throw new p(63);return A.Vb||(A.Vb={dir:{node:{Tb:A.Cb.Tb,Qb:A.Cb.Qb,cc:A.Cb.cc,jc:A.Cb.jc,Bc:A.Cb.Bc,oc:A.Cb.oc,mc:A.Cb.mc,Ac:A.Cb.Ac,nc:A.Cb.nc},stream:{Zb:A.Mb.Zb}},file:{node:{Tb:A.Cb.Tb,Qb:A.Cb.Qb},stream:{Zb:A.Mb.Zb,read:A.Mb.read,write:A.Mb.write,uc:A.Mb.uc,kc:A.Mb.kc,lc:A.Mb.lc}},link:{node:{Tb:A.Cb.Tb,Qb:A.Cb.Qb,fc:A.Cb.fc},stream:{}},vc:{node:{Tb:A.Cb.Tb,Qb:A.Cb.Qb},stream:ni}}),r=ur(e,t,r,n),ae(r.mode)?(r.Cb=A.Vb.dir.node,r.Mb=A.Vb.dir.stream,r.Nb={}):(r.mode&61440)===32768?(r.Cb=A.Vb.file.node,r.Mb=A.Vb.file.stream,r.Pb=0,r.Nb=null):(r.mode&61440)===40960?(r.Cb=A.Vb.link.node,r.Mb=A.Vb.link.stream):(r.mode&61440)===8192&&(r.Cb=A.Vb.vc.node,r.Mb=A.Vb.vc.stream),r.timestamp=Date.now(),e&&(e.Nb[t]=r,e.timestamp=r.timestamp),r},Xc(e){return e.Nb?e.Nb.subarray?e.Nb.subarray(0,e.Pb):new Uint8Array(e.Nb):new Uint8Array(0)},Cb:{Tb(e){var t={};return t.Hc=(e.mode&61440)===8192?e.id:1,t.yc=e.id,t.mode=e.mode,t.Nc=1,t.uid=0,t.Kc=0,t.ec=e.ec,ae(e.mode)?t.size=4096:(e.mode&61440)===32768?t.size=e.Pb:(e.mode&61440)===40960?t.size=e.link.length:t.size=0,t.Dc=new Date(e.timestamp),t.Mc=new Date(e.timestamp),t.Gc=new Date(e.timestamp),t.Ec=4096,t.Fc=Math.ceil(t.size/t.Ec),t},Qb(e,t){if(t.mode!==void 0&&(e.mode=t.mode),t.timestamp!==void 0&&(e.timestamp=t.timestamp),t.size!==void 0&&(t=t.size,e.Pb!=t))if(t==0)e.Nb=null,e.Pb=0;else{var r=e.Nb;e.Nb=new Uint8Array(t),r&&e.Nb.set(r.subarray(0,Math.min(t,e.Pb))),e.Pb=t}},cc(){throw Ct[44]},jc(e,t,r,n){return A.createNode(e,t,r,n)},Bc(e,t,r){if(ae(e.mode)){try{var n=qe(t,r)}catch{}if(n)for(var o in n.Nb)throw new p(55)}delete e.parent.Nb[e.name],e.parent.timestamp=Date.now(),e.name=r,t.Nb[r]=e,t.timestamp=e.parent.timestamp,e.parent=t},oc(e,t){delete e.Nb[t],e.timestamp=Date.now()},mc(e,t){var r=qe(e,t),n;for(n in r.Nb)throw new p(55);delete e.Nb[t],e.timestamp=Date.now()},Ac(e){var t=[".",".."],r;for(r in e.Nb)e.Nb.hasOwnProperty(r)&&t.push(r);return t},nc(e,t,r){return e=A.createNode(e,t,41471,0),e.link=r,e},fc(e){if((e.mode&61440)!==40960)throw new p(28);return e.link}},Mb:{read(e,t,r,n,o){var u=e.node.Nb;if(o>=e.node.Pb)return 0;if(e=Math.min(e.node.Pb-o,n),8<e&&u.subarray)t.set(u.subarray(o,o+e),r);else for(n=0;n<e;n++)t[r+n]=u[o+n];return e},write(e,t,r,n,o,u){if(t.buffer===L.buffer&&(u=!1),!n)return 0;if(e=e.node,e.timestamp=Date.now(),t.subarray&&(!e.Nb||e.Nb.subarray)){if(u)return e.Nb=t.subarray(r,r+n),e.Pb=n;if(e.Pb===0&&o===0)return e.Nb=t.slice(r,r+n),e.Pb=n;if(o+n<=e.Pb)return e.Nb.set(t.subarray(r,r+n),o),n}if(ir(e,o+n),e.Nb.subarray&&t.subarray)e.Nb.set(t.subarray(r,r+n),o);else for(u=0;u<n;u++)e.Nb[o+u]=t[r+u];return e.Pb=Math.max(e.Pb,o+n),n},Zb(e,t,r){if(r===1?t+=e.position:r===2&&(e.node.mode&61440)===32768&&(t+=e.node.Pb),0>t)throw new p(28);return t},uc(e,t,r){ir(e.node,t+r),e.node.Pb=Math.max(e.node.Pb,t+r)},kc(e,t,r,n,o){if((e.node.mode&61440)!==32768)throw new p(43);if(e=e.node.Nb,o&2||e.buffer!==L.buffer){if((0<r||r+t<e.length)&&(e.subarray?e=e.subarray(r,r+t):e=Array.prototype.slice.call(e,r,r+t)),r=!0,t=65536*Math.ceil(t/65536),(o=gn(65536,t))?(E.fill(0,o,o+t),t=o):t=0,!t)throw new p(48);L.set(e,t)}else r=!1,t=e.byteOffset;return{Oc:t,Cc:r}},lc(e,t,r,n){return A.Mb.write(e,t,0,n,r,!1),0}}},ei=(e,t)=>{var r=0;return e&&(r|=365),t&&(r|=146),r},At=null,or={},je=[],ti=1,pe=null,sr=!0,p=null,Ct={};function re(e,t={}){if(e=rt(e),!e)return{path:"",node:null};if(t=Object.assign({wc:!0,sc:0},t),8<t.sc)throw new p(32);e=e.split("/").filter(a=>!!a);for(var r=At,n="/",o=0;o<e.length;o++){var u=o===e.length-1;if(u&&t.parent)break;if(r=qe(r,e[o]),n=_e(n+"/"+e[o]),r.$b&&(!u||u&&t.wc)&&(r=r.$b.root),!u||t.Yb){for(u=0;(r.mode&61440)===40960;)if(r=br(n),n=rt(Xn(n),r),r=re(n,{sc:t.sc+1}).node,40<u++)throw new p(32)}}return{path:n,node:r}}function nt(e){for(var t;;){if(e===e.parent)return e=e.Ub.zc,t?e[e.length-1]!=="/"?`${e}/${t}`:e+t:e;t=t?`${e.name}/${t}`:e.name,e=e.parent}}function qt(e,t){for(var r=0,n=0;n<t.length;n++)r=(r<<5)-r+t.charCodeAt(n)|0;return(e+r>>>0)%pe.length}function ar(e){var t=qt(e.parent.id,e.name);if(pe[t]===e)pe[t]=e.ac;else for(t=pe[t];t;){if(t.ac===e){t.ac=e.ac;break}t=t.ac}}function qe(e,t){var r;if(r=(r=Pe(e,"x"))?r:e.Cb.cc?0:2)throw new p(r,e);for(r=pe[qt(e.id,t)];r;r=r.ac){var n=r.name;if(r.parent.id===e.id&&n===t)return r}return e.Cb.cc(e,t)}function ur(e,t,r,n){return e=new pn(e,t,r,n),t=qt(e.parent.id,e.name),e.ac=pe[t],pe[t]=e}function ae(e){return(e&61440)===16384}function cr(e){var t=["r","w","rw"][e&3];return e&512&&(t+="w"),t}function Pe(e,t){if(sr)return 0;if(!t.includes("r")||e.mode&292){if(t.includes("w")&&!(e.mode&146)||t.includes("x")&&!(e.mode&73))return 2}else return 2;return 0}function lr(e,t){try{return qe(e,t),20}catch{}return Pe(e,"wx")}function fr(e,t,r){try{var n=qe(e,t)}catch(o){return o.Ob}if(e=Pe(e,"wx"))return e;if(r){if(!ae(n.mode))return 54;if(n===n.parent||nt(n)==="/")return 10}else if(ae(n.mode))return 31;return 0}function ri(){for(var e=0;4096>=e;e++)if(!je[e])return e;throw new p(33)}function ee(e){if(e=je[e],!e)throw new p(8);return e}function hr(e,t=-1){return We||(We=function(){this.hc={}},We.prototype={},Object.defineProperties(We.prototype,{object:{get(){return this.node},set(r){this.node=r}},flags:{get(){return this.hc.flags},set(r){this.hc.flags=r}},position:{get(){return this.hc.position},set(r){this.hc.position=r}}})),e=Object.assign(new We,e),t==-1&&(t=ri()),e.Wb=t,je[t]=e}var ni={open(e){e.Mb=or[e.node.ec].Mb,e.Mb.open&&e.Mb.open(e)},Zb(){throw new p(70)}};function Mt(e,t){or[e]={Mb:t}}function dr(e,t){var r=t==="/",n=!t;if(r&&At)throw new p(10);if(!r&&!n){var o=re(t,{wc:!1});if(t=o.path,o=o.node,o.$b)throw new p(10);if(!ae(o.mode))throw new p(54)}t={type:e,bd:{},zc:t,Lc:[]},e=e.Ub(t),e.Ub=t,t.root=e,r?At=e:o&&(o.$b=t,o.Ub&&o.Ub.Lc.push(t))}function It(e,t,r){var n=re(e,{parent:!0}).node;if(e=tt(e),!e||e==="."||e==="..")throw new p(28);var o=lr(n,e);if(o)throw new p(o);if(!n.Cb.jc)throw new p(63);return n.Cb.jc(n,e,t,r)}function le(e,t){return It(e,(t!==void 0?t:511)&1023|16384,0)}function it(e,t,r){typeof r>"u"&&(r=t,t=438),It(e,t|8192,r)}function Nt(e,t){if(!rt(e))throw new p(44);var r=re(t,{parent:!0}).node;if(!r)throw new p(44);t=tt(t);var n=lr(r,t);if(n)throw new p(n);if(!r.Cb.nc)throw new p(63);r.Cb.nc(r,t,e)}function wr(e){var t=re(e,{parent:!0}).node;e=tt(e);var r=qe(t,e),n=fr(t,e,!0);if(n)throw new p(n);if(!t.Cb.mc)throw new p(63);if(r.$b)throw new p(10);t.Cb.mc(t,e),ar(r)}function br(e){if(e=re(e).node,!e)throw new p(44);if(!e.Cb.fc)throw new p(28);return rt(nt(e.parent),e.Cb.fc(e))}function ot(e,t){if(e=re(e,{Yb:!t}).node,!e)throw new p(44);if(!e.Cb.Tb)throw new p(63);return e.Cb.Tb(e)}function _r(e){return ot(e,!0)}function pr(e,t){if(e=typeof e=="string"?re(e,{Yb:!0}).node:e,!e.Cb.Qb)throw new p(63);e.Cb.Qb(e,{mode:t&4095|e.mode&-4096,timestamp:Date.now()})}function mr(e,t){if(0>t)throw new p(28);if(e=typeof e=="string"?re(e,{Yb:!0}).node:e,!e.Cb.Qb)throw new p(63);if(ae(e.mode))throw new p(31);if((e.mode&61440)!==32768)throw new p(28);var r=Pe(e,"w");if(r)throw new p(r);e.Cb.Qb(e,{size:t,timestamp:Date.now()})}function st(e,t,r){if(e==="")throw new p(44);if(typeof t=="string"){var n={r:0,"r+":2,w:577,"w+":578,a:1089,"a+":1090}[t];if(typeof n>"u")throw Error(`Unknown file open mode: ${t}`);t=n}if(r=t&64?(typeof r>"u"?438:r)&4095|32768:0,typeof e=="object")var o=e;else{e=_e(e);try{o=re(e,{Yb:!(t&131072)}).node}catch{}}if(n=!1,t&64)if(o){if(t&128)throw new p(20)}else o=It(e,r,0),n=!0;if(!o)throw new p(44);if((o.mode&61440)===8192&&(t&=-513),t&65536&&!ae(o.mode))throw new p(54);if(!n&&(r=o?(o.mode&61440)===40960?32:ae(o.mode)&&(cr(t)!=="r"||t&512)?31:Pe(o,cr(t)):44))throw new p(r);return t&512&&!n&&mr(o,0),t&=-131713,o=hr({node:o,path:nt(o),flags:t,seekable:!0,position:0,Mb:o.Mb,Rc:[],error:!1}),o.Mb.open&&o.Mb.open(o),!i.logReadFiles||t&1||(at||(at={}),e in at||(at[e]=1)),o}function yr(e,t,r){if(e.Wb===null)throw new p(8);if(!e.seekable||!e.Mb.Zb)throw new p(70);if(r!=0&&r!=1&&r!=2)throw new p(28);e.position=e.Mb.Zb(e,t,r),e.Rc=[]}function vr(){p||(p=function(e,t){this.name="ErrnoError",this.node=t,this.Pc=function(r){this.Ob=r},this.Pc(e),this.message="FS error"},p.prototype=Error(),p.prototype.constructor=p,[44].forEach(e=>{Ct[e]=new p(e),Ct[e].stack="<generic error, no stack>"}))}var gr;function He(e,t,r){e=_e("/dev/"+e);var n=ei(!!t,!!r);Dt||(Dt=64);var o=Dt++<<8|0;Mt(o,{open(u){u.seekable=!1},close(){r&&r.buffer&&r.buffer.length&&r(10)},read(u,a,b,c){for(var l=0,y=0;y<c;y++){try{var d=t()}catch{throw new p(29)}if(d===void 0&&l===0)throw new p(6);if(d==null)break;l++,a[b+y]=d}return l&&(u.node.timestamp=Date.now()),l},write(u,a,b,c){for(var l=0;l<c;l++)try{r(a[b+l])}catch{throw new p(29)}return c&&(u.node.timestamp=Date.now()),l}}),it(e,n,o)}var Dt,O={},We,at;function Me(e,t,r){if(t.charAt(0)==="/")return t;if(e=e===-100?"/":ee(e).path,t.length==0){if(!r)throw new p(44);return e}return _e(e+"/"+t)}function ut(e,t,r){try{var n=e(t)}catch(u){if(u&&u.node&&_e(t)!==_e(nt(u.node)))return-54;throw u}S[r>>2]=n.Hc,S[r+4>>2]=n.mode,N[r+8>>2]=n.Nc,S[r+12>>2]=n.uid,S[r+16>>2]=n.Kc,S[r+20>>2]=n.ec,k=[n.size>>>0,(x=n.size,1<=+Math.abs(x)?0<x?+Math.floor(x/4294967296)>>>0:~~+Math.ceil((x-+(~~x>>>0))/4294967296)>>>0:0)],S[r+24>>2]=k[0],S[r+28>>2]=k[1],S[r+32>>2]=4096,S[r+36>>2]=n.Fc,e=n.Dc.getTime(),t=n.Mc.getTime();var o=n.Gc.getTime();return k=[Math.floor(e/1e3)>>>0,(x=Math.floor(e/1e3),1<=+Math.abs(x)?0<x?+Math.floor(x/4294967296)>>>0:~~+Math.ceil((x-+(~~x>>>0))/4294967296)>>>0:0)],S[r+40>>2]=k[0],S[r+44>>2]=k[1],N[r+48>>2]=e%1e3*1e3,k=[Math.floor(t/1e3)>>>0,(x=Math.floor(t/1e3),1<=+Math.abs(x)?0<x?+Math.floor(x/4294967296)>>>0:~~+Math.ceil((x-+(~~x>>>0))/4294967296)>>>0:0)],S[r+56>>2]=k[0],S[r+60>>2]=k[1],N[r+64>>2]=t%1e3*1e3,k=[Math.floor(o/1e3)>>>0,(x=Math.floor(o/1e3),1<=+Math.abs(x)?0<x?+Math.floor(x/4294967296)>>>0:~~+Math.ceil((x-+(~~x>>>0))/4294967296)>>>0:0)],S[r+72>>2]=k[0],S[r+76>>2]=k[1],N[r+80>>2]=o%1e3*1e3,k=[n.yc>>>0,(x=n.yc,1<=+Math.abs(x)?0<x?+Math.floor(x/4294967296)>>>0:~~+Math.ceil((x-+(~~x>>>0))/4294967296)>>>0:0)],S[r+88>>2]=k[0],S[r+92>>2]=k[1],0}var ct=void 0;function lt(){var e=S[+ct>>2];return ct+=4,e}var Ke=(e,t)=>t+2097152>>>0<4194305-!!e?(e>>>0)+4294967296*t:NaN,ii=[0,31,60,91,121,152,182,213,244,274,305,335],oi=[0,31,59,90,120,151,181,212,243,273,304,334],Er=e=>{var t=Ae(e)+1,r=$t(t);return r&&Ce(e,E,r,t),r},Ot={},xr=()=>{if(!kt){var e={USER:"web_user",LOGNAME:"web_user",PATH:"/",PWD:"/",HOME:"/home/web_user",LANG:(typeof navigator=="object"&&navigator.languages&&navigator.languages[0]||"C").replace("-","_")+".UTF-8",_:C||"./this.program"},t;for(t in Ot)Ot[t]===void 0?delete e[t]:e[t]=Ot[t];var r=[];for(t in e)r.push(`${t}=${e[t]}`);kt=r}return kt},kt;function Sr(){}function Rr(){}function Ar(){}function Cr(){}function qr(){}function Mr(){}function Ir(){}function Nr(){}function Dr(){}function Or(){}function kr(){}function Tr(){}function Pr(){}function $r(){}function Lr(){}function Ur(){}function Vr(){}function Br(){}function zr(){}function Fr(){}function Qr(){}function jr(){}function Hr(){}function Wr(){}function Kr(){}function Xr(){}function Yr(){}function Zr(){}function Jr(){}function Gr(){}function en(){}function tn(){}function rn(){}function nn(){}function on(){}function sn(){}function an(){}function un(){}function cn(){}var ft=0,ln=e=>{ue=e,Jt||0<ft||(i.onExit&&i.onExit(e),z=!0),q(e,new Zt(e))},Tt=e=>{e instanceof Zt||e=="unwind"||q(1,e)},ht=e=>{try{e()}catch(t){se(t)}};function si(){var e=v,t={},r;for(r in e)(function(n){var o=e[n];t[n]=typeof o=="function"?function(){dt.push(n);try{return o.apply(null,arguments)}finally{z||(dt.pop()===n||se(),fe&&me===1&&dt.length===0&&(me=0,ht(An),typeof Fibers<"u"&&Fibers.cd()))}}:o})(r);return t}var me=0,fe=null,fn=0,dt=[],hn={},dn={},ai=0,Pt=null,ui=[];function ci(){return new Promise((e,t)=>{Pt={resolve:e,reject:t}})}function li(){var e=$t(16396),t=e+12;N[e>>2]=t,N[e+4>>2]=t+16384,t=dt[0];var r=hn[t];return r===void 0&&(r=ai++,hn[t]=r,dn[r]=t),S[e+8>>2]=r,e}function wn(e){if(!z){if(me===0){var t=!1,r=!1;e((n=0)=>{if(!z&&(fn=n,t=!0,r)){me=2,ht(()=>Cn(fe)),typeof Browser<"u"&&Browser.qc.Jc&&Browser.qc.resume(),n=!1;try{var o=(0,v[dn[S[fe+8>>2]]])()}catch(b){o=b,n=!0}var u=!1;if(!fe){var a=Pt;a&&(Pt=null,(n?a.reject:a.resolve)(o),u=!0)}if(n&&!u)throw o}}),r=!0,t||(me=1,fe=li(),typeof Browser<"u"&&Browser.qc.Jc&&Browser.qc.pause(),ht(()=>Rn(fe)))}else me===2?(me=0,ht(qn),yn(fe),fe=null,ui.forEach(n=>{if(!z)try{if(n(),!(Jt||0<ft))try{ue=n=ue,ln(n)}catch(o){Tt(o)}}catch(o){Tt(o)}})):se(`invalid state: ${me}`);return fn}}function bn(e){return wn(t=>{e().then(t)})}var _n={},he=(e,t,r,n,o)=>{function u(d){return--ft,c!==0&&Sn(c),t==="string"?d?M(E,d):"":t==="boolean"?!!d:d}var a={string:d=>{var m=0;if(d!=null&&d!==0){m=Ae(d)+1;var R=Lt(m);Ce(d,E,R,m),m=R}return m},array:d=>{var m=Lt(d.length);return L.set(d,m),m}};e=i["_"+e];var b=[],c=0;if(n)for(var l=0;l<n.length;l++){var y=a[r[l]];y?(c===0&&(c=xn()),b[l]=y(n[l])):b[l]=n[l]}return r=fe,n=e.apply(null,b),o=o&&o.async,ft+=1,fe!=r?ci().then(u):(n=u(n),o?Promise.resolve(n):n)};function pn(e,t,r,n){e||(e=this),this.parent=e,this.Ub=e.Ub,this.$b=null,this.id=ti++,this.name=t,this.mode=r,this.Cb={},this.Mb={},this.ec=n}Object.defineProperties(pn.prototype,{read:{get:function(){return(this.mode&365)===365},set:function(e){e?this.mode|=365:this.mode&=-366}},write:{get:function(){return(this.mode&146)===146},set:function(e){e?this.mode|=146:this.mode&=-147}}}),vr(),pe=Array(4096),dr(A,"/"),le("/tmp"),le("/home"),le("/home/web_user"),function(){le("/dev"),Mt(259,{read:()=>0,write:(n,o,u,a)=>a}),it("/dev/null",259),nr(1280,Jn),nr(1536,Gn),it("/dev/tty",1280),it("/dev/tty1",1536);var e=new Uint8Array(1024),t=0,r=()=>(t===0&&(t=tr(e).byteLength),e[--t]);He("random",r),He("urandom",r),le("/dev/shm"),le("/dev/shm/tmp")}(),function(){le("/proc");var e=le("/proc/self");le("/proc/self/fd"),dr({Ub(){var t=ur(e,"fd",16895,73);return t.Cb={cc(r,n){var o=ee(+n);return r={parent:null,Ub:{zc:"fake"},Cb:{fc:()=>o.path}},r.parent=r}},t}},"/proc/self/fd")}(),function(){const e=new Map;i.setAuthorizer=function(t,r,n){return r?e.set(t,{f:r,tc:n}):e.delete(t),he("set_authorizer","number",["number"],[t])},Sr=function(t,r,n,o,u,a){if(e.has(t)){const{f:b,tc:c}=e.get(t);return b(c,r,n?n?M(E,n):"":null,o?o?M(E,o):"":null,u?u?M(E,u):"":null,a?a?M(E,a):"":null)}return 0}}(),function(){const e=new Map,t=new Map;i.createFunction=function(r,n,o,u,a,b){const c=e.size;return e.set(c,{f:b,Xb:a}),he("create_function","number","number string number number number number".split(" "),[r,n,o,u,c,0])},i.createAggregate=function(r,n,o,u,a,b,c){const l=e.size;return e.set(l,{step:b,Ic:c,Xb:a}),he("create_function","number","number string number number number number".split(" "),[r,n,o,u,l,1])},i.getFunctionUserData=function(r){return t.get(r)},Ar=function(r,n,o,u){r=e.get(r),t.set(n,r.Xb),r.f(n,new Uint32Array(E.buffer,u,o)),t.delete(n)},qr=function(r,n,o,u){r=e.get(r),t.set(n,r.Xb),r.step(n,new Uint32Array(E.buffer,u,o)),t.delete(n)},Rr=function(r,n){r=e.get(r),t.set(n,r.Xb),r.Ic(n),t.delete(n)}}(),function(){const e=new Map;i.progressHandler=function(t,r,n,o){return n?e.set(t,{f:n,tc:o}):e.delete(t),he("progress_handler",null,["number","number"],[t,r])},Cr=function(t){if(e.has(t)){const{f:r,tc:n}=e.get(t);return r(n)}return 0}}(),function(){function e(c,l){const y=`get${c}`,d=`set${c}`;return new Proxy(new DataView(E.buffer,l,c==="Int32"?4:8),{get(m,R){if(R===y)return function(I,Q){if(!Q)throw Error("must be little endian");return m[R](I,Q)};if(R===d)return function(I,Q,U){if(!U)throw Error("must be little endian");return m[R](I,Q,U)};if(typeof R=="string"&&R.match(/^(get)|(set)/))throw Error("invalid type");return m[R]}})}const t=typeof _n=="object",r=new Map,n=new Map,o=new Map,u=t?new Set:null,a=t?new Set:null,b=new Map;jr=function(c,l,y,d){b.set(c?M(E,c):"",{size:l,dc:Array.from(new Uint32Array(E.buffer,d,y))})},i.createModule=function(c,l,y,d){t&&(y.handleAsync=bn);const m=r.size;return r.set(m,{module:y,Xb:d}),d=0,y.xCreate&&(d|=1),y.xConnect&&(d|=2),y.xBestIndex&&(d|=4),y.xDisconnect&&(d|=8),y.xDestroy&&(d|=16),y.xOpen&&(d|=32),y.xClose&&(d|=64),y.xFilter&&(d|=128),y.xNext&&(d|=256),y.xEof&&(d|=512),y.xColumn&&(d|=1024),y.xRowid&&(d|=2048),y.xUpdate&&(d|=4096),y.xBegin&&(d|=8192),y.xSync&&(d|=16384),y.xCommit&&(d|=32768),y.xRollback&&(d|=65536),y.xFindFunction&&(d|=131072),y.xRename&&(d|=262144),he("create_module","number",["number","string","number","number"],[c,l,m,d])},Tr=function(c,l,y,d,m,R){if(l=r.get(l),n.set(m,l),t){u.delete(m);for(const I of u)n.delete(I)}return d=Array.from(new Uint32Array(E.buffer,d,y)).map(I=>I?M(E,I):""),l.module.xCreate(c,l.Xb,d,m,e("Int32",R))},kr=function(c,l,y,d,m,R){if(l=r.get(l),n.set(m,l),t){u.delete(m);for(const I of u)n.delete(I)}return d=Array.from(new Uint32Array(E.buffer,d,y)).map(I=>I?M(E,I):""),l.module.xConnect(c,l.Xb,d,m,e("Int32",R))},Ir=function(c,l){var y=n.get(c),d=b.get("sqlite3_index_info").dc;const m={};m.nConstraint=F(l+d[0],"i32"),m.aConstraint=[];for(var R=F(l+d[1],"*"),I=b.get("sqlite3_index_constraint").size,Q=0;Q<m.nConstraint;++Q){var U=m.aConstraint,ne=U.push,W=R+Q*I,$e=b.get("sqlite3_index_constraint").dc,ye={};ye.iColumn=F(W+$e[0],"i32"),ye.op=F(W+$e[1],"i8"),ye.usable=!!F(W+$e[2],"i8"),ne.call(U,ye)}for(m.nOrderBy=F(l+d[2],"i32"),m.aOrderBy=[],R=F(l+d[3],"*"),I=b.get("sqlite3_index_orderby").size,Q=0;Q<m.nOrderBy;++Q)U=m.aOrderBy,ne=U.push,W=R+Q*I,$e=b.get("sqlite3_index_orderby").dc,ye={},ye.iColumn=F(W+$e[0],"i32"),ye.desc=!!F(W+$e[1],"i8"),ne.call(U,ye);for(m.aConstraintUsage=[],R=0;R<m.nConstraint;++R)m.aConstraintUsage.push({argvIndex:0,omit:!1});for(m.idxNum=F(l+d[5],"i32"),m.idxStr=null,m.orderByConsumed=!!F(l+d[8],"i8"),m.estimatedCost=F(l+d[9],"double"),m.estimatedRows=F(l+d[10],"i32"),m.idxFlags=F(l+d[11],"i32"),m.colUsed=F(l+d[12],"i32"),c=y.module.xBestIndex(c,m),y=b.get("sqlite3_index_info").dc,d=F(l+y[4],"*"),R=b.get("sqlite3_index_constraint_usage").size,ne=0;ne<m.nConstraint;++ne)I=d+ne*R,U=m.aConstraintUsage[ne],W=b.get("sqlite3_index_constraint_usage").dc,ce(I+W[0],U.argvIndex,"i32"),ce(I+W[1],U.omit?1:0,"i8");return ce(l+y[5],m.idxNum,"i32"),typeof m.idxStr=="string"&&(d=Ae(m.idxStr),R=he("sqlite3_malloc","number",["number"],[d+1]),Ce(m.idxStr,E,R,d+1),ce(l+y[6],R,"*"),ce(l+y[7],1,"i32")),ce(l+y[8],m.orderByConsumed,"i32"),ce(l+y[9],m.estimatedCost,"double"),ce(l+y[10],m.estimatedRows,"i32"),ce(l+y[11],m.idxFlags,"i32"),c},$r=function(c){const l=n.get(c);return t?u.add(c):n.delete(c),l.module.xDisconnect(c)},Pr=function(c){const l=n.get(c);return t?u.add(c):n.delete(c),l.module.xDestroy(c)},Br=function(c,l){const y=n.get(c);if(o.set(l,y),t){a.delete(l);for(const d of a)o.delete(d)}return y.module.xOpen(c,l)},Nr=function(c){const l=o.get(c);return t?a.add(c):o.delete(c),l.module.xClose(c)},Lr=function(c){return o.get(c).module.xEof(c)?1:0},Ur=function(c,l,y,d,m){const R=o.get(c);return y=y?y?M(E,y):"":null,m=new Uint32Array(E.buffer,m,d),R.module.xFilter(c,l,y,m)},Vr=function(c){return o.get(c).module.xNext(c)},Dr=function(c,l,y){return o.get(c).module.xColumn(c,l,y)},Qr=function(c,l){return o.get(c).module.xRowid(c,e("BigInt64",l))},Wr=function(c,l,y,d){const m=n.get(c);return y=new Uint32Array(E.buffer,y,l),m.module.xUpdate(c,y,e("BigInt64",d))},Mr=function(c){return n.get(c).module.xBegin(c)},Hr=function(c){return n.get(c).module.xSync(c)},Or=function(c){return n.get(c).module.xCommit(c)},Fr=function(c){return n.get(c).module.xRollback(c)},zr=function(c,l){const y=n.get(c);return l=l?M(E,l):"",y.module.xRename(c,l)}}(),function(){function e(a,b){const c=`get${a}`,l=`set${a}`;return new Proxy(new DataView(E.buffer,b,a==="Int32"?4:8),{get(y,d){if(d===c)return function(m,R){if(!R)throw Error("must be little endian");return y[d](m,R)};if(d===l)return function(m,R,I){if(!I)throw Error("must be little endian");return y[d](m,R,I)};if(typeof d=="string"&&d.match(/^(get)|(set)/))throw Error("invalid type");return y[d]}})}function t(a){return a>>=2,N[a]+N[a+1]*2**32}const r=typeof _n=="object",n=new Map,o=new Map;i.registerVFS=function(a,b){if(he("sqlite3_vfs_find","number",["string"],[a.name]))throw Error(`VFS '${a.name}' already registered`);r&&(a.handleAsync=bn);var c=a.ad??64;const l=i._malloc(4);return b=he("register_vfs","number",["string","number","number","number"],[a.name,c,b?1:0,l]),b||(c=F(l,"*"),n.set(c,a)),i._free(l),b};const u=r?new Set:null;Yr=function(a){const b=o.get(a);return r?u.add(a):o.delete(a),b.xClose(a)},nn=function(a,b,c,l){return o.get(a).xRead(a,E.subarray(b,b+c),t(l))},cn=function(a,b,c,l){return o.get(a).xWrite(a,E.subarray(b,b+c),t(l))},an=function(a,b){return o.get(a).xTruncate(a,t(b))},sn=function(a,b){return o.get(a).xSync(a,b)},en=function(a,b){const c=o.get(a);return b=e("BigInt64",b),c.xFileSize(a,b)},tn=function(a,b){return o.get(a).xLock(a,b)},un=function(a,b){return o.get(a).xUnlock(a,b)},Xr=function(a,b){const c=o.get(a);return b=e("Int32",b),c.xCheckReservedLock(a,b)},Gr=function(a,b,c){const l=o.get(a);return c=new DataView(E.buffer,c),l.xFileControl(a,b,c)},on=function(a){return o.get(a).xSectorSize(a)},Jr=function(a){return o.get(a).xDeviceCharacteristics(a)},rn=function(a,b,c,l,y){if(a=n.get(a),o.set(c,a),r){u.delete(c);for(var d of u)o.delete(d)}if(d=null,l&64){d=1;const m=[];for(;d;){const R=E[b++];if(R)m.push(R);else switch(E[b]||(d=null),d){case 1:m.push(63),d=2;break;case 2:m.push(61),d=3;break;case 3:m.push(38),d=2}}d=new TextDecoder().decode(new Uint8Array(m))}else b&&(d=b?M(E,b):"");return y=e("Int32",y),a.xOpen(d,c,l,y)},Zr=function(a,b,c){return n.get(a).xDelete(b?M(E,b):"",c)},Kr=function(a,b,c,l){return a=n.get(a),l=e("Int32",l),a.xAccess(b?M(E,b):"",c,l)}}();var fi={a:(e,t,r,n)=>{se(`Assertion failed: ${e?M(E,e):""}, at: `+[t?t?M(E,t):"":"unknown filename",r,n?n?M(E,n):"":"unknown function"])},K:function(e,t){try{return e=e?M(E,e):"",pr(e,t),0}catch(r){if(typeof O>"u"||r.name!=="ErrnoError")throw r;return-r.Ob}},M:function(e,t,r){try{if(t=t?M(E,t):"",t=Me(e,t),r&-8)return-28;var n=re(t,{Yb:!0}).node;return n?(e="",r&4&&(e+="r"),r&2&&(e+="w"),r&1&&(e+="x"),e&&Pe(n,e)?-2:0):-44}catch(o){if(typeof O>"u"||o.name!=="ErrnoError")throw o;return-o.Ob}},L:function(e,t){try{var r=ee(e);return pr(r.node,t),0}catch(n){if(typeof O>"u"||n.name!=="ErrnoError")throw n;return-n.Ob}},J:function(e){try{var t=ee(e).node,r=typeof t=="string"?re(t,{Yb:!0}).node:t;if(!r.Cb.Qb)throw new p(63);return r.Cb.Qb(r,{timestamp:Date.now()}),0}catch(n){if(typeof O>"u"||n.name!=="ErrnoError")throw n;return-n.Ob}},b:function(e,t,r){ct=r;try{var n=ee(e);switch(t){case 0:var o=lt();if(0>o)return-28;for(;je[o];)o++;return hr(n,o).Wb;case 1:case 2:return 0;case 3:return n.flags;case 4:return o=lt(),n.flags|=o,0;case 5:return o=lt(),Fe[o+0>>1]=2,0;case 6:case 7:return 0;case 16:case 8:return-28;case 9:return S[mn()>>2]=28,-1;default:return-28}}catch(u){if(typeof O>"u"||u.name!=="ErrnoError")throw u;return-u.Ob}},I:function(e,t){try{var r=ee(e);return ut(ot,r.path,t)}catch(n){if(typeof O>"u"||n.name!=="ErrnoError")throw n;return-n.Ob}},n:function(e,t,r){t=Ke(t,r);try{if(isNaN(t))return 61;var n=ee(e);if(!(n.flags&2097155))throw new p(28);return mr(n.node,t),0}catch(o){if(typeof O>"u"||o.name!=="ErrnoError")throw o;return-o.Ob}},C:function(e,t){try{if(t===0)return-28;var r=Ae("/")+1;return t<r?-68:(Ce("/",E,e,t),r)}catch(n){if(typeof O>"u"||n.name!=="ErrnoError")throw n;return-n.Ob}},F:function(e,t){try{return e=e?M(E,e):"",ut(_r,e,t)}catch(r){if(typeof O>"u"||r.name!=="ErrnoError")throw r;return-r.Ob}},z:function(e,t,r){try{return t=t?M(E,t):"",t=Me(e,t),t=_e(t),t[t.length-1]==="/"&&(t=t.substr(0,t.length-1)),le(t,r),0}catch(n){if(typeof O>"u"||n.name!=="ErrnoError")throw n;return-n.Ob}},E:function(e,t,r,n){try{t=t?M(E,t):"";var o=n&256;return t=Me(e,t,n&4096),ut(o?_r:ot,t,r)}catch(u){if(typeof O>"u"||u.name!=="ErrnoError")throw u;return-u.Ob}},y:function(e,t,r,n){ct=n;try{t=t?M(E,t):"",t=Me(e,t);var o=n?lt():0;return st(t,r,o).Wb}catch(u){if(typeof O>"u"||u.name!=="ErrnoError")throw u;return-u.Ob}},w:function(e,t,r,n){try{if(t=t?M(E,t):"",t=Me(e,t),0>=n)return-28;var o=br(t),u=Math.min(n,Ae(o)),a=L[r+u];return Ce(o,E,r,n+1),L[r+u]=a,u}catch(b){if(typeof O>"u"||b.name!=="ErrnoError")throw b;return-b.Ob}},u:function(e){try{return e=e?M(E,e):"",wr(e),0}catch(t){if(typeof O>"u"||t.name!=="ErrnoError")throw t;return-t.Ob}},H:function(e,t){try{return e=e?M(E,e):"",ut(ot,e,t)}catch(r){if(typeof O>"u"||r.name!=="ErrnoError")throw r;return-r.Ob}},r:function(e,t,r){try{if(t=t?M(E,t):"",t=Me(e,t),r===0){e=t;var n=re(e,{parent:!0}).node;if(!n)throw new p(44);var o=tt(e),u=qe(n,o),a=fr(n,o,!1);if(a)throw new p(a);if(!n.Cb.oc)throw new p(63);if(u.$b)throw new p(10);n.Cb.oc(n,o),ar(u)}else r===512?wr(t):se("Invalid flags passed to unlinkat");return 0}catch(b){if(typeof O>"u"||b.name!=="ErrnoError")throw b;return-b.Ob}},q:function(e,t,r){try{if(t=t?M(E,t):"",t=Me(e,t,!0),r){var n=N[r>>2]+4294967296*S[r+4>>2],o=S[r+8>>2];u=1e3*n+o/1e6,r+=16,n=N[r>>2]+4294967296*S[r+4>>2],o=S[r+8>>2],a=1e3*n+o/1e6}else var u=Date.now(),a=u;e=u;var b=re(t,{Yb:!0}).node;return b.Cb.Qb(b,{timestamp:Math.max(e,a)}),0}catch(c){if(typeof O>"u"||c.name!=="ErrnoError")throw c;return-c.Ob}},l:function(e,t,r){e=new Date(1e3*Ke(e,t)),S[r>>2]=e.getSeconds(),S[r+4>>2]=e.getMinutes(),S[r+8>>2]=e.getHours(),S[r+12>>2]=e.getDate(),S[r+16>>2]=e.getMonth(),S[r+20>>2]=e.getFullYear()-1900,S[r+24>>2]=e.getDay(),t=e.getFullYear(),S[r+28>>2]=(t%4!==0||t%100===0&&t%400!==0?oi:ii)[e.getMonth()]+e.getDate()-1|0,S[r+36>>2]=-(60*e.getTimezoneOffset()),t=new Date(e.getFullYear(),6,1).getTimezoneOffset();var n=new Date(e.getFullYear(),0,1).getTimezoneOffset();S[r+32>>2]=(t!=n&&e.getTimezoneOffset()==Math.min(n,t))|0},i:function(e,t,r,n,o,u,a,b){o=Ke(o,u);try{if(isNaN(o))return 61;var c=ee(n);if(t&2&&!(r&2)&&(c.flags&2097155)!==2)throw new p(2);if((c.flags&2097155)===1)throw new p(2);if(!c.Mb.kc)throw new p(43);var l=c.Mb.kc(c,e,o,t,r),y=l.Oc;return S[a>>2]=l.Cc,N[b>>2]=y,0}catch(d){if(typeof O>"u"||d.name!=="ErrnoError")throw d;return-d.Ob}},j:function(e,t,r,n,o,u,a){u=Ke(u,a);try{if(isNaN(u))return 61;var b=ee(o);if(r&2){if((b.node.mode&61440)!==32768)throw new p(43);n&2||b.Mb.lc&&b.Mb.lc(b,E.slice(e,e+t),u,t,n)}}catch(c){if(typeof O>"u"||c.name!=="ErrnoError")throw c;return-c.Ob}},s:(e,t,r)=>{function n(c){return(c=c.toTimeString().match(/\(([A-Za-z ]+)\)$/))?c[1]:"GMT"}var o=new Date().getFullYear(),u=new Date(o,0,1),a=new Date(o,6,1);o=u.getTimezoneOffset();var b=a.getTimezoneOffset();N[e>>2]=60*Math.max(o,b),S[t>>2]=+(o!=b),e=n(u),t=n(a),e=Er(e),t=Er(t),b<o?(N[r>>2]=e,N[r+4>>2]=t):(N[r>>2]=t,N[r+4>>2]=e)},e:()=>Date.now(),d:()=>performance.now(),o:e=>{var t=E.length;if(e>>>=0,2147483648<e)return!1;for(var r=1;4>=r;r*=2){var n=t*(1+.2/r);n=Math.min(n,e+100663296);var o=Math;n=Math.max(e,n);e:{o=(o.min.call(o,2147483648,n+(65536-n%65536)%65536)-te.buffer.byteLength+65535)/65536;try{te.grow(o),Ft();var u=1;break e}catch{}u=void 0}if(u)return!0}return!1},A:(e,t)=>{var r=0;return xr().forEach((n,o)=>{var u=t+r;for(o=N[e+4*o>>2]=u,u=0;u<n.length;++u)L[o++>>0]=n.charCodeAt(u);L[o>>0]=0,r+=n.length+1}),0},B:(e,t)=>{var r=xr();N[e>>2]=r.length;var n=0;return r.forEach(o=>n+=o.length+1),N[t>>2]=n,0},f:function(e){try{var t=ee(e);if(t.Wb===null)throw new p(8);t.pc&&(t.pc=null);try{t.Mb.close&&t.Mb.close(t)}catch(r){throw r}finally{je[t.Wb]=null}return t.Wb=null,0}catch(r){if(typeof O>"u"||r.name!=="ErrnoError")throw r;return r.Ob}},p:function(e,t){try{var r=ee(e);return L[t>>0]=r.Sb?2:ae(r.mode)?3:(r.mode&61440)===40960?7:4,Fe[t+2>>1]=0,k=[0,(x=0,1<=+Math.abs(x)?0<x?+Math.floor(x/4294967296)>>>0:~~+Math.ceil((x-+(~~x>>>0))/4294967296)>>>0:0)],S[t+8>>2]=k[0],S[t+12>>2]=k[1],k=[0,(x=0,1<=+Math.abs(x)?0<x?+Math.floor(x/4294967296)>>>0:~~+Math.ceil((x-+(~~x>>>0))/4294967296)>>>0:0)],S[t+16>>2]=k[0],S[t+20>>2]=k[1],0}catch(n){if(typeof O>"u"||n.name!=="ErrnoError")throw n;return n.Ob}},x:function(e,t,r,n){try{e:{var o=ee(e);e=t;for(var u,a=t=0;a<r;a++){var b=N[e>>2],c=N[e+4>>2];e+=8;var l=o,y=b,d=c,m=u,R=L;if(0>d||0>m)throw new p(28);if(l.Wb===null)throw new p(8);if((l.flags&2097155)===1)throw new p(8);if(ae(l.node.mode))throw new p(31);if(!l.Mb.read)throw new p(28);var I=typeof m<"u";if(!I)m=l.position;else if(!l.seekable)throw new p(70);var Q=l.Mb.read(l,R,y,d,m);I||(l.position+=Q);var U=Q;if(0>U){var ne=-1;break e}if(t+=U,U<c)break;typeof u<"u"&&(u+=U)}ne=t}return N[n>>2]=ne,0}catch(W){if(typeof O>"u"||W.name!=="ErrnoError")throw W;return W.Ob}},m:function(e,t,r,n,o){t=Ke(t,r);try{if(isNaN(t))return 61;var u=ee(e);return yr(u,t,n),k=[u.position>>>0,(x=u.position,1<=+Math.abs(x)?0<x?+Math.floor(x/4294967296)>>>0:~~+Math.ceil((x-+(~~x>>>0))/4294967296)>>>0:0)],S[o>>2]=k[0],S[o+4>>2]=k[1],u.pc&&t===0&&n===0&&(u.pc=null),0}catch(a){if(typeof O>"u"||a.name!=="ErrnoError")throw a;return a.Ob}},D:function(e){try{var t=ee(e);return wn(r=>{var n=t.node.Ub;n.type.Qc?n.type.Qc(n,!1,o=>{r(o?29:0)}):r(0)})}catch(r){if(typeof O>"u"||r.name!=="ErrnoError")throw r;return r.Ob}},t:function(e,t,r,n){try{e:{var o=ee(e);e=t;for(var u,a=t=0;a<r;a++){var b=N[e>>2],c=N[e+4>>2];e+=8;var l=o,y=b,d=c,m=u,R=L;if(0>d||0>m)throw new p(28);if(l.Wb===null)throw new p(8);if(!(l.flags&2097155))throw new p(8);if(ae(l.node.mode))throw new p(31);if(!l.Mb.write)throw new p(28);l.seekable&&l.flags&1024&&yr(l,0,2);var I=typeof m<"u";if(!I)m=l.position;else if(!l.seekable)throw new p(70);var Q=l.Mb.write(l,R,y,d,m,void 0);I||(l.position+=Q);var U=Q;if(0>U){var ne=-1;break e}t+=U,typeof u<"u"&&(u+=U)}ne=t}return N[n>>2]=ne,0}catch(W){if(typeof O>"u"||W.name!=="ErrnoError")throw W;return W.Ob}},ra:Sr,N:Rr,ga:Ar,ca:Cr,Y:qr,la:Mr,G:Ir,h:Nr,oa:Dr,ja:Or,ea:kr,fa:Tr,k:Pr,v:$r,pa:Lr,g:Ur,qa:Vr,da:Br,ha:zr,ia:Fr,na:Qr,c:jr,ka:Hr,ma:Wr,aa:Kr,V:Xr,$:Yr,ba:Zr,S:Jr,U:Gr,Z:en,X:tn,R:rn,Q:nn,T:on,_:sn,O:an,W:un,P:cn},v=function(){function e(r){return v=r.exports,v=si(),te=v.sa,Ft(),jt.unshift(v.ta),Se--,i.monitorRunDependencies&&i.monitorRunDependencies(Se),Se==0&&Qe&&(r=Qe,Qe=null,r()),v}var t={a:fi};if(Se++,i.monitorRunDependencies&&i.monitorRunDependencies(Se),i.instantiateWasm)try{return i.instantiateWasm(t,e)}catch(r){Z(`Module.instantiateWasm callback failed with error: ${r}`),h(r)}return Kn(t,function(r){e(r.instance)}).catch(h),{}}();i._sqlite3_vfs_find=e=>(i._sqlite3_vfs_find=v.ua)(e),i._sqlite3_malloc=e=>(i._sqlite3_malloc=v.va)(e),i._sqlite3_free=e=>(i._sqlite3_free=v.wa)(e),i._sqlite3_prepare_v2=(e,t,r,n,o)=>(i._sqlite3_prepare_v2=v.xa)(e,t,r,n,o),i._sqlite3_step=e=>(i._sqlite3_step=v.ya)(e),i._sqlite3_column_int64=(e,t)=>(i._sqlite3_column_int64=v.za)(e,t),i._sqlite3_column_int=(e,t)=>(i._sqlite3_column_int=v.Aa)(e,t),i._sqlite3_finalize=e=>(i._sqlite3_finalize=v.Ba)(e),i._sqlite3_reset=e=>(i._sqlite3_reset=v.Ca)(e),i._sqlite3_clear_bindings=e=>(i._sqlite3_clear_bindings=v.Da)(e),i._sqlite3_value_blob=e=>(i._sqlite3_value_blob=v.Ea)(e),i._sqlite3_value_text=e=>(i._sqlite3_value_text=v.Fa)(e),i._sqlite3_value_bytes=e=>(i._sqlite3_value_bytes=v.Ga)(e),i._sqlite3_value_double=e=>(i._sqlite3_value_double=v.Ha)(e),i._sqlite3_value_int=e=>(i._sqlite3_value_int=v.Ia)(e),i._sqlite3_value_int64=e=>(i._sqlite3_value_int64=v.Ja)(e),i._sqlite3_value_type=e=>(i._sqlite3_value_type=v.Ka)(e),i._sqlite3_result_blob=(e,t,r,n)=>(i._sqlite3_result_blob=v.La)(e,t,r,n),i._sqlite3_result_double=(e,t)=>(i._sqlite3_result_double=v.Ma)(e,t),i._sqlite3_result_error=(e,t,r)=>(i._sqlite3_result_error=v.Na)(e,t,r),i._sqlite3_result_int=(e,t)=>(i._sqlite3_result_int=v.Oa)(e,t),i._sqlite3_result_int64=(e,t,r)=>(i._sqlite3_result_int64=v.Pa)(e,t,r),i._sqlite3_result_null=e=>(i._sqlite3_result_null=v.Qa)(e),i._sqlite3_result_text=(e,t,r,n)=>(i._sqlite3_result_text=v.Ra)(e,t,r,n),i._sqlite3_column_count=e=>(i._sqlite3_column_count=v.Sa)(e),i._sqlite3_data_count=e=>(i._sqlite3_data_count=v.Ta)(e),i._sqlite3_column_blob=(e,t)=>(i._sqlite3_column_blob=v.Ua)(e,t),i._sqlite3_column_bytes=(e,t)=>(i._sqlite3_column_bytes=v.Va)(e,t),i._sqlite3_column_double=(e,t)=>(i._sqlite3_column_double=v.Wa)(e,t),i._sqlite3_column_text=(e,t)=>(i._sqlite3_column_text=v.Xa)(e,t),i._sqlite3_column_type=(e,t)=>(i._sqlite3_column_type=v.Ya)(e,t),i._sqlite3_column_name=(e,t)=>(i._sqlite3_column_name=v.Za)(e,t),i._sqlite3_bind_blob=(e,t,r,n,o)=>(i._sqlite3_bind_blob=v._a)(e,t,r,n,o),i._sqlite3_bind_double=(e,t,r)=>(i._sqlite3_bind_double=v.$a)(e,t,r),i._sqlite3_bind_int=(e,t,r)=>(i._sqlite3_bind_int=v.ab)(e,t,r),i._sqlite3_bind_int64=(e,t,r,n)=>(i._sqlite3_bind_int64=v.bb)(e,t,r,n),i._sqlite3_bind_null=(e,t)=>(i._sqlite3_bind_null=v.cb)(e,t),i._sqlite3_bind_text=(e,t,r,n,o)=>(i._sqlite3_bind_text=v.db)(e,t,r,n,o),i._sqlite3_bind_parameter_count=e=>(i._sqlite3_bind_parameter_count=v.eb)(e),i._sqlite3_bind_parameter_name=(e,t)=>(i._sqlite3_bind_parameter_name=v.fb)(e,t),i._sqlite3_sql=e=>(i._sqlite3_sql=v.gb)(e),i._sqlite3_exec=(e,t,r,n,o)=>(i._sqlite3_exec=v.hb)(e,t,r,n,o),i._sqlite3_errmsg=e=>(i._sqlite3_errmsg=v.ib)(e),i._sqlite3_declare_vtab=(e,t)=>(i._sqlite3_declare_vtab=v.jb)(e,t),i._sqlite3_libversion=()=>(i._sqlite3_libversion=v.kb)(),i._sqlite3_libversion_number=()=>(i._sqlite3_libversion_number=v.lb)(),i._sqlite3_changes=e=>(i._sqlite3_changes=v.mb)(e),i._sqlite3_close=e=>(i._sqlite3_close=v.nb)(e),i._sqlite3_limit=(e,t,r)=>(i._sqlite3_limit=v.ob)(e,t,r),i._sqlite3_open_v2=(e,t,r,n)=>(i._sqlite3_open_v2=v.pb)(e,t,r,n),i._sqlite3_get_autocommit=e=>(i._sqlite3_get_autocommit=v.qb)(e);var mn=()=>(mn=v.rb)(),$t=i._malloc=e=>($t=i._malloc=v.sb)(e),yn=i._free=e=>(yn=i._free=v.tb)(e);i._RegisterExtensionFunctions=e=>(i._RegisterExtensionFunctions=v.ub)(e),i._set_authorizer=e=>(i._set_authorizer=v.vb)(e),i._create_function=(e,t,r,n,o,u)=>(i._create_function=v.wb)(e,t,r,n,o,u),i._create_module=(e,t,r,n)=>(i._create_module=v.xb)(e,t,r,n),i._progress_handler=(e,t)=>(i._progress_handler=v.yb)(e,t),i._register_vfs=(e,t,r,n)=>(i._register_vfs=v.zb)(e,t,r,n),i._getSqliteFree=()=>(i._getSqliteFree=v.Ab)();var vn=i._main=(e,t)=>(vn=i._main=v.Bb)(e,t),gn=(e,t)=>(gn=v.Db)(e,t),En=()=>(En=v.Eb)(),xn=()=>(xn=v.Fb)(),Sn=e=>(Sn=v.Gb)(e),Lt=e=>(Lt=v.Hb)(e),Rn=e=>(Rn=v.Ib)(e),An=()=>(An=v.Jb)(),Cn=e=>(Cn=v.Kb)(e),qn=()=>(qn=v.Lb)();i.getTempRet0=En,i.ccall=he,i.cwrap=(e,t,r,n)=>{var o=!r||r.every(u=>u==="number"||u==="boolean");return t!=="string"&&o&&!n?i["_"+e]:function(){return he(e,t,r,arguments,n)}},i.setValue=ce,i.getValue=F,i.UTF8ToString=(e,t)=>e?M(E,e,t):"",i.stringToUTF8=(e,t,r)=>Ce(e,E,t,r),i.lengthBytesUTF8=Ae;var wt;Qe=function e(){wt||Mn(),wt||(Qe=e)};function Mn(){function e(){if(!wt&&(wt=!0,i.calledRun=!0,!z)){if(i.noFSInit||gr||(gr=!0,vr(),i.stdin=i.stdin,i.stdout=i.stdout,i.stderr=i.stderr,i.stdin?He("stdin",i.stdin):Nt("/dev/tty","/dev/stdin"),i.stdout?He("stdout",null,i.stdout):Nt("/dev/tty","/dev/stdout"),i.stderr?He("stderr",null,i.stderr):Nt("/dev/tty1","/dev/stderr"),st("/dev/stdin",0),st("/dev/stdout",1),st("/dev/stderr",1)),sr=!1,et(jt),et(jn),_(i),i.onRuntimeInitialized&&i.onRuntimeInitialized(),In){var t=vn;try{var r=t(0,0);ue=r,ln(r)}catch(n){Tt(n)}}if(i.postRun)for(typeof i.postRun=="function"&&(i.postRun=[i.postRun]);i.postRun.length;)t=i.postRun.shift(),Ht.unshift(t);et(Ht)}}if(!(0<Se)){if(i.preRun)for(typeof i.preRun=="function"&&(i.preRun=[i.preRun]);i.preRun.length;)Hn();et(Qt),0<Se||(i.setStatus?(i.setStatus("Running..."),setTimeout(function(){setTimeout(function(){i.setStatus("")},1),e()},1)):e())}}if(i.preInit)for(typeof i.preInit=="function"&&(i.preInit=[i.preInit]);0<i.preInit.length;)i.preInit.pop()();var In=!0;return i.noInitialRun&&(In=!1),Mn(),s.ready}})(),Mi=qi,Ii=Le|Ie|bt|Ci|_t,K,Ve,Xe,Ye,Bt,pt,Un,mt,Vn,kn,Ni=(kn=class{constructor(){D(this,Ye);D(this,pt);D(this,mt);D(this,K,Le);Nn(this,"timeoutMillis",0);D(this,Ve,new Map);D(this,Xe,Promise.resolve(0))}get state(){return w(this,K)}async lock(f){return J(this,Ye,Bt).call(this,J(this,pt,Un),f)}async unlock(f){return J(this,Ye,Bt).call(this,J(this,mt,Vn),f)}async isSomewhereReserved(){throw new Error("unimplemented")}async _NONEtoSHARED(){}async _SHAREDtoEXCLUSIVE(){await this._SHAREDtoRESERVED(),await this._RESERVEDtoEXCLUSIVE()}async _SHAREDtoRESERVED(){}async _RESERVEDtoEXCLUSIVE(){}async _EXCLUSIVEtoRESERVED(){}async _EXCLUSIVEtoSHARED(){await this._EXCLUSIVEtoRESERVED(),await this._RESERVEDtoSHARED()}async _EXCLUSIVEtoNONE(){await this._EXCLUSIVEtoRESERVED(),await this._RESERVEDtoSHARED(),await this._SHAREDtoNONE()}async _RESERVEDtoSHARED(){}async _RESERVEDtoNONE(){await this._RESERVEDtoSHARED(),await this._SHAREDtoNONE()}async _SHAREDtoNONE(){}_acquireWebLock(f,s){return new Promise(async(i,_)=>{try{await navigator.locks.request(f,s,h=>{if(i(h),h)return new Promise(g=>w(this,Ve).set(f,g))})}catch(h){_(h)}})}_releaseWebLock(f){w(this,Ve).get(f)?.(),w(this,Ve).delete(f)}async _pollWebLock(f){return(await navigator.locks.query()).held.find(({name:i})=>i===f)?.mode}_getTimeoutSignal(){if(this.timeoutMillis){const f=new AbortController;return setTimeout(()=>f.abort(),this.timeoutMillis),f.signal}}},K=new WeakMap,Ve=new WeakMap,Xe=new WeakMap,Ye=new WeakSet,Bt=async function(f,s){const i=s&Ii;try{const _=()=>f.call(this,i);return await P(this,Xe,w(this,Xe).then(_,_)),P(this,K,i),$}catch(_){return _.name==="AbortError"?Ri:(console.error(_),Ai)}},pt=new WeakSet,Un=async function(f){if(f===w(this,K))return $;switch(w(this,K)){case Le:switch(f){case Ie:return this._NONEtoSHARED();default:throw new Error(`unexpected transition ${w(this,K)} -> ${f}`)}case Ie:switch(f){case bt:return this._SHAREDtoRESERVED();case _t:return this._SHAREDtoEXCLUSIVE();default:throw new Error(`unexpected transition ${w(this,K)} -> ${f}`)}case bt:switch(f){case _t:return this._RESERVEDtoEXCLUSIVE();default:throw new Error(`unexpected transition ${w(this,K)} -> ${f}`)}default:throw new Error(`unexpected transition ${w(this,K)} -> ${f}`)}},mt=new WeakSet,Vn=async function(f){if(f===w(this,K))return $;switch(w(this,K)){case _t:switch(f){case Ie:return this._EXCLUSIVEtoSHARED();case Le:return this._EXCLUSIVEtoNONE();default:throw new Error(`unexpected transition ${w(this,K)} -> ${f}`)}case bt:switch(f){case Ie:return this._RESERVEDtoSHARED();case Le:return this._RESERVEDtoNONE();default:throw new Error(`unexpected transition ${w(this,K)} -> ${f}`)}case Ie:switch(f){case Le:return this._SHAREDtoNONE();default:throw new Error(`unexpected transition ${w(this,K)} -> ${f}`)}default:throw new Error(`unexpected transition ${w(this,K)} -> ${f}`)}},kn),Di=class extends Ni{constructor(f){super(),this._lockName=f+"-outer",this._reservedName=f+"-reserved"}async isSomewhereReserved(){return await this._pollWebLock(this._reservedName)==="exclusive"}async _NONEtoSHARED(){await this._acquireWebLock(this._lockName,{mode:"exclusive",signal:this._getTimeoutSignal()})}async _SHAREDtoRESERVED(){await this._acquireWebLock(this._reservedName,{mode:"exclusive",signal:this._getTimeoutSignal()})}async _RESERVEDtoSHARED(){this._releaseWebLock(this._reservedName)}async _SHAREDtoNONE(){this._releaseWebLock(this._lockName)}},Oi=5e3,ki=0,Vt=new WeakMap;function de(...f){}var Be,ze,Ze,j,Je,Ne,De,yt,Bn,Tn,Ti=(Tn=class{constructor(f,s={durability:"default"}){D(this,yt);D(this,Be,void 0);D(this,ze,void 0);D(this,Ze,void 0);D(this,j,null);D(this,Je,0);D(this,Ne,Promise.resolve());D(this,De,Promise.resolve());P(this,ze,Promise.resolve(f).then(i=>P(this,Be,i))),P(this,Ze,s)}async close(){const f=w(this,Be)??await w(this,ze);await w(this,Ne),await this.sync(),f.close()}async run(f,s){const i=w(this,Ne).then(()=>J(this,yt,Bn).call(this,f,s));return P(this,Ne,i.catch(()=>{})),i}async sync(){await w(this,Ne),await w(this,De),P(this,De,Promise.resolve())}},Be=new WeakMap,ze=new WeakMap,Ze=new WeakMap,j=new WeakMap,Je=new WeakMap,Ne=new WeakMap,De=new WeakMap,yt=new WeakSet,Bn=async function(f,s){const i=w(this,Be)??await w(this,ze);if(f==="readwrite"&&w(this,j)?.mode==="readonly")P(this,j,null);else if(performance.now()-w(this,Je)>Oi){try{w(this,j)?.commit()}catch(_){if(_.name!=="InvalidStateError")throw _}await new Promise(_=>setTimeout(_)),P(this,j,null)}for(let _=0;_<2;++_){if(!w(this,j)){P(this,j,i.transaction(i.objectStoreNames,f,w(this,Ze)));const h=P(this,Je,performance.now());P(this,De,w(this,De).then(()=>new Promise((g,C)=>{w(this,j).addEventListener("complete",q=>{g(),w(this,j)===q.target&&P(this,j,null),de(`transaction ${Vt.get(q.target)} complete`)}),w(this,j).addEventListener("abort",q=>{console.warn("tx abort",(performance.now()-h)/1e3);const Y=q.target.error;C(Y),w(this,j)===q.target&&P(this,j,null),de(`transaction ${Vt.get(q.target)} aborted`,Y)})}))),Vt.set(w(this,j),ki++)}try{const h=Object.fromEntries(Array.from(i.objectStoreNames,g=>[g,new Pi(w(this,j).objectStore(g))]));return await s(h)}catch(h){if(P(this,j,null),_)throw h}}},Tn);function ve(f){return new Promise((s,i)=>{f.addEventListener("success",()=>s(f.result)),f.addEventListener("error",()=>i(f.error))})}var V,Pn,Pi=(Pn=class{constructor(f){D(this,V,void 0);P(this,V,f)}get(f){de(`get ${w(this,V).name}`,f);const s=w(this,V).get(f);return ve(s)}getAll(f,s){de(`getAll ${w(this,V).name}`,f,s);const i=w(this,V).getAll(f,s);return ve(i)}getKey(f){de(`getKey ${w(this,V).name}`,f);const s=w(this,V).getKey(f);return ve(s)}getAllKeys(f,s){de(`getAllKeys ${w(this,V).name}`,f,s);const i=w(this,V).getAllKeys(f,s);return ve(i)}put(f,s){de(`put ${w(this,V).name}`,f,s);const i=w(this,V).put(f,s);return ve(i)}delete(f){de(`delete ${w(this,V).name}`,f);const s=w(this,V).delete(f);return ve(s)}clear(){de(`clear ${w(this,V).name}`);const f=w(this,V).clear();return ve(f)}index(f){return new $i(w(this,V).index(f))}},V=new WeakMap,Pn),Oe,$n,$i=($n=class{constructor(f){D(this,Oe,void 0);P(this,Oe,f)}getAllKeys(f,s){de(`IDBIndex.getAllKeys ${w(this,Oe).objectStore.name}<${w(this,Oe).name}>`,f,s);const i=w(this,Oe).getAllKeys(f,s);return ve(i)}},Oe=new WeakMap,$n),Li=512,Dn=3e3,On={durability:"default",purge:"deferred",purgeAtLeast:16};function oe(...f){}var ge,X,T,ke,Te,be,Ge,zt,vt,zn,gt,Fn,Ee,Ue,Et,Qn,Ln,Ui=(Ln=class extends wi{constructor(s="wa-sqlite",i=On){super();D(this,Ge);D(this,vt);D(this,gt);D(this,Ee);D(this,Et);D(this,ge,void 0);D(this,X,new Map);D(this,T,void 0);D(this,ke,new Set);D(this,Te,performance.now());D(this,be,new Set);this.name=s,P(this,ge,Object.assign({},On,i)),P(this,T,new Ti(Vi(s),{durability:w(this,ge).durability}))}async close(){for(const s of w(this,X).keys())await this.xClose(s);await w(this,T)?.close(),P(this,T,null)}xOpen(s,i,_,h){return this.handleAsync(async()=>{s===null&&(s=`null_${i}`),oe(`xOpen ${s} 0x${i.toString(16)} 0x${_.toString(16)}`);try{const g=new URL(s,"http://localhost/"),C={path:g.pathname,flags:_,block0:null,isMetadataChanged:!0,locks:new Di(g.pathname)};return w(this,X).set(i,C),await w(this,T).run("readwrite",async({blocks:q})=>{if(C.block0=await q.get(J(this,Ee,Ue).call(this,C,0)),!C.block0)if(_&bi)C.block0={path:C.path,offset:0,version:0,data:new Uint8Array(0),fileSize:0},q.put(C.block0);else throw new Error(`file not found: ${C.path}`)}),h.setInt32(0,_&_i,!0),$}catch(g){return console.error(g),pi}})}xClose(s){return this.handleAsync(async()=>{try{const i=w(this,X).get(s);return i&&(oe(`xClose ${i.path}`),w(this,X).delete(s),i.flags&mi&&w(this,T).run("readwrite",({blocks:_})=>{_.delete(IDBKeyRange.bound([i.path],[i.path,[]]))})),$}catch(i){return console.error(i),ie}})}xRead(s,i,_){return this.handleAsync(async()=>{const h=w(this,X).get(s);oe(`xRead ${h.path} ${i.byteLength} ${_}`);try{return await w(this,T).run("readonly",async({blocks:C})=>{let q=0;for(;q<i.byteLength;){const Y=_+q,B=Y<h.block0.data.byteLength?h.block0:await C.get(J(this,Ee,Ue).call(this,h,-Y));if(!B||B.data.byteLength-B.offset<=Y)return i.fill(0,q),yi;const H=i.subarray(q),G=Y+B.offset,xe=Math.min(Math.max(B.data.byteLength-G,0),H.byteLength);H.set(B.data.subarray(G,G+xe)),q+=xe}return $})}catch(g){return console.error(g),ie}})}xWrite(s,i,_){const h=w(this,be).has(s);if(h||performance.now()-w(this,Te)>Dn){const g=this.handleAsync(async()=>{this.handleAsync!==super.handleAsync&&w(this,be).add(s),await new Promise(q=>setTimeout(q));const C=J(this,Ge,zt).call(this,s,i,_);return P(this,Te,performance.now()),C});return h&&w(this,be).delete(s),g}return J(this,Ge,zt).call(this,s,i,_)}xTruncate(s,i){const _=w(this,X).get(s);oe(`xTruncate ${_.path} ${i}`);try{Object.assign(_.block0,{fileSize:i,data:_.block0.data.slice(0,i)});const h=Object.assign({},_.block0);return w(this,T).run("readwrite",({blocks:g})=>{g.delete(J(this,Ee,Ue).call(this,_,-1/0,-i)),g.put(h)}),$}catch(h){return console.error(h),ie}}xSync(s,i){const _=w(this,be).has(s);if(_||w(this,ge).durability!=="relaxed"||performance.now()-w(this,Te)>Dn){const g=this.handleAsync(async()=>{this.handleAsync!==super.handleAsync&&w(this,be).add(s);const C=await J(this,vt,zn).call(this,s,i);return P(this,Te,performance.now()),C});return _&&w(this,be).delete(s),g}const h=w(this,X).get(s);return oe(`xSync ${h.path} ${i}`),$}xFileSize(s,i){const _=w(this,X).get(s);return oe(`xFileSize ${_.path}`),i.setBigInt64(0,BigInt(_.block0.fileSize),!0),$}xLock(s,i){return this.handleAsync(async()=>{const _=w(this,X).get(s);oe(`xLock ${_.path} ${i}`);try{const h=await _.locks.lock(i);return h===$&&_.locks.state===Ie&&(_.block0=await w(this,T).run("readonly",({blocks:g})=>g.get(J(this,Ee,Ue).call(this,_,0)))),h}catch(h){return console.error(h),ie}})}xUnlock(s,i){return this.handleAsync(async()=>{const _=w(this,X).get(s);oe(`xUnlock ${_.path} ${i}`);try{return _.locks.unlock(i)}catch(h){return console.error(h),ie}})}xCheckReservedLock(s,i){return this.handleAsync(async()=>{const _=w(this,X).get(s);oe(`xCheckReservedLock ${_.path}`);const h=await _.locks.isSomewhereReserved();return i.setInt32(0,h?1:0,!0),$})}xSectorSize(s){return Li}xDeviceCharacteristics(s){return vi|gi|Ei|xi}xFileControl(s,i,_){const h=w(this,X).get(s);switch(oe(`xFileControl ${h.path} ${i}`),i){case 11:return h.overwrite=!0,$;case 21:if(h.overwrite)try{return this.handleAsync(async()=>(await J(this,Et,Qn).call(this,h),$))}catch(g){return console.error(g),ie}if(h.isMetadataChanged)try{w(this,T).run("readwrite",async({blocks:g})=>{await g.put(h.block0)}),h.isMetadataChanged=!1}catch(g){return console.error(g),ie}return $;case 22:return h.overwrite=!1,$;case 31:return this.handleAsync(async()=>{try{return h.block0.version--,h.changedPages=new Set,w(this,T).run("readwrite",async({blocks:g})=>{const C=await g.index("version").getAllKeys(IDBKeyRange.bound([h.path],[h.path,h.block0.version]));for(const q of C)g.delete(q)}),$}catch(g){return console.error(g),ie}});case 32:try{const g=Object.assign({},h.block0);g.data=g.data.slice();const C=h.changedPages;return h.changedPages=null,h.isMetadataChanged=!1,w(this,T).run("readwrite",async({blocks:q})=>{q.put(g);const Y=await q.get([h.path,"purge",0])??{path:h.path,offset:"purge",version:0,data:new Map,count:0};Y.count+=C.size;for(const B of C)Y.data.set(B,g.version);q.put(Y),J(this,gt,Fn).call(this,h.path,Y.count)}),$}catch(g){return console.error(g),ie}case 33:return this.handleAsync(async()=>{try{return h.changedPages=null,h.isMetadataChanged=!1,h.block0=await w(this,T).run("readonly",({blocks:g})=>g.get([h.path,0,h.block0.version+1])),$}catch(g){return console.error(g),ie}});default:return Si}}xAccess(s,i,_){return this.handleAsync(async()=>{try{const h=new URL(s,"file://localhost/").pathname;oe(`xAccess ${h} ${i}`);const g=await w(this,T).run("readonly",({blocks:C})=>C.getKey(J(this,Ee,Ue).call(this,{path:h},0)));return _.setInt32(0,g?1:0,!0),$}catch(h){return console.error(h),ie}})}xDelete(s,i){return this.handleAsync(async()=>{const _=new URL(s,"file://localhost/").pathname;try{return w(this,T).run("readwrite",({blocks:h})=>h.delete(IDBKeyRange.bound([_],[_,[]]))),i&&await w(this,T).sync(),$}catch(h){return console.error(h),ie}})}async purge(s){const i=Date.now();await w(this,T).run("readwrite",async({blocks:_})=>{const h=await _.get([s,"purge",0]);if(h){for(const[g,C]of h.data)_.delete(IDBKeyRange.bound([s,g,C],[s,g,1/0],!0,!1));await _.delete([s,"purge",0])}oe(`purge ${s} ${h?.data.size??0} pages in ${Date.now()-i} ms`)})}},ge=new WeakMap,X=new WeakMap,T=new WeakMap,ke=new WeakMap,Te=new WeakMap,be=new WeakMap,Ge=new WeakSet,zt=function(s,i,_){const h=w(this,X).get(s);oe(`xWrite ${h.path} ${i.byteLength} ${_}`);try{const g=h.block0.fileSize;h.block0.fileSize<_+i.byteLength&&(h.block0.fileSize=_+i.byteLength,h.isMetadataChanged=!0);const C=_===0?h.block0:{path:h.path,offset:-_,version:h.block0.version,data:null};return C.data=i.slice(),h.changedPages?(g===h.block0.fileSize&&h.changedPages.add(-_),_!==0&&w(this,T).run("readwrite",({blocks:q})=>q.put(C))):w(this,T).run("readwrite",({blocks:q})=>q.put(C)),h.isMetadataChanged=_===0?!1:h.isMetadataChanged,$}catch(g){return console.error(g),ie}},vt=new WeakSet,zn=async function(s,i){const _=w(this,X).get(s);oe(`xSync ${_.path} ${i}`);try{_.isMetadataChanged&&(w(this,T).run("readwrite",async({blocks:h})=>{await h.put(_.block0)}),_.isMetadataChanged=!1),await w(this,T).sync()}catch(h){return console.error(h),ie}return $},gt=new WeakSet,Fn=function(s,i){w(this,ge).purge==="manual"||w(this,ke).has(s)||i<w(this,ge).purgeAtLeast||(globalThis.requestIdleCallback?globalThis.requestIdleCallback(()=>{this.purge(s),w(this,ke).delete(s)}):setTimeout(()=>{this.purge(s),w(this,ke).delete(s)}),w(this,ke).add(s))},Ee=new WeakSet,Ue=function(s,i,_=0){const h=!i||-i<s.block0.data.length?-1/0:s.block0.version;return IDBKeyRange.bound([s.path,i,h],[s.path,_,1/0])},Et=new WeakSet,Qn=async function(s){const i=s.block0.data.length;if(i<18)return;const _=new DataView(s.block0.data.buffer,s.block0.data.byteOffset);let h=_.getUint16(16);if(h===1&&(h=65536),h===i)return;const g=Math.max(i,h),C=g/i,q=g/h,B=_.getUint32(28)*h,H=s.block0.version;await w(this,T).run("readwrite",async({blocks:G})=>{const xe=await G.index("version").getAllKeys(IDBKeyRange.bound([s.path,H+1],[s.path,1/0]));for(const Z of xe)G.delete(Z);G.delete([s.path,"purge",0]);for(let Z=0;Z<B;Z+=g){const we=await G.getAll(IDBKeyRange.lowerBound([s.path,-(Z+g),1/0]),C);for(const te of we)G.delete([te.path,te.offset,te.version]);if(q===1){const te=new Uint8Array(h);for(const ue of we)te.set(ue.data,-(Z+ue.offset));const z={path:s.path,offset:-Z,version:H,data:te};z.offset===0&&(z.fileSize=B,s.block0=z),G.put(z)}else{const te=we[0];for(let z=0;z<q;++z){const ue=-(Z+z*h);if(-ue>=B)break;const L={path:te.path,offset:ue,version:H,data:te.data.subarray(z*h,(z+1)*h)};L.offset===0&&(L.fileSize=B,s.block0=L),G.put(L)}}}})},Ln);function Vi(f){return new Promise((s,i)=>{const _=globalThis.indexedDB.open(f,5);_.addEventListener("upgradeneeded",function(){_.result.createObjectStore("blocks",{keyPath:["path","offset","version"]}).createIndex("version",["path","version"])}),_.addEventListener("success",()=>{s(_.result)}),_.addEventListener("error",()=>{i(_.error)})})}async function Qi(f,s={}){const{url:i,idbName:_="idb-sqlite-vfs",...h}=s,g=await Mi(i?{locateFile:()=>i}:void 0),C=new Ui(_,{durability:"relaxed",...h});return{path:f.endsWith(".db")?f:`${f}.db`,sqliteModule:g,vfs:C}}export{Ui as IDBBatchAtomicVFS,Qi as useIdbStorage};
