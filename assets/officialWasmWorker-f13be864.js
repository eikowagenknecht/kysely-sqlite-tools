var yd=Object.defineProperty;var gd=(Te,Ne,Ze)=>Ne in Te?yd(Te,Ne,{enumerable:!0,configurable:!0,writable:!0,value:Ze}):Te[Ne]=Ze;var Tt=(Te,Ne,Ze)=>(gd(Te,typeof Ne!="symbol"?Ne+"":Ne,Ze),Ze),qo=(Te,Ne,Ze)=>{if(!Ne.has(Te))throw TypeError("Cannot "+Ze)};var s=(Te,Ne,Ze)=>(qo(Te,Ne,"read from private field"),Ze?Ze.call(Te):Ne.get(Te)),R=(Te,Ne,Ze)=>{if(Ne.has(Te))throw TypeError("Cannot add the same private member more than once");Ne instanceof WeakSet?Ne.add(Te):Ne.set(Te,Ze)},U=(Te,Ne,Ze,Pr)=>(qo(Te,Ne,"write to private field"),Pr?Pr.call(Te,Ze):Ne.set(Te,Ze),Ze);var Le=(Te,Ne,Ze)=>(qo(Te,Ne,"access private method"),Ze);(function(){var ze,Dn,cr,Zr,ei,ge,ti,Ve,ye,ni,Z,ri,te,dr,gs,fr,Rn,ws,il,qs,sl,Bn,Oi,ii,bo,bs,ol,si,Re,oi,hr,pr,Un,ai,No,F,_r,mr,yr,gr,kn,Ue,wr,qr,br,Nr,sn,vr,Fe,jn,Xt,qt,tt,je,Ye,Pe,Ft,ke,ht,vt,xt,Ss,He,pt,Pt,Lt,lt,xr,an,ln,_n,Yt,On,mn,Vn,fi,ks,al,Is,ll,Os,ul,As,cl,hi,vo,pi,An,Ts,dl,Tn,Hn,_t,Zt,$n,en,Ot,kr,Us,_i,xo,mi,Eo,Ir,Cn,Ws,Or,Gn,Ar,Fs,fl,yi,Ps,Oa,Jn,Tr,Aa,yn,gi,Ta,Kn,Ca,wi,Wa,Xn,Fa,qi,bi,Cr,Pa,Wn,Ni,La;"use strict";function Te(t){return typeof t>"u"||t===void 0}function Ne(t){return typeof t=="string"}function Ze(t){return typeof t=="number"}function Pr(t){return typeof t=="boolean"}function So(t){return t===null}function hl(t){return t instanceof Date}function pl(t){return typeof t=="bigint"}function Rt(t){return typeof t=="function"}function tn(t){return typeof t=="object"&&t!==null}function h(t){return Object.freeze(t)}function Lr(t){return Array.isArray(t)}function tr(t){return t}const et=h({is(t){return t.kind==="AlterTableNode"},create(t){return h({kind:"AlterTableNode",table:t})},cloneWithTableProps(t,e){return h({...t,...e})},cloneWithColumnAlteration(t,e){return h({...t,columnAlterations:t.columnAlterations?[...t.columnAlterations,e]:[e]})}}),Ge=h({is(t){return t.kind==="IdentifierNode"},create(t){return h({kind:"IdentifierNode",name:t})}}),bn=h({is(t){return t.kind==="CreateIndexNode"},create(t){return h({kind:"CreateIndexNode",name:Ge.create(t)})},cloneWith(t,e){return h({...t,...e})},cloneWithColumns(t,e){return h({...t,columns:[...t.columns||[],...e]})}}),ko=h({is(t){return t.kind==="CreateSchemaNode"},create(t,e){return h({kind:"CreateSchemaNode",schema:Ge.create(t),...e})},cloneWith(t,e){return h({...t,...e})}}),_l=["preserve rows","delete rows","drop"],Ht=h({is(t){return t.kind==="CreateTableNode"},create(t){return h({kind:"CreateTableNode",table:t,columns:h([])})},cloneWithColumn(t,e){return h({...t,columns:h([...t.columns,e])})},cloneWithConstraint(t,e){return h({...t,constraints:t.constraints?h([...t.constraints,e]):h([e])})},cloneWithFrontModifier(t,e){return h({...t,frontModifiers:t.frontModifiers?h([...t.frontModifiers,e]):h([e])})},cloneWithEndModifier(t,e){return h({...t,endModifiers:t.endModifiers?h([...t.endModifiers,e]):h([e])})},cloneWith(t,e){return h({...t,...e})}}),Nn=h({is(t){return t.kind==="SchemableIdentifierNode"},create(t){return h({kind:"SchemableIdentifierNode",identifier:Ge.create(t)})},createWithSchema(t,e){return h({kind:"SchemableIdentifierNode",schema:Ge.create(t),identifier:Ge.create(e)})}}),Ai=h({is(t){return t.kind==="DropIndexNode"},create(t,e){return h({kind:"DropIndexNode",name:Nn.create(t),...e})},cloneWith(t,e){return h({...t,...e})}}),js=h({is(t){return t.kind==="DropSchemaNode"},create(t,e){return h({kind:"DropSchemaNode",schema:Ge.create(t),...e})},cloneWith(t,e){return h({...t,...e})}}),Qs=h({is(t){return t.kind==="DropTableNode"},create(t,e){return h({kind:"DropTableNode",table:t,...e})},cloneWith(t,e){return h({...t,...e})}}),Pn=h({is(t){return t.kind==="AliasNode"},create(t,e){return h({kind:"AliasNode",node:t,alias:e})}}),vn=h({is(t){return t.kind==="TableNode"},create(t){return h({kind:"TableNode",table:Nn.create(t)})},createWithSchema(t,e){return h({kind:"TableNode",table:Nn.createWithSchema(t,e)})}});function bt(t){return tn(t)&&Rt(t.toOperationNode)}function ml(t){return tn(t)&&"expressionType"in t&&bt(t)}function yl(t){return tn(t)&&"expression"in t&&Ne(t.alias)&&bt(t)}const dn=h({is(t){return t.kind==="SelectModifierNode"},create(t){return h({kind:"SelectModifierNode",modifier:t})},createWithExpression(t){return h({kind:"SelectModifierNode",rawModifier:t})}}),Dr=h({is(t){return t.kind==="AndNode"},create(t,e){return h({kind:"AndNode",left:t,right:e})}}),Rr=h({is(t){return t.kind==="OrNode"},create(t,e){return h({kind:"OrNode",left:t,right:e})}}),Br=h({is(t){return t.kind==="OnNode"},create(t){return h({kind:"OnNode",on:t})},cloneWithOperation(t,e,r){return h({...t,on:e==="And"?Dr.create(t.on,r):Rr.create(t.on,r)})}}),Bt=h({is(t){return t.kind==="JoinNode"},create(t,e){return h({kind:"JoinNode",joinType:t,table:e,on:void 0})},createWithOn(t,e,r){return h({kind:"JoinNode",joinType:t,table:e,on:Br.create(r)})},cloneWithOn(t,e){return h({...t,on:t.on?Br.cloneWithOperation(t.on,"And",e):Br.create(e)})},cloneWithOrOn(t,e){return h({...t,on:t.on?Br.cloneWithOperation(t.on,"Or",e):Br.create(e)})}}),Ti=h({is(t){return t.kind==="BinaryOperationNode"},create(t,e,r){return h({kind:"BinaryOperationNode",leftOperand:t,operator:e,rightOperand:r})}}),yt=h({is(t){return t.kind==="RawNode"},create(t,e){return h({kind:"RawNode",sqlFragments:h(t),parameters:h(e)})},createWithSql(t){return yt.create([t],[])},createWithChild(t){return yt.create(["",""],[t])},createWithChildren(t){return yt.create(new Array(t.length+1).fill(""),t)}}),Io=["=","==","!=","<>",">",">=","<","<=","in","not in","is","is not","like","not like","match","ilike","not ilike","@>","<@","?","?&","!<","!>","<=>","!~","~","~*","!~*","@@","@@@","!!","<->"],gl=["+","-","*","/","%","^","&","|","#","<<",">>"],Oo=[...Io,...gl,"&&","||"],wl=["not","-",...["exists","not exists"]],ql=[...Oo,...wl],zs=h({is(t){return t.kind==="OperatorNode"},create(t){return h({kind:"OperatorNode",operator:t})}});function Ao(t){return Ne(t)&&Oo.includes(t)}function To(t){return Ne(t)&&Io.includes(t)}const nr=h({is(t){return t.kind==="ParensNode"},create(t){return h({kind:"ParensNode",node:t})}}),Ke=h({is(t){return t.kind==="ColumnNode"},create(t){return h({kind:"ColumnNode",column:Ge.create(t)})}}),Vs=h({is(t){return t.kind==="SelectAllNode"},create(){return h({kind:"SelectAllNode"})}}),Ci=h({is(t){return t.kind==="ReferenceNode"},create(t,e){return h({kind:"ReferenceNode",table:t,column:e})},createSelectAll(t){return h({kind:"ReferenceNode",table:t,column:Vs.create()})}}),bl=h({is(t){return t.kind==="OrderByItemNode"},create(t,e){return h({kind:"OrderByItemNode",orderBy:t,direction:e})}});function Nl(t){return t==="asc"||t==="desc"}function Wi(t,e){return bl.create(vl(t),xl(e))}function vl(t){return fn(t)}function xl(t){if(t)return t==="asc"||t==="desc"?yt.createWithSql(t):t.toOperationNode()}function Co(t){return Ne(t)?rr(t):t.toOperationNode()}function Mr(t){return Lr(t)?t.map(e=>fn(e)):[fn(t)]}function fn(t){return Ki(t)?Ji(t):Co(t)}function rr(t){const e=".";if(t.includes(e)){const r=t.split(e).map(Hs);if(r.length===3)return Sl(r);if(r.length===2)return kl(r);throw new Error(`invalid column reference ${t}`)}else return Ke.create(t)}function El(t){const e=" as ";if(t.includes(e)){const[r,n]=t.split(e).map(Hs);return Pn.create(rr(r),Ge.create(n))}else return rr(t)}function Wo(t){return Ke.create(t)}function Fo(t){const e=" ";if(t.includes(e)){const[r,n]=t.split(e).map(Hs);if(!Nl(n))throw new Error(`invalid order direction "${n}" next to "${r}"`);return Wi(r,n)}else return Wo(t)}function Sl(t){const[e,r,n]=t;return Ci.create(vn.createWithSchema(e,r),Ke.create(n))}function kl(t){const[e,r]=t;return Ci.create(vn.create(e),Ke.create(r))}function Hs(t){return t.trim()}const Po=h({is(t){return t.kind==="PrimitiveValueListNode"},create(t){return h({kind:"PrimitiveValueListNode",values:h([...t])})}}),$s=h({is(t){return t.kind==="ValueListNode"},create(t){return h({kind:"ValueListNode",values:h(t)})}}),nn=h({is(t){return t.kind==="ValueNode"},create(t){return h({kind:"ValueNode",value:t})},createImmediate(t){return h({kind:"ValueNode",value:t,immediate:!0})}});function Lo(t){return Lr(t)?Il(t):hn(t)}function hn(t){return Ki(t)?Ji(t):nn.create(t)}function Il(t){return t.some(Ki)?$s.create(t.map(e=>hn(e))):Po.create(t)}const ir=h({is(t){return t.kind==="OrderByNode"},create(t){return h({kind:"OrderByNode",items:h([t])})},cloneWithItem(t,e){return h({...t,items:h([...t.items,e])})}}),Do=h({is(t){return t.kind==="PartitionByNode"},create(t){return h({kind:"PartitionByNode",items:h(t)})},cloneWithItems(t,e){return h({...t,items:h([...t.items,...e])})}}),Gs=h({is(t){return t.kind==="OverNode"},create(){return h({kind:"OverNode"})},cloneWithOrderByItem(t,e){return h({...t,orderBy:t.orderBy?ir.cloneWithItem(t.orderBy,e):ir.create(e)})},cloneWithPartitionByItems(t,e){return h({...t,partitionBy:t.partitionBy?Do.cloneWithItems(t.partitionBy,e):Do.create(e)})}}),Fi=h({is(t){return t.kind==="FromNode"},create(t){return h({kind:"FromNode",froms:h(t)})},cloneWithFroms(t,e){return h({...t,froms:h([...t.froms,...e])})}}),Ro=h({is(t){return t.kind==="GroupByNode"},create(t){return h({kind:"GroupByNode",items:h(t)})},cloneWithItems(t,e){return h({...t,items:h([...t.items,...e])})}}),Pi=h({is(t){return t.kind==="HavingNode"},create(t){return h({kind:"HavingNode",having:t})},cloneWithOperation(t,e,r){return h({...t,having:e==="And"?Dr.create(t.having,r):Rr.create(t.having,r)})}}),_e=h({is(t){return t.kind==="SelectQueryNode"},create(t,e){return h({kind:"SelectQueryNode",from:Fi.create(t),...e&&{with:e}})},cloneWithSelections(t,e){return h({...t,selections:t.selections?h([...t.selections,...e]):h(e)})},cloneWithDistinctOn(t,e){return h({...t,distinctOn:t.distinctOn?h([...t.distinctOn,...e]):h(e)})},cloneWithFrontModifier(t,e){return h({...t,frontModifiers:t.frontModifiers?h([...t.frontModifiers,e]):h([e])})},cloneWithEndModifier(t,e){return h({...t,endModifiers:t.endModifiers?h([...t.endModifiers,e]):h([e])})},cloneWithOrderByItem(t,e){return h({...t,orderBy:t.orderBy?ir.cloneWithItem(t.orderBy,e):ir.create(e)})},cloneWithGroupByItems(t,e){return h({...t,groupBy:t.groupBy?Ro.cloneWithItems(t.groupBy,e):Ro.create(e)})},cloneWithLimit(t,e){return h({...t,limit:e})},cloneWithOffset(t,e){return h({...t,offset:e})},cloneWithHaving(t,e){return h({...t,having:t.having?Pi.cloneWithOperation(t.having,"And",e):Pi.create(e)})},cloneWithOrHaving(t,e){return h({...t,having:t.having?Pi.cloneWithOperation(t.having,"Or",e):Pi.create(e)})},cloneWithSetOperation(t,e){return h({...t,setOperations:t.setOperations?h([...t.setOperations,e]):h([e])})},cloneWithoutSelections(t){return h({...t,selections:[]})},cloneWithoutLimit(t){return h({...t,limit:void 0})},cloneWithoutOffset(t){return h({...t,offset:void 0})},cloneWithoutOrderBy(t){return h({...t,orderBy:void 0})}}),Bo=h({is(t){return t.kind==="UnaryOperationNode"},create(t,e){return h({kind:"UnaryOperationNode",operator:t,operand:e})}});function gt(t){return Js("exists",t)}function dt(t){return Js("not exists",t)}function Js(t,e){return Bo.create(zs.create(t),fn(e))}function Se(t,e){Object.defineProperties(t.prototype,{then:{enumerable:!1,value:()=>{throw new Error(e)}}})}const Jt=class{constructor(e){R(this,ze,void 0);U(this,ze,h(e))}on(...e){return new Jt({...s(this,ze),joinNode:Bt.cloneWithOn(s(this,ze).joinNode,ia(e))})}orOn(...e){return new Jt({...s(this,ze),joinNode:Bt.cloneWithOrOn(s(this,ze).joinNode,ia(e))})}onRef(e,r,n){return new Jt({...s(this,ze),joinNode:Bt.cloneWithOn(s(this,ze).joinNode,ft(e,r,n))})}orOnRef(e,r,n){return new Jt({...s(this,ze),joinNode:Bt.cloneWithOrOn(s(this,ze).joinNode,ft(e,r,n))})}onExists(e){return new Jt({...s(this,ze),joinNode:Bt.cloneWithOn(s(this,ze).joinNode,gt(e))})}onNotExists(e){return new Jt({...s(this,ze),joinNode:Bt.cloneWithOn(s(this,ze).joinNode,dt(e))})}orOnExists(e){return new Jt({...s(this,ze),joinNode:Bt.cloneWithOrOn(s(this,ze).joinNode,gt(e))})}orOnNotExists(e){return new Jt({...s(this,ze),joinNode:Bt.cloneWithOrOn(s(this,ze).joinNode,dt(e))})}onTrue(){return new Jt({...s(this,ze),joinNode:Bt.cloneWithOn(s(this,ze).joinNode,yt.createWithSql("true"))})}$call(e){return e(this)}toOperationNode(){return s(this,ze).joinNode}};let Li=Jt;ze=new WeakMap,Se(Li,"don't await JoinBuilder instances. They are never executed directly and are always just a part of a query.");const Ol=h({is(t){return t.kind==="PartitionByItemNode"},create(t){return h({kind:"PartitionByItemNode",partitionBy:t})}});function Al(t){return Mr(t).map(Ol.create)}const ys=class{constructor(e){R(this,Dn,void 0);U(this,Dn,h(e))}orderBy(e,r){return new ys({overNode:Gs.cloneWithOrderByItem(s(this,Dn).overNode,Wi(e,r))})}partitionBy(e){return new ys({overNode:Gs.cloneWithPartitionByItems(s(this,Dn).overNode,Al(e))})}$call(e){return e(this)}toOperationNode(){return s(this,Dn).overNode}};let Di=ys;Dn=new WeakMap,Se(Di,"don't await OverBuilder instances. They are never executed directly and are always just a part of a query.");const Ur=h({is(t){return t.kind==="SelectionNode"},create(t){return h({kind:"SelectionNode",selection:t})},createSelectAll(){return h({kind:"SelectionNode",selection:Vs.create()})},createSelectAllFromTable(t){return h({kind:"SelectionNode",selection:Ci.createSelectAll(t)})}});class Tl{constructor(e){R(this,cr,void 0);U(this,cr,e)}get dynamicReference(){return s(this,cr)}get refType(){}toOperationNode(){return Co(s(this,cr))}}cr=new WeakMap;function Cl(t){return tn(t)&&bt(t)&&Ne(t.dynamicReference)}function jr(t){return Rt(t)?jr(t(pn())):Lr(t)?t.map(e=>Mo(e)):[Mo(t)]}function Mo(t){return Ne(t)?Ur.create(El(t)):Cl(t)?Ur.create(t.toOperationNode()):Ur.create(fa(t))}function Qr(t){return t?Array.isArray(t)?t.map(Uo):[Uo(t)]:[Ur.createSelectAll()]}function Uo(t){if(Ne(t))return Ur.createSelectAllFromTable(It(t));throw new Error(`invalid value selectAll expression: ${JSON.stringify(t)}`)}const Wl=h({is(t){return t.kind==="ValuesNode"},create(t){return h({kind:"ValuesNode",values:h(t)})}}),Fl=h({is(t){return t.kind==="DefaultInsertValueNode"},create(){return h({kind:"DefaultInsertValueNode"})}});function Pl(t){const e=Rt(t)?t(pn()):t,r=Lr(e)?e:h([e]);return Ll(r)}function Ll(t){const e=Dl(t);return[h([...e.keys()].map(Ke.create)),Wl.create(t.map(r=>Rl(r,e)))]}function Dl(t){const e=new Map;for(const r of t){const n=Object.keys(r);for(const A of n)!e.has(A)&&r[A]!==void 0&&e.set(A,e.size)}return e}function Rl(t,e){const r=Object.keys(t),n=Array.from({length:e.size});let A=!1;for(const ae of r){const me=e.get(ae);if(Te(me))continue;const Oe=t[ae];(Te(Oe)||Ki(Oe))&&(A=!0),n[me]=Oe}if(r.length<e.size||A){const ae=Fl.create();return $s.create(n.map(me=>Te(me)?ae:hn(me)))}return Po.create(n)}const rn=h({is(t){return t.kind==="InsertQueryNode"},create(t,e,r){return h({kind:"InsertQueryNode",into:t,...e&&{with:e},replace:r})},cloneWith(t,e){return h({...t,...e})}}),Ri=h({is(t){return t.kind==="UpdateQueryNode"},create(t,e){return h({kind:"UpdateQueryNode",table:t,...e&&{with:e}})},cloneWithFromItems(t,e){return h({...t,from:t.from?Fi.cloneWithFroms(t.from,e):Fi.create(e)})},cloneWithUpdates(t,e){return h({...t,updates:t.updates?h([...t.updates,...e]):e})}}),jo=h({is(t){return t.kind==="UsingNode"},create(t){return h({kind:"UsingNode",tables:h(t)})},cloneWithTables(t,e){return h({...t,tables:h([...t.tables,...e])})}}),zr=h({is(t){return t.kind==="DeleteQueryNode"},create(t,e){return h({kind:"DeleteQueryNode",from:Fi.create(t),...e&&{with:e}})},cloneWithOrderByItem(t,e){return h({...t,orderBy:t.orderBy?ir.cloneWithItem(t.orderBy,e):ir.create(e)})},cloneWithLimit(t,e){return h({...t,limit:e})},cloneWithUsing(t,e){return h({...t,using:t.using!==void 0?jo.cloneWithTables(t.using,e):jo.create(e)})}}),wt=h({is(t){return t.kind==="WhereNode"},create(t){return h({kind:"WhereNode",where:t})},cloneWithOperation(t,e,r){return h({...t,where:e==="And"?Dr.create(t.where,r):Rr.create(t.where,r)})}}),Qo=h({is(t){return t.kind==="ReturningNode"},create(t){return h({kind:"ReturningNode",selections:h(t)})},cloneWithSelections(t,e){return h({...t,selections:t.selections?h([...t.selections,...e]):h(e)})}}),Bl=h({is(t){return t.kind==="ExplainNode"},create(t,e){return h({kind:"ExplainNode",format:t,options:e})}}),re=h({is(t){return _e.is(t)||rn.is(t)||Ri.is(t)||zr.is(t)},cloneWithWhere(t,e){return h({...t,where:t.where?wt.cloneWithOperation(t.where,"And",e):wt.create(e)})},cloneWithOrWhere(t,e){return h({...t,where:t.where?wt.cloneWithOperation(t.where,"Or",e):wt.create(e)})},cloneWithJoin(t,e){return h({...t,joins:t.joins?h([...t.joins,e]):h([e])})},cloneWithReturning(t,e){return h({...t,returning:t.returning?Qo.cloneWithSelections(t.returning,e):Qo.create(e)})},cloneWithoutWhere(t){return h({...t,where:void 0})},cloneWithExplain(t,e,r){return h({...t,explain:Bl.create(e,r==null?void 0:r.toOperationNode())})}}),Ml=h({is(t){return t.kind==="ColumnUpdateNode"},create(t,e){return h({kind:"ColumnUpdateNode",column:t,value:e})}});function Ks(t){const e=Rt(t)?t(pn()):t;return Object.entries(e).filter(([r,n])=>n!==void 0).map(([r,n])=>Ml.create(Ke.create(r),hn(n)))}const Ul=h({is(t){return t.kind==="OnDuplicateKeyNode"},create(t){return h({kind:"OnDuplicateKeyNode",updates:t})}});class zo{constructor(e,r){R(this,Zr,void 0);R(this,ei,void 0);U(this,Zr,e),U(this,ei,r)}get insertId(){return s(this,Zr)}get numInsertedOrUpdatedRows(){return s(this,ei)}}Zr=new WeakMap,ei=new WeakMap;for(const t of["insertId","numInsertedOrUpdatedRows"])Object.defineProperty(zo.prototype,t,{enumerable:!0});class Bi extends Error{constructor(r){super("no result");Tt(this,"node");this.node=r}}function Mi(t){return Object.prototype.hasOwnProperty.call(t,"prototype")}const Me=h({is(t){return t.kind==="OnConflictNode"},create(){return h({kind:"OnConflictNode"})},cloneWith(t,e){return h({...t,...e})},cloneWithIndexWhere(t,e){return h({...t,indexWhere:t.indexWhere?wt.cloneWithOperation(t.indexWhere,"And",e):wt.create(e)})},cloneWithIndexOrWhere(t,e){return h({...t,indexWhere:t.indexWhere?wt.cloneWithOperation(t.indexWhere,"Or",e):wt.create(e)})},cloneWithUpdateWhere(t,e){return h({...t,updateWhere:t.updateWhere?wt.cloneWithOperation(t.updateWhere,"And",e):wt.create(e)})},cloneWithUpdateOrWhere(t,e){return h({...t,updateWhere:t.updateWhere?wt.cloneWithOperation(t.updateWhere,"Or",e):wt.create(e)})},cloneWithoutIndexWhere(t){return h({...t,indexWhere:void 0})},cloneWithoutUpdateWhere(t){return h({...t,updateWhere:void 0})}}),Nt=class{constructor(e){R(this,ge,void 0);U(this,ge,h(e))}column(e){const r=Ke.create(e);return new Nt({...s(this,ge),onConflictNode:Me.cloneWith(s(this,ge).onConflictNode,{columns:s(this,ge).onConflictNode.columns?h([...s(this,ge).onConflictNode.columns,r]):h([r])})})}columns(e){const r=e.map(Ke.create);return new Nt({...s(this,ge),onConflictNode:Me.cloneWith(s(this,ge).onConflictNode,{columns:s(this,ge).onConflictNode.columns?h([...s(this,ge).onConflictNode.columns,...r]):h(r)})})}constraint(e){return new Nt({...s(this,ge),onConflictNode:Me.cloneWith(s(this,ge).onConflictNode,{constraint:Ge.create(e)})})}expression(e){return new Nt({...s(this,ge),onConflictNode:Me.cloneWith(s(this,ge).onConflictNode,{indexExpression:e.toOperationNode()})})}where(...e){return new Nt({...s(this,ge),onConflictNode:Me.cloneWithIndexWhere(s(this,ge).onConflictNode,Ct(e))})}whereRef(e,r,n){return new Nt({...s(this,ge),onConflictNode:Me.cloneWithIndexWhere(s(this,ge).onConflictNode,ft(e,r,n))})}orWhere(...e){return new Nt({...s(this,ge),onConflictNode:Me.cloneWithIndexOrWhere(s(this,ge).onConflictNode,Ct(e))})}orWhereRef(e,r,n){return new Nt({...s(this,ge),onConflictNode:Me.cloneWithIndexOrWhere(s(this,ge).onConflictNode,ft(e,r,n))})}whereExists(e){return new Nt({...s(this,ge),onConflictNode:Me.cloneWithIndexWhere(s(this,ge).onConflictNode,gt(e))})}whereNotExists(e){return new Nt({...s(this,ge),onConflictNode:Me.cloneWithIndexWhere(s(this,ge).onConflictNode,dt(e))})}orWhereExists(e){return new Nt({...s(this,ge),onConflictNode:Me.cloneWithIndexOrWhere(s(this,ge).onConflictNode,gt(e))})}orWhereNotExists(e){return new Nt({...s(this,ge),onConflictNode:Me.cloneWithIndexOrWhere(s(this,ge).onConflictNode,dt(e))})}clearWhere(){return new Nt({...s(this,ge),onConflictNode:Me.cloneWithoutIndexWhere(s(this,ge).onConflictNode)})}doNothing(){return new Vo({...s(this,ge),onConflictNode:Me.cloneWith(s(this,ge).onConflictNode,{doNothing:!0})})}doUpdateSet(e){return new ji({...s(this,ge),onConflictNode:Me.cloneWith(s(this,ge).onConflictNode,{updates:Ks(e)})})}$call(e){return e(this)}};let Ui=Nt;ge=new WeakMap,Se(Ui,"don't await OnConflictBuilder instances.");class Vo{constructor(e){R(this,ti,void 0);U(this,ti,h(e))}toOperationNode(){return s(this,ti).onConflictNode}}ti=new WeakMap,Se(Vo,"don't await OnConflictDoNothingBuilder instances.");const Kt=class{constructor(e){R(this,Ve,void 0);U(this,Ve,h(e))}where(...e){return new Kt({...s(this,Ve),onConflictNode:Me.cloneWithUpdateWhere(s(this,Ve).onConflictNode,Ct(e))})}whereRef(e,r,n){return new Kt({...s(this,Ve),onConflictNode:Me.cloneWithUpdateWhere(s(this,Ve).onConflictNode,ft(e,r,n))})}orWhere(...e){return new Kt({...s(this,Ve),onConflictNode:Me.cloneWithUpdateOrWhere(s(this,Ve).onConflictNode,Ct(e))})}orWhereRef(e,r,n){return new Kt({...s(this,Ve),onConflictNode:Me.cloneWithUpdateOrWhere(s(this,Ve).onConflictNode,ft(e,r,n))})}whereExists(e){return new Kt({...s(this,Ve),onConflictNode:Me.cloneWithUpdateWhere(s(this,Ve).onConflictNode,gt(e))})}whereNotExists(e){return new Kt({...s(this,Ve),onConflictNode:Me.cloneWithUpdateWhere(s(this,Ve).onConflictNode,dt(e))})}orWhereExists(e){return new Kt({...s(this,Ve),onConflictNode:Me.cloneWithUpdateOrWhere(s(this,Ve).onConflictNode,gt(e))})}orWhereNotExists(e){return new Kt({...s(this,Ve),onConflictNode:Me.cloneWithUpdateOrWhere(s(this,Ve).onConflictNode,dt(e))})}clearWhere(){return new Kt({...s(this,Ve),onConflictNode:Me.cloneWithoutUpdateWhere(s(this,Ve).onConflictNode)})}$call(e){return e(this)}toOperationNode(){return s(this,Ve).onConflictNode}};let ji=Kt;Ve=new WeakMap,Se(ji,"don't await OnConflictUpdateBuilder instances.");const ot=class{constructor(e){R(this,ye,void 0);U(this,ye,h(e))}values(e){const[r,n]=Pl(e);return new ot({...s(this,ye),queryNode:rn.cloneWith(s(this,ye).queryNode,{columns:r,values:n})})}columns(e){return new ot({...s(this,ye),queryNode:rn.cloneWith(s(this,ye).queryNode,{columns:h(e.map(Ke.create))})})}expression(e){return new ot({...s(this,ye),queryNode:rn.cloneWith(s(this,ye).queryNode,{values:Ji(e)})})}ignore(){return new ot({...s(this,ye),queryNode:rn.cloneWith(s(this,ye).queryNode,{ignore:!0})})}onConflict(e){return new ot({...s(this,ye),queryNode:rn.cloneWith(s(this,ye).queryNode,{onConflict:e(new Ui({onConflictNode:Me.create()})).toOperationNode()})})}onDuplicateKeyUpdate(e){return new ot({...s(this,ye),queryNode:rn.cloneWith(s(this,ye).queryNode,{onDuplicateKey:Ul.create(Ks(e))})})}returning(e){return new ot({...s(this,ye),queryNode:re.cloneWithReturning(s(this,ye).queryNode,jr(e))})}returningAll(){return new ot({...s(this,ye),queryNode:re.cloneWithReturning(s(this,ye).queryNode,Qr())})}$call(e){return e(this)}call(e){return this.$call(e)}$if(e,r){return e?r(this):new ot({...s(this,ye)})}if(e,r){return e?r(this):new ot({...s(this,ye)})}$castTo(){return new ot(s(this,ye))}castTo(){return this.$castTo()}$narrowType(){return new ot(s(this,ye))}$assertType(){return new ot(s(this,ye))}assertType(){return new ot(s(this,ye))}withPlugin(e){return new ot({...s(this,ye),executor:s(this,ye).executor.withPlugin(e)})}toOperationNode(){return s(this,ye).executor.transformQuery(s(this,ye).queryNode,s(this,ye).queryId)}compile(){return s(this,ye).executor.compileQuery(this.toOperationNode(),s(this,ye).queryId)}async execute(){const e=this.compile(),r=e.query,n=await s(this,ye).executor.executeQuery(e,s(this,ye).queryId);return s(this,ye).executor.adapter.supportsReturning&&r.returning?n.rows:[new zo(n.insertId,n.numAffectedRows??n.numUpdatedOrDeletedRows)]}async executeTakeFirst(){const[e]=await this.execute();return e}async executeTakeFirstOrThrow(e=Bi){const r=await this.executeTakeFirst();if(r===void 0)throw Mi(e)?new e(this.toOperationNode()):e(this.toOperationNode());return r}async*stream(e=100){const r=this.compile(),n=s(this,ye).executor.stream(r,e,s(this,ye).queryId);for await(const A of n)yield*A.rows}async explain(e,r){return await new ot({...s(this,ye),queryNode:re.cloneWithExplain(s(this,ye).queryNode,e,r)}).execute()}};let Vr=ot;ye=new WeakMap,Se(Vr,"don't await InsertQueryBuilder instances directly. To execute the query you need to call `execute` or `executeTakeFirst`.");class Ho{constructor(e){R(this,ni,void 0);U(this,ni,e)}get numDeletedRows(){return s(this,ni)}}ni=new WeakMap,Object.defineProperty(Ho.prototype,"numDeletedRows",{enumerable:!0});const $o=h({is(t){return t.kind==="LimitNode"},create(t){return h({kind:"LimitNode",limit:nn.create(t)})}}),We=class{constructor(e){R(this,Z,void 0);U(this,Z,h(e))}where(...e){return new We({...s(this,Z),queryNode:re.cloneWithWhere(s(this,Z).queryNode,Ct(e))})}whereRef(e,r,n){return new We({...s(this,Z),queryNode:re.cloneWithWhere(s(this,Z).queryNode,ft(e,r,n))})}orWhere(...e){return new We({...s(this,Z),queryNode:re.cloneWithOrWhere(s(this,Z).queryNode,Ct(e))})}orWhereRef(e,r,n){return new We({...s(this,Z),queryNode:re.cloneWithOrWhere(s(this,Z).queryNode,ft(e,r,n))})}whereExists(e){return new We({...s(this,Z),queryNode:re.cloneWithWhere(s(this,Z).queryNode,gt(e))})}whereNotExists(e){return new We({...s(this,Z),queryNode:re.cloneWithWhere(s(this,Z).queryNode,dt(e))})}orWhereExists(e){return new We({...s(this,Z),queryNode:re.cloneWithOrWhere(s(this,Z).queryNode,gt(e))})}orWhereNotExists(e){return new We({...s(this,Z),queryNode:re.cloneWithOrWhere(s(this,Z).queryNode,dt(e))})}clearWhere(){return new We({...s(this,Z),queryNode:re.cloneWithoutWhere(s(this,Z).queryNode)})}using(e){return new We({...s(this,Z),queryNode:zr.cloneWithUsing(s(this,Z).queryNode,lr(e))})}innerJoin(...e){return new We({...s(this,Z),queryNode:re.cloneWithJoin(s(this,Z).queryNode,kt("InnerJoin",e))})}leftJoin(...e){return new We({...s(this,Z),queryNode:re.cloneWithJoin(s(this,Z).queryNode,kt("LeftJoin",e))})}rightJoin(...e){return new We({...s(this,Z),queryNode:re.cloneWithJoin(s(this,Z).queryNode,kt("RightJoin",e))})}fullJoin(...e){return new We({...s(this,Z),queryNode:re.cloneWithJoin(s(this,Z).queryNode,kt("FullJoin",e))})}returning(e){return new We({...s(this,Z),queryNode:re.cloneWithReturning(s(this,Z).queryNode,jr(e))})}returningAll(e){return new We({...s(this,Z),queryNode:re.cloneWithReturning(s(this,Z).queryNode,Qr(e))})}orderBy(e,r){return new We({...s(this,Z),queryNode:zr.cloneWithOrderByItem(s(this,Z).queryNode,Wi(e,r))})}limit(e){return new We({...s(this,Z),queryNode:zr.cloneWithLimit(s(this,Z).queryNode,$o.create(e))})}$call(e){return e(this)}call(e){return this.$call(e)}$if(e,r){return e?r(this):new We({...s(this,Z)})}if(e,r){return this.$if(e,r)}$castTo(){return new We(s(this,Z))}castTo(){return this.$castTo()}$narrowType(){return new We(s(this,Z))}$assertType(){return new We(s(this,Z))}assertType(){return new We(s(this,Z))}withPlugin(e){return new We({...s(this,Z),executor:s(this,Z).executor.withPlugin(e)})}toOperationNode(){return s(this,Z).executor.transformQuery(s(this,Z).queryNode,s(this,Z).queryId)}compile(){return s(this,Z).executor.compileQuery(this.toOperationNode(),s(this,Z).queryId)}async execute(){const e=this.compile(),r=e.query,n=await s(this,Z).executor.executeQuery(e,s(this,Z).queryId);return s(this,Z).executor.adapter.supportsReturning&&r.returning?n.rows:[new Ho(n.numAffectedRows??n.numUpdatedOrDeletedRows??BigInt(0))]}async executeTakeFirst(){const[e]=await this.execute();return e}async executeTakeFirstOrThrow(e=Bi){const r=await this.executeTakeFirst();if(r===void 0)throw Mi(e)?new e(this.toOperationNode()):e(this.toOperationNode());return r}async*stream(e=100){const r=this.compile(),n=s(this,Z).executor.stream(r,e,s(this,Z).queryId);for await(const A of n)yield*A.rows}async explain(e,r){return await new We({...s(this,Z),queryNode:re.cloneWithExplain(s(this,Z).queryNode,e,r)}).execute()}};let Qi=We;Z=new WeakMap,Se(Qi,"don't await DeleteQueryBuilder instances directly. To execute the query you need to call `execute` or `executeTakeFirst`.");class Go{constructor(e){R(this,ri,void 0);U(this,ri,e)}get numUpdatedRows(){return s(this,ri)}}ri=new WeakMap,Object.defineProperty(Go.prototype,"numUpdatedRows",{enumerable:!0});const De=class{constructor(e){R(this,te,void 0);U(this,te,h(e))}where(...e){return new De({...s(this,te),queryNode:re.cloneWithWhere(s(this,te).queryNode,Ct(e))})}whereRef(e,r,n){return new De({...s(this,te),queryNode:re.cloneWithWhere(s(this,te).queryNode,ft(e,r,n))})}orWhere(...e){return new De({...s(this,te),queryNode:re.cloneWithOrWhere(s(this,te).queryNode,Ct(e))})}orWhereRef(e,r,n){return new De({...s(this,te),queryNode:re.cloneWithOrWhere(s(this,te).queryNode,ft(e,r,n))})}whereExists(e){return new De({...s(this,te),queryNode:re.cloneWithWhere(s(this,te).queryNode,gt(e))})}whereNotExists(e){return new De({...s(this,te),queryNode:re.cloneWithWhere(s(this,te).queryNode,dt(e))})}orWhereExists(e){return new De({...s(this,te),queryNode:re.cloneWithOrWhere(s(this,te).queryNode,gt(e))})}orWhereNotExists(e){return new De({...s(this,te),queryNode:re.cloneWithOrWhere(s(this,te).queryNode,dt(e))})}clearWhere(){return new De({...s(this,te),queryNode:re.cloneWithoutWhere(s(this,te).queryNode)})}from(e){return new De({...s(this,te),queryNode:Ri.cloneWithFromItems(s(this,te).queryNode,lr(e))})}innerJoin(...e){return new De({...s(this,te),queryNode:re.cloneWithJoin(s(this,te).queryNode,kt("InnerJoin",e))})}leftJoin(...e){return new De({...s(this,te),queryNode:re.cloneWithJoin(s(this,te).queryNode,kt("LeftJoin",e))})}rightJoin(...e){return new De({...s(this,te),queryNode:re.cloneWithJoin(s(this,te).queryNode,kt("RightJoin",e))})}fullJoin(...e){return new De({...s(this,te),queryNode:re.cloneWithJoin(s(this,te).queryNode,kt("FullJoin",e))})}set(e){return new De({...s(this,te),queryNode:Ri.cloneWithUpdates(s(this,te).queryNode,Ks(e))})}returning(e){return new De({...s(this,te),queryNode:re.cloneWithReturning(s(this,te).queryNode,jr(e))})}returningAll(){return new De({...s(this,te),queryNode:re.cloneWithReturning(s(this,te).queryNode,Qr())})}$call(e){return e(this)}call(e){return this.$call(e)}$if(e,r){return e?r(this):new De({...s(this,te)})}if(e,r){return this.$if(e,r)}$castTo(){return new De(s(this,te))}castTo(){return this.$castTo()}$narrowType(){return new De(s(this,te))}$assertType(){return new De(s(this,te))}assertType(){return new De(s(this,te))}withPlugin(e){return new De({...s(this,te),executor:s(this,te).executor.withPlugin(e)})}toOperationNode(){return s(this,te).executor.transformQuery(s(this,te).queryNode,s(this,te).queryId)}compile(){return s(this,te).executor.compileQuery(this.toOperationNode(),s(this,te).queryId)}async execute(){const e=this.compile(),r=e.query,n=await s(this,te).executor.executeQuery(e,s(this,te).queryId);return s(this,te).executor.adapter.supportsReturning&&r.returning?n.rows:[new Go(n.numAffectedRows??n.numUpdatedOrDeletedRows??BigInt(0))]}async executeTakeFirst(){const[e]=await this.execute();return e}async executeTakeFirstOrThrow(e=Bi){const r=await this.executeTakeFirst();if(r===void 0)throw Mi(e)?new e(this.toOperationNode()):e(this.toOperationNode());return r}async*stream(e=100){const r=this.compile(),n=s(this,te).executor.stream(r,e,s(this,te).queryId);for await(const A of n)yield*A.rows}async explain(e,r){return await new De({...s(this,te),queryNode:re.cloneWithExplain(s(this,te).queryNode,e,r)}).execute()}};let zi=De;te=new WeakMap,Se(zi,"don't await UpdateQueryBuilder instances directly. To execute the query you need to call `execute` or `executeTakeFirst`.");const jl=h({is(t){return t.kind==="CommonTableExpressionNode"},create(t,e){return h({kind:"CommonTableExpressionNode",name:t,expression:e})}}),Jo=h({is(t){return t.kind==="CommonTableExpressionNameNode"},create(t,e){return h({kind:"CommonTableExpressionNameNode",table:vn.create(t),columns:e?h(e.map(Ke.create)):void 0})}});function Ko(t,e){const r=e(Yl());return jl.create(Ql(t),r.toOperationNode())}function Ql(t){if(t.includes("(")){const e=t.split(/[\(\)]/),r=e[0],n=e[1].split(",").map(A=>A.trim());return Jo.create(r,n)}else return Jo.create(t)}const Vi=h({is(t){return t.kind==="WithNode"},create(t,e){return h({kind:"WithNode",expressions:h([t]),...e})},cloneWithExpression(t,e){return h({...t,expressions:h([...t.expressions,e])})}}),Xo=["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","0","1","2","3","4","5","6","7","8","9"];function zl(t){let e="";for(let r=0;r<t;++r)e+=Vl();return e}function Vl(){return Xo[~~(Math.random()*Xo.length)]}function Ce(){return new Hl}class Hl{constructor(){R(this,dr,void 0)}get queryId(){return s(this,dr)===void 0&&U(this,dr,zl(8)),s(this,dr)}}dr=new WeakMap;function qd(t){return t}class Xs{constructor(){Tt(this,"nodeStack",[]);R(this,gs,h({AliasNode:this.transformAlias.bind(this),ColumnNode:this.transformColumn.bind(this),IdentifierNode:this.transformIdentifier.bind(this),SchemableIdentifierNode:this.transformSchemableIdentifier.bind(this),RawNode:this.transformRaw.bind(this),ReferenceNode:this.transformReference.bind(this),SelectQueryNode:this.transformSelectQuery.bind(this),SelectionNode:this.transformSelection.bind(this),TableNode:this.transformTable.bind(this),FromNode:this.transformFrom.bind(this),SelectAllNode:this.transformSelectAll.bind(this),AndNode:this.transformAnd.bind(this),OrNode:this.transformOr.bind(this),ValueNode:this.transformValue.bind(this),ValueListNode:this.transformValueList.bind(this),PrimitiveValueListNode:this.transformPrimitiveValueList.bind(this),ParensNode:this.transformParens.bind(this),JoinNode:this.transformJoin.bind(this),OperatorNode:this.transformOperator.bind(this),WhereNode:this.transformWhere.bind(this),InsertQueryNode:this.transformInsertQuery.bind(this),DeleteQueryNode:this.transformDeleteQuery.bind(this),ReturningNode:this.transformReturning.bind(this),CreateTableNode:this.transformCreateTable.bind(this),AddColumnNode:this.transformAddColumn.bind(this),ColumnDefinitionNode:this.transformColumnDefinition.bind(this),DropTableNode:this.transformDropTable.bind(this),DataTypeNode:this.transformDataType.bind(this),OrderByNode:this.transformOrderBy.bind(this),OrderByItemNode:this.transformOrderByItem.bind(this),GroupByNode:this.transformGroupBy.bind(this),GroupByItemNode:this.transformGroupByItem.bind(this),UpdateQueryNode:this.transformUpdateQuery.bind(this),ColumnUpdateNode:this.transformColumnUpdate.bind(this),LimitNode:this.transformLimit.bind(this),OffsetNode:this.transformOffset.bind(this),OnConflictNode:this.transformOnConflict.bind(this),OnDuplicateKeyNode:this.transformOnDuplicateKey.bind(this),CreateIndexNode:this.transformCreateIndex.bind(this),DropIndexNode:this.transformDropIndex.bind(this),ListNode:this.transformList.bind(this),PrimaryKeyConstraintNode:this.transformPrimaryKeyConstraint.bind(this),UniqueConstraintNode:this.transformUniqueConstraint.bind(this),ReferencesNode:this.transformReferences.bind(this),CheckConstraintNode:this.transformCheckConstraint.bind(this),WithNode:this.transformWith.bind(this),CommonTableExpressionNode:this.transformCommonTableExpression.bind(this),CommonTableExpressionNameNode:this.transformCommonTableExpressionName.bind(this),HavingNode:this.transformHaving.bind(this),CreateSchemaNode:this.transformCreateSchema.bind(this),DropSchemaNode:this.transformDropSchema.bind(this),AlterTableNode:this.transformAlterTable.bind(this),DropColumnNode:this.transformDropColumn.bind(this),RenameColumnNode:this.transformRenameColumn.bind(this),AlterColumnNode:this.transformAlterColumn.bind(this),ModifyColumnNode:this.transformModifyColumn.bind(this),AddConstraintNode:this.transformAddConstraint.bind(this),DropConstraintNode:this.transformDropConstraint.bind(this),ForeignKeyConstraintNode:this.transformForeignKeyConstraint.bind(this),CreateViewNode:this.transformCreateView.bind(this),DropViewNode:this.transformDropView.bind(this),GeneratedNode:this.transformGenerated.bind(this),DefaultValueNode:this.transformDefaultValue.bind(this),OnNode:this.transformOn.bind(this),ValuesNode:this.transformValues.bind(this),SelectModifierNode:this.transformSelectModifier.bind(this),CreateTypeNode:this.transformCreateType.bind(this),DropTypeNode:this.transformDropType.bind(this),ExplainNode:this.transformExplain.bind(this),DefaultInsertValueNode:this.transformDefaultInsertValue.bind(this),AggregateFunctionNode:this.transformAggregateFunction.bind(this),OverNode:this.transformOver.bind(this),PartitionByNode:this.transformPartitionBy.bind(this),PartitionByItemNode:this.transformPartitionByItem.bind(this),SetOperationNode:this.transformSetOperation.bind(this),BinaryOperationNode:this.transformBinaryOperation.bind(this),UnaryOperationNode:this.transformUnaryOperation.bind(this),UsingNode:this.transformUsing.bind(this),FunctionNode:this.transformFunction.bind(this),CaseNode:this.transformCase.bind(this),WhenNode:this.transformWhen.bind(this)}))}transformNode(e){if(!e)return e;this.nodeStack.push(e);const r=this.transformNodeImpl(e);return this.nodeStack.pop(),h(r)}transformNodeImpl(e){return s(this,gs)[e.kind](e)}transformNodeList(e){return e&&h(e.map(r=>this.transformNode(r)))}transformSelectQuery(e){return{kind:"SelectQueryNode",from:this.transformNode(e.from),selections:this.transformNodeList(e.selections),distinctOn:this.transformNodeList(e.distinctOn),joins:this.transformNodeList(e.joins),groupBy:this.transformNode(e.groupBy),orderBy:this.transformNode(e.orderBy),where:this.transformNode(e.where),frontModifiers:this.transformNodeList(e.frontModifiers),endModifiers:this.transformNodeList(e.endModifiers),limit:this.transformNode(e.limit),offset:this.transformNode(e.offset),with:this.transformNode(e.with),having:this.transformNode(e.having),explain:this.transformNode(e.explain),setOperations:this.transformNodeList(e.setOperations)}}transformSelection(e){return{kind:"SelectionNode",selection:this.transformNode(e.selection)}}transformColumn(e){return{kind:"ColumnNode",column:this.transformNode(e.column)}}transformAlias(e){return{kind:"AliasNode",node:this.transformNode(e.node),alias:this.transformNode(e.alias)}}transformTable(e){return{kind:"TableNode",table:this.transformNode(e.table)}}transformFrom(e){return{kind:"FromNode",froms:this.transformNodeList(e.froms)}}transformReference(e){return{kind:"ReferenceNode",table:this.transformNode(e.table),column:this.transformNode(e.column)}}transformAnd(e){return{kind:"AndNode",left:this.transformNode(e.left),right:this.transformNode(e.right)}}transformOr(e){return{kind:"OrNode",left:this.transformNode(e.left),right:this.transformNode(e.right)}}transformValueList(e){return{kind:"ValueListNode",values:this.transformNodeList(e.values)}}transformParens(e){return{kind:"ParensNode",node:this.transformNode(e.node)}}transformJoin(e){return{kind:"JoinNode",joinType:e.joinType,table:this.transformNode(e.table),on:this.transformNode(e.on)}}transformRaw(e){return{kind:"RawNode",sqlFragments:h([...e.sqlFragments]),parameters:this.transformNodeList(e.parameters)}}transformWhere(e){return{kind:"WhereNode",where:this.transformNode(e.where)}}transformInsertQuery(e){return{kind:"InsertQueryNode",into:this.transformNode(e.into),columns:this.transformNodeList(e.columns),values:this.transformNode(e.values),returning:this.transformNode(e.returning),onConflict:this.transformNode(e.onConflict),onDuplicateKey:this.transformNode(e.onDuplicateKey),with:this.transformNode(e.with),ignore:e.ignore,replace:e.replace,explain:this.transformNode(e.explain)}}transformValues(e){return{kind:"ValuesNode",values:this.transformNodeList(e.values)}}transformDeleteQuery(e){return{kind:"DeleteQueryNode",from:this.transformNode(e.from),using:this.transformNode(e.using),joins:this.transformNodeList(e.joins),where:this.transformNode(e.where),returning:this.transformNode(e.returning),with:this.transformNode(e.with),orderBy:this.transformNode(e.orderBy),limit:this.transformNode(e.limit),explain:this.transformNode(e.explain)}}transformReturning(e){return{kind:"ReturningNode",selections:this.transformNodeList(e.selections)}}transformCreateTable(e){return{kind:"CreateTableNode",table:this.transformNode(e.table),columns:this.transformNodeList(e.columns),constraints:this.transformNodeList(e.constraints),temporary:e.temporary,ifNotExists:e.ifNotExists,onCommit:e.onCommit,frontModifiers:this.transformNodeList(e.frontModifiers),endModifiers:this.transformNodeList(e.endModifiers)}}transformColumnDefinition(e){return{kind:"ColumnDefinitionNode",column:this.transformNode(e.column),dataType:this.transformNode(e.dataType),references:this.transformNode(e.references),primaryKey:e.primaryKey,autoIncrement:e.autoIncrement,unique:e.unique,notNull:e.notNull,unsigned:e.unsigned,defaultTo:this.transformNode(e.defaultTo),check:this.transformNode(e.check),generated:this.transformNode(e.generated),frontModifiers:this.transformNodeList(e.frontModifiers),endModifiers:this.transformNodeList(e.endModifiers)}}transformAddColumn(e){return{kind:"AddColumnNode",column:this.transformNode(e.column)}}transformDropTable(e){return{kind:"DropTableNode",table:this.transformNode(e.table),ifExists:e.ifExists,cascade:e.cascade}}transformOrderBy(e){return{kind:"OrderByNode",items:this.transformNodeList(e.items)}}transformOrderByItem(e){return{kind:"OrderByItemNode",orderBy:this.transformNode(e.orderBy),direction:this.transformNode(e.direction)}}transformGroupBy(e){return{kind:"GroupByNode",items:this.transformNodeList(e.items)}}transformGroupByItem(e){return{kind:"GroupByItemNode",groupBy:this.transformNode(e.groupBy)}}transformUpdateQuery(e){return{kind:"UpdateQueryNode",table:this.transformNode(e.table),from:this.transformNode(e.from),joins:this.transformNodeList(e.joins),where:this.transformNode(e.where),updates:this.transformNodeList(e.updates),returning:this.transformNode(e.returning),with:this.transformNode(e.with),explain:this.transformNode(e.explain)}}transformColumnUpdate(e){return{kind:"ColumnUpdateNode",column:this.transformNode(e.column),value:this.transformNode(e.value)}}transformLimit(e){return{kind:"LimitNode",limit:this.transformNode(e.limit)}}transformOffset(e){return{kind:"OffsetNode",offset:this.transformNode(e.offset)}}transformOnConflict(e){return{kind:"OnConflictNode",columns:this.transformNodeList(e.columns),constraint:this.transformNode(e.constraint),indexExpression:this.transformNode(e.indexExpression),indexWhere:this.transformNode(e.indexWhere),updates:this.transformNodeList(e.updates),updateWhere:this.transformNode(e.updateWhere),doNothing:e.doNothing}}transformOnDuplicateKey(e){return{kind:"OnDuplicateKeyNode",updates:this.transformNodeList(e.updates)}}transformCreateIndex(e){return{kind:"CreateIndexNode",name:this.transformNode(e.name),table:this.transformNode(e.table),columns:this.transformNodeList(e.columns),unique:e.unique,using:this.transformNode(e.using),ifNotExists:e.ifNotExists,where:this.transformNode(e.where)}}transformList(e){return{kind:"ListNode",items:this.transformNodeList(e.items)}}transformDropIndex(e){return{kind:"DropIndexNode",name:this.transformNode(e.name),table:this.transformNode(e.table),ifExists:e.ifExists,cascade:e.cascade}}transformPrimaryKeyConstraint(e){return{kind:"PrimaryKeyConstraintNode",columns:this.transformNodeList(e.columns),name:this.transformNode(e.name)}}transformUniqueConstraint(e){return{kind:"UniqueConstraintNode",columns:this.transformNodeList(e.columns),name:this.transformNode(e.name)}}transformForeignKeyConstraint(e){return{kind:"ForeignKeyConstraintNode",columns:this.transformNodeList(e.columns),references:this.transformNode(e.references),name:this.transformNode(e.name),onDelete:e.onDelete,onUpdate:e.onUpdate}}transformSetOperation(e){return{kind:"SetOperationNode",operator:e.operator,expression:this.transformNode(e.expression),all:e.all}}transformReferences(e){return{kind:"ReferencesNode",table:this.transformNode(e.table),columns:this.transformNodeList(e.columns),onDelete:e.onDelete,onUpdate:e.onUpdate}}transformCheckConstraint(e){return{kind:"CheckConstraintNode",expression:this.transformNode(e.expression),name:this.transformNode(e.name)}}transformWith(e){return{kind:"WithNode",expressions:this.transformNodeList(e.expressions),recursive:e.recursive}}transformCommonTableExpression(e){return{kind:"CommonTableExpressionNode",name:this.transformNode(e.name),expression:this.transformNode(e.expression)}}transformCommonTableExpressionName(e){return{kind:"CommonTableExpressionNameNode",table:this.transformNode(e.table),columns:this.transformNodeList(e.columns)}}transformHaving(e){return{kind:"HavingNode",having:this.transformNode(e.having)}}transformCreateSchema(e){return{kind:"CreateSchemaNode",schema:this.transformNode(e.schema),ifNotExists:e.ifNotExists}}transformDropSchema(e){return{kind:"DropSchemaNode",schema:this.transformNode(e.schema),ifExists:e.ifExists,cascade:e.cascade}}transformAlterTable(e){return{kind:"AlterTableNode",table:this.transformNode(e.table),renameTo:this.transformNode(e.renameTo),setSchema:this.transformNode(e.setSchema),columnAlterations:this.transformNodeList(e.columnAlterations),addConstraint:this.transformNode(e.addConstraint),dropConstraint:this.transformNode(e.dropConstraint)}}transformDropColumn(e){return{kind:"DropColumnNode",column:this.transformNode(e.column)}}transformRenameColumn(e){return{kind:"RenameColumnNode",column:this.transformNode(e.column),renameTo:this.transformNode(e.renameTo)}}transformAlterColumn(e){return{kind:"AlterColumnNode",column:this.transformNode(e.column),dataType:this.transformNode(e.dataType),dataTypeExpression:this.transformNode(e.dataTypeExpression),setDefault:this.transformNode(e.setDefault),dropDefault:e.dropDefault,setNotNull:e.setNotNull,dropNotNull:e.dropNotNull}}transformModifyColumn(e){return{kind:"ModifyColumnNode",column:this.transformNode(e.column)}}transformAddConstraint(e){return{kind:"AddConstraintNode",constraint:this.transformNode(e.constraint)}}transformDropConstraint(e){return{kind:"DropConstraintNode",constraintName:this.transformNode(e.constraintName),ifExists:e.ifExists,modifier:e.modifier}}transformCreateView(e){return{kind:"CreateViewNode",name:this.transformNode(e.name),temporary:e.temporary,orReplace:e.orReplace,ifNotExists:e.ifNotExists,materialized:e.materialized,columns:this.transformNodeList(e.columns),as:this.transformNode(e.as)}}transformDropView(e){return{kind:"DropViewNode",name:this.transformNode(e.name),ifExists:e.ifExists,materialized:e.materialized,cascade:e.cascade}}transformGenerated(e){return{kind:"GeneratedNode",byDefault:e.byDefault,always:e.always,identity:e.identity,stored:e.stored,expression:this.transformNode(e.expression)}}transformDefaultValue(e){return{kind:"DefaultValueNode",defaultValue:this.transformNode(e.defaultValue)}}transformOn(e){return{kind:"OnNode",on:this.transformNode(e.on)}}transformSelectModifier(e){return{kind:"SelectModifierNode",modifier:e.modifier,rawModifier:this.transformNode(e.rawModifier)}}transformCreateType(e){return{kind:"CreateTypeNode",name:this.transformNode(e.name),enum:this.transformNode(e.enum)}}transformDropType(e){return{kind:"DropTypeNode",name:this.transformNode(e.name),ifExists:e.ifExists}}transformExplain(e){return{kind:"ExplainNode",format:e.format,options:this.transformNode(e.options)}}transformSchemableIdentifier(e){return{kind:"SchemableIdentifierNode",schema:this.transformNode(e.schema),identifier:this.transformNode(e.identifier)}}transformAggregateFunction(e){return{kind:"AggregateFunctionNode",aggregated:this.transformNodeList(e.aggregated),distinct:e.distinct,filter:this.transformNode(e.filter),func:e.func,over:this.transformNode(e.over)}}transformOver(e){return{kind:"OverNode",orderBy:this.transformNode(e.orderBy),partitionBy:this.transformNode(e.partitionBy)}}transformPartitionBy(e){return{kind:"PartitionByNode",items:this.transformNodeList(e.items)}}transformPartitionByItem(e){return{kind:"PartitionByItemNode",partitionBy:this.transformNode(e.partitionBy)}}transformBinaryOperation(e){return{kind:"BinaryOperationNode",leftOperand:this.transformNode(e.leftOperand),operator:this.transformNode(e.operator),rightOperand:this.transformNode(e.rightOperand)}}transformUnaryOperation(e){return{kind:"UnaryOperationNode",operator:this.transformNode(e.operator),operand:this.transformNode(e.operand)}}transformUsing(e){return{kind:"UsingNode",tables:this.transformNodeList(e.tables)}}transformFunction(e){return{kind:"FunctionNode",func:e.func,arguments:this.transformNodeList(e.arguments)}}transformCase(e){return{kind:"CaseNode",value:this.transformNode(e.value),when:this.transformNodeList(e.when),else:this.transformNode(e.else),isStatement:e.isStatement}}transformWhen(e){return{kind:"WhenNode",condition:this.transformNode(e.condition),result:this.transformNode(e.result)}}transformDataType(e){return e}transformSelectAll(e){return e}transformIdentifier(e){return e}transformValue(e){return e}transformPrimitiveValueList(e){return e}transformOperator(e){return e}transformDefaultInsertValue(e){return e}}gs=new WeakMap;const $l=h({AlterTableNode:!0,CreateIndexNode:!0,CreateSchemaNode:!0,CreateTableNode:!0,CreateTypeNode:!0,CreateViewNode:!0,DeleteQueryNode:!0,DropIndexNode:!0,DropSchemaNode:!0,DropTableNode:!0,DropTypeNode:!0,DropViewNode:!0,InsertQueryNode:!0,RawNode:!0,SelectQueryNode:!0,UpdateQueryNode:!0});class Gl extends Xs{constructor(r){super();R(this,ws);R(this,qs);R(this,Bn);R(this,ii);R(this,bs);R(this,fr,void 0);R(this,Rn,new Set);U(this,fr,r)}transformNodeImpl(r){if(!Le(this,ws,il).call(this,r))return super.transformNodeImpl(r);const n=Le(this,qs,sl).call(this,r);for(const X of n)s(this,Rn).add(X);const A=super.transformNodeImpl(r);for(const X of n)s(this,Rn).delete(X);return A}transformSchemableIdentifier(r){const n=super.transformSchemableIdentifier(r);return n.schema||!s(this,Rn).has(r.identifier.name)?n:{...n,schema:Ge.create(s(this,fr))}}transformReferences(r){const n=super.transformReferences(r);return n.table.table.schema?n:{...n,table:vn.createWithSchema(s(this,fr),n.table.table.identifier.name)}}}fr=new WeakMap,Rn=new WeakMap,ws=new WeakSet,il=function(r){return r.kind in $l},qs=new WeakSet,sl=function(r){const n=new Set;if("name"in r&&r.name&&Nn.is(r.name)&&Le(this,ii,bo).call(this,r.name,n),"from"in r&&r.from)for(const A of r.from.froms)Le(this,Bn,Oi).call(this,A,n);if("into"in r&&r.into&&Le(this,Bn,Oi).call(this,r.into,n),"table"in r&&r.table&&Le(this,Bn,Oi).call(this,r.table,n),"joins"in r&&r.joins)for(const A of r.joins)Le(this,Bn,Oi).call(this,A.table,n);return"with"in r&&r.with&&Le(this,bs,ol).call(this,r.with,n),n},Bn=new WeakSet,Oi=function(r,n){const A=vn.is(r)?r:Pn.is(r)&&vn.is(r.node)?r.node:null;A&&Le(this,ii,bo).call(this,A.table,n)},ii=new WeakSet,bo=function(r,n){s(this,Rn).has(r.identifier.name)||n.add(r.identifier.name)},bs=new WeakSet,ol=function(r,n){for(const A of r.expressions)n.delete(A.name.table.table.identifier.name)};class Hr{constructor(e){R(this,si,void 0);U(this,si,new Gl(e))}transformQuery(e){return s(this,si).transformNode(e.node)}async transformResult(e){return e.result}}si=new WeakMap;const Mn=class{constructor(e){R(this,Re,void 0);U(this,Re,h(e))}selectFrom(e){return new ar({queryId:Ce(),executor:s(this,Re).executor,queryNode:_e.create(lr(e),s(this,Re).withNode)})}insertInto(e){return new Vr({queryId:Ce(),executor:s(this,Re).executor,queryNode:rn.create(It(e),s(this,Re).withNode)})}replaceInto(e){return new Vr({queryId:Ce(),executor:s(this,Re).executor,queryNode:rn.create(It(e),s(this,Re).withNode,!0)})}deleteFrom(e){return new Qi({queryId:Ce(),executor:s(this,Re).executor,queryNode:zr.create(lr(e),s(this,Re).withNode)})}updateTable(e){return new zi({queryId:Ce(),executor:s(this,Re).executor,queryNode:Ri.create(Gr(e),s(this,Re).withNode)})}with(e,r){const n=Ko(e,r);return new Mn({...s(this,Re),withNode:s(this,Re).withNode?Vi.cloneWithExpression(s(this,Re).withNode,n):Vi.create(n)})}withRecursive(e,r){const n=Ko(e,r);return new Mn({...s(this,Re),withNode:s(this,Re).withNode?Vi.cloneWithExpression(s(this,Re).withNode,n):Vi.create(n,{recursive:!0})})}withPlugin(e){return new Mn({...s(this,Re),executor:s(this,Re).executor.withPlugin(e)})}withoutPlugins(){return new Mn({...s(this,Re),executor:s(this,Re).executor.withoutPlugins()})}withSchema(e){return new Mn({...s(this,Re),executor:s(this,Re).executor.withPluginAtFront(new Hr(e))})}};let Hi=Mn;Re=new WeakMap;class Yo{constructor(){R(this,oi,void 0);R(this,hr,void 0);R(this,pr,void 0);Tt(this,"resolve",e=>{s(this,hr)&&s(this,hr).call(this,e)});Tt(this,"reject",e=>{s(this,pr)&&s(this,pr).call(this,e)});U(this,oi,new Promise((e,r)=>{U(this,pr,r),U(this,hr,e)}))}get promise(){return s(this,oi)}}oi=new WeakMap,hr=new WeakMap,pr=new WeakMap;const Zo=new Set;function Jl(t){Zo.has(t)||(Zo.add(t),console.log(t))}const Kl=h([]);class ea{constructor(e=Kl){R(this,ai);R(this,Un,void 0);U(this,Un,e)}get plugins(){return s(this,Un)}transformQuery(e,r){for(const n of s(this,Un)){const A=n.transformQuery({node:e,queryId:r});if(A.kind===e.kind)e=A;else throw new Error(["KyselyPlugin.transformQuery must return a node","of the same kind that was given to it.",`The plugin was given a ${e.kind}`,`but it returned a ${A.kind}`].join(" "))}return e}async executeQuery(e,r){return await this.provideConnection(async n=>{const A=await n.executeQuery(e),X=await Le(this,ai,No).call(this,A,r);return Xl(A,X),X})}async*stream(e,r,n){const A=new Yo,X=new Yo;this.provideConnection(async me=>(A.resolve(me),await X.promise)).catch(me=>A.reject(me));const ae=await A.promise;try{for await(const me of ae.streamQuery(e,r))yield await Le(this,ai,No).call(this,me,n)}finally{X.resolve()}}}Un=new WeakMap,ai=new WeakSet,No=async function(e,r){for(const n of s(this,Un))e=await n.transformResult({result:e,queryId:r});return e};function Xl(t,e){const{numAffectedRows:r}=t;r===void 0&&t.numUpdatedOrDeletedRows===void 0||r!==void 0&&e.numAffectedRows!==void 0||Jl("kysely:warning: outdated driver/plugin detected! QueryResult.numUpdatedOrDeletedRows is deprecated and will be removed in a future release.")}class sr extends ea{get adapter(){throw new Error("this query cannot be compiled to SQL")}compileQuery(){throw new Error("this query cannot be compiled to SQL")}provideConnection(){throw new Error("this query cannot be executed")}withConnectionProvider(){throw new Error("this query cannot have a connection provider")}withPlugin(e){return new sr([...this.plugins,e])}withPlugins(e){return new sr([...this.plugins,...e])}withPluginAtFront(e){return new sr([e,...this.plugins])}withoutPlugins(){return new sr([])}}const $i=new sr;function ta(){return new ar({queryId:Ce(),executor:$i,queryNode:_e.create(lr([]))})}function Yl(){return new Hi({executor:$i})}function na(t,e){return new Li({joinNode:Bt.create(t,Gr(e))})}function Zl(){return new Di({overNode:Gs.create()})}const Ys=h({is(t){return t.kind==="WhenNode"},create(t){return h({kind:"WhenNode",condition:t})},cloneWithResult(t,e){return h({...t,result:e})}}),$t=h({is(t){return t.kind==="CaseNode"},create(t){return h({kind:"CaseNode",value:t})},cloneWithWhen(t,e){return h({...t,when:h(t.when?[...t.when,e]:[e])})},cloneWithThen(t,e){return h({...t,when:t.when?h([...t.when.slice(0,-1),Ys.cloneWithResult(t.when[t.when.length-1],e)]):void 0})},cloneWith(t,e){return h({...t,...e})}});function Zs(t,e,r){if(!Ao(e)&&!bt(e))throw new Error(`invalid binary operator ${JSON.stringify(e)}`);return nu(e,r)?ru(t,e,r):Ti.create(fn(t),eo(e),Lo(r))}function eu(t,e,r){if(!Ao(e)&&!bt(e))throw new Error(`invalid binary operator ${JSON.stringify(e)}`);return Ti.create(fn(t),eo(e),fn(r))}function tu(t,e,r){if(!To(e)&&!bt(e))throw new Error(`invalid comparison operator ${JSON.stringify(e)}`);return Zs(t,e,r)}function ft(t,e,r){if(!To(e)&&!bt(e))throw new Error(`invalid comparison operator ${JSON.stringify(e)}`);return eu(t,e,r)}function Ct(t){return Gi("where",t)}function ra(t){return Gi("having",t)}function ia(t){return Gi("on",t)}function sa(t){return Gi("when",t)}function Gi(t,e){if(e.length===3)return tu(e[0],e[1],e[2]);if(e.length===1)return iu(t,e[0]);throw oa(t,e)}function nu(t,e){return(t==="is"||t==="is not")&&(So(e)||Pr(e))}function ru(t,e,r){return Ti.create(fn(t),eo(e),nn.createImmediate(r))}function eo(t){if(Ne(t)&&ql.includes(t))return zs.create(t);if(bt(t))return t.toOperationNode();throw new Error(`invalid operator ${JSON.stringify(t)}`)}function iu(t,e){if(Rt(e)){if(t==="when")throw new Error("when method doesn't accept a callback as an argument");return su[t](e)}else if(bt(e)){const r=e.toOperationNode();if(yt.is(r)||Ti.is(r)||Bo.is(r)||nr.is(r)||$t.is(r))return r}else if(t==="when")return nn.create(e);throw oa(t,e)}function oa(t,e){return new Error(`invalid arguments passed to a '${t}' method: ${JSON.stringify(e)}`)}const su=h({where(t){const e=ta(),r=pn(),A=t(Object.assign(e,r)).toOperationNode();if(_e.is(A)){if(!A.where)throw new Error("no `where` methods called inside a group callback");return nr.create(A.where.where)}else return A},having(t){const e=ta(),r=pn(),A=t(Object.assign(e,r)).toOperationNode();if(_e.is(A)){if(!A.having)throw new Error("no `having` methods called inside a group callback");return nr.create(A.having.having)}else return A},on(t){const e=na("InnerJoin","table"),r=pn(),A=t(Object.assign(e,r)).toOperationNode();if(Bt.is(A)){if(!A.on)throw new Error("no `on` methods called inside a group callback");return nr.create(A.on.on)}else return A}});function kt(t,e){if(e.length===3)return au(t,e[0],e[1],e[2]);if(e.length===2)return ou(t,e[0],e[1]);throw new Error("not implemented")}function ou(t,e,r){return r(na(t,e)).toOperationNode()}function au(t,e,r,n){return Bt.createWithOn(t,Gr(e),ft(r,"=",n))}const lu=h({is(t){return t.kind==="OffsetNode"},create(t){return h({kind:"OffsetNode",offset:nn.create(t)})}}),uu=h({is(t){return t.kind==="GroupByItemNode"},create(t){return h({kind:"GroupByItemNode",groupBy:t})}});function cu(t){return t=Rt(t)?t(pn()):t,Mr(t).map(uu.create)}const aa=h({is(t){return t.kind==="SetOperationNode"},create(t,e,r){return h({kind:"SetOperationNode",operator:t,expression:e,all:r})}});function or(t,e,r){return aa.create(t,e.toOperationNode(),r)}const ee=class{constructor(e){R(this,F,void 0);U(this,F,h(e))}get expressionType(){}where(...e){return new ee({...s(this,F),queryNode:re.cloneWithWhere(s(this,F).queryNode,Ct(e))})}whereRef(e,r,n){return new ee({...s(this,F),queryNode:re.cloneWithWhere(s(this,F).queryNode,ft(e,r,n))})}orWhere(...e){return new ee({...s(this,F),queryNode:re.cloneWithOrWhere(s(this,F).queryNode,Ct(e))})}orWhereRef(e,r,n){return new ee({...s(this,F),queryNode:re.cloneWithOrWhere(s(this,F).queryNode,ft(e,r,n))})}whereExists(e){return new ee({...s(this,F),queryNode:re.cloneWithWhere(s(this,F).queryNode,gt(e))})}whereNotExists(e){return new ee({...s(this,F),queryNode:re.cloneWithWhere(s(this,F).queryNode,dt(e))})}orWhereExists(e){return new ee({...s(this,F),queryNode:re.cloneWithOrWhere(s(this,F).queryNode,gt(e))})}orWhereNotExists(e){return new ee({...s(this,F),queryNode:re.cloneWithOrWhere(s(this,F).queryNode,dt(e))})}having(...e){return new ee({...s(this,F),queryNode:_e.cloneWithHaving(s(this,F).queryNode,ra(e))})}havingRef(e,r,n){return new ee({...s(this,F),queryNode:_e.cloneWithHaving(s(this,F).queryNode,ft(e,r,n))})}orHaving(...e){return new ee({...s(this,F),queryNode:_e.cloneWithOrHaving(s(this,F).queryNode,ra(e))})}orHavingRef(e,r,n){return new ee({...s(this,F),queryNode:_e.cloneWithOrHaving(s(this,F).queryNode,ft(e,r,n))})}havingExists(e){return new ee({...s(this,F),queryNode:_e.cloneWithHaving(s(this,F).queryNode,gt(e))})}havingNotExist(e){return new ee({...s(this,F),queryNode:_e.cloneWithHaving(s(this,F).queryNode,dt(e))})}havingNotExists(e){return new ee({...s(this,F),queryNode:_e.cloneWithHaving(s(this,F).queryNode,dt(e))})}orHavingExists(e){return new ee({...s(this,F),queryNode:_e.cloneWithOrHaving(s(this,F).queryNode,gt(e))})}orHavingNotExists(e){return new ee({...s(this,F),queryNode:_e.cloneWithOrHaving(s(this,F).queryNode,dt(e))})}select(e){return new ee({...s(this,F),queryNode:_e.cloneWithSelections(s(this,F).queryNode,jr(e))})}distinctOn(e){return new ee({...s(this,F),queryNode:_e.cloneWithDistinctOn(s(this,F).queryNode,Mr(e))})}modifyFront(e){return new ee({...s(this,F),queryNode:_e.cloneWithFrontModifier(s(this,F).queryNode,dn.createWithExpression(e.toOperationNode()))})}modifyEnd(e){return new ee({...s(this,F),queryNode:_e.cloneWithEndModifier(s(this,F).queryNode,dn.createWithExpression(e.toOperationNode()))})}distinct(){return new ee({...s(this,F),queryNode:_e.cloneWithFrontModifier(s(this,F).queryNode,dn.create("Distinct"))})}forUpdate(){return new ee({...s(this,F),queryNode:_e.cloneWithEndModifier(s(this,F).queryNode,dn.create("ForUpdate"))})}forShare(){return new ee({...s(this,F),queryNode:_e.cloneWithEndModifier(s(this,F).queryNode,dn.create("ForShare"))})}forKeyShare(){return new ee({...s(this,F),queryNode:_e.cloneWithEndModifier(s(this,F).queryNode,dn.create("ForKeyShare"))})}forNoKeyUpdate(){return new ee({...s(this,F),queryNode:_e.cloneWithEndModifier(s(this,F).queryNode,dn.create("ForNoKeyUpdate"))})}skipLocked(){return new ee({...s(this,F),queryNode:_e.cloneWithEndModifier(s(this,F).queryNode,dn.create("SkipLocked"))})}noWait(){return new ee({...s(this,F),queryNode:_e.cloneWithEndModifier(s(this,F).queryNode,dn.create("NoWait"))})}selectAll(e){return new ee({...s(this,F),queryNode:_e.cloneWithSelections(s(this,F).queryNode,Qr(e))})}innerJoin(...e){return new ee({...s(this,F),queryNode:re.cloneWithJoin(s(this,F).queryNode,kt("InnerJoin",e))})}leftJoin(...e){return new ee({...s(this,F),queryNode:re.cloneWithJoin(s(this,F).queryNode,kt("LeftJoin",e))})}rightJoin(...e){return new ee({...s(this,F),queryNode:re.cloneWithJoin(s(this,F).queryNode,kt("RightJoin",e))})}fullJoin(...e){return new ee({...s(this,F),queryNode:re.cloneWithJoin(s(this,F).queryNode,kt("FullJoin",e))})}innerJoinLateral(...e){return new ee({...s(this,F),queryNode:re.cloneWithJoin(s(this,F).queryNode,kt("LateralInnerJoin",e))})}leftJoinLateral(...e){return new ee({...s(this,F),queryNode:re.cloneWithJoin(s(this,F).queryNode,kt("LateralLeftJoin",e))})}orderBy(e,r){return new ee({...s(this,F),queryNode:_e.cloneWithOrderByItem(s(this,F).queryNode,Wi(e,r))})}groupBy(e){return new ee({...s(this,F),queryNode:_e.cloneWithGroupByItems(s(this,F).queryNode,cu(e))})}limit(e){return new ee({...s(this,F),queryNode:_e.cloneWithLimit(s(this,F).queryNode,$o.create(e))})}offset(e){return new ee({...s(this,F),queryNode:_e.cloneWithOffset(s(this,F).queryNode,lu.create(e))})}union(e){return new ee({...s(this,F),queryNode:_e.cloneWithSetOperation(s(this,F).queryNode,or("union",e,!1))})}unionAll(e){return new ee({...s(this,F),queryNode:_e.cloneWithSetOperation(s(this,F).queryNode,or("union",e,!0))})}intersect(e){return new ee({...s(this,F),queryNode:_e.cloneWithSetOperation(s(this,F).queryNode,or("intersect",e,!1))})}intersectAll(e){return new ee({...s(this,F),queryNode:_e.cloneWithSetOperation(s(this,F).queryNode,or("intersect",e,!0))})}except(e){return new ee({...s(this,F),queryNode:_e.cloneWithSetOperation(s(this,F).queryNode,or("except",e,!1))})}exceptAll(e){return new ee({...s(this,F),queryNode:_e.cloneWithSetOperation(s(this,F).queryNode,or("except",e,!0))})}as(e){return new du(this,e)}clearSelect(){return new ee({...s(this,F),queryNode:_e.cloneWithoutSelections(s(this,F).queryNode)})}clearWhere(){return new ee({...s(this,F),queryNode:re.cloneWithoutWhere(s(this,F).queryNode)})}clearLimit(){return new ee({...s(this,F),queryNode:_e.cloneWithoutLimit(s(this,F).queryNode)})}clearOffset(){return new ee({...s(this,F),queryNode:_e.cloneWithoutOffset(s(this,F).queryNode)})}clearOrderBy(){return new ee({...s(this,F),queryNode:_e.cloneWithoutOrderBy(s(this,F).queryNode)})}$call(e){return e(this)}call(e){return this.$call(e)}$if(e,r){return e?r(this):new ee({...s(this,F)})}if(e,r){return this.$if(e,r)}$castTo(){return new ee(s(this,F))}castTo(){return this.$castTo()}$narrowType(){return new ee(s(this,F))}$assertType(){return new ee(s(this,F))}assertType(){return new ee(s(this,F))}withPlugin(e){return new ee({...s(this,F),executor:s(this,F).executor.withPlugin(e)})}toOperationNode(){return s(this,F).executor.transformQuery(s(this,F).queryNode,s(this,F).queryId)}compile(){return s(this,F).executor.compileQuery(this.toOperationNode(),s(this,F).queryId)}async execute(){const e=this.compile();return(await s(this,F).executor.executeQuery(e,s(this,F).queryId)).rows}async executeTakeFirst(){const[e]=await this.execute();return e}async executeTakeFirstOrThrow(e=Bi){const r=await this.executeTakeFirst();if(r===void 0)throw Mi(e)?new e(this.toOperationNode()):e(this.toOperationNode());return r}async*stream(e=100){const r=this.compile(),n=s(this,F).executor.stream(r,e,s(this,F).queryId);for await(const A of n)yield*A.rows}async explain(e,r){return await new ee({...s(this,F),queryNode:re.cloneWithExplain(s(this,F).queryNode,e,r)}).execute()}};let ar=ee;F=new WeakMap,Se(ar,"don't await SelectQueryBuilder instances directly. To execute the query you need to call `execute` or `executeTakeFirst`.");class du{constructor(e,r){R(this,_r,void 0);R(this,mr,void 0);U(this,_r,e),U(this,mr,r)}get expression(){return s(this,_r)}get alias(){return s(this,mr)}toOperationNode(){return Pn.create(s(this,_r).toOperationNode(),Ge.create(s(this,mr)))}}_r=new WeakMap,mr=new WeakMap;const lo=class{constructor(e){R(this,yr,void 0);U(this,yr,e)}get expressionType(){}as(e){return new fu(this,e)}$castTo(){return new lo(s(this,yr))}toOperationNode(){return s(this,yr)}};let st=lo;yr=new WeakMap;class fu{constructor(e,r){R(this,gr,void 0);R(this,kn,void 0);U(this,gr,e),U(this,kn,r)}get expression(){return s(this,gr)}get alias(){return s(this,kn)}toOperationNode(){return Pn.create(s(this,gr).toOperationNode(),bt(s(this,kn))?s(this,kn).toOperationNode():Ge.create(s(this,kn)))}}gr=new WeakMap,kn=new WeakMap;const Mt=h({is(t){return t.kind==="AggregateFunctionNode"},create(t,e=[]){return h({kind:"AggregateFunctionNode",func:t,aggregated:e})},cloneWithDistinct(t){return h({...t,distinct:!0})},cloneWithFilter(t,e){return h({...t,filter:t.filter?wt.cloneWithOperation(t.filter,"And",e):wt.create(e)})},cloneWithOrFilter(t,e){return h({...t,filter:t.filter?wt.cloneWithOperation(t.filter,"Or",e):wt.create(e)})},cloneWithOver(t,e){return h({...t,over:e})}}),hu=h({is(t){return t.kind==="FunctionNode"},create(t,e){return h({kind:"FunctionNode",func:t,arguments:e})}}),Ut=class{constructor(e){R(this,Ue,void 0);U(this,Ue,h(e))}get expressionType(){}as(e){return new pu(this,e)}distinct(){return new Ut({...s(this,Ue),aggregateFunctionNode:Mt.cloneWithDistinct(s(this,Ue).aggregateFunctionNode)})}filterWhere(...e){return new Ut({...s(this,Ue),aggregateFunctionNode:Mt.cloneWithFilter(s(this,Ue).aggregateFunctionNode,Ct(e))})}filterWhereExists(e){return new Ut({...s(this,Ue),aggregateFunctionNode:Mt.cloneWithFilter(s(this,Ue).aggregateFunctionNode,gt(e))})}filterWhereNotExists(e){return new Ut({...s(this,Ue),aggregateFunctionNode:Mt.cloneWithFilter(s(this,Ue).aggregateFunctionNode,dt(e))})}filterWhereRef(e,r,n){return new Ut({...s(this,Ue),aggregateFunctionNode:Mt.cloneWithFilter(s(this,Ue).aggregateFunctionNode,ft(e,r,n))})}orFilterWhere(...e){return new Ut({...s(this,Ue),aggregateFunctionNode:Mt.cloneWithOrFilter(s(this,Ue).aggregateFunctionNode,Ct(e))})}orFilterWhereExists(e){return new Ut({...s(this,Ue),aggregateFunctionNode:Mt.cloneWithOrFilter(s(this,Ue).aggregateFunctionNode,gt(e))})}orFilterWhereNotExists(e){return new Ut({...s(this,Ue),aggregateFunctionNode:Mt.cloneWithOrFilter(s(this,Ue).aggregateFunctionNode,dt(e))})}orFilterWhereRef(e,r,n){return new Ut({...s(this,Ue),aggregateFunctionNode:Mt.cloneWithOrFilter(s(this,Ue).aggregateFunctionNode,ft(e,r,n))})}over(e){const r=Zl();return new Ut({...s(this,Ue),aggregateFunctionNode:Mt.cloneWithOver(s(this,Ue).aggregateFunctionNode,(e?e(r):r).toOperationNode())})}$call(e){return e(this)}toOperationNode(){return s(this,Ue).aggregateFunctionNode}};let $r=Ut;Ue=new WeakMap,Se($r,"don't await AggregateFunctionBuilder instances. They are never executed directly and are always just a part of a query.");class pu{constructor(e,r){R(this,wr,void 0);R(this,qr,void 0);U(this,wr,e),U(this,qr,r)}get expression(){return s(this,wr)}get alias(){return s(this,qr)}toOperationNode(){return Pn.create(s(this,wr).toOperationNode(),Ge.create(s(this,qr)))}}wr=new WeakMap,qr=new WeakMap;function la(){const t=(r,n)=>new st(hu.create(r,Mr(n))),e=(r,n)=>new $r({aggregateFunctionNode:Mt.create(r,n?Mr(n):void 0)});return Object.assign(t,{agg:e,avg(r){return e("avg",[r])},coalesce(r,...n){return t("coalesce",[r,...n])},count(r){return e("count",[r])},countAll(r){return new $r({aggregateFunctionNode:Mt.create("count",Qr(r))})},max(r){return e("max",[r])},min(r){return e("min",[r])},sum(r){return e("sum",[r])}})}class ua{constructor(e){R(this,br,void 0);U(this,br,h(e))}when(...e){return new ca({...s(this,br),node:$t.cloneWithWhen(s(this,br).node,Ys.create(sa(e)))})}}br=new WeakMap;class ca{constructor(e){R(this,Nr,void 0);U(this,Nr,h(e))}then(e){return new _u({...s(this,Nr),node:$t.cloneWithThen(s(this,Nr).node,hn(e))})}}Nr=new WeakMap;class _u{constructor(e){R(this,sn,void 0);U(this,sn,h(e))}when(...e){return new ca({...s(this,sn),node:$t.cloneWithWhen(s(this,sn).node,Ys.create(sa(e)))})}else(e){return new mu({...s(this,sn),node:$t.cloneWith(s(this,sn).node,{else:hn(e)})})}end(){return new st($t.cloneWith(s(this,sn).node,{isStatement:!1}))}endCase(){return new st($t.cloneWith(s(this,sn).node,{isStatement:!0}))}}sn=new WeakMap;class mu{constructor(e){R(this,vr,void 0);U(this,vr,h(e))}end(){return new st($t.cloneWith(s(this,vr).node,{isStatement:!1}))}endCase(){return new st($t.cloneWith(s(this,vr).node,{isStatement:!0}))}}vr=new WeakMap;function da(t=$i){function e(r,n){return new st(Js(r,n))}return{get fn(){return la()},selectFrom(r){return new ar({queryId:Ce(),executor:t,queryNode:_e.create(lr(r))})},case(r){return new ua({node:$t.create(Te(r)?void 0:fn(r))})},ref(r){return new st(rr(r))},val(r){return new st(Lo(r))},cmpr(r,n,A){return new st(Zs(r,n,A))},bxp(r,n,A){return new st(Zs(r,n,A))},unary:e,not(r){return e("not",r)},exists(r){return e("exists",r)},neg(r){return e("-",r)},and(r){if(r.length===0)return new st(nn.createImmediate(!0));if(r.length===1)return new st(r[0].toOperationNode());let n=Dr.create(r[0].toOperationNode(),r[1].toOperationNode());for(let A=2;A<r.length;++A)n=Dr.create(n,r[A].toOperationNode());return new st(nr.create(n))},or(r){if(r.length===0)return new st(nn.createImmediate(!1));if(r.length===1)return new st(r[0].toOperationNode());let n=Rr.create(r[0].toOperationNode(),r[1].toOperationNode());for(let A=2;A<r.length;++A)n=Rr.create(n,r[A].toOperationNode());return new st(nr.create(n))},withSchema(r){return da(t.withPluginAtFront(new Hr(r)))}}}function pn(t){return da()}function Ji(t){if(bt(t))return t.toOperationNode();if(Rt(t))return t(pn()).toOperationNode();throw new Error(`invalid expression: ${JSON.stringify(t)}`)}function fa(t){if(bt(t))return t.toOperationNode();if(Rt(t))return t(pn()).toOperationNode();throw new Error(`invalid aliased expression: ${JSON.stringify(t)}`)}function Ki(t){return ml(t)||yl(t)||Rt(t)}function lr(t){return Lr(t)?t.map(e=>Gr(e)):[Gr(t)]}function Gr(t){return Ne(t)?yu(t):fa(t)}function yu(t){const e=" as ";if(t.includes(e)){const[r,n]=t.split(e).map(ha);return Pn.create(It(r),Ge.create(n))}else return It(t)}function It(t){const e=".";if(t.includes(e)){const[r,n]=t.split(e).map(ha);return vn.createWithSchema(r,n)}else return vn.create(t)}function ha(t){return t.trim()}const pa=h({is(t){return t.kind==="AddColumnNode"},create(t){return h({kind:"AddColumnNode",column:t})}}),Ln=h({is(t){return t.kind==="AlterColumnNode"},create(t){return h({kind:"AlterColumnNode",column:Ke.create(t)})},cloneWith(t,e){return h({...t,...e})}}),Xe=h({is(t){return t.kind==="ColumnDefinitionNode"},create(t,e){return h({kind:"ColumnDefinitionNode",column:Ke.create(t),dataType:e})},cloneWithFrontModifier(t,e){return h({...t,frontModifiers:t.frontModifiers?h([...t.frontModifiers,e]):[e]})},cloneWithEndModifier(t,e){return h({...t,endModifiers:t.endModifiers?h([...t.endModifiers,e]):[e]})},cloneWith(t,e){return h({...t,...e})}}),_a=h({is(t){return t.kind==="DropColumnNode"},create(t){return h({kind:"DropColumnNode",column:Ke.create(t)})}}),ma=h({is(t){return t.kind==="RenameColumnNode"},create(t,e){return h({kind:"RenameColumnNode",column:Ke.create(t),renameTo:Ke.create(e)})}}),to=h({is(t){return t.kind==="CheckConstraintNode"},create(t,e){return h({kind:"CheckConstraintNode",expression:t,name:e?Ge.create(e):void 0})}}),gu=["no action","restrict","cascade","set null","set default"],Xi=h({is(t){return t.kind==="ReferencesNode"},create(t,e){return h({kind:"ReferencesNode",table:t,columns:h([...e])})},cloneWithOnDelete(t,e){return h({...t,onDelete:e})},cloneWithOnUpdate(t,e){return h({...t,onUpdate:e})}});function ya(t){return bt(t)?t.toOperationNode():nn.createImmediate(t)}const Yi=h({is(t){return t.kind==="GeneratedNode"},create(t){return h({kind:"GeneratedNode",...t})},createWithExpression(t){return h({kind:"GeneratedNode",always:!0,expression:t})},cloneWith(t,e){return h({...t,...e})}}),wu=h({is(t){return t.kind==="DefaultValueNode"},create(t){return h({kind:"DefaultValueNode",defaultValue:t})}});function Zi(t){if(gu.includes(t))return t;throw new Error(`invalid OnModifyForeignAction ${t}`)}const at=class{constructor(e){R(this,Fe,void 0);U(this,Fe,e)}autoIncrement(){return new at(Xe.cloneWith(s(this,Fe),{autoIncrement:!0}))}primaryKey(){return new at(Xe.cloneWith(s(this,Fe),{primaryKey:!0}))}references(e){const r=rr(e);if(!Ci.is(r)||Vs.is(r.column))throw new Error(`invalid call references('${e}'). The reference must have format table.column or schema.table.column`);return new at(Xe.cloneWith(s(this,Fe),{references:Xi.create(r.table,[r.column])}))}onDelete(e){if(!s(this,Fe).references)throw new Error("on delete constraint can only be added for foreign keys");return new at(Xe.cloneWith(s(this,Fe),{references:Xi.cloneWithOnDelete(s(this,Fe).references,Zi(e))}))}onUpdate(e){if(!s(this,Fe).references)throw new Error("on update constraint can only be added for foreign keys");return new at(Xe.cloneWith(s(this,Fe),{references:Xi.cloneWithOnUpdate(s(this,Fe).references,Zi(e))}))}unique(){return new at(Xe.cloneWith(s(this,Fe),{unique:!0}))}notNull(){return new at(Xe.cloneWith(s(this,Fe),{notNull:!0}))}unsigned(){return new at(Xe.cloneWith(s(this,Fe),{unsigned:!0}))}defaultTo(e){return new at(Xe.cloneWith(s(this,Fe),{defaultTo:wu.create(ya(e))}))}check(e){return new at(Xe.cloneWith(s(this,Fe),{check:to.create(e.toOperationNode())}))}generatedAlwaysAs(e){return new at(Xe.cloneWith(s(this,Fe),{generated:Yi.createWithExpression(e.toOperationNode())}))}generatedAlwaysAsIdentity(){return new at(Xe.cloneWith(s(this,Fe),{generated:Yi.create({identity:!0,always:!0})}))}generatedByDefaultAsIdentity(){return new at(Xe.cloneWith(s(this,Fe),{generated:Yi.create({identity:!0,byDefault:!0})}))}stored(){if(!s(this,Fe).generated)throw new Error("stored() can only be called after generatedAlwaysAs");return new at(Xe.cloneWith(s(this,Fe),{generated:Yi.cloneWith(s(this,Fe).generated,{stored:!0})}))}modifyFront(e){return new at(Xe.cloneWithFrontModifier(s(this,Fe),e.toOperationNode()))}modifyEnd(e){return new at(Xe.cloneWithEndModifier(s(this,Fe),e.toOperationNode()))}$call(e){return e(this)}toOperationNode(){return s(this,Fe)}};let xn=at;Fe=new WeakMap,Se(xn,"don't await ColumnDefinitionBuilder instances directly.");const ga=h({is(t){return t.kind==="ModifyColumnNode"},create(t){return h({kind:"ModifyColumnNode",column:t})}}),qu=h({is(t){return t.kind==="DataTypeNode"},create(t){return h({kind:"DataTypeNode",dataType:t})}});function ur(t){return bt(t)?t.toOperationNode():qu.create(t)}const es=h({is(t){return t.kind==="ForeignKeyConstraintNode"},create(t,e,r,n){return h({kind:"ForeignKeyConstraintNode",columns:t,references:Xi.create(e,r),name:n?Ge.create(n):void 0})},cloneWith(t,e){return h({...t,...e})}}),Ns=class{constructor(e){R(this,jn,void 0);U(this,jn,e)}onDelete(e){return new Ns(es.cloneWith(s(this,jn),{onDelete:Zi(e)}))}onUpdate(e){return new Ns(es.cloneWith(s(this,jn),{onUpdate:Zi(e)}))}$call(e){return e(this)}toOperationNode(){return s(this,jn)}};let Jr=Ns;jn=new WeakMap,Se(Jr,"don't await ForeignKeyConstraintBuilder instances directly.");const no=h({is(t){return t.kind==="AddConstraintNode"},create(t){return h({kind:"AddConstraintNode",constraint:t})}}),wa=h({is(t){return t.kind==="UniqueConstraintNode"},create(t,e){return h({kind:"UniqueConstraintNode",columns:h(t.map(Ke.create)),name:e?Ge.create(e):void 0})}}),ts=h({is(t){return t.kind==="DropConstraintNode"},create(t){return h({kind:"DropConstraintNode",constraintName:Ge.create(t)})},cloneWith(t,e){return h({...t,...e})}});class ns{constructor(e){Tt(this,"alterColumnNode");this.alterColumnNode=e}setDataType(e){return new Kr(Ln.cloneWith(this.alterColumnNode,{dataType:ur(e)}))}setDefault(e){return new Kr(Ln.cloneWith(this.alterColumnNode,{setDefault:ya(e)}))}dropDefault(){return new Kr(Ln.cloneWith(this.alterColumnNode,{dropDefault:!0}))}setNotNull(){return new Kr(Ln.cloneWith(this.alterColumnNode,{setNotNull:!0}))}dropNotNull(){return new Kr(Ln.cloneWith(this.alterColumnNode,{dropNotNull:!0}))}$call(e){return e(this)}}class Kr extends ns{toOperationNode(){return this.alterColumnNode}}class Xr{constructor(e){R(this,Xt,void 0);U(this,Xt,h(e))}toOperationNode(){return s(this,Xt).executor.transformQuery(s(this,Xt).node,s(this,Xt).queryId)}compile(){return s(this,Xt).executor.compileQuery(this.toOperationNode(),s(this,Xt).queryId)}async execute(){await s(this,Xt).executor.executeQuery(this.compile(),s(this,Xt).queryId)}}Xt=new WeakMap,Se(Xr,"don't await AlterTableExecutor instances directly. To execute the query you need to call `execute`");const vs=class{constructor(e){R(this,qt,void 0);U(this,qt,h(e))}onDelete(e){return new vs({...s(this,qt),constraintBuilder:s(this,qt).constraintBuilder.onDelete(e)})}onUpdate(e){return new vs({...s(this,qt),constraintBuilder:s(this,qt).constraintBuilder.onUpdate(e)})}$call(e){return e(this)}toOperationNode(){return s(this,qt).executor.transformQuery(et.cloneWithTableProps(s(this,qt).node,{addConstraint:no.create(s(this,qt).constraintBuilder.toOperationNode())}),s(this,qt).queryId)}compile(){return s(this,qt).executor.compileQuery(this.toOperationNode(),s(this,qt).queryId)}async execute(){await s(this,qt).executor.executeQuery(this.compile(),s(this,qt).queryId)}};let rs=vs;qt=new WeakMap,Se(rs,"don't await AlterTableAddForeignKeyConstraintBuilder instances directly. To execute the query you need to call `execute`");const li=class{constructor(e){R(this,tt,void 0);U(this,tt,h(e))}ifExists(){return new li({...s(this,tt),node:et.cloneWithTableProps(s(this,tt).node,{dropConstraint:ts.cloneWith(s(this,tt).node.dropConstraint,{ifExists:!0})})})}cascade(){return new li({...s(this,tt),node:et.cloneWithTableProps(s(this,tt).node,{dropConstraint:ts.cloneWith(s(this,tt).node.dropConstraint,{modifier:"cascade"})})})}restrict(){return new li({...s(this,tt),node:et.cloneWithTableProps(s(this,tt).node,{dropConstraint:ts.cloneWith(s(this,tt).node.dropConstraint,{modifier:"restrict"})})})}$call(e){return e(this)}toOperationNode(){return s(this,tt).executor.transformQuery(s(this,tt).node,s(this,tt).queryId)}compile(){return s(this,tt).executor.compileQuery(this.toOperationNode(),s(this,tt).queryId)}async execute(){await s(this,tt).executor.executeQuery(this.compile(),s(this,tt).queryId)}};let is=li;tt=new WeakMap,Se(is,"don't await AlterTableDropConstraintBuilder instances directly. To execute the query you need to call `execute`");class qa{constructor(e){R(this,je,void 0);U(this,je,h(e))}renameTo(e){return new Xr({...s(this,je),node:et.cloneWithTableProps(s(this,je).node,{renameTo:It(e)})})}setSchema(e){return new Xr({...s(this,je),node:et.cloneWithTableProps(s(this,je).node,{setSchema:Ge.create(e)})})}alterColumn(e,r){const n=r(new ns(Ln.create(e)));return new En({...s(this,je),node:et.cloneWithColumnAlteration(s(this,je).node,n.toOperationNode())})}dropColumn(e){return new En({...s(this,je),node:et.cloneWithColumnAlteration(s(this,je).node,_a.create(e))})}renameColumn(e,r){return new En({...s(this,je),node:et.cloneWithColumnAlteration(s(this,je).node,ma.create(e,r))})}addColumn(e,r,n=tr){const A=n(new xn(Xe.create(e,ur(r))));return new En({...s(this,je),node:et.cloneWithColumnAlteration(s(this,je).node,pa.create(A.toOperationNode()))})}modifyColumn(e,r,n=tr){const A=n(new xn(Xe.create(e,ur(r))));return new En({...s(this,je),node:et.cloneWithColumnAlteration(s(this,je).node,ga.create(A.toOperationNode()))})}addUniqueConstraint(e,r){return new Xr({...s(this,je),node:et.cloneWithTableProps(s(this,je).node,{addConstraint:no.create(wa.create(r,e))})})}addCheckConstraint(e,r){return new Xr({...s(this,je),node:et.cloneWithTableProps(s(this,je).node,{addConstraint:no.create(to.create(r.toOperationNode(),e))})})}addForeignKeyConstraint(e,r,n,A){return new rs({...s(this,je),constraintBuilder:new Jr(es.create(r.map(Ke.create),It(n),A.map(Ke.create),e))})}dropConstraint(e){return new is({...s(this,je),node:et.cloneWithTableProps(s(this,je).node,{dropConstraint:ts.create(e)})})}$call(e){return e(this)}call(e){return this.$call(e)}}je=new WeakMap;const Qn=class{constructor(e){R(this,Ye,void 0);U(this,Ye,h(e))}alterColumn(e,r){const n=r(new ns(Ln.create(e)));return new Qn({...s(this,Ye),node:et.cloneWithColumnAlteration(s(this,Ye).node,n.toOperationNode())})}dropColumn(e){return new Qn({...s(this,Ye),node:et.cloneWithColumnAlteration(s(this,Ye).node,_a.create(e))})}renameColumn(e,r){return new Qn({...s(this,Ye),node:et.cloneWithColumnAlteration(s(this,Ye).node,ma.create(e,r))})}addColumn(e,r,n=tr){const A=n(new xn(Xe.create(e,ur(r))));return new Qn({...s(this,Ye),node:et.cloneWithColumnAlteration(s(this,Ye).node,pa.create(A.toOperationNode()))})}modifyColumn(e,r,n=tr){const A=n(new xn(Xe.create(e,ur(r))));return new Qn({...s(this,Ye),node:et.cloneWithColumnAlteration(s(this,Ye).node,ga.create(A.toOperationNode()))})}toOperationNode(){return s(this,Ye).executor.transformQuery(s(this,Ye).node,s(this,Ye).queryId)}compile(){return s(this,Ye).executor.compileQuery(this.toOperationNode(),s(this,Ye).queryId)}async execute(){await s(this,Ye).executor.executeQuery(this.compile(),s(this,Ye).queryId)}};let En=Qn;Ye=new WeakMap,Se(qa,"don't await AlterTableBuilder instances"),Se(ns,"don't await AlterColumnBuilder instances"),Se(En,"don't await AlterTableColumnAlteringBuilder instances directly. To execute the query you need to call `execute`");class ba extends Xs{transformValue(e){return{...super.transformValue(e),immediate:!0}}}const on=class{constructor(e){R(this,Pe,void 0);U(this,Pe,h(e))}ifNotExists(){return new on({...s(this,Pe),node:bn.cloneWith(s(this,Pe).node,{ifNotExists:!0})})}unique(){return new on({...s(this,Pe),node:bn.cloneWith(s(this,Pe).node,{unique:!0})})}on(e){return new on({...s(this,Pe),node:bn.cloneWith(s(this,Pe).node,{table:It(e)})})}column(e){return new on({...s(this,Pe),node:bn.cloneWithColumns(s(this,Pe).node,[Fo(e)])})}columns(e){return new on({...s(this,Pe),node:bn.cloneWithColumns(s(this,Pe).node,e.map(Fo))})}expression(e){return new on({...s(this,Pe),node:bn.cloneWithColumns(s(this,Pe).node,[e.toOperationNode()])})}using(e){return new on({...s(this,Pe),node:bn.cloneWith(s(this,Pe).node,{using:yt.createWithSql(e)})})}where(...e){const r=new ba;return new on({...s(this,Pe),node:re.cloneWithWhere(s(this,Pe).node,r.transformNode(Ct(e)))})}$call(e){return e(this)}toOperationNode(){return s(this,Pe).executor.transformQuery(s(this,Pe).node,s(this,Pe).queryId)}compile(){return s(this,Pe).executor.compileQuery(this.toOperationNode(),s(this,Pe).queryId)}async execute(){await s(this,Pe).executor.executeQuery(this.compile(),s(this,Pe).queryId)}};let ss=on;Pe=new WeakMap,Se(ss,"don't await CreateIndexBuilder instances directly. To execute the query you need to call `execute`");const uo=class{constructor(e){R(this,Ft,void 0);U(this,Ft,h(e))}ifNotExists(){return new uo({...s(this,Ft),node:ko.cloneWith(s(this,Ft).node,{ifNotExists:!0})})}$call(e){return e(this)}toOperationNode(){return s(this,Ft).executor.transformQuery(s(this,Ft).node,s(this,Ft).queryId)}compile(){return s(this,Ft).executor.compileQuery(this.toOperationNode(),s(this,Ft).queryId)}async execute(){await s(this,Ft).executor.executeQuery(this.compile(),s(this,Ft).queryId)}};let os=uo;Ft=new WeakMap,Se(os,"don't await CreateSchemaBuilder instances directly. To execute the query you need to call `execute`");const bu=h({is(t){return t.kind==="PrimaryKeyConstraintNode"},create(t,e){return h({kind:"PrimaryKeyConstraintNode",columns:h(t.map(Ke.create)),name:e?Ge.create(e):void 0})}});function Nu(t){if(_l.includes(t))return t;throw new Error(`invalid OnCommitAction ${t}`)}const jt=class{constructor(e){R(this,ke,void 0);U(this,ke,h(e))}temporary(){return new jt({...s(this,ke),node:Ht.cloneWith(s(this,ke).node,{temporary:!0})})}onCommit(e){return new jt({...s(this,ke),node:Ht.cloneWith(s(this,ke).node,{onCommit:Nu(e)})})}ifNotExists(){return new jt({...s(this,ke),node:Ht.cloneWith(s(this,ke).node,{ifNotExists:!0})})}addColumn(e,r,n=tr){const A=n(new xn(Xe.create(e,ur(r))));return new jt({...s(this,ke),node:Ht.cloneWithColumn(s(this,ke).node,A.toOperationNode())})}addPrimaryKeyConstraint(e,r){return new jt({...s(this,ke),node:Ht.cloneWithConstraint(s(this,ke).node,bu.create(r,e))})}addUniqueConstraint(e,r){return new jt({...s(this,ke),node:Ht.cloneWithConstraint(s(this,ke).node,wa.create(r,e))})}addCheckConstraint(e,r){return new jt({...s(this,ke),node:Ht.cloneWithConstraint(s(this,ke).node,to.create(r.toOperationNode(),e))})}addForeignKeyConstraint(e,r,n,A,X=tr){const ae=X(new Jr(es.create(r.map(Ke.create),It(n),A.map(Ke.create),e)));return new jt({...s(this,ke),node:Ht.cloneWithConstraint(s(this,ke).node,ae.toOperationNode())})}modifyFront(e){return new jt({...s(this,ke),node:Ht.cloneWithFrontModifier(s(this,ke).node,e.toOperationNode())})}modifyEnd(e){return new jt({...s(this,ke),node:Ht.cloneWithEndModifier(s(this,ke).node,e.toOperationNode())})}$call(e){return e(this)}call(e){return this.$call(e)}toOperationNode(){return s(this,ke).executor.transformQuery(s(this,ke).node,s(this,ke).queryId)}compile(){return s(this,ke).executor.compileQuery(this.toOperationNode(),s(this,ke).queryId)}async execute(){await s(this,ke).executor.executeQuery(this.compile(),s(this,ke).queryId)}};let as=jt;ke=new WeakMap,Se(as,"don't await CreateTableBuilder instances directly. To execute the query you need to call `execute`");const ui=class{constructor(e){R(this,ht,void 0);U(this,ht,h(e))}on(e){return new ui({...s(this,ht),node:Ai.cloneWith(s(this,ht).node,{table:It(e)})})}ifExists(){return new ui({...s(this,ht),node:Ai.cloneWith(s(this,ht).node,{ifExists:!0})})}cascade(){return new ui({...s(this,ht),node:Ai.cloneWith(s(this,ht).node,{cascade:!0})})}$call(e){return e(this)}toOperationNode(){return s(this,ht).executor.transformQuery(s(this,ht).node,s(this,ht).queryId)}compile(){return s(this,ht).executor.compileQuery(this.toOperationNode(),s(this,ht).queryId)}async execute(){await s(this,ht).executor.executeQuery(this.compile(),s(this,ht).queryId)}};let ls=ui;ht=new WeakMap,Se(ls,"don't await DropIndexBuilder instances directly. To execute the query you need to call `execute`");const xs=class{constructor(e){R(this,vt,void 0);U(this,vt,h(e))}ifExists(){return new xs({...s(this,vt),node:js.cloneWith(s(this,vt).node,{ifExists:!0})})}cascade(){return new xs({...s(this,vt),node:js.cloneWith(s(this,vt).node,{cascade:!0})})}$call(e){return e(this)}toOperationNode(){return s(this,vt).executor.transformQuery(s(this,vt).node,s(this,vt).queryId)}compile(){return s(this,vt).executor.compileQuery(this.toOperationNode(),s(this,vt).queryId)}async execute(){await s(this,vt).executor.executeQuery(this.compile(),s(this,vt).queryId)}};let us=xs;vt=new WeakMap,Se(us,"don't await DropSchemaBuilder instances directly. To execute the query you need to call `execute`");const Es=class{constructor(e){R(this,xt,void 0);U(this,xt,h(e))}ifExists(){return new Es({...s(this,xt),node:Qs.cloneWith(s(this,xt).node,{ifExists:!0})})}cascade(){return new Es({...s(this,xt),node:Qs.cloneWith(s(this,xt).node,{cascade:!0})})}$call(e){return e(this)}toOperationNode(){return s(this,xt).executor.transformQuery(s(this,xt).node,s(this,xt).queryId)}compile(){return s(this,xt).executor.compileQuery(this.toOperationNode(),s(this,xt).queryId)}async execute(){await s(this,xt).executor.executeQuery(this.compile(),s(this,xt).queryId)}};let cs=Es;xt=new WeakMap,Se(cs,"don't await DropTableBuilder instances directly. To execute the query you need to call `execute`");const Sn=h({is(t){return t.kind==="CreateViewNode"},create(t){return h({kind:"CreateViewNode",name:Nn.create(t)})},cloneWith(t,e){return h({...t,...e})}});class vu{constructor(){R(this,Ss,new ba)}transformQuery(e){return s(this,Ss).transformNode(e.node)}transformResult(e){return Promise.resolve(e.result)}}Ss=new WeakMap;const In=class{constructor(e){R(this,He,void 0);U(this,He,h(e))}temporary(){return new In({...s(this,He),node:Sn.cloneWith(s(this,He).node,{temporary:!0})})}materialized(){return new In({...s(this,He),node:Sn.cloneWith(s(this,He).node,{materialized:!0})})}ifNotExists(){return new In({...s(this,He),node:Sn.cloneWith(s(this,He).node,{ifNotExists:!0})})}orReplace(){return new In({...s(this,He),node:Sn.cloneWith(s(this,He).node,{orReplace:!0})})}columns(e){return new In({...s(this,He),node:Sn.cloneWith(s(this,He).node,{columns:e.map(Wo)})})}as(e){const r=e.withPlugin(new vu).toOperationNode();return new In({...s(this,He),node:Sn.cloneWith(s(this,He).node,{as:r})})}$call(e){return e(this)}toOperationNode(){return s(this,He).executor.transformQuery(s(this,He).node,s(this,He).queryId)}compile(){return s(this,He).executor.compileQuery(this.toOperationNode(),s(this,He).queryId)}async execute(){await s(this,He).executor.executeQuery(this.compile(),s(this,He).queryId)}};let ds=In;He=new WeakMap,Se(ds,"don't await CreateViewBuilder instances directly. To execute the query you need to call `execute`");const fs=h({is(t){return t.kind==="DropViewNode"},create(t){return h({kind:"DropViewNode",name:Nn.create(t)})},cloneWith(t,e){return h({...t,...e})}}),ci=class{constructor(e){R(this,pt,void 0);U(this,pt,h(e))}materialized(){return new ci({...s(this,pt),node:fs.cloneWith(s(this,pt).node,{materialized:!0})})}ifExists(){return new ci({...s(this,pt),node:fs.cloneWith(s(this,pt).node,{ifExists:!0})})}cascade(){return new ci({...s(this,pt),node:fs.cloneWith(s(this,pt).node,{cascade:!0})})}$call(e){return e(this)}toOperationNode(){return s(this,pt).executor.transformQuery(s(this,pt).node,s(this,pt).queryId)}compile(){return s(this,pt).executor.compileQuery(this.toOperationNode(),s(this,pt).queryId)}async execute(){await s(this,pt).executor.executeQuery(this.compile(),s(this,pt).queryId)}};let hs=ci;pt=new WeakMap,Se(hs,"don't await DropViewBuilder instances directly. To execute the query you need to call `execute`");const Na=h({is(t){return t.kind==="CreateTypeNode"},create(t){return h({kind:"CreateTypeNode",name:t})},cloneWithEnum(t,e){return h({...t,enum:$s.create(e.map(r=>nn.createImmediate(r)))})}}),co=class{constructor(e){R(this,Pt,void 0);U(this,Pt,h(e))}toOperationNode(){return s(this,Pt).executor.transformQuery(s(this,Pt).node,s(this,Pt).queryId)}asEnum(e){return new co({...s(this,Pt),node:Na.cloneWithEnum(s(this,Pt).node,e)})}$call(e){return e(this)}compile(){return s(this,Pt).executor.compileQuery(this.toOperationNode(),s(this,Pt).queryId)}async execute(){await s(this,Pt).executor.executeQuery(this.compile(),s(this,Pt).queryId)}};let ps=co;Pt=new WeakMap,Se(ps,"don't await CreateTypeBuilder instances directly. To execute the query you need to call `execute`");const va=h({is(t){return t.kind==="DropTypeNode"},create(t){return h({kind:"DropTypeNode",name:t})},cloneWith(t,e){return h({...t,...e})}}),fo=class{constructor(e){R(this,Lt,void 0);U(this,Lt,h(e))}ifExists(){return new fo({...s(this,Lt),node:va.cloneWith(s(this,Lt).node,{ifExists:!0})})}$call(e){return e(this)}toOperationNode(){return s(this,Lt).executor.transformQuery(s(this,Lt).node,s(this,Lt).queryId)}compile(){return s(this,Lt).executor.compileQuery(this.toOperationNode(),s(this,Lt).queryId)}async execute(){await s(this,Lt).executor.executeQuery(this.compile(),s(this,Lt).queryId)}};let _s=fo;Lt=new WeakMap,Se(_s,"don't await DropTypeBuilder instances directly. To execute the query you need to call `execute`");function xa(t){const e=".";if(t.includes(e)){const r=t.split(e).map(xu);if(r.length===2)return Nn.createWithSchema(r[0],r[1]);throw new Error(`invalid schemable identifier ${t}`)}else return Nn.create(t)}function xu(t){return t.trim()}const di=class{constructor(e){R(this,lt,void 0);U(this,lt,e)}createTable(e){return new as({queryId:Ce(),executor:s(this,lt),node:Ht.create(It(e))})}dropTable(e){return new cs({queryId:Ce(),executor:s(this,lt),node:Qs.create(It(e))})}createIndex(e){return new ss({queryId:Ce(),executor:s(this,lt),node:bn.create(e)})}dropIndex(e){return new ls({queryId:Ce(),executor:s(this,lt),node:Ai.create(e)})}createSchema(e){return new os({queryId:Ce(),executor:s(this,lt),node:ko.create(e)})}dropSchema(e){return new us({queryId:Ce(),executor:s(this,lt),node:js.create(e)})}alterTable(e){return new qa({queryId:Ce(),executor:s(this,lt),node:et.create(It(e))})}createView(e){return new ds({queryId:Ce(),executor:s(this,lt),node:Sn.create(e)})}dropView(e){return new hs({queryId:Ce(),executor:s(this,lt),node:fs.create(e)})}createType(e){return new ps({queryId:Ce(),executor:s(this,lt),node:Na.create(xa(e))})}dropType(e){return new _s({queryId:Ce(),executor:s(this,lt),node:va.create(xa(e))})}withPlugin(e){return new di(s(this,lt).withPlugin(e))}withoutPlugins(){return new di(s(this,lt).withoutPlugins())}withSchema(e){return new di(s(this,lt).withPluginAtFront(new Hr(e)))}};let ro=di;lt=new WeakMap;class Eu{ref(e){return new Tl(e)}}class Su{constructor(e){R(this,xr,void 0);U(this,xr,e)}async provideConnection(e){const r=await s(this,xr).acquireConnection();try{return await e(r)}finally{await s(this,xr).releaseConnection(r)}}}xr=new WeakMap;const zn=class extends ea{constructor(r,n,A,X=[]){super(X);R(this,an,void 0);R(this,ln,void 0);R(this,_n,void 0);U(this,an,r),U(this,ln,n),U(this,_n,A)}get adapter(){return s(this,ln)}compileQuery(r){return s(this,an).compileQuery(r)}provideConnection(r){return s(this,_n).provideConnection(r)}withPlugins(r){return new zn(s(this,an),s(this,ln),s(this,_n),[...this.plugins,...r])}withPlugin(r){return new zn(s(this,an),s(this,ln),s(this,_n),[...this.plugins,r])}withPluginAtFront(r){return new zn(s(this,an),s(this,ln),s(this,_n),[r,...this.plugins])}withConnectionProvider(r){return new zn(s(this,an),s(this,ln),r,[...this.plugins])}withoutPlugins(){return new zn(s(this,an),s(this,ln),s(this,_n),[])}};let io=zn;an=new WeakMap,ln=new WeakMap,_n=new WeakMap;function Ea(){return typeof performance<"u"&&Rt(performance.now)?performance.now():Date.now()}class ku{constructor(e,r){R(this,ks);R(this,Is);R(this,Os);R(this,As);R(this,hi);R(this,Yt,void 0);R(this,On,void 0);R(this,mn,void 0);R(this,Vn,void 0);R(this,fi,new WeakSet);U(this,Yt,e),U(this,On,r)}async init(){s(this,mn)||U(this,mn,s(this,Yt).init().catch(e=>(U(this,mn,void 0),Promise.reject(e)))),await s(this,mn)}async acquireConnection(){await this.init();const e=await s(this,Yt).acquireConnection();return s(this,fi).has(e)||(Le(this,ks,al).call(this)&&Le(this,Is,ll).call(this,e),s(this,fi).add(e)),e}async releaseConnection(e){await s(this,Yt).releaseConnection(e)}beginTransaction(e,r){return s(this,Yt).beginTransaction(e,r)}commitTransaction(e){return s(this,Yt).commitTransaction(e)}rollbackTransaction(e){return s(this,Yt).rollbackTransaction(e)}async destroy(){s(this,mn)&&(await s(this,mn),s(this,Vn)||U(this,Vn,s(this,Yt).destroy().catch(e=>(U(this,Vn,void 0),Promise.reject(e)))),await s(this,Vn))}}Yt=new WeakMap,On=new WeakMap,mn=new WeakMap,Vn=new WeakMap,fi=new WeakMap,ks=new WeakSet,al=function(){return s(this,On).isLevelEnabled("query")||s(this,On).isLevelEnabled("error")},Is=new WeakSet,ll=function(e){const r=e.executeQuery;e.executeQuery=async n=>{const A=Ea();try{return await r.call(e,n)}catch(X){throw await Le(this,Os,ul).call(this,X,n,A),X}finally{await Le(this,As,cl).call(this,n,A)}}},Os=new WeakSet,ul=async function(e,r,n){await s(this,On).error(()=>({level:"error",error:e,query:r,queryDurationMillis:Le(this,hi,vo).call(this,n)}))},As=new WeakSet,cl=async function(e,r){await s(this,On).query(()=>({level:"query",query:e,queryDurationMillis:Le(this,hi,vo).call(this,r)}))},hi=new WeakSet,vo=function(e){return Ea()-e};class Sa{constructor(e){R(this,Ts);R(this,pi,void 0);R(this,An,void 0);U(this,pi,e)}async provideConnection(e){for(;s(this,An);)await s(this,An);const r=Le(this,Ts,dl).call(this,e);return U(this,An,r.then(()=>{U(this,An,void 0)}).catch(()=>{U(this,An,void 0)})),r}}pi=new WeakMap,An=new WeakMap,Ts=new WeakSet,dl=async function(e){return await e(s(this,pi))};const Iu=["read uncommitted","read committed","repeatable read","serializable"];h(["query","error"]);class Ou{constructor(e){R(this,Tn,void 0);R(this,Hn,void 0);Rt(e)?(U(this,Hn,e),U(this,Tn,h({query:!0,error:!0}))):(U(this,Hn,Au),U(this,Tn,h({query:e.includes("query"),error:e.includes("error")})))}isLevelEnabled(e){return s(this,Tn)[e]}async query(e){s(this,Tn).query&&await s(this,Hn).call(this,e())}async error(e){s(this,Tn).error&&await s(this,Hn).call(this,e())}}Tn=new WeakMap,Hn=new WeakMap;function Au(t){t.level==="query"?(console.log(`kysely:query: ${t.query.sql}`),console.log(`kysely:query: duration: ${t.queryDurationMillis.toFixed(1)}ms`)):t.level==="error"&&(t.error instanceof Error?console.error(`kysely:error: ${t.error.stack??t.error.message}`):console.error(`kysely:error: ${t}`))}function Tu(t){return tn(t)&&Rt(t.compile)}const Er=class extends Hi{constructor(r){let n,A;if(Cu(r))n={executor:r.executor},A={...r};else{const X=r.dialect,ae=X.createDriver(),me=X.createQueryCompiler(),Oe=X.createAdapter(),At=new Ou(r.log??[]),nt=new ku(ae,At),rt=new Su(nt),ue=new io(me,Oe,rt,r.plugins??[]);n={executor:ue},A={config:r,executor:ue,dialect:X,driver:nt}}super(n);R(this,_t,void 0);U(this,_t,h(A))}get schema(){return new ro(s(this,_t).executor)}get dynamic(){return new Eu}get introspection(){return s(this,_t).dialect.createIntrospector(this.withoutPlugins())}case(r){return new ua({node:$t.create(Te(r)?void 0:Ji(r))})}get fn(){return la()}transaction(){return new ms({...s(this,_t)})}connection(){return new ka({...s(this,_t)})}withPlugin(r){return new Er({...s(this,_t),executor:s(this,_t).executor.withPlugin(r)})}withoutPlugins(){return new Er({...s(this,_t),executor:s(this,_t).executor.withoutPlugins()})}withSchema(r){return new Er({...s(this,_t),executor:s(this,_t).executor.withPluginAtFront(new Hr(r))})}withTables(){return new Er({...s(this,_t)})}async destroy(){await s(this,_t).driver.destroy()}get isTransaction(){return!1}getExecutor(){return s(this,_t).executor}executeQuery(r,n=Ce()){const A=Tu(r)?r.compile():r;return this.getExecutor().executeQuery(A,n)}};let Yr=Er;_t=new WeakMap;const Sr=class extends Yr{constructor(r){super(r);R(this,Zt,void 0);U(this,Zt,r)}get isTransaction(){return!0}transaction(){throw new Error("calling the transaction method for a Transaction is not supported")}connection(){throw new Error("calling the connection method for a Transaction is not supported")}async destroy(){throw new Error("calling the destroy method for a Transaction is not supported")}withPlugin(r){return new Sr({...s(this,Zt),executor:s(this,Zt).executor.withPlugin(r)})}withoutPlugins(){return new Sr({...s(this,Zt),executor:s(this,Zt).executor.withoutPlugins()})}withSchema(r){return new Sr({...s(this,Zt),executor:s(this,Zt).executor.withPluginAtFront(new Hr(r))})}withTables(){return new Sr({...s(this,Zt)})}};let so=Sr;Zt=new WeakMap;function Cu(t){return tn(t)&&tn(t.config)&&tn(t.driver)&&tn(t.executor)&&tn(t.dialect)}class ka{constructor(e){R(this,$n,void 0);U(this,$n,h(e))}async execute(e){return s(this,$n).executor.provideConnection(async r=>{const n=s(this,$n).executor.withConnectionProvider(new Sa(r)),A=new Yr({...s(this,$n),executor:n});return await e(A)})}}$n=new WeakMap,Se(ka,"don't await ConnectionBuilder instances directly. To execute the query you need to call the `execute` method");const ho=class{constructor(e){R(this,en,void 0);U(this,en,h(e))}setIsolationLevel(e){return new ho({...s(this,en),isolationLevel:e})}async execute(e){const{isolationLevel:r,...n}=s(this,en),A={isolationLevel:r};return Wu(A),s(this,en).executor.provideConnection(async X=>{const ae=s(this,en).executor.withConnectionProvider(new Sa(X)),me=new so({...n,executor:ae});try{await s(this,en).driver.beginTransaction(X,A);const Oe=await e(me);return await s(this,en).driver.commitTransaction(X),Oe}catch(Oe){throw await s(this,en).driver.rollbackTransaction(X),Oe}})}};let ms=ho;en=new WeakMap,Se(ms,"don't await TransactionBuilder instances directly. To execute the transaction you need to call the `execute` method");function Wu(t){if(t.isolationLevel&&!Iu.includes(t.isolationLevel))throw new Error(`invalid transaction isolation level ${t.isolationLevel}`)}const Cs=class{constructor(e){R(this,kr);R(this,_i);R(this,mi);R(this,Ot,void 0);U(this,Ot,h(e))}get expressionType(){}as(e){return new Fu(this,e)}$castTo(){return new Cs({...s(this,Ot)})}castTo(){return this.$castTo()}withPlugin(e){return new Cs({...s(this,Ot),plugins:s(this,Ot).plugins!==void 0?h([...s(this,Ot).plugins,e]):h([e])})}toOperationNode(){return Le(this,_i,xo).call(this,Le(this,kr,Us).call(this))}compile(e){return Le(this,mi,Eo).call(this,Le(this,kr,Us).call(this,e))}async execute(e){const r=Le(this,kr,Us).call(this,e);return r.executeQuery(Le(this,mi,Eo).call(this,r),s(this,Ot).queryId)}};let Gt=Cs;Ot=new WeakMap,kr=new WeakSet,Us=function(e){const r=e!==void 0?e.getExecutor():$i;return s(this,Ot).plugins!==void 0?r.withPlugins(s(this,Ot).plugins):r},_i=new WeakSet,xo=function(e){return e.transformQuery(s(this,Ot).rawNode,s(this,Ot).queryId)},mi=new WeakSet,Eo=function(e){return e.compileQuery(Le(this,_i,xo).call(this,e),s(this,Ot).queryId)},Se(Gt,"don't await RawBuilder instances directly. To execute the query you need to call `execute`");class Fu{constructor(e,r){R(this,Ir,void 0);R(this,Cn,void 0);U(this,Ir,e),U(this,Cn,r)}get expression(){return s(this,Ir)}get alias(){return s(this,Cn)}toOperationNode(){return Pn.create(s(this,Ir).toOperationNode(),bt(s(this,Cn))?s(this,Cn).toOperationNode():Ge.create(s(this,Cn)))}}Ir=new WeakMap,Cn=new WeakMap;const Wt=Object.assign((t,...e)=>new Gt({queryId:Ce(),rawNode:yt.create(t,(e==null?void 0:e.map(hn))??[])}),{ref(t){return new Gt({queryId:Ce(),rawNode:yt.createWithChild(rr(t))})},val(t){return new Gt({queryId:Ce(),rawNode:yt.createWithChild(hn(t))})},value(t){return this.val(t)},table(t){return new Gt({queryId:Ce(),rawNode:yt.createWithChild(It(t))})},id(...t){const e=new Array(t.length+1).fill(".");return e[0]="",e[e.length-1]="",new Gt({queryId:Ce(),rawNode:yt.create(e,t.map(Ge.create))})},lit(t){return new Gt({queryId:Ce(),rawNode:yt.createWithChild(nn.createImmediate(t))})},literal(t){return this.lit(t)},raw(t){return new Gt({queryId:Ce(),rawNode:yt.createWithSql(t)})},join(t,e=Wt`, `){const r=new Array(2*t.length-1),n=e.toOperationNode();for(let A=0;A<t.length;++A)r[2*A]=hn(t[A]),A!==t.length-1&&(r[2*A+1]=n);return new Gt({queryId:Ce(),rawNode:yt.createWithChildren(r)})}});class Pu{constructor(){Tt(this,"nodeStack",[]);R(this,Ws,h({AliasNode:this.visitAlias.bind(this),ColumnNode:this.visitColumn.bind(this),IdentifierNode:this.visitIdentifier.bind(this),SchemableIdentifierNode:this.visitSchemableIdentifier.bind(this),RawNode:this.visitRaw.bind(this),ReferenceNode:this.visitReference.bind(this),SelectQueryNode:this.visitSelectQuery.bind(this),SelectionNode:this.visitSelection.bind(this),TableNode:this.visitTable.bind(this),FromNode:this.visitFrom.bind(this),SelectAllNode:this.visitSelectAll.bind(this),AndNode:this.visitAnd.bind(this),OrNode:this.visitOr.bind(this),ValueNode:this.visitValue.bind(this),ValueListNode:this.visitValueList.bind(this),PrimitiveValueListNode:this.visitPrimitiveValueList.bind(this),ParensNode:this.visitParens.bind(this),JoinNode:this.visitJoin.bind(this),OperatorNode:this.visitOperator.bind(this),WhereNode:this.visitWhere.bind(this),InsertQueryNode:this.visitInsertQuery.bind(this),DeleteQueryNode:this.visitDeleteQuery.bind(this),ReturningNode:this.visitReturning.bind(this),CreateTableNode:this.visitCreateTable.bind(this),AddColumnNode:this.visitAddColumn.bind(this),ColumnDefinitionNode:this.visitColumnDefinition.bind(this),DropTableNode:this.visitDropTable.bind(this),DataTypeNode:this.visitDataType.bind(this),OrderByNode:this.visitOrderBy.bind(this),OrderByItemNode:this.visitOrderByItem.bind(this),GroupByNode:this.visitGroupBy.bind(this),GroupByItemNode:this.visitGroupByItem.bind(this),UpdateQueryNode:this.visitUpdateQuery.bind(this),ColumnUpdateNode:this.visitColumnUpdate.bind(this),LimitNode:this.visitLimit.bind(this),OffsetNode:this.visitOffset.bind(this),OnConflictNode:this.visitOnConflict.bind(this),OnDuplicateKeyNode:this.visitOnDuplicateKey.bind(this),CreateIndexNode:this.visitCreateIndex.bind(this),DropIndexNode:this.visitDropIndex.bind(this),ListNode:this.visitList.bind(this),PrimaryKeyConstraintNode:this.visitPrimaryKeyConstraint.bind(this),UniqueConstraintNode:this.visitUniqueConstraint.bind(this),ReferencesNode:this.visitReferences.bind(this),CheckConstraintNode:this.visitCheckConstraint.bind(this),WithNode:this.visitWith.bind(this),CommonTableExpressionNode:this.visitCommonTableExpression.bind(this),CommonTableExpressionNameNode:this.visitCommonTableExpressionName.bind(this),HavingNode:this.visitHaving.bind(this),CreateSchemaNode:this.visitCreateSchema.bind(this),DropSchemaNode:this.visitDropSchema.bind(this),AlterTableNode:this.visitAlterTable.bind(this),DropColumnNode:this.visitDropColumn.bind(this),RenameColumnNode:this.visitRenameColumn.bind(this),AlterColumnNode:this.visitAlterColumn.bind(this),ModifyColumnNode:this.visitModifyColumn.bind(this),AddConstraintNode:this.visitAddConstraint.bind(this),DropConstraintNode:this.visitDropConstraint.bind(this),ForeignKeyConstraintNode:this.visitForeignKeyConstraint.bind(this),CreateViewNode:this.visitCreateView.bind(this),DropViewNode:this.visitDropView.bind(this),GeneratedNode:this.visitGenerated.bind(this),DefaultValueNode:this.visitDefaultValue.bind(this),OnNode:this.visitOn.bind(this),ValuesNode:this.visitValues.bind(this),SelectModifierNode:this.visitSelectModifier.bind(this),CreateTypeNode:this.visitCreateType.bind(this),DropTypeNode:this.visitDropType.bind(this),ExplainNode:this.visitExplain.bind(this),DefaultInsertValueNode:this.visitDefaultInsertValue.bind(this),AggregateFunctionNode:this.visitAggregateFunction.bind(this),OverNode:this.visitOver.bind(this),PartitionByNode:this.visitPartitionBy.bind(this),PartitionByItemNode:this.visitPartitionByItem.bind(this),SetOperationNode:this.visitSetOperation.bind(this),BinaryOperationNode:this.visitBinaryOperation.bind(this),UnaryOperationNode:this.visitUnaryOperation.bind(this),UsingNode:this.visitUsing.bind(this),FunctionNode:this.visitFunction.bind(this),CaseNode:this.visitCase.bind(this),WhenNode:this.visitWhen.bind(this)}));Tt(this,"visitNode",e=>{this.nodeStack.push(e),s(this,Ws)[e.kind](e),this.nodeStack.pop()})}get parentNode(){return this.nodeStack[this.nodeStack.length-2]}}Ws=new WeakMap;class Lu extends Pu{constructor(){super(...arguments);R(this,Or,"");R(this,Gn,[])}get numParameters(){return s(this,Gn).length}compileQuery(r){return U(this,Or,""),U(this,Gn,[]),this.visitNode(r),h({query:r,sql:this.getSql(),parameters:[...s(this,Gn)]})}getSql(){return s(this,Or)}visitSelectQuery(r){const n=this.parentNode!==void 0&&!rn.is(this.parentNode)&&!Sn.is(this.parentNode)&&!aa.is(this.parentNode);this.parentNode===void 0&&r.explain&&(this.visitNode(r.explain),this.append(" ")),n&&this.append("("),r.with&&(this.visitNode(r.with),this.append(" ")),this.append("select "),r.distinctOn&&(this.compileDistinctOn(r.distinctOn),this.append(" ")),r.frontModifiers&&r.frontModifiers.length>0&&(this.compileList(r.frontModifiers," "),this.append(" ")),r.selections&&(this.compileList(r.selections),this.append(" ")),this.visitNode(r.from),r.joins&&(this.append(" "),this.compileList(r.joins," ")),r.where&&(this.append(" "),this.visitNode(r.where)),r.groupBy&&(this.append(" "),this.visitNode(r.groupBy)),r.having&&(this.append(" "),this.visitNode(r.having)),r.setOperations&&(this.append(" "),this.compileList(r.setOperations," ")),r.orderBy&&(this.append(" "),this.visitNode(r.orderBy)),r.limit&&(this.append(" "),this.visitNode(r.limit)),r.offset&&(this.append(" "),this.visitNode(r.offset)),r.endModifiers&&r.endModifiers.length>0&&(this.append(" "),this.compileList(r.endModifiers," ")),n&&this.append(")")}visitFrom(r){this.append("from "),this.compileList(r.froms)}visitSelection(r){this.visitNode(r.selection)}visitColumn(r){this.visitNode(r.column)}compileDistinctOn(r){this.append("distinct on ("),this.compileList(r),this.append(")")}compileList(r,n=", "){const A=r.length-1;for(let X=0;X<=A;X++)this.visitNode(r[X]),X<A&&this.append(n)}visitWhere(r){this.append("where "),this.visitNode(r.where)}visitHaving(r){this.append("having "),this.visitNode(r.having)}visitInsertQuery(r){const n=this.nodeStack.find(re.is)!==r;!n&&r.explain&&(this.visitNode(r.explain),this.append(" ")),n&&this.append("("),r.with&&(this.visitNode(r.with),this.append(" ")),this.append(r.replace?"replace":"insert"),r.ignore&&this.append(" ignore"),this.append(" into "),this.visitNode(r.into),r.columns&&(this.append(" ("),this.compileList(r.columns),this.append(")")),r.values&&(this.append(" "),this.visitNode(r.values)),r.onConflict&&(this.append(" "),this.visitNode(r.onConflict)),r.onDuplicateKey&&(this.append(" "),this.visitNode(r.onDuplicateKey)),r.returning&&(this.append(" "),this.visitNode(r.returning)),n&&this.append(")")}visitValues(r){this.append("values "),this.compileList(r.values)}visitDeleteQuery(r){const n=this.nodeStack.find(re.is)!==r;!n&&r.explain&&(this.visitNode(r.explain),this.append(" ")),n&&this.append("("),r.with&&(this.visitNode(r.with),this.append(" ")),this.append("delete "),this.visitNode(r.from),r.using&&(this.append(" "),this.visitNode(r.using)),r.joins&&(this.append(" "),this.compileList(r.joins," ")),r.where&&(this.append(" "),this.visitNode(r.where)),r.orderBy&&(this.append(" "),this.visitNode(r.orderBy)),r.limit&&(this.append(" "),this.visitNode(r.limit)),r.returning&&(this.append(" "),this.visitNode(r.returning)),n&&this.append(")")}visitReturning(r){this.append("returning "),this.compileList(r.selections)}visitAlias(r){this.visitNode(r.node),this.append(" as "),this.visitNode(r.alias)}visitReference(r){this.visitNode(r.table),this.append("."),this.visitNode(r.column)}visitSelectAll(r){this.append("*")}visitIdentifier(r){this.append(this.getLeftIdentifierWrapper()),this.compileUnwrappedIdentifier(r),this.append(this.getRightIdentifierWrapper())}compileUnwrappedIdentifier(r){if(!Ne(r.name))throw new Error("a non-string identifier was passed to compileUnwrappedIdentifier.");this.append(this.sanitizeIdentifier(r.name))}visitAnd(r){this.visitNode(r.left),this.append(" and "),this.visitNode(r.right)}visitOr(r){this.visitNode(r.left),this.append(" or "),this.visitNode(r.right)}visitValue(r){r.immediate?this.appendImmediateValue(r.value):this.appendValue(r.value)}visitValueList(r){this.append("("),this.compileList(r.values),this.append(")")}visitPrimitiveValueList(r){this.append("(");const{values:n}=r;for(let A=0;A<n.length;++A)this.appendValue(n[A]),A!==n.length-1&&this.append(", ");this.append(")")}visitParens(r){this.append("("),this.visitNode(r.node),this.append(")")}visitJoin(r){this.append(Ru[r.joinType]),this.append(" "),this.visitNode(r.table),r.on&&(this.append(" "),this.visitNode(r.on))}visitOn(r){this.append("on "),this.visitNode(r.on)}visitRaw(r){const{sqlFragments:n,parameters:A}=r;for(let X=0;X<n.length;++X)this.append(n[X]),A.length>X&&this.visitNode(A[X])}visitOperator(r){this.append(r.operator)}visitTable(r){this.visitNode(r.table)}visitSchemableIdentifier(r){r.schema&&(this.visitNode(r.schema),this.append(".")),this.visitNode(r.identifier)}visitCreateTable(r){this.append("create "),r.frontModifiers&&r.frontModifiers.length>0&&(this.compileList(r.frontModifiers," "),this.append(" ")),r.temporary&&this.append("temporary "),this.append("table "),r.ifNotExists&&this.append("if not exists "),this.visitNode(r.table),this.append(" ("),this.compileList([...r.columns,...r.constraints??[]]),this.append(")"),r.onCommit&&(this.append(" on commit "),this.append(r.onCommit)),r.endModifiers&&r.endModifiers.length>0&&(this.append(" "),this.compileList(r.endModifiers," "))}visitColumnDefinition(r){this.visitNode(r.column),this.append(" "),this.visitNode(r.dataType),r.unsigned&&this.append(" unsigned"),r.frontModifiers&&r.frontModifiers.length>0&&(this.append(" "),this.compileList(r.frontModifiers," ")),r.generated&&(this.append(" "),this.visitNode(r.generated)),r.defaultTo&&(this.append(" "),this.visitNode(r.defaultTo)),r.notNull&&this.append(" not null"),r.unique&&this.append(" unique"),r.primaryKey&&this.append(" primary key"),r.autoIncrement&&(this.append(" "),this.append(this.getAutoIncrement())),r.references&&(this.append(" "),this.visitNode(r.references)),r.check&&(this.append(" "),this.visitNode(r.check)),r.endModifiers&&r.endModifiers.length>0&&(this.append(" "),this.compileList(r.endModifiers," "))}getAutoIncrement(){return"auto_increment"}visitReferences(r){this.append("references "),this.visitNode(r.table),this.append(" ("),this.compileList(r.columns),this.append(")"),r.onDelete&&(this.append(" on delete "),this.append(r.onDelete)),r.onUpdate&&(this.append(" on update "),this.append(r.onUpdate))}visitDropTable(r){this.append("drop table "),r.ifExists&&this.append("if exists "),this.visitNode(r.table),r.cascade&&this.append(" cascade")}visitDataType(r){this.append(r.dataType)}visitOrderBy(r){this.append("order by "),this.compileList(r.items)}visitOrderByItem(r){this.visitNode(r.orderBy),r.direction&&(this.append(" "),this.visitNode(r.direction))}visitGroupBy(r){this.append("group by "),this.compileList(r.items)}visitGroupByItem(r){this.visitNode(r.groupBy)}visitUpdateQuery(r){const n=this.nodeStack.find(re.is)!==r;!n&&r.explain&&(this.visitNode(r.explain),this.append(" ")),n&&this.append("("),r.with&&(this.visitNode(r.with),this.append(" ")),this.append("update "),this.visitNode(r.table),this.append(" set "),r.updates&&this.compileList(r.updates),r.from&&(this.append(" "),this.visitNode(r.from)),r.joins&&(this.append(" "),this.compileList(r.joins," ")),r.where&&(this.append(" "),this.visitNode(r.where)),r.returning&&(this.append(" "),this.visitNode(r.returning)),n&&this.append(")")}visitColumnUpdate(r){this.visitNode(r.column),this.append(" = "),this.visitNode(r.value)}visitLimit(r){this.append("limit "),this.visitNode(r.limit)}visitOffset(r){this.append("offset "),this.visitNode(r.offset)}visitOnConflict(r){this.append("on conflict"),r.columns?(this.append(" ("),this.compileList(r.columns),this.append(")")):r.constraint?(this.append(" on constraint "),this.visitNode(r.constraint)):r.indexExpression&&(this.append(" ("),this.visitNode(r.indexExpression),this.append(")")),r.indexWhere&&(this.append(" "),this.visitNode(r.indexWhere)),r.doNothing===!0?this.append(" do nothing"):r.updates&&(this.append(" do update set "),this.compileList(r.updates),r.updateWhere&&(this.append(" "),this.visitNode(r.updateWhere)))}visitOnDuplicateKey(r){this.append("on duplicate key update "),this.compileList(r.updates)}visitCreateIndex(r){this.append("create "),r.unique&&this.append("unique "),this.append("index "),r.ifNotExists&&this.append("if not exists "),this.visitNode(r.name),r.table&&(this.append(" on "),this.visitNode(r.table)),r.using&&(this.append(" using "),this.visitNode(r.using)),r.columns&&(this.append(" ("),this.compileList(r.columns),this.append(")")),r.where&&(this.append(" "),this.visitNode(r.where))}visitDropIndex(r){this.append("drop index "),r.ifExists&&this.append("if exists "),this.visitNode(r.name),r.table&&(this.append(" on "),this.visitNode(r.table)),r.cascade&&this.append(" cascade")}visitCreateSchema(r){this.append("create schema "),r.ifNotExists&&this.append("if not exists "),this.visitNode(r.schema)}visitDropSchema(r){this.append("drop schema "),r.ifExists&&this.append("if exists "),this.visitNode(r.schema),r.cascade&&this.append(" cascade")}visitPrimaryKeyConstraint(r){r.name&&(this.append("constraint "),this.visitNode(r.name),this.append(" ")),this.append("primary key ("),this.compileList(r.columns),this.append(")")}visitUniqueConstraint(r){r.name&&(this.append("constraint "),this.visitNode(r.name),this.append(" ")),this.append("unique ("),this.compileList(r.columns),this.append(")")}visitCheckConstraint(r){r.name&&(this.append("constraint "),this.visitNode(r.name),this.append(" ")),this.append("check ("),this.visitNode(r.expression),this.append(")")}visitForeignKeyConstraint(r){r.name&&(this.append("constraint "),this.visitNode(r.name),this.append(" ")),this.append("foreign key ("),this.compileList(r.columns),this.append(") "),this.visitNode(r.references),r.onDelete&&(this.append(" on delete "),this.append(r.onDelete)),r.onUpdate&&(this.append(" on update "),this.append(r.onUpdate))}visitList(r){this.compileList(r.items)}visitWith(r){this.append("with "),r.recursive&&this.append("recursive "),this.compileList(r.expressions)}visitCommonTableExpression(r){this.visitNode(r.name),this.append(" as "),this.visitNode(r.expression)}visitCommonTableExpressionName(r){this.visitNode(r.table),r.columns&&(this.append("("),this.compileList(r.columns),this.append(")"))}visitAlterTable(r){this.append("alter table "),this.visitNode(r.table),this.append(" "),r.renameTo&&(this.append("rename to "),this.visitNode(r.renameTo)),r.setSchema&&(this.append("set schema "),this.visitNode(r.setSchema)),r.addConstraint&&this.visitNode(r.addConstraint),r.dropConstraint&&this.visitNode(r.dropConstraint),r.columnAlterations&&this.compileList(r.columnAlterations)}visitAddColumn(r){this.append("add column "),this.visitNode(r.column)}visitRenameColumn(r){this.append("rename column "),this.visitNode(r.column),this.append(" to "),this.visitNode(r.renameTo)}visitDropColumn(r){this.append("drop column "),this.visitNode(r.column)}visitAlterColumn(r){this.append("alter column "),this.visitNode(r.column),this.append(" "),r.dataType&&(this.append("type "),this.visitNode(r.dataType),r.dataTypeExpression&&(this.append("using "),this.visitNode(r.dataTypeExpression))),r.setDefault&&(this.append("set default "),this.visitNode(r.setDefault)),r.dropDefault&&this.append("drop default"),r.setNotNull&&this.append("set not null"),r.dropNotNull&&this.append("drop not null")}visitModifyColumn(r){this.append("modify column "),this.visitNode(r.column)}visitAddConstraint(r){this.append("add "),this.visitNode(r.constraint)}visitDropConstraint(r){this.append("drop constraint "),r.ifExists&&this.append("if exists "),this.visitNode(r.constraintName),r.modifier==="cascade"?this.append(" cascade"):r.modifier==="restrict"&&this.append(" restrict")}visitSetOperation(r){this.append(r.operator),this.append(" "),r.all&&this.append("all "),this.visitNode(r.expression)}visitCreateView(r){this.append("create "),r.orReplace&&this.append("or replace "),r.materialized&&this.append("materialized "),r.temporary&&this.append("temporary "),this.append("view "),r.ifNotExists&&this.append("if not exists "),this.visitNode(r.name),this.append(" "),r.columns&&(this.append("("),this.compileList(r.columns),this.append(") ")),r.as&&(this.append("as "),this.visitNode(r.as))}visitDropView(r){this.append("drop "),r.materialized&&this.append("materialized "),this.append("view "),r.ifExists&&this.append("if exists "),this.visitNode(r.name),r.cascade&&this.append(" cascade")}visitGenerated(r){this.append("generated "),r.always&&this.append("always "),r.byDefault&&this.append("by default "),this.append("as "),r.identity&&this.append("identity"),r.expression&&(this.append("("),this.visitNode(r.expression),this.append(")")),r.stored&&this.append(" stored")}visitDefaultValue(r){this.append("default "),this.visitNode(r.defaultValue)}visitSelectModifier(r){r.rawModifier?this.visitNode(r.rawModifier):this.append(Du[r.modifier])}visitCreateType(r){this.append("create type "),this.visitNode(r.name),r.enum&&(this.append(" as enum "),this.visitNode(r.enum))}visitDropType(r){this.append("drop type "),r.ifExists&&this.append("if exists "),this.visitNode(r.name)}visitExplain(r){this.append("explain"),(r.options||r.format)&&(this.append(" "),this.append(this.getLeftExplainOptionsWrapper()),r.options&&(this.visitNode(r.options),r.format&&this.append(this.getExplainOptionsDelimiter())),r.format&&(this.append("format"),this.append(this.getExplainOptionAssignment()),this.append(r.format)),this.append(this.getRightExplainOptionsWrapper()))}visitDefaultInsertValue(r){this.append("default")}visitAggregateFunction(r){this.append(r.func),this.append("("),r.distinct&&this.append("distinct "),this.compileList(r.aggregated),this.append(")"),r.filter&&(this.append(" filter("),this.visitNode(r.filter),this.append(")")),r.over&&(this.append(" "),this.visitNode(r.over))}visitOver(r){this.append("over("),r.partitionBy&&(this.visitNode(r.partitionBy),r.orderBy&&this.append(" ")),r.orderBy&&this.visitNode(r.orderBy),this.append(")")}visitPartitionBy(r){this.append("partition by "),this.compileList(r.items)}visitPartitionByItem(r){this.visitNode(r.partitionBy)}visitBinaryOperation(r){this.visitNode(r.leftOperand),this.append(" "),this.visitNode(r.operator),this.append(" "),this.visitNode(r.rightOperand)}visitUnaryOperation(r){this.visitNode(r.operator),this.isMinusOperator(r.operator)||this.append(" "),this.visitNode(r.operand)}isMinusOperator(r){return zs.is(r)&&r.operator==="-"}visitUsing(r){this.append("using "),this.compileList(r.tables)}visitFunction(r){this.append(r.func),this.append("("),this.compileList(r.arguments),this.append(")")}visitCase(r){this.append("case"),r.value&&(this.append(" "),this.visitNode(r.value)),r.when&&(this.append(" "),this.compileList(r.when," ")),r.else&&(this.append(" else "),this.visitNode(r.else)),this.append(" end"),r.isStatement&&this.append(" case")}visitWhen(r){this.append("when "),this.visitNode(r.condition),r.result&&(this.append(" then "),this.visitNode(r.result))}append(r){U(this,Or,s(this,Or)+r)}appendValue(r){this.addParameter(r),this.append(this.getCurrentParameterPlaceholder())}getLeftIdentifierWrapper(){return'"'}getRightIdentifierWrapper(){return'"'}getCurrentParameterPlaceholder(){return"$"+this.numParameters}getLeftExplainOptionsWrapper(){return"("}getExplainOptionAssignment(){return" "}getExplainOptionsDelimiter(){return", "}getRightExplainOptionsWrapper(){return")"}sanitizeIdentifier(r){const n=this.getLeftIdentifierWrapper(),A=this.getRightIdentifierWrapper();let X="";for(const ae of r)X+=ae,ae===n?X+=n:ae===A&&(X+=A);return X}addParameter(r){s(this,Gn).push(r)}appendImmediateValue(r){if(Ne(r))this.append(`'${r}'`);else if(Ze(r)||Pr(r))this.append(r.toString());else if(So(r))this.append("null");else if(hl(r))this.appendImmediateValue(r.toISOString());else if(pl(r))this.appendImmediateValue(r.toString());else throw new Error(`invalid immediate value ${r}`)}}Or=new WeakMap,Gn=new WeakMap;const Du=h({ForKeyShare:"for key share",ForNoKeyUpdate:"for no key update",ForUpdate:"for update",ForShare:"for share",NoWait:"nowait",SkipLocked:"skip locked",Distinct:"distinct"}),Ru=h({InnerJoin:"inner join",LeftJoin:"left join",RightJoin:"right join",FullJoin:"full join",LateralInnerJoin:"inner join lateral",LateralLeftJoin:"left join lateral"}),oo=h({raw(t){return h({sql:t,query:yt.createWithSql(t),parameters:h([])})}}),Bu=/"/g;class Mu extends Lu{getCurrentParameterPlaceholder(){return"?"}getLeftExplainOptionsWrapper(){return""}getRightExplainOptionsWrapper(){return""}getLeftIdentifierWrapper(){return'"'}getRightIdentifierWrapper(){return'"'}getAutoIncrement(){return"autoincrement"}sanitizeIdentifier(e){return e.replace(Bu,'""')}visitDefaultInsertValue(e){this.append("null")}}const Uu="kysely_migration",ju="kysely_migration_lock";h({__noMigrations__:!0});class Qu{constructor(e){R(this,Fs);R(this,Ar,void 0);U(this,Ar,e)}async getSchemas(){return[]}async getTables(e={withInternalKyselyTables:!1}){let r=s(this,Ar).selectFrom("sqlite_schema").where("type","in",["table","view"]).where("name","not like","sqlite_%").select("name").orderBy("name").$castTo();e.withInternalKyselyTables||(r=r.where("name","!=",Uu).where("name","!=",ju));const n=await r.execute();return Promise.all(n.map(({name:A})=>Le(this,Fs,fl).call(this,A)))}async getMetadata(e){return{tables:await this.getTables(e)}}}Ar=new WeakMap,Fs=new WeakSet,fl=async function(e){var ae,me,Oe,At,nt,rt;const r=s(this,Ar),n=await r.selectFrom("sqlite_master").where("name","=",e).select(["sql","type"]).$castTo().executeTakeFirstOrThrow(),A=(rt=(nt=(At=(Oe=(me=(ae=n.sql)==null?void 0:ae.split(/[\(\),]/))==null?void 0:me.find(ue=>ue.toLowerCase().includes("autoincrement")))==null?void 0:Oe.trimStart())==null?void 0:At.split(/\s+/))==null?void 0:nt[0])==null?void 0:rt.replace(/["`]/g,""),X=await r.selectFrom(Wt`pragma_table_info(${e})`.as("table_info")).select(["name","type","notnull","dflt_value"]).orderBy("cid").execute();return{name:e,isView:n.type==="view",columns:X.map(ue=>({name:ue.name,dataType:ue.type,isNullable:!ue.notnull,isAutoIncrementing:ue.name===A,hasDefaultValue:ue.dflt_value!=null}))}};class zu{get supportsTransactionalDdl(){return!1}get supportsReturning(){return!0}async acquireMigrationLock(){}async releaseMigrationLock(){}}var Vu=class{createQueryCompiler(){return new Mu}createAdapter(){return new zu}createIntrospector(t){return new Qu(t)}},Hu=(Oa=class{constructor(){R(this,yi,new $u);Tt(this,"connection");R(this,Ps,void 0)}async acquireConnection(){return await s(this,yi).lock(),this.connection}async beginTransaction(t){await t.executeQuery(oo.raw("begin"))}async commitTransaction(t){await t.executeQuery(oo.raw("commit"))}async rollbackTransaction(t){await t.executeQuery(oo.raw("rollback"))}async releaseConnection(){s(this,yi).unlock()}async destroy(){var t;(t=s(this,Ps))==null||t.close()}},yi=new WeakMap,Ps=new WeakMap,Oa),$u=(Aa=class{constructor(){R(this,Jn,void 0);R(this,Tr,void 0)}async lock(){for(;s(this,Jn);)await s(this,Jn);U(this,Jn,new Promise(t=>{U(this,Tr,t)}))}unlock(){const t=s(this,Tr);U(this,Jn,void 0),U(this,Tr,void 0),t==null||t()}},Jn=new WeakMap,Tr=new WeakMap,Aa),Gu=class{streamQuery(){throw new Error("Sqlite driver doesn't support streaming")}async executeQuery(t){const{parameters:e,sql:r,query:n}=t;return["SelectQueryNode","RawNode"].includes(n.kind)?{rows:await this.query(r,e)}:{rows:[],...await this.exec(r,e)}}},Ju=(Ta=class extends Hu{constructor(e){super();R(this,yn,void 0);R(this,gi,void 0);U(this,yn,e)}async init(){U(this,gi,typeof s(this,yn).database=="function"?await s(this,yn).database():s(this,yn).database),this.connection=new Ku(s(this,gi)),s(this,yn).onCreateConnection&&await s(this,yn).onCreateConnection(this.connection)}},yn=new WeakMap,gi=new WeakMap,Ta),Ku=(Ca=class extends Gu{constructor(e){super();R(this,Kn,void 0);U(this,Kn,e)}query(e,r){const n=[];return s(this,Kn).exec({sql:e,bind:r??[],rowMode:"object",resultRows:n}),n}exec(e,r){return s(this,Kn).exec({sql:e,bind:r??[]}),{numAffectedRows:BigInt(s(this,Kn).changes(!1,!0)),insertId:BigInt(this.query("SELECT last_insert_rowid() as id")[0].id)}}},Kn=new WeakMap,Ca),Xu=(Wa=class extends Vu{constructor(e){super();R(this,wi,void 0);U(this,wi,e)}createDriver(){return new Ju(s(this,wi))}},wi=new WeakMap,Wa),Yu=(()=>{var t=self.location.href;return function(e){var r=e||{},n=typeof r<"u"?r:{},A,X;n.ready=new Promise(function(o,i){A=o,X=i});const ae=globalThis.sqlite3InitModuleState||Object.assign(Object.create(null),{debugModule:()=>{}});delete globalThis.sqlite3InitModuleState,ae.debugModule("globalThis.location =",globalThis.location);const me="emscripten-bug-17951";n[me]=function o(i,l){i.env.foo=function(){};const a=n.locateFile(o.uri,typeof ue>"u"?"":ue);ae.debugModule("instantiateWasm() uri =",a);const u=()=>fetch(a,{credentials:"same-origin"});return(WebAssembly.instantiateStreaming?async()=>WebAssembly.instantiateStreaming(u(),i).then(N=>l(N.instance,N.module)):async()=>u().then(N=>N.arrayBuffer()).then(N=>WebAssembly.instantiate(N,i)).then(N=>l(N.instance,N.module)))(),{}},n[me].uri="sqlite3.wasm";var Oe=Object.assign({},n),At="./this.program",nt=typeof window=="object",rt=typeof importScripts=="function";typeof process=="object"&&typeof process.versions=="object"&&process.versions.node;var ue="";function Qt(o){return n.locateFile?n.locateFile(o,ue):ue+o}var Qe,gn,vi;(nt||rt)&&(rt?ue=self.location.href:typeof document<"u"&&document.currentScript&&(ue=document.currentScript.src),t&&(ue=t),ue.indexOf("blob:")!==0?ue=ue.substr(0,ue.replace(/[?#].*/,"").lastIndexOf("/")+1):ue="",Qe=o=>{var i=new XMLHttpRequest;return i.open("GET",o,!1),i.send(null),i.responseText},rt&&(vi=o=>{var i=new XMLHttpRequest;return i.open("GET",o,!1),i.responseType="arraybuffer",i.send(null),new Uint8Array(i.response)}),gn=(o,i,l)=>{var a=new XMLHttpRequest;a.open("GET",o,!0),a.responseType="arraybuffer",a.onload=()=>{if(a.status==200||a.status==0&&a.response){i(a.response);return}l()},a.onerror=l,a.send(null)});var wn=n.print||console.log.bind(console),Et=n.printErr||console.warn.bind(console);Object.assign(n,Oe),Oe=null,n.arguments&&n.arguments,n.thisProgram&&(At=n.thisProgram),n.quit&&n.quit;var xi;n.wasmBinary&&(xi=n.wasmBinary),n.noExitRuntime,typeof WebAssembly!="object"&&Zn("no native wasm support detected");var Fn,Da=!1;function cc(o,i){o||Zn(i)}var Ra=typeof TextDecoder<"u"?new TextDecoder("utf8"):void 0;function Wr(o,i,l){for(var a=i+l,u=i;o[u]&&!(u>=a);)++u;if(u-i>16&&o.buffer&&Ra)return Ra.decode(o.subarray(i,u));for(var d="";i<u;){var N=o[i++];if(!(N&128)){d+=String.fromCharCode(N);continue}var S=o[i++]&63;if((N&224)==192){d+=String.fromCharCode((N&31)<<6|S);continue}var C=o[i++]&63;if((N&240)==224?N=(N&15)<<12|S<<6|C:N=(N&7)<<18|S<<12|C<<6|o[i++]&63,N<65536)d+=String.fromCharCode(N);else{var V=N-65536;d+=String.fromCharCode(55296|V>>10,56320|V&1023)}}return d}function dc(o,i){return o?Wr(Si,o,i):""}function Ls(o,i,l,a){if(!(a>0))return 0;for(var u=l,d=l+a-1,N=0;N<o.length;++N){var S=o.charCodeAt(N);if(S>=55296&&S<=57343){var C=o.charCodeAt(++N);S=65536+((S&1023)<<10)|C&1023}if(S<=127){if(l>=d)break;i[l++]=S}else if(S<=2047){if(l+1>=d)break;i[l++]=192|S>>6,i[l++]=128|S&63}else if(S<=65535){if(l+2>=d)break;i[l++]=224|S>>12,i[l++]=128|S>>6&63,i[l++]=128|S&63}else{if(l+3>=d)break;i[l++]=240|S>>18,i[l++]=128|S>>12&63,i[l++]=128|S>>6&63,i[l++]=128|S&63}}return i[l]=0,l-u}function Ba(o,i,l){return Ls(o,Si,i,l)}function Ei(o){for(var i=0,l=0;l<o.length;++l){var a=o.charCodeAt(l);a<=127?i++:a<=2047?i+=2:a>=55296&&a<=57343?(i+=4,++l):i+=3}return i}var Dt,Si,Ma,we,it;function Ua(){var o=Fn.buffer;n.HEAP8=Dt=new Int8Array(o),n.HEAP16=Ma=new Int16Array(o),n.HEAP32=we=new Int32Array(o),n.HEAPU8=Si=new Uint8Array(o),n.HEAPU16=new Uint16Array(o),n.HEAPU32=it=new Uint32Array(o),n.HEAPF32=new Float32Array(o),n.HEAPF64=new Float64Array(o),n.HEAP64=new BigInt64Array(o),n.HEAPU64=new BigUint64Array(o)}var ja=n.INITIAL_MEMORY||16777216;n.wasmMemory?Fn=n.wasmMemory:Fn=new WebAssembly.Memory({initial:ja/65536,maximum:2147483648/65536}),Ua(),ja=Fn.buffer.byteLength;var Qa=[],za=[],Va=[];function fc(){if(n.preRun)for(typeof n.preRun=="function"&&(n.preRun=[n.preRun]);n.preRun.length;)_c(n.preRun.shift());_o(Qa)}function hc(){!n.noFSInit&&!c.init.initialized&&c.init(),c.ignorePermissions=!1,_o(za)}function pc(){if(n.postRun)for(typeof n.postRun=="function"&&(n.postRun=[n.postRun]);n.postRun.length;)yc(n.postRun.shift());_o(Va)}function _c(o){Qa.unshift(o)}function mc(o){za.unshift(o)}function yc(o){Va.unshift(o)}var Yn=0,ki=null;function bd(o){return o}function po(o){Yn++,n.monitorRunDependencies&&n.monitorRunDependencies(Yn)}function Ds(o){if(Yn--,n.monitorRunDependencies&&n.monitorRunDependencies(Yn),Yn==0&&ki){var i=ki;ki=null,i()}}function Zn(o){n.onAbort&&n.onAbort(o),o="Aborted("+o+")",Et(o),Da=!0,o+=". Build with -sASSERTIONS for more info.";var i=new WebAssembly.RuntimeError(o);throw X(i),i}var gc="data:application/octet-stream;base64,";function Ha(o){return o.startsWith(gc)}var zt;n.locateFile?(zt="sqlite3.wasm",Ha(zt)||(zt=Qt(zt))):zt=new URL(""+new URL("sqlite3-14470338.wasm",self.location.href).href,self.location).href;function $a(o){try{if(o==zt&&xi)return new Uint8Array(xi);if(vi)return vi(o);throw"both async and sync fetching of the wasm failed"}catch(i){Zn(i)}}function wc(){return!xi&&(nt||rt)&&typeof fetch=="function"?fetch(zt,{credentials:"same-origin"}).then(function(o){if(!o.ok)throw"failed to load wasm binary file at '"+zt+"'";return o.arrayBuffer()}).catch(function(){return $a(zt)}):Promise.resolve().then(function(){return $a(zt)})}function qc(){var o={env:Za,wasi_snapshot_preview1:Za};function i(N,S){var C=N.exports;n.asm=C,n.asm.__indirect_function_table,mc(n.asm.__wasm_call_ctors),Ds()}po();function l(N){i(N.instance)}function a(N){return wc().then(function(S){return WebAssembly.instantiate(S,o)}).then(function(S){return S}).then(N,function(S){Et("failed to asynchronously prepare wasm: "+S),Zn(S)})}function u(){return!xi&&typeof WebAssembly.instantiateStreaming=="function"&&!Ha(zt)&&typeof fetch=="function"?fetch(zt,{credentials:"same-origin"}).then(function(N){var S=WebAssembly.instantiateStreaming(N,o);return S.then(l,function(C){return Et("wasm streaming compile failed: "+C),Et("falling back to ArrayBuffer instantiation"),a(l)})}):a(l)}if(n.instantiateWasm)try{var d=n.instantiateWasm(o,i);return d}catch(N){Et("Module.instantiateWasm callback failed with error: "+N),X(N)}return u().catch(X),{}}var qe,ut;function _o(o){for(;o.length>0;)o.shift()(n)}var Ee={isAbs:o=>o.charAt(0)==="/",splitPath:o=>{var i=/^(\/?|)([\s\S]*?)((?:\.{1,2}|[^\/]+?|)(\.[^.\/]*|))(?:[\/]*)$/;return i.exec(o).slice(1)},normalizeArray:(o,i)=>{for(var l=0,a=o.length-1;a>=0;a--){var u=o[a];u==="."?o.splice(a,1):u===".."?(o.splice(a,1),l++):l&&(o.splice(a,1),l--)}if(i)for(;l;l--)o.unshift("..");return o},normalize:o=>{var i=Ee.isAbs(o),l=o.substr(-1)==="/";return o=Ee.normalizeArray(o.split("/").filter(a=>!!a),!i).join("/"),!o&&!i&&(o="."),o&&l&&(o+="/"),(i?"/":"")+o},dirname:o=>{var i=Ee.splitPath(o),l=i[0],a=i[1];return!l&&!a?".":(a&&(a=a.substr(0,a.length-1)),l+a)},basename:o=>{if(o==="/")return"/";o=Ee.normalize(o),o=o.replace(/\/$/,"");var i=o.lastIndexOf("/");return i===-1?o:o.substr(i+1)},join:function(){var o=Array.prototype.slice.call(arguments);return Ee.normalize(o.join("/"))},join2:(o,i)=>Ee.normalize(o+"/"+i)};function bc(){if(typeof crypto=="object"&&typeof crypto.getRandomValues=="function"){var o=new Uint8Array(1);return()=>(crypto.getRandomValues(o),o[0])}else return()=>Zn("randomDevice")}var qn={resolve:function(){for(var o="",i=!1,l=arguments.length-1;l>=-1&&!i;l--){var a=l>=0?arguments[l]:c.cwd();if(typeof a!="string")throw new TypeError("Arguments to path.resolve must be strings");if(!a)return"";o=a+"/"+o,i=Ee.isAbs(a)}return o=Ee.normalizeArray(o.split("/").filter(u=>!!u),!i).join("/"),(i?"/":"")+o||"."},relative:(o,i)=>{o=qn.resolve(o).substr(1),i=qn.resolve(i).substr(1);function l(V){for(var J=0;J<V.length&&V[J]==="";J++);for(var ie=V.length-1;ie>=0&&V[ie]==="";ie--);return J>ie?[]:V.slice(J,ie-J+1)}for(var a=l(o.split("/")),u=l(i.split("/")),d=Math.min(a.length,u.length),N=d,S=0;S<d;S++)if(a[S]!==u[S]){N=S;break}for(var C=[],S=N;S<a.length;S++)C.push("..");return C=C.concat(u.slice(N)),C.join("/")}};function mo(o,i,l){var a=l>0?l:Ei(o)+1,u=new Array(a),d=Ls(o,u,0,u.length);return i&&(u.length=d),u}var er={ttys:[],init:function(){},shutdown:function(){},register:function(o,i){er.ttys[o]={input:[],output:[],ops:i},c.registerDevice(o,er.stream_ops)},stream_ops:{open:function(o){var i=er.ttys[o.node.rdev];if(!i)throw new c.ErrnoError(43);o.tty=i,o.seekable=!1},close:function(o){o.tty.ops.fsync(o.tty)},fsync:function(o){o.tty.ops.fsync(o.tty)},read:function(o,i,l,a,u){if(!o.tty||!o.tty.ops.get_char)throw new c.ErrnoError(60);for(var d=0,N=0;N<a;N++){var S;try{S=o.tty.ops.get_char(o.tty)}catch{throw new c.ErrnoError(29)}if(S===void 0&&d===0)throw new c.ErrnoError(6);if(S==null)break;d++,i[l+N]=S}return d&&(o.node.timestamp=Date.now()),d},write:function(o,i,l,a,u){if(!o.tty||!o.tty.ops.put_char)throw new c.ErrnoError(60);try{for(var d=0;d<a;d++)o.tty.ops.put_char(o.tty,i[l+d])}catch{throw new c.ErrnoError(29)}return a&&(o.node.timestamp=Date.now()),d}},default_tty_ops:{get_char:function(o){if(!o.input.length){var i=null;if(typeof window<"u"&&typeof window.prompt=="function"?(i=window.prompt("Input: "),i!==null&&(i+=`
`)):typeof readline=="function"&&(i=readline(),i!==null&&(i+=`
`)),!i)return null;o.input=mo(i,!0)}return o.input.shift()},put_char:function(o,i){i===null||i===10?(wn(Wr(o.output,0)),o.output=[]):i!=0&&o.output.push(i)},fsync:function(o){o.output&&o.output.length>0&&(wn(Wr(o.output,0)),o.output=[])}},default_tty1_ops:{put_char:function(o,i){i===null||i===10?(Et(Wr(o.output,0)),o.output=[]):i!=0&&o.output.push(i)},fsync:function(o){o.output&&o.output.length>0&&(Et(Wr(o.output,0)),o.output=[])}}};function Ga(o){Zn()}var he={ops_table:null,mount:function(o){return he.createNode(null,"/",16895,0)},createNode:function(o,i,l,a){if(c.isBlkdev(l)||c.isFIFO(l))throw new c.ErrnoError(63);he.ops_table||(he.ops_table={dir:{node:{getattr:he.node_ops.getattr,setattr:he.node_ops.setattr,lookup:he.node_ops.lookup,mknod:he.node_ops.mknod,rename:he.node_ops.rename,unlink:he.node_ops.unlink,rmdir:he.node_ops.rmdir,readdir:he.node_ops.readdir,symlink:he.node_ops.symlink},stream:{llseek:he.stream_ops.llseek}},file:{node:{getattr:he.node_ops.getattr,setattr:he.node_ops.setattr},stream:{llseek:he.stream_ops.llseek,read:he.stream_ops.read,write:he.stream_ops.write,allocate:he.stream_ops.allocate,mmap:he.stream_ops.mmap,msync:he.stream_ops.msync}},link:{node:{getattr:he.node_ops.getattr,setattr:he.node_ops.setattr,readlink:he.node_ops.readlink},stream:{}},chrdev:{node:{getattr:he.node_ops.getattr,setattr:he.node_ops.setattr},stream:c.chrdev_stream_ops}});var u=c.createNode(o,i,l,a);return c.isDir(u.mode)?(u.node_ops=he.ops_table.dir.node,u.stream_ops=he.ops_table.dir.stream,u.contents={}):c.isFile(u.mode)?(u.node_ops=he.ops_table.file.node,u.stream_ops=he.ops_table.file.stream,u.usedBytes=0,u.contents=null):c.isLink(u.mode)?(u.node_ops=he.ops_table.link.node,u.stream_ops=he.ops_table.link.stream):c.isChrdev(u.mode)&&(u.node_ops=he.ops_table.chrdev.node,u.stream_ops=he.ops_table.chrdev.stream),u.timestamp=Date.now(),o&&(o.contents[i]=u,o.timestamp=u.timestamp),u},getFileDataAsTypedArray:function(o){return o.contents?o.contents.subarray?o.contents.subarray(0,o.usedBytes):new Uint8Array(o.contents):new Uint8Array(0)},expandFileStorage:function(o,i){var l=o.contents?o.contents.length:0;if(!(l>=i)){var a=1024*1024;i=Math.max(i,l*(l<a?2:1.125)>>>0),l!=0&&(i=Math.max(i,256));var u=o.contents;o.contents=new Uint8Array(i),o.usedBytes>0&&o.contents.set(u.subarray(0,o.usedBytes),0)}},resizeFileStorage:function(o,i){if(o.usedBytes!=i)if(i==0)o.contents=null,o.usedBytes=0;else{var l=o.contents;o.contents=new Uint8Array(i),l&&o.contents.set(l.subarray(0,Math.min(i,o.usedBytes))),o.usedBytes=i}},node_ops:{getattr:function(o){var i={};return i.dev=c.isChrdev(o.mode)?o.id:1,i.ino=o.id,i.mode=o.mode,i.nlink=1,i.uid=0,i.gid=0,i.rdev=o.rdev,c.isDir(o.mode)?i.size=4096:c.isFile(o.mode)?i.size=o.usedBytes:c.isLink(o.mode)?i.size=o.link.length:i.size=0,i.atime=new Date(o.timestamp),i.mtime=new Date(o.timestamp),i.ctime=new Date(o.timestamp),i.blksize=4096,i.blocks=Math.ceil(i.size/i.blksize),i},setattr:function(o,i){i.mode!==void 0&&(o.mode=i.mode),i.timestamp!==void 0&&(o.timestamp=i.timestamp),i.size!==void 0&&he.resizeFileStorage(o,i.size)},lookup:function(o,i){throw c.genericErrors[44]},mknod:function(o,i,l,a){return he.createNode(o,i,l,a)},rename:function(o,i,l){if(c.isDir(o.mode)){var a;try{a=c.lookupNode(i,l)}catch{}if(a)for(var u in a.contents)throw new c.ErrnoError(55)}delete o.parent.contents[o.name],o.parent.timestamp=Date.now(),o.name=l,i.contents[l]=o,i.timestamp=o.parent.timestamp,o.parent=i},unlink:function(o,i){delete o.contents[i],o.timestamp=Date.now()},rmdir:function(o,i){var l=c.lookupNode(o,i);for(var a in l.contents)throw new c.ErrnoError(55);delete o.contents[i],o.timestamp=Date.now()},readdir:function(o){var i=[".",".."];for(var l in o.contents)o.contents.hasOwnProperty(l)&&i.push(l);return i},symlink:function(o,i,l){var a=he.createNode(o,i,41471,0);return a.link=l,a},readlink:function(o){if(!c.isLink(o.mode))throw new c.ErrnoError(28);return o.link}},stream_ops:{read:function(o,i,l,a,u){var d=o.node.contents;if(u>=o.node.usedBytes)return 0;var N=Math.min(o.node.usedBytes-u,a);if(N>8&&d.subarray)i.set(d.subarray(u,u+N),l);else for(var S=0;S<N;S++)i[l+S]=d[u+S];return N},write:function(o,i,l,a,u,d){if(i.buffer===Dt.buffer&&(d=!1),!a)return 0;var N=o.node;if(N.timestamp=Date.now(),i.subarray&&(!N.contents||N.contents.subarray)){if(d)return N.contents=i.subarray(l,l+a),N.usedBytes=a,a;if(N.usedBytes===0&&u===0)return N.contents=i.slice(l,l+a),N.usedBytes=a,a;if(u+a<=N.usedBytes)return N.contents.set(i.subarray(l,l+a),u),a}if(he.expandFileStorage(N,u+a),N.contents.subarray&&i.subarray)N.contents.set(i.subarray(l,l+a),u);else for(var S=0;S<a;S++)N.contents[u+S]=i[l+S];return N.usedBytes=Math.max(N.usedBytes,u+a),a},llseek:function(o,i,l){var a=i;if(l===1?a+=o.position:l===2&&c.isFile(o.node.mode)&&(a+=o.node.usedBytes),a<0)throw new c.ErrnoError(28);return a},allocate:function(o,i,l){he.expandFileStorage(o.node,i+l),o.node.usedBytes=Math.max(o.node.usedBytes,i+l)},mmap:function(o,i,l,a,u){if(!c.isFile(o.node.mode))throw new c.ErrnoError(43);var d,N,S=o.node.contents;if(!(u&2)&&S.buffer===Dt.buffer)N=!1,d=S.byteOffset;else{if((l>0||l+i<S.length)&&(S.subarray?S=S.subarray(l,l+i):S=Array.prototype.slice.call(S,l,l+i)),N=!0,d=Ga(),!d)throw new c.ErrnoError(48);Dt.set(S,d)}return{ptr:d,allocated:N}},msync:function(o,i,l,a,u){return he.stream_ops.write(o,i,0,a,l,!1),0}}};function Nc(o,i,l,a){var u=a?"":"al "+o;gn(o,d=>{cc(d,'Loading data file "'+o+'" failed (no arrayBuffer).'),i(new Uint8Array(d)),u&&Ds()},d=>{if(l)l();else throw'Loading data file "'+o+'" failed.'}),u&&po()}var c={root:null,mounts:[],devices:{},streams:[],nextInode:1,nameTable:null,currentPath:"/",initialized:!1,ignorePermissions:!0,ErrnoError:null,genericErrors:{},filesystems:null,syncFSRequests:0,lookupPath:(o,i={})=>{if(o=qn.resolve(o),!o)return{path:"",node:null};var l={follow_mount:!0,recurse_count:0};if(i=Object.assign(l,i),i.recurse_count>8)throw new c.ErrnoError(32);for(var a=o.split("/").filter(ie=>!!ie),u=c.root,d="/",N=0;N<a.length;N++){var S=N===a.length-1;if(S&&i.parent)break;if(u=c.lookupNode(u,a[N]),d=Ee.join2(d,a[N]),c.isMountpoint(u)&&(!S||S&&i.follow_mount)&&(u=u.mounted.root),!S||i.follow)for(var C=0;c.isLink(u.mode);){var V=c.readlink(d);d=qn.resolve(Ee.dirname(d),V);var J=c.lookupPath(d,{recurse_count:i.recurse_count+1});if(u=J.node,C++>40)throw new c.ErrnoError(32)}}return{path:d,node:u}},getPath:o=>{for(var i;;){if(c.isRoot(o)){var l=o.mount.mountpoint;return i?l[l.length-1]!=="/"?l+"/"+i:l+i:l}i=i?o.name+"/"+i:o.name,o=o.parent}},hashName:(o,i)=>{for(var l=0,a=0;a<i.length;a++)l=(l<<5)-l+i.charCodeAt(a)|0;return(o+l>>>0)%c.nameTable.length},hashAddNode:o=>{var i=c.hashName(o.parent.id,o.name);o.name_next=c.nameTable[i],c.nameTable[i]=o},hashRemoveNode:o=>{var i=c.hashName(o.parent.id,o.name);if(c.nameTable[i]===o)c.nameTable[i]=o.name_next;else for(var l=c.nameTable[i];l;){if(l.name_next===o){l.name_next=o.name_next;break}l=l.name_next}},lookupNode:(o,i)=>{var l=c.mayLookup(o);if(l)throw new c.ErrnoError(l,o);for(var a=c.hashName(o.id,i),u=c.nameTable[a];u;u=u.name_next){var d=u.name;if(u.parent.id===o.id&&d===i)return u}return c.lookup(o,i)},createNode:(o,i,l,a)=>{var u=new c.FSNode(o,i,l,a);return c.hashAddNode(u),u},destroyNode:o=>{c.hashRemoveNode(o)},isRoot:o=>o===o.parent,isMountpoint:o=>!!o.mounted,isFile:o=>(o&61440)===32768,isDir:o=>(o&61440)===16384,isLink:o=>(o&61440)===40960,isChrdev:o=>(o&61440)===8192,isBlkdev:o=>(o&61440)===24576,isFIFO:o=>(o&61440)===4096,isSocket:o=>(o&49152)===49152,flagModes:{r:0,"r+":2,w:577,"w+":578,a:1089,"a+":1090},modeStringToFlags:o=>{var i=c.flagModes[o];if(typeof i>"u")throw new Error("Unknown file open mode: "+o);return i},flagsToPermissionString:o=>{var i=["r","w","rw"][o&3];return o&512&&(i+="w"),i},nodePermissions:(o,i)=>c.ignorePermissions?0:i.includes("r")&&!(o.mode&292)||i.includes("w")&&!(o.mode&146)||i.includes("x")&&!(o.mode&73)?2:0,mayLookup:o=>{var i=c.nodePermissions(o,"x");return i||(o.node_ops.lookup?0:2)},mayCreate:(o,i)=>{try{var l=c.lookupNode(o,i);return 20}catch{}return c.nodePermissions(o,"wx")},mayDelete:(o,i,l)=>{var a;try{a=c.lookupNode(o,i)}catch(d){return d.errno}var u=c.nodePermissions(o,"wx");if(u)return u;if(l){if(!c.isDir(a.mode))return 54;if(c.isRoot(a)||c.getPath(a)===c.cwd())return 10}else if(c.isDir(a.mode))return 31;return 0},mayOpen:(o,i)=>o?c.isLink(o.mode)?32:c.isDir(o.mode)&&(c.flagsToPermissionString(i)!=="r"||i&512)?31:c.nodePermissions(o,c.flagsToPermissionString(i)):44,MAX_OPEN_FDS:4096,nextfd:(o=0,i=c.MAX_OPEN_FDS)=>{for(var l=o;l<=i;l++)if(!c.streams[l])return l;throw new c.ErrnoError(33)},getStream:o=>c.streams[o],createStream:(o,i,l)=>{c.FSStream||(c.FSStream=function(){this.shared={}},c.FSStream.prototype={},Object.defineProperties(c.FSStream.prototype,{object:{get:function(){return this.node},set:function(u){this.node=u}},isRead:{get:function(){return(this.flags&2097155)!==1}},isWrite:{get:function(){return(this.flags&2097155)!==0}},isAppend:{get:function(){return this.flags&1024}},flags:{get:function(){return this.shared.flags},set:function(u){this.shared.flags=u}},position:{get:function(){return this.shared.position},set:function(u){this.shared.position=u}}})),o=Object.assign(new c.FSStream,o);var a=c.nextfd(i,l);return o.fd=a,c.streams[a]=o,o},closeStream:o=>{c.streams[o]=null},chrdev_stream_ops:{open:o=>{var i=c.getDevice(o.node.rdev);o.stream_ops=i.stream_ops,o.stream_ops.open&&o.stream_ops.open(o)},llseek:()=>{throw new c.ErrnoError(70)}},major:o=>o>>8,minor:o=>o&255,makedev:(o,i)=>o<<8|i,registerDevice:(o,i)=>{c.devices[o]={stream_ops:i}},getDevice:o=>c.devices[o],getMounts:o=>{for(var i=[],l=[o];l.length;){var a=l.pop();i.push(a),l.push.apply(l,a.mounts)}return i},syncfs:(o,i)=>{typeof o=="function"&&(i=o,o=!1),c.syncFSRequests++,c.syncFSRequests>1&&Et("warning: "+c.syncFSRequests+" FS.syncfs operations in flight at once, probably just doing extra work");var l=c.getMounts(c.root.mount),a=0;function u(N){return c.syncFSRequests--,i(N)}function d(N){if(N)return d.errored?void 0:(d.errored=!0,u(N));++a>=l.length&&u(null)}l.forEach(N=>{if(!N.type.syncfs)return d(null);N.type.syncfs(N,o,d)})},mount:(o,i,l)=>{var a=l==="/",u=!l,d;if(a&&c.root)throw new c.ErrnoError(10);if(!a&&!u){var N=c.lookupPath(l,{follow_mount:!1});if(l=N.path,d=N.node,c.isMountpoint(d))throw new c.ErrnoError(10);if(!c.isDir(d.mode))throw new c.ErrnoError(54)}var S={type:o,opts:i,mountpoint:l,mounts:[]},C=o.mount(S);return C.mount=S,S.root=C,a?c.root=C:d&&(d.mounted=S,d.mount&&d.mount.mounts.push(S)),C},unmount:o=>{var i=c.lookupPath(o,{follow_mount:!1});if(!c.isMountpoint(i.node))throw new c.ErrnoError(28);var l=i.node,a=l.mounted,u=c.getMounts(a);Object.keys(c.nameTable).forEach(N=>{for(var S=c.nameTable[N];S;){var C=S.name_next;u.includes(S.mount)&&c.destroyNode(S),S=C}}),l.mounted=null;var d=l.mount.mounts.indexOf(a);l.mount.mounts.splice(d,1)},lookup:(o,i)=>o.node_ops.lookup(o,i),mknod:(o,i,l)=>{var a=c.lookupPath(o,{parent:!0}),u=a.node,d=Ee.basename(o);if(!d||d==="."||d==="..")throw new c.ErrnoError(28);var N=c.mayCreate(u,d);if(N)throw new c.ErrnoError(N);if(!u.node_ops.mknod)throw new c.ErrnoError(63);return u.node_ops.mknod(u,d,i,l)},create:(o,i)=>(i=i!==void 0?i:438,i&=4095,i|=32768,c.mknod(o,i,0)),mkdir:(o,i)=>(i=i!==void 0?i:511,i&=1023,i|=16384,c.mknod(o,i,0)),mkdirTree:(o,i)=>{for(var l=o.split("/"),a="",u=0;u<l.length;++u)if(l[u]){a+="/"+l[u];try{c.mkdir(a,i)}catch(d){if(d.errno!=20)throw d}}},mkdev:(o,i,l)=>(typeof l>"u"&&(l=i,i=438),i|=8192,c.mknod(o,i,l)),symlink:(o,i)=>{if(!qn.resolve(o))throw new c.ErrnoError(44);var l=c.lookupPath(i,{parent:!0}),a=l.node;if(!a)throw new c.ErrnoError(44);var u=Ee.basename(i),d=c.mayCreate(a,u);if(d)throw new c.ErrnoError(d);if(!a.node_ops.symlink)throw new c.ErrnoError(63);return a.node_ops.symlink(a,u,o)},rename:(o,i)=>{var l=Ee.dirname(o),a=Ee.dirname(i),u=Ee.basename(o),d=Ee.basename(i),N,S,C;if(N=c.lookupPath(o,{parent:!0}),S=N.node,N=c.lookupPath(i,{parent:!0}),C=N.node,!S||!C)throw new c.ErrnoError(44);if(S.mount!==C.mount)throw new c.ErrnoError(75);var V=c.lookupNode(S,u),J=qn.relative(o,a);if(J.charAt(0)!==".")throw new c.ErrnoError(28);if(J=qn.relative(i,l),J.charAt(0)!==".")throw new c.ErrnoError(55);var ie;try{ie=c.lookupNode(C,d)}catch{}if(V!==ie){var k=c.isDir(V.mode),m=c.mayDelete(S,u,k);if(m)throw new c.ErrnoError(m);if(m=ie?c.mayDelete(C,d,k):c.mayCreate(C,d),m)throw new c.ErrnoError(m);if(!S.node_ops.rename)throw new c.ErrnoError(63);if(c.isMountpoint(V)||ie&&c.isMountpoint(ie))throw new c.ErrnoError(10);if(C!==S&&(m=c.nodePermissions(S,"w"),m))throw new c.ErrnoError(m);c.hashRemoveNode(V);try{S.node_ops.rename(V,C,d)}catch(y){throw y}finally{c.hashAddNode(V)}}},rmdir:o=>{var i=c.lookupPath(o,{parent:!0}),l=i.node,a=Ee.basename(o),u=c.lookupNode(l,a),d=c.mayDelete(l,a,!0);if(d)throw new c.ErrnoError(d);if(!l.node_ops.rmdir)throw new c.ErrnoError(63);if(c.isMountpoint(u))throw new c.ErrnoError(10);l.node_ops.rmdir(l,a),c.destroyNode(u)},readdir:o=>{var i=c.lookupPath(o,{follow:!0}),l=i.node;if(!l.node_ops.readdir)throw new c.ErrnoError(54);return l.node_ops.readdir(l)},unlink:o=>{var i=c.lookupPath(o,{parent:!0}),l=i.node;if(!l)throw new c.ErrnoError(44);var a=Ee.basename(o),u=c.lookupNode(l,a),d=c.mayDelete(l,a,!1);if(d)throw new c.ErrnoError(d);if(!l.node_ops.unlink)throw new c.ErrnoError(63);if(c.isMountpoint(u))throw new c.ErrnoError(10);l.node_ops.unlink(l,a),c.destroyNode(u)},readlink:o=>{var i=c.lookupPath(o),l=i.node;if(!l)throw new c.ErrnoError(44);if(!l.node_ops.readlink)throw new c.ErrnoError(28);return qn.resolve(c.getPath(l.parent),l.node_ops.readlink(l))},stat:(o,i)=>{var l=c.lookupPath(o,{follow:!i}),a=l.node;if(!a)throw new c.ErrnoError(44);if(!a.node_ops.getattr)throw new c.ErrnoError(63);return a.node_ops.getattr(a)},lstat:o=>c.stat(o,!0),chmod:(o,i,l)=>{var a;if(typeof o=="string"){var u=c.lookupPath(o,{follow:!l});a=u.node}else a=o;if(!a.node_ops.setattr)throw new c.ErrnoError(63);a.node_ops.setattr(a,{mode:i&4095|a.mode&-4096,timestamp:Date.now()})},lchmod:(o,i)=>{c.chmod(o,i,!0)},fchmod:(o,i)=>{var l=c.getStream(o);if(!l)throw new c.ErrnoError(8);c.chmod(l.node,i)},chown:(o,i,l,a)=>{var u;if(typeof o=="string"){var d=c.lookupPath(o,{follow:!a});u=d.node}else u=o;if(!u.node_ops.setattr)throw new c.ErrnoError(63);u.node_ops.setattr(u,{timestamp:Date.now()})},lchown:(o,i,l)=>{c.chown(o,i,l,!0)},fchown:(o,i,l)=>{var a=c.getStream(o);if(!a)throw new c.ErrnoError(8);c.chown(a.node,i,l)},truncate:(o,i)=>{if(i<0)throw new c.ErrnoError(28);var l;if(typeof o=="string"){var a=c.lookupPath(o,{follow:!0});l=a.node}else l=o;if(!l.node_ops.setattr)throw new c.ErrnoError(63);if(c.isDir(l.mode))throw new c.ErrnoError(31);if(!c.isFile(l.mode))throw new c.ErrnoError(28);var u=c.nodePermissions(l,"w");if(u)throw new c.ErrnoError(u);l.node_ops.setattr(l,{size:i,timestamp:Date.now()})},ftruncate:(o,i)=>{var l=c.getStream(o);if(!l)throw new c.ErrnoError(8);if(!(l.flags&2097155))throw new c.ErrnoError(28);c.truncate(l.node,i)},utime:(o,i,l)=>{var a=c.lookupPath(o,{follow:!0}),u=a.node;u.node_ops.setattr(u,{timestamp:Math.max(i,l)})},open:(o,i,l)=>{if(o==="")throw new c.ErrnoError(44);i=typeof i=="string"?c.modeStringToFlags(i):i,l=typeof l>"u"?438:l,i&64?l=l&4095|32768:l=0;var a;if(typeof o=="object")a=o;else{o=Ee.normalize(o);try{var u=c.lookupPath(o,{follow:!(i&131072)});a=u.node}catch{}}var d=!1;if(i&64)if(a){if(i&128)throw new c.ErrnoError(20)}else a=c.mknod(o,l,0),d=!0;if(!a)throw new c.ErrnoError(44);if(c.isChrdev(a.mode)&&(i&=-513),i&65536&&!c.isDir(a.mode))throw new c.ErrnoError(54);if(!d){var N=c.mayOpen(a,i);if(N)throw new c.ErrnoError(N)}i&512&&!d&&c.truncate(a,0),i&=-131713;var S=c.createStream({node:a,path:c.getPath(a),flags:i,seekable:!0,position:0,stream_ops:a.stream_ops,ungotten:[],error:!1});return S.stream_ops.open&&S.stream_ops.open(S),n.logReadFiles&&!(i&1)&&(c.readFiles||(c.readFiles={}),o in c.readFiles||(c.readFiles[o]=1)),S},close:o=>{if(c.isClosed(o))throw new c.ErrnoError(8);o.getdents&&(o.getdents=null);try{o.stream_ops.close&&o.stream_ops.close(o)}catch(i){throw i}finally{c.closeStream(o.fd)}o.fd=null},isClosed:o=>o.fd===null,llseek:(o,i,l)=>{if(c.isClosed(o))throw new c.ErrnoError(8);if(!o.seekable||!o.stream_ops.llseek)throw new c.ErrnoError(70);if(l!=0&&l!=1&&l!=2)throw new c.ErrnoError(28);return o.position=o.stream_ops.llseek(o,i,l),o.ungotten=[],o.position},read:(o,i,l,a,u)=>{if(a<0||u<0)throw new c.ErrnoError(28);if(c.isClosed(o))throw new c.ErrnoError(8);if((o.flags&2097155)===1)throw new c.ErrnoError(8);if(c.isDir(o.node.mode))throw new c.ErrnoError(31);if(!o.stream_ops.read)throw new c.ErrnoError(28);var d=typeof u<"u";if(!d)u=o.position;else if(!o.seekable)throw new c.ErrnoError(70);var N=o.stream_ops.read(o,i,l,a,u);return d||(o.position+=N),N},write:(o,i,l,a,u,d)=>{if(a<0||u<0)throw new c.ErrnoError(28);if(c.isClosed(o))throw new c.ErrnoError(8);if(!(o.flags&2097155))throw new c.ErrnoError(8);if(c.isDir(o.node.mode))throw new c.ErrnoError(31);if(!o.stream_ops.write)throw new c.ErrnoError(28);o.seekable&&o.flags&1024&&c.llseek(o,0,2);var N=typeof u<"u";if(!N)u=o.position;else if(!o.seekable)throw new c.ErrnoError(70);var S=o.stream_ops.write(o,i,l,a,u,d);return N||(o.position+=S),S},allocate:(o,i,l)=>{if(c.isClosed(o))throw new c.ErrnoError(8);if(i<0||l<=0)throw new c.ErrnoError(28);if(!(o.flags&2097155))throw new c.ErrnoError(8);if(!c.isFile(o.node.mode)&&!c.isDir(o.node.mode))throw new c.ErrnoError(43);if(!o.stream_ops.allocate)throw new c.ErrnoError(138);o.stream_ops.allocate(o,i,l)},mmap:(o,i,l,a,u)=>{if(a&2&&!(u&2)&&(o.flags&2097155)!==2)throw new c.ErrnoError(2);if((o.flags&2097155)===1)throw new c.ErrnoError(2);if(!o.stream_ops.mmap)throw new c.ErrnoError(43);return o.stream_ops.mmap(o,i,l,a,u)},msync:(o,i,l,a,u)=>o.stream_ops.msync?o.stream_ops.msync(o,i,l,a,u):0,munmap:o=>0,ioctl:(o,i,l)=>{if(!o.stream_ops.ioctl)throw new c.ErrnoError(59);return o.stream_ops.ioctl(o,i,l)},readFile:(o,i={})=>{if(i.flags=i.flags||0,i.encoding=i.encoding||"binary",i.encoding!=="utf8"&&i.encoding!=="binary")throw new Error('Invalid encoding type "'+i.encoding+'"');var l,a=c.open(o,i.flags),u=c.stat(o),d=u.size,N=new Uint8Array(d);return c.read(a,N,0,d,0),i.encoding==="utf8"?l=Wr(N,0):i.encoding==="binary"&&(l=N),c.close(a),l},writeFile:(o,i,l={})=>{l.flags=l.flags||577;var a=c.open(o,l.flags,l.mode);if(typeof i=="string"){var u=new Uint8Array(Ei(i)+1),d=Ls(i,u,0,u.length);c.write(a,u,0,d,void 0,l.canOwn)}else if(ArrayBuffer.isView(i))c.write(a,i,0,i.byteLength,void 0,l.canOwn);else throw new Error("Unsupported data type");c.close(a)},cwd:()=>c.currentPath,chdir:o=>{var i=c.lookupPath(o,{follow:!0});if(i.node===null)throw new c.ErrnoError(44);if(!c.isDir(i.node.mode))throw new c.ErrnoError(54);var l=c.nodePermissions(i.node,"x");if(l)throw new c.ErrnoError(l);c.currentPath=i.path},createDefaultDirectories:()=>{c.mkdir("/tmp"),c.mkdir("/home"),c.mkdir("/home/web_user")},createDefaultDevices:()=>{c.mkdir("/dev"),c.registerDevice(c.makedev(1,3),{read:()=>0,write:(i,l,a,u,d)=>u}),c.mkdev("/dev/null",c.makedev(1,3)),er.register(c.makedev(5,0),er.default_tty_ops),er.register(c.makedev(6,0),er.default_tty1_ops),c.mkdev("/dev/tty",c.makedev(5,0)),c.mkdev("/dev/tty1",c.makedev(6,0));var o=bc();c.createDevice("/dev","random",o),c.createDevice("/dev","urandom",o),c.mkdir("/dev/shm"),c.mkdir("/dev/shm/tmp")},createSpecialDirectories:()=>{c.mkdir("/proc");var o=c.mkdir("/proc/self");c.mkdir("/proc/self/fd"),c.mount({mount:()=>{var i=c.createNode(o,"fd",16895,73);return i.node_ops={lookup:(l,a)=>{var u=+a,d=c.getStream(u);if(!d)throw new c.ErrnoError(8);var N={parent:null,mount:{mountpoint:"fake"},node_ops:{readlink:()=>d.path}};return N.parent=N,N}},i}},{},"/proc/self/fd")},createStandardStreams:()=>{n.stdin?c.createDevice("/dev","stdin",n.stdin):c.symlink("/dev/tty","/dev/stdin"),n.stdout?c.createDevice("/dev","stdout",null,n.stdout):c.symlink("/dev/tty","/dev/stdout"),n.stderr?c.createDevice("/dev","stderr",null,n.stderr):c.symlink("/dev/tty1","/dev/stderr"),c.open("/dev/stdin",0),c.open("/dev/stdout",1),c.open("/dev/stderr",1)},ensureErrnoError:()=>{c.ErrnoError||(c.ErrnoError=function(i,l){this.node=l,this.setErrno=function(a){this.errno=a},this.setErrno(i),this.message="FS error"},c.ErrnoError.prototype=new Error,c.ErrnoError.prototype.constructor=c.ErrnoError,[44].forEach(o=>{c.genericErrors[o]=new c.ErrnoError(o),c.genericErrors[o].stack="<generic error, no stack>"}))},staticInit:()=>{c.ensureErrnoError(),c.nameTable=new Array(4096),c.mount(he,{},"/"),c.createDefaultDirectories(),c.createDefaultDevices(),c.createSpecialDirectories(),c.filesystems={MEMFS:he}},init:(o,i,l)=>{c.init.initialized=!0,c.ensureErrnoError(),n.stdin=o||n.stdin,n.stdout=i||n.stdout,n.stderr=l||n.stderr,c.createStandardStreams()},quit:()=>{c.init.initialized=!1;for(var o=0;o<c.streams.length;o++){var i=c.streams[o];i&&c.close(i)}},getMode:(o,i)=>{var l=0;return o&&(l|=365),i&&(l|=146),l},findObject:(o,i)=>{var l=c.analyzePath(o,i);return l.exists?l.object:null},analyzePath:(o,i)=>{try{var l=c.lookupPath(o,{follow:!i});o=l.path}catch{}var a={isRoot:!1,exists:!1,error:0,name:null,path:null,object:null,parentExists:!1,parentPath:null,parentObject:null};try{var l=c.lookupPath(o,{parent:!0});a.parentExists=!0,a.parentPath=l.path,a.parentObject=l.node,a.name=Ee.basename(o),l=c.lookupPath(o,{follow:!i}),a.exists=!0,a.path=l.path,a.object=l.node,a.name=l.node.name,a.isRoot=l.path==="/"}catch(u){a.error=u.errno}return a},createPath:(o,i,l,a)=>{o=typeof o=="string"?o:c.getPath(o);for(var u=i.split("/").reverse();u.length;){var d=u.pop();if(d){var N=Ee.join2(o,d);try{c.mkdir(N)}catch{}o=N}}return N},createFile:(o,i,l,a,u)=>{var d=Ee.join2(typeof o=="string"?o:c.getPath(o),i),N=c.getMode(a,u);return c.create(d,N)},createDataFile:(o,i,l,a,u,d)=>{var N=i;o&&(o=typeof o=="string"?o:c.getPath(o),N=i?Ee.join2(o,i):o);var S=c.getMode(a,u),C=c.create(N,S);if(l){if(typeof l=="string"){for(var V=new Array(l.length),J=0,ie=l.length;J<ie;++J)V[J]=l.charCodeAt(J);l=V}c.chmod(C,S|146);var k=c.open(C,577);c.write(k,l,0,l.length,0,d),c.close(k),c.chmod(C,S)}return C},createDevice:(o,i,l,a)=>{var u=Ee.join2(typeof o=="string"?o:c.getPath(o),i),d=c.getMode(!!l,!!a);c.createDevice.major||(c.createDevice.major=64);var N=c.makedev(c.createDevice.major++,0);return c.registerDevice(N,{open:S=>{S.seekable=!1},close:S=>{a&&a.buffer&&a.buffer.length&&a(10)},read:(S,C,V,J,ie)=>{for(var k=0,m=0;m<J;m++){var y;try{y=l()}catch{throw new c.ErrnoError(29)}if(y===void 0&&k===0)throw new c.ErrnoError(6);if(y==null)break;k++,C[V+m]=y}return k&&(S.node.timestamp=Date.now()),k},write:(S,C,V,J,ie)=>{for(var k=0;k<J;k++)try{a(C[V+k])}catch{throw new c.ErrnoError(29)}return J&&(S.node.timestamp=Date.now()),k}}),c.mkdev(u,d,N)},forceLoadFile:o=>{if(o.isDevice||o.isFolder||o.link||o.contents)return!0;if(typeof XMLHttpRequest<"u")throw new Error("Lazy loading should have been performed (contents set) in createLazyFile, but it was not. Lazy loading only works in web workers. Use --embed-file or --preload-file in emcc on the main thread.");if(Qe)try{o.contents=mo(Qe(o.url),!0),o.usedBytes=o.contents.length}catch{throw new c.ErrnoError(29)}else throw new Error("Cannot load without read() or XMLHttpRequest.")},createLazyFile:(o,i,l,a,u)=>{function d(){this.lengthKnown=!1,this.chunks=[]}if(d.prototype.get=function(m){if(!(m>this.length-1||m<0)){var y=m%this.chunkSize,x=m/this.chunkSize|0;return this.getter(x)[y]}},d.prototype.setDataGetter=function(m){this.getter=m},d.prototype.cacheLength=function(){var m=new XMLHttpRequest;if(m.open("HEAD",l,!1),m.send(null),!(m.status>=200&&m.status<300||m.status===304))throw new Error("Couldn't load "+l+". Status: "+m.status);var y=Number(m.getResponseHeader("Content-length")),x,E=(x=m.getResponseHeader("Accept-Ranges"))&&x==="bytes",b=(x=m.getResponseHeader("Content-Encoding"))&&x==="gzip",P=1024*1024;E||(P=y);var M=(D,le)=>{if(D>le)throw new Error("invalid range ("+D+", "+le+") or no bytes requested!");if(le>y-1)throw new Error("only "+y+" bytes available! programmer error!");var z=new XMLHttpRequest;if(z.open("GET",l,!1),y!==P&&z.setRequestHeader("Range","bytes="+D+"-"+le),z.responseType="arraybuffer",z.overrideMimeType&&z.overrideMimeType("text/plain; charset=x-user-defined"),z.send(null),!(z.status>=200&&z.status<300||z.status===304))throw new Error("Couldn't load "+l+". Status: "+z.status);return z.response!==void 0?new Uint8Array(z.response||[]):mo(z.responseText||"",!0)},B=this;B.setDataGetter(D=>{var le=D*P,z=(D+1)*P-1;if(z=Math.min(z,y-1),typeof B.chunks[D]>"u"&&(B.chunks[D]=M(le,z)),typeof B.chunks[D]>"u")throw new Error("doXHR failed!");return B.chunks[D]}),(b||!y)&&(P=y=1,y=this.getter(0).length,P=y,wn("LazyFiles on gzip forces download of the whole file when length is accessed")),this._length=y,this._chunkSize=P,this.lengthKnown=!0},typeof XMLHttpRequest<"u"){if(!rt)throw"Cannot do synchronous binary XHRs outside webworkers in modern browsers. Use --embed-file or --preload-file in emcc";var N=new d;Object.defineProperties(N,{length:{get:function(){return this.lengthKnown||this.cacheLength(),this._length}},chunkSize:{get:function(){return this.lengthKnown||this.cacheLength(),this._chunkSize}}});var S={isDevice:!1,contents:N}}else var S={isDevice:!1,url:l};var C=c.createFile(o,i,S,a,u);S.contents?C.contents=S.contents:S.url&&(C.contents=null,C.url=S.url),Object.defineProperties(C,{usedBytes:{get:function(){return this.contents.length}}});var V={},J=Object.keys(C.stream_ops);J.forEach(k=>{var m=C.stream_ops[k];V[k]=function(){return c.forceLoadFile(C),m.apply(null,arguments)}});function ie(k,m,y,x,E){var b=k.node.contents;if(E>=b.length)return 0;var P=Math.min(b.length-E,x);if(b.slice)for(var M=0;M<P;M++)m[y+M]=b[E+M];else for(var M=0;M<P;M++)m[y+M]=b.get(E+M);return P}return V.read=(k,m,y,x,E)=>(c.forceLoadFile(C),ie(k,m,y,x,E)),V.mmap=(k,m,y,x,E)=>{c.forceLoadFile(C);var b=Ga();if(!b)throw new c.ErrnoError(48);return ie(k,Dt,b,m,y),{ptr:b,allocated:!0}},C.stream_ops=V,C},createPreloadedFile:(o,i,l,a,u,d,N,S,C,V)=>{var J=i?qn.resolve(Ee.join2(o,i)):o;function ie(k){function m(y){V&&V(),S||c.createDataFile(o,i,y,a,u,C),d&&d(),Ds()}Browser.handledByPreloadPlugin(k,J,m,()=>{N&&N(),Ds()})||m(k)}po(),typeof l=="string"?Nc(l,k=>ie(k),N):ie(l)},indexedDB:()=>window.indexedDB||window.mozIndexedDB||window.webkitIndexedDB||window.msIndexedDB,DB_NAME:()=>"EM_FS_"+window.location.pathname,DB_VERSION:20,DB_STORE_NAME:"FILE_DATA",saveFilesToDB:(o,i,l)=>{i=i||(()=>{}),l=l||(()=>{});var a=c.indexedDB();try{var u=a.open(c.DB_NAME(),c.DB_VERSION)}catch(d){return l(d)}u.onupgradeneeded=()=>{wn("creating db");var d=u.result;d.createObjectStore(c.DB_STORE_NAME)},u.onsuccess=()=>{var d=u.result,N=d.transaction([c.DB_STORE_NAME],"readwrite"),S=N.objectStore(c.DB_STORE_NAME),C=0,V=0,J=o.length;function ie(){V==0?i():l()}o.forEach(k=>{var m=S.put(c.analyzePath(k).object.contents,k);m.onsuccess=()=>{C++,C+V==J&&ie()},m.onerror=()=>{V++,C+V==J&&ie()}}),N.onerror=l},u.onerror=l},loadFilesFromDB:(o,i,l)=>{i=i||(()=>{}),l=l||(()=>{});var a=c.indexedDB();try{var u=a.open(c.DB_NAME(),c.DB_VERSION)}catch(d){return l(d)}u.onupgradeneeded=l,u.onsuccess=()=>{var d=u.result;try{var N=d.transaction([c.DB_STORE_NAME],"readonly")}catch(k){l(k);return}var S=N.objectStore(c.DB_STORE_NAME),C=0,V=0,J=o.length;function ie(){V==0?i():l()}o.forEach(k=>{var m=S.get(k);m.onsuccess=()=>{c.analyzePath(k).exists&&c.unlink(k),c.createDataFile(Ee.dirname(k),Ee.basename(k),m.result,!0,!0,!0),C++,C+V==J&&ie()},m.onerror=()=>{V++,C+V==J&&ie()}}),N.onerror=l},u.onerror=l}},fe={DEFAULT_POLLMASK:5,calculateAt:function(o,i,l){if(Ee.isAbs(i))return i;var a;if(o===-100)a=c.cwd();else{var u=fe.getStreamFromFD(o);a=u.path}if(i.length==0){if(!l)throw new c.ErrnoError(44);return a}return Ee.join2(a,i)},doStat:function(o,i,l){try{var a=o(i)}catch(S){if(S&&S.node&&Ee.normalize(i)!==Ee.normalize(c.getPath(S.node)))return-54;throw S}we[l>>2]=a.dev,we[l+8>>2]=a.ino,we[l+12>>2]=a.mode,it[l+16>>2]=a.nlink,we[l+20>>2]=a.uid,we[l+24>>2]=a.gid,we[l+28>>2]=a.rdev,ut=[a.size>>>0,(qe=a.size,+Math.abs(qe)>=1?qe>0?(Math.min(+Math.floor(qe/4294967296),4294967295)|0)>>>0:~~+Math.ceil((qe-+(~~qe>>>0))/4294967296)>>>0:0)],we[l+40>>2]=ut[0],we[l+44>>2]=ut[1],we[l+48>>2]=4096,we[l+52>>2]=a.blocks;var u=a.atime.getTime(),d=a.mtime.getTime(),N=a.ctime.getTime();return ut=[Math.floor(u/1e3)>>>0,(qe=Math.floor(u/1e3),+Math.abs(qe)>=1?qe>0?(Math.min(+Math.floor(qe/4294967296),4294967295)|0)>>>0:~~+Math.ceil((qe-+(~~qe>>>0))/4294967296)>>>0:0)],we[l+56>>2]=ut[0],we[l+60>>2]=ut[1],it[l+64>>2]=u%1e3*1e3,ut=[Math.floor(d/1e3)>>>0,(qe=Math.floor(d/1e3),+Math.abs(qe)>=1?qe>0?(Math.min(+Math.floor(qe/4294967296),4294967295)|0)>>>0:~~+Math.ceil((qe-+(~~qe>>>0))/4294967296)>>>0:0)],we[l+72>>2]=ut[0],we[l+76>>2]=ut[1],it[l+80>>2]=d%1e3*1e3,ut=[Math.floor(N/1e3)>>>0,(qe=Math.floor(N/1e3),+Math.abs(qe)>=1?qe>0?(Math.min(+Math.floor(qe/4294967296),4294967295)|0)>>>0:~~+Math.ceil((qe-+(~~qe>>>0))/4294967296)>>>0:0)],we[l+88>>2]=ut[0],we[l+92>>2]=ut[1],it[l+96>>2]=N%1e3*1e3,ut=[a.ino>>>0,(qe=a.ino,+Math.abs(qe)>=1?qe>0?(Math.min(+Math.floor(qe/4294967296),4294967295)|0)>>>0:~~+Math.ceil((qe-+(~~qe>>>0))/4294967296)>>>0:0)],we[l+104>>2]=ut[0],we[l+108>>2]=ut[1],0},doMsync:function(o,i,l,a,u){if(!c.isFile(i.node.mode))throw new c.ErrnoError(43);if(a&2)return 0;var d=Si.slice(o,o+l);c.msync(i,d,u,l,a)},varargs:void 0,get:function(){fe.varargs+=4;var o=we[fe.varargs-4>>2];return o},getStr:function(o){var i=dc(o);return i},getStreamFromFD:function(o){var i=c.getStream(o);if(!i)throw new c.ErrnoError(8);return i}};function vc(o,i){try{return o=fe.getStr(o),c.chmod(o,i),0}catch(l){if(typeof c>"u"||!(l instanceof c.ErrnoError))throw l;return-l.errno}}function xc(o,i,l,a){try{if(i=fe.getStr(i),i=fe.calculateAt(o,i),l&-8)return-28;var u=c.lookupPath(i,{follow:!0}),d=u.node;if(!d)return-44;var N="";return l&4&&(N+="r"),l&2&&(N+="w"),l&1&&(N+="x"),N&&c.nodePermissions(d,N)?-2:0}catch(S){if(typeof c>"u"||!(S instanceof c.ErrnoError))throw S;return-S.errno}}function Ec(o,i){try{return c.fchmod(o,i),0}catch(l){if(typeof c>"u"||!(l instanceof c.ErrnoError))throw l;return-l.errno}}function Sc(o,i,l){try{return c.fchown(o,i,l),0}catch(a){if(typeof c>"u"||!(a instanceof c.ErrnoError))throw a;return-a.errno}}function kc(o){return we[el()>>2]=o,o}function Ic(o,i,l){fe.varargs=l;try{var a=fe.getStreamFromFD(o);switch(i){case 0:{var u=fe.get();if(u<0)return-28;var d;return d=c.createStream(a,u),d.fd}case 1:case 2:return 0;case 3:return a.flags;case 4:{var u=fe.get();return a.flags|=u,0}case 5:{var u=fe.get(),N=0;return Ma[u+N>>1]=2,0}case 6:case 7:return 0;case 16:case 8:return-28;case 9:return kc(28),-1;default:return-28}}catch(S){if(typeof c>"u"||!(S instanceof c.ErrnoError))throw S;return-S.errno}}function Oc(o,i){try{var l=fe.getStreamFromFD(o);return fe.doStat(c.stat,l.path,i)}catch(a){if(typeof c>"u"||!(a instanceof c.ErrnoError))throw a;return-a.errno}}var Ac=9007199254740992,Tc=-9007199254740992;function Ja(o){return o<Tc||o>Ac?NaN:Number(o)}function Cc(o,i){try{return i=Ja(i),isNaN(i)?-61:(c.ftruncate(o,i),0)}catch(l){if(typeof c>"u"||!(l instanceof c.ErrnoError))throw l;return-l.errno}}function Wc(o,i){try{if(i===0)return-28;var l=c.cwd(),a=Ei(l)+1;return i<a?-68:(Ba(l,o,i),a)}catch(u){if(typeof c>"u"||!(u instanceof c.ErrnoError))throw u;return-u.errno}}function Fc(o,i,l){fe.varargs=l;try{var a=fe.getStreamFromFD(o);switch(i){case 21509:case 21505:return a.tty?0:-59;case 21510:case 21511:case 21512:case 21506:case 21507:case 21508:return a.tty?0:-59;case 21519:{if(!a.tty)return-59;var u=fe.get();return we[u>>2]=0,0}case 21520:return a.tty?-28:-59;case 21531:{var u=fe.get();return c.ioctl(a,i,u)}case 21523:return a.tty?0:-59;case 21524:return a.tty?0:-59;default:return-28}}catch(d){if(typeof c>"u"||!(d instanceof c.ErrnoError))throw d;return-d.errno}}function Pc(o,i){try{return o=fe.getStr(o),fe.doStat(c.lstat,o,i)}catch(l){if(typeof c>"u"||!(l instanceof c.ErrnoError))throw l;return-l.errno}}function Lc(o,i,l){try{return i=fe.getStr(i),i=fe.calculateAt(o,i),i=Ee.normalize(i),i[i.length-1]==="/"&&(i=i.substr(0,i.length-1)),c.mkdir(i,l,0),0}catch(a){if(typeof c>"u"||!(a instanceof c.ErrnoError))throw a;return-a.errno}}function Dc(o,i,l,a){try{i=fe.getStr(i);var u=a&256,d=a&4096;return a=a&-6401,i=fe.calculateAt(o,i,d),fe.doStat(u?c.lstat:c.stat,i,l)}catch(N){if(typeof c>"u"||!(N instanceof c.ErrnoError))throw N;return-N.errno}}function Rc(o,i,l,a){fe.varargs=a;try{i=fe.getStr(i),i=fe.calculateAt(o,i);var u=a?fe.get():0;return c.open(i,l,u).fd}catch(d){if(typeof c>"u"||!(d instanceof c.ErrnoError))throw d;return-d.errno}}function Bc(o,i,l,a){try{if(i=fe.getStr(i),i=fe.calculateAt(o,i),a<=0)return-28;var u=c.readlink(i),d=Math.min(a,Ei(u)),N=Dt[l+d];return Ba(u,l,a+1),Dt[l+d]=N,d}catch(S){if(typeof c>"u"||!(S instanceof c.ErrnoError))throw S;return-S.errno}}function Mc(o){try{return o=fe.getStr(o),c.rmdir(o),0}catch(i){if(typeof c>"u"||!(i instanceof c.ErrnoError))throw i;return-i.errno}}function Uc(o,i){try{return o=fe.getStr(o),fe.doStat(c.stat,o,i)}catch(l){if(typeof c>"u"||!(l instanceof c.ErrnoError))throw l;return-l.errno}}function jc(o,i,l){try{return i=fe.getStr(i),i=fe.calculateAt(o,i),l===0?c.unlink(i):l===512?c.rmdir(i):Zn("Invalid flags passed to unlinkat"),0}catch(a){if(typeof c>"u"||!(a instanceof c.ErrnoError))throw a;return-a.errno}}function yo(o){return it[o>>2]+we[o+4>>2]*4294967296}function Qc(o,i,l,a){try{if(i=fe.getStr(i),i=fe.calculateAt(o,i,!0),l){var N=yo(l),S=we[l+8>>2];u=N*1e3+S/(1e3*1e3),l+=16,N=yo(l),S=we[l+8>>2],d=N*1e3+S/(1e3*1e3)}else var u=Date.now(),d=u;return c.utime(i,u,d),0}catch(C){if(typeof c>"u"||!(C instanceof c.ErrnoError))throw C;return-C.errno}}var zc=!0;function Vc(){return zc}function Hc(o){return o%4===0&&(o%100!==0||o%400===0)}var $c=[0,31,60,91,121,152,182,213,244,274,305,335],Gc=[0,31,59,90,120,151,181,212,243,273,304,334];function Jc(o){var i=Hc(o.getFullYear()),l=i?$c:Gc,a=l[o.getMonth()]+o.getDate()-1;return a}function Kc(o,i){var l=new Date(yo(o)*1e3);we[i>>2]=l.getSeconds(),we[i+4>>2]=l.getMinutes(),we[i+8>>2]=l.getHours(),we[i+12>>2]=l.getDate(),we[i+16>>2]=l.getMonth(),we[i+20>>2]=l.getFullYear()-1900,we[i+24>>2]=l.getDay();var a=Jc(l)|0;we[i+28>>2]=a,we[i+36>>2]=-(l.getTimezoneOffset()*60);var u=new Date(l.getFullYear(),0,1),d=new Date(l.getFullYear(),6,1).getTimezoneOffset(),N=u.getTimezoneOffset(),S=(d!=N&&l.getTimezoneOffset()==Math.min(N,d))|0;we[i+32>>2]=S}function Ka(o){var i=Ei(o)+1,l=tl(i);return l&&Ls(o,Dt,l,i),l}function Xc(o,i,l){var a=new Date().getFullYear(),u=new Date(a,0,1),d=new Date(a,6,1),N=u.getTimezoneOffset(),S=d.getTimezoneOffset(),C=Math.max(N,S);it[o>>2]=C*60,we[i>>2]=+(N!=S);function V(y){var x=y.toTimeString().match(/\(([A-Za-z ]+)\)$/);return x?x[1]:"GMT"}var J=V(u),ie=V(d),k=Ka(J),m=Ka(ie);S<N?(it[l>>2]=k,it[l+4>>2]=m):(it[l>>2]=m,it[l+4>>2]=k)}function Yc(){return Date.now()}var Xa;Xa=()=>performance.now();function Zc(){return 2147483648}function ed(o){var i=Fn.buffer;try{return Fn.grow(o-i.byteLength+65535>>>16),Ua(),1}catch{}}function td(o){var i=Si.length;o=o>>>0;var l=Zc();if(o>l)return!1;let a=(C,V)=>C+(V-C%V)%V;for(var u=1;u<=4;u*=2){var d=i*(1+.2/u);d=Math.min(d,o+100663296);var N=Math.min(l,a(Math.max(o,d),65536)),S=ed(N);if(S)return!0}return!1}var go={};function nd(){return At||"./this.program"}function Ii(){if(!Ii.strings){var o=(typeof navigator=="object"&&navigator.languages&&navigator.languages[0]||"C").replace("-","_")+".UTF-8",i={USER:"web_user",LOGNAME:"web_user",PATH:"/",PWD:"/",HOME:"/home/web_user",LANG:o,_:nd()};for(var l in go)go[l]===void 0?delete i[l]:i[l]=go[l];var a=[];for(var l in i)a.push(l+"="+i[l]);Ii.strings=a}return Ii.strings}function rd(o,i,l){for(var a=0;a<o.length;++a)Dt[i++>>0]=o.charCodeAt(a);l||(Dt[i>>0]=0)}function id(o,i){var l=0;return Ii().forEach(function(a,u){var d=i+l;it[o+u*4>>2]=d,rd(a,d),l+=a.length+1}),0}function sd(o,i){var l=Ii();it[o>>2]=l.length;var a=0;return l.forEach(function(u){a+=u.length+1}),it[i>>2]=a,0}function od(o){try{var i=fe.getStreamFromFD(o);return c.close(i),0}catch(l){if(typeof c>"u"||!(l instanceof c.ErrnoError))throw l;return l.errno}}function ad(o,i){try{var l=fe.getStreamFromFD(o),a=l.tty?2:c.isDir(l.mode)?3:c.isLink(l.mode)?7:4;return Dt[i>>0]=a,0}catch(u){if(typeof c>"u"||!(u instanceof c.ErrnoError))throw u;return u.errno}}function ld(o,i,l,a){for(var u=0,d=0;d<l;d++){var N=it[i>>2],S=it[i+4>>2];i+=8;var C=c.read(o,Dt,N,S,a);if(C<0)return-1;if(u+=C,C<S)break;typeof a<"u"&&(a+=C)}return u}function ud(o,i,l,a){try{var u=fe.getStreamFromFD(o),d=ld(u,i,l);return it[a>>2]=d,0}catch(N){if(typeof c>"u"||!(N instanceof c.ErrnoError))throw N;return N.errno}}function cd(o,i,l,a){try{if(i=Ja(i),isNaN(i))return 61;var u=fe.getStreamFromFD(o);return c.llseek(u,i,l),ut=[u.position>>>0,(qe=u.position,+Math.abs(qe)>=1?qe>0?(Math.min(+Math.floor(qe/4294967296),4294967295)|0)>>>0:~~+Math.ceil((qe-+(~~qe>>>0))/4294967296)>>>0:0)],we[a>>2]=ut[0],we[a+4>>2]=ut[1],u.getdents&&i===0&&l===0&&(u.getdents=null),0}catch(d){if(typeof c>"u"||!(d instanceof c.ErrnoError))throw d;return d.errno}}function dd(o){try{var i=fe.getStreamFromFD(o);return i.stream_ops&&i.stream_ops.fsync?i.stream_ops.fsync(i):0}catch(l){if(typeof c>"u"||!(l instanceof c.ErrnoError))throw l;return l.errno}}function fd(o,i,l,a){for(var u=0,d=0;d<l;d++){var N=it[i>>2],S=it[i+4>>2];i+=8;var C=c.write(o,Dt,N,S,a);if(C<0)return-1;u+=C,typeof a<"u"&&(a+=C)}return u}function hd(o,i,l,a){try{var u=fe.getStreamFromFD(o),d=fd(u,i,l);return it[a>>2]=d,0}catch(N){if(typeof c>"u"||!(N instanceof c.ErrnoError))throw N;return N.errno}}var Ya=function(o,i,l,a){o||(o=this),this.parent=o,this.mount=o.mount,this.mounted=null,this.id=c.nextInode++,this.name=i,this.mode=l,this.node_ops={},this.stream_ops={},this.rdev=a},Rs=365,Bs=146;Object.defineProperties(Ya.prototype,{read:{get:function(){return(this.mode&Rs)===Rs},set:function(o){o?this.mode|=Rs:this.mode&=~Rs}},write:{get:function(){return(this.mode&Bs)===Bs},set:function(o){o?this.mode|=Bs:this.mode&=~Bs}},isFolder:{get:function(){return c.isDir(this.mode)}},isDevice:{get:function(){return c.isChrdev(this.mode)}}}),c.FSNode=Ya,c.staticInit();var Za={__syscall_chmod:vc,__syscall_faccessat:xc,__syscall_fchmod:Ec,__syscall_fchown32:Sc,__syscall_fcntl64:Ic,__syscall_fstat64:Oc,__syscall_ftruncate64:Cc,__syscall_getcwd:Wc,__syscall_ioctl:Fc,__syscall_lstat64:Pc,__syscall_mkdirat:Lc,__syscall_newfstatat:Dc,__syscall_openat:Rc,__syscall_readlinkat:Bc,__syscall_rmdir:Mc,__syscall_stat64:Uc,__syscall_unlinkat:jc,__syscall_utimensat:Qc,_emscripten_get_now_is_monotonic:Vc,_localtime_js:Kc,_tzset_js:Xc,emscripten_date_now:Yc,emscripten_get_now:Xa,emscripten_resize_heap:td,environ_get:id,environ_sizes_get:sd,fd_close:od,fd_fdstat_get:ad,fd_read:ud,fd_seek:cd,fd_sync:dd,fd_write:hd,memory:Fn};qc(),n.___wasm_call_ctors=function(){return(n.___wasm_call_ctors=n.asm.__wasm_call_ctors).apply(null,arguments)},n._sqlite3_status64=function(){return(n._sqlite3_status64=n.asm.sqlite3_status64).apply(null,arguments)},n._sqlite3_status=function(){return(n._sqlite3_status=n.asm.sqlite3_status).apply(null,arguments)},n._sqlite3_db_status=function(){return(n._sqlite3_db_status=n.asm.sqlite3_db_status).apply(null,arguments)},n._sqlite3_msize=function(){return(n._sqlite3_msize=n.asm.sqlite3_msize).apply(null,arguments)},n._sqlite3_vfs_find=function(){return(n._sqlite3_vfs_find=n.asm.sqlite3_vfs_find).apply(null,arguments)},n._sqlite3_initialize=function(){return(n._sqlite3_initialize=n.asm.sqlite3_initialize).apply(null,arguments)},n._sqlite3_malloc=function(){return(n._sqlite3_malloc=n.asm.sqlite3_malloc).apply(null,arguments)},n._sqlite3_free=function(){return(n._sqlite3_free=n.asm.sqlite3_free).apply(null,arguments)},n._sqlite3_vfs_register=function(){return(n._sqlite3_vfs_register=n.asm.sqlite3_vfs_register).apply(null,arguments)},n._sqlite3_vfs_unregister=function(){return(n._sqlite3_vfs_unregister=n.asm.sqlite3_vfs_unregister).apply(null,arguments)},n._sqlite3_malloc64=function(){return(n._sqlite3_malloc64=n.asm.sqlite3_malloc64).apply(null,arguments)},n._sqlite3_realloc=function(){return(n._sqlite3_realloc=n.asm.sqlite3_realloc).apply(null,arguments)},n._sqlite3_realloc64=function(){return(n._sqlite3_realloc64=n.asm.sqlite3_realloc64).apply(null,arguments)},n._sqlite3_value_text=function(){return(n._sqlite3_value_text=n.asm.sqlite3_value_text).apply(null,arguments)},n._sqlite3_randomness=function(){return(n._sqlite3_randomness=n.asm.sqlite3_randomness).apply(null,arguments)},n._sqlite3_stricmp=function(){return(n._sqlite3_stricmp=n.asm.sqlite3_stricmp).apply(null,arguments)},n._sqlite3_strnicmp=function(){return(n._sqlite3_strnicmp=n.asm.sqlite3_strnicmp).apply(null,arguments)},n._sqlite3_uri_parameter=function(){return(n._sqlite3_uri_parameter=n.asm.sqlite3_uri_parameter).apply(null,arguments)};var el=n.___errno_location=function(){return(el=n.___errno_location=n.asm.__errno_location).apply(null,arguments)};n._sqlite3_uri_boolean=function(){return(n._sqlite3_uri_boolean=n.asm.sqlite3_uri_boolean).apply(null,arguments)},n._sqlite3_serialize=function(){return(n._sqlite3_serialize=n.asm.sqlite3_serialize).apply(null,arguments)},n._sqlite3_prepare_v2=function(){return(n._sqlite3_prepare_v2=n.asm.sqlite3_prepare_v2).apply(null,arguments)},n._sqlite3_step=function(){return(n._sqlite3_step=n.asm.sqlite3_step).apply(null,arguments)},n._sqlite3_column_int64=function(){return(n._sqlite3_column_int64=n.asm.sqlite3_column_int64).apply(null,arguments)},n._sqlite3_column_int=function(){return(n._sqlite3_column_int=n.asm.sqlite3_column_int).apply(null,arguments)},n._sqlite3_finalize=function(){return(n._sqlite3_finalize=n.asm.sqlite3_finalize).apply(null,arguments)},n._sqlite3_file_control=function(){return(n._sqlite3_file_control=n.asm.sqlite3_file_control).apply(null,arguments)},n._sqlite3_reset=function(){return(n._sqlite3_reset=n.asm.sqlite3_reset).apply(null,arguments)},n._sqlite3_deserialize=function(){return(n._sqlite3_deserialize=n.asm.sqlite3_deserialize).apply(null,arguments)},n._sqlite3_clear_bindings=function(){return(n._sqlite3_clear_bindings=n.asm.sqlite3_clear_bindings).apply(null,arguments)},n._sqlite3_value_blob=function(){return(n._sqlite3_value_blob=n.asm.sqlite3_value_blob).apply(null,arguments)},n._sqlite3_value_bytes=function(){return(n._sqlite3_value_bytes=n.asm.sqlite3_value_bytes).apply(null,arguments)},n._sqlite3_value_double=function(){return(n._sqlite3_value_double=n.asm.sqlite3_value_double).apply(null,arguments)},n._sqlite3_value_int=function(){return(n._sqlite3_value_int=n.asm.sqlite3_value_int).apply(null,arguments)},n._sqlite3_value_int64=function(){return(n._sqlite3_value_int64=n.asm.sqlite3_value_int64).apply(null,arguments)},n._sqlite3_value_subtype=function(){return(n._sqlite3_value_subtype=n.asm.sqlite3_value_subtype).apply(null,arguments)},n._sqlite3_value_pointer=function(){return(n._sqlite3_value_pointer=n.asm.sqlite3_value_pointer).apply(null,arguments)},n._sqlite3_value_type=function(){return(n._sqlite3_value_type=n.asm.sqlite3_value_type).apply(null,arguments)},n._sqlite3_value_nochange=function(){return(n._sqlite3_value_nochange=n.asm.sqlite3_value_nochange).apply(null,arguments)},n._sqlite3_value_frombind=function(){return(n._sqlite3_value_frombind=n.asm.sqlite3_value_frombind).apply(null,arguments)},n._sqlite3_value_dup=function(){return(n._sqlite3_value_dup=n.asm.sqlite3_value_dup).apply(null,arguments)},n._sqlite3_value_free=function(){return(n._sqlite3_value_free=n.asm.sqlite3_value_free).apply(null,arguments)},n._sqlite3_result_blob=function(){return(n._sqlite3_result_blob=n.asm.sqlite3_result_blob).apply(null,arguments)},n._sqlite3_result_error_nomem=function(){return(n._sqlite3_result_error_nomem=n.asm.sqlite3_result_error_nomem).apply(null,arguments)},n._sqlite3_result_error_toobig=function(){return(n._sqlite3_result_error_toobig=n.asm.sqlite3_result_error_toobig).apply(null,arguments)},n._sqlite3_result_double=function(){return(n._sqlite3_result_double=n.asm.sqlite3_result_double).apply(null,arguments)},n._sqlite3_result_error=function(){return(n._sqlite3_result_error=n.asm.sqlite3_result_error).apply(null,arguments)},n._sqlite3_result_int=function(){return(n._sqlite3_result_int=n.asm.sqlite3_result_int).apply(null,arguments)},n._sqlite3_result_int64=function(){return(n._sqlite3_result_int64=n.asm.sqlite3_result_int64).apply(null,arguments)},n._sqlite3_result_null=function(){return(n._sqlite3_result_null=n.asm.sqlite3_result_null).apply(null,arguments)},n._sqlite3_result_pointer=function(){return(n._sqlite3_result_pointer=n.asm.sqlite3_result_pointer).apply(null,arguments)},n._sqlite3_result_subtype=function(){return(n._sqlite3_result_subtype=n.asm.sqlite3_result_subtype).apply(null,arguments)},n._sqlite3_result_text=function(){return(n._sqlite3_result_text=n.asm.sqlite3_result_text).apply(null,arguments)},n._sqlite3_result_zeroblob=function(){return(n._sqlite3_result_zeroblob=n.asm.sqlite3_result_zeroblob).apply(null,arguments)},n._sqlite3_result_zeroblob64=function(){return(n._sqlite3_result_zeroblob64=n.asm.sqlite3_result_zeroblob64).apply(null,arguments)},n._sqlite3_result_error_code=function(){return(n._sqlite3_result_error_code=n.asm.sqlite3_result_error_code).apply(null,arguments)},n._sqlite3_user_data=function(){return(n._sqlite3_user_data=n.asm.sqlite3_user_data).apply(null,arguments)},n._sqlite3_context_db_handle=function(){return(n._sqlite3_context_db_handle=n.asm.sqlite3_context_db_handle).apply(null,arguments)},n._sqlite3_vtab_nochange=function(){return(n._sqlite3_vtab_nochange=n.asm.sqlite3_vtab_nochange).apply(null,arguments)},n._sqlite3_vtab_in_first=function(){return(n._sqlite3_vtab_in_first=n.asm.sqlite3_vtab_in_first).apply(null,arguments)},n._sqlite3_vtab_in_next=function(){return(n._sqlite3_vtab_in_next=n.asm.sqlite3_vtab_in_next).apply(null,arguments)},n._sqlite3_aggregate_context=function(){return(n._sqlite3_aggregate_context=n.asm.sqlite3_aggregate_context).apply(null,arguments)},n._sqlite3_get_auxdata=function(){return(n._sqlite3_get_auxdata=n.asm.sqlite3_get_auxdata).apply(null,arguments)},n._sqlite3_set_auxdata=function(){return(n._sqlite3_set_auxdata=n.asm.sqlite3_set_auxdata).apply(null,arguments)},n._sqlite3_column_count=function(){return(n._sqlite3_column_count=n.asm.sqlite3_column_count).apply(null,arguments)},n._sqlite3_data_count=function(){return(n._sqlite3_data_count=n.asm.sqlite3_data_count).apply(null,arguments)},n._sqlite3_column_blob=function(){return(n._sqlite3_column_blob=n.asm.sqlite3_column_blob).apply(null,arguments)},n._sqlite3_column_bytes=function(){return(n._sqlite3_column_bytes=n.asm.sqlite3_column_bytes).apply(null,arguments)},n._sqlite3_column_double=function(){return(n._sqlite3_column_double=n.asm.sqlite3_column_double).apply(null,arguments)},n._sqlite3_column_text=function(){return(n._sqlite3_column_text=n.asm.sqlite3_column_text).apply(null,arguments)},n._sqlite3_column_value=function(){return(n._sqlite3_column_value=n.asm.sqlite3_column_value).apply(null,arguments)},n._sqlite3_column_type=function(){return(n._sqlite3_column_type=n.asm.sqlite3_column_type).apply(null,arguments)},n._sqlite3_column_name=function(){return(n._sqlite3_column_name=n.asm.sqlite3_column_name).apply(null,arguments)},n._sqlite3_bind_blob=function(){return(n._sqlite3_bind_blob=n.asm.sqlite3_bind_blob).apply(null,arguments)},n._sqlite3_bind_double=function(){return(n._sqlite3_bind_double=n.asm.sqlite3_bind_double).apply(null,arguments)},n._sqlite3_bind_int=function(){return(n._sqlite3_bind_int=n.asm.sqlite3_bind_int).apply(null,arguments)},n._sqlite3_bind_int64=function(){return(n._sqlite3_bind_int64=n.asm.sqlite3_bind_int64).apply(null,arguments)},n._sqlite3_bind_null=function(){return(n._sqlite3_bind_null=n.asm.sqlite3_bind_null).apply(null,arguments)},n._sqlite3_bind_pointer=function(){return(n._sqlite3_bind_pointer=n.asm.sqlite3_bind_pointer).apply(null,arguments)},n._sqlite3_bind_text=function(){return(n._sqlite3_bind_text=n.asm.sqlite3_bind_text).apply(null,arguments)},n._sqlite3_bind_parameter_count=function(){return(n._sqlite3_bind_parameter_count=n.asm.sqlite3_bind_parameter_count).apply(null,arguments)},n._sqlite3_bind_parameter_index=function(){return(n._sqlite3_bind_parameter_index=n.asm.sqlite3_bind_parameter_index).apply(null,arguments)},n._sqlite3_db_handle=function(){return(n._sqlite3_db_handle=n.asm.sqlite3_db_handle).apply(null,arguments)},n._sqlite3_stmt_readonly=function(){return(n._sqlite3_stmt_readonly=n.asm.sqlite3_stmt_readonly).apply(null,arguments)},n._sqlite3_stmt_isexplain=function(){return(n._sqlite3_stmt_isexplain=n.asm.sqlite3_stmt_isexplain).apply(null,arguments)},n._sqlite3_stmt_status=function(){return(n._sqlite3_stmt_status=n.asm.sqlite3_stmt_status).apply(null,arguments)},n._sqlite3_sql=function(){return(n._sqlite3_sql=n.asm.sqlite3_sql).apply(null,arguments)},n._sqlite3_expanded_sql=function(){return(n._sqlite3_expanded_sql=n.asm.sqlite3_expanded_sql).apply(null,arguments)},n._sqlite3_preupdate_old=function(){return(n._sqlite3_preupdate_old=n.asm.sqlite3_preupdate_old).apply(null,arguments)},n._sqlite3_preupdate_count=function(){return(n._sqlite3_preupdate_count=n.asm.sqlite3_preupdate_count).apply(null,arguments)},n._sqlite3_preupdate_depth=function(){return(n._sqlite3_preupdate_depth=n.asm.sqlite3_preupdate_depth).apply(null,arguments)},n._sqlite3_preupdate_blobwrite=function(){return(n._sqlite3_preupdate_blobwrite=n.asm.sqlite3_preupdate_blobwrite).apply(null,arguments)},n._sqlite3_preupdate_new=function(){return(n._sqlite3_preupdate_new=n.asm.sqlite3_preupdate_new).apply(null,arguments)},n._sqlite3_value_numeric_type=function(){return(n._sqlite3_value_numeric_type=n.asm.sqlite3_value_numeric_type).apply(null,arguments)},n._sqlite3_errmsg=function(){return(n._sqlite3_errmsg=n.asm.sqlite3_errmsg).apply(null,arguments)},n._sqlite3_set_authorizer=function(){return(n._sqlite3_set_authorizer=n.asm.sqlite3_set_authorizer).apply(null,arguments)},n._sqlite3_strglob=function(){return(n._sqlite3_strglob=n.asm.sqlite3_strglob).apply(null,arguments)},n._sqlite3_strlike=function(){return(n._sqlite3_strlike=n.asm.sqlite3_strlike).apply(null,arguments)},n._sqlite3_exec=function(){return(n._sqlite3_exec=n.asm.sqlite3_exec).apply(null,arguments)},n._sqlite3_auto_extension=function(){return(n._sqlite3_auto_extension=n.asm.sqlite3_auto_extension).apply(null,arguments)},n._sqlite3_cancel_auto_extension=function(){return(n._sqlite3_cancel_auto_extension=n.asm.sqlite3_cancel_auto_extension).apply(null,arguments)},n._sqlite3_reset_auto_extension=function(){return(n._sqlite3_reset_auto_extension=n.asm.sqlite3_reset_auto_extension).apply(null,arguments)},n._sqlite3_prepare_v3=function(){return(n._sqlite3_prepare_v3=n.asm.sqlite3_prepare_v3).apply(null,arguments)},n._sqlite3_create_module=function(){return(n._sqlite3_create_module=n.asm.sqlite3_create_module).apply(null,arguments)},n._sqlite3_create_module_v2=function(){return(n._sqlite3_create_module_v2=n.asm.sqlite3_create_module_v2).apply(null,arguments)},n._sqlite3_drop_modules=function(){return(n._sqlite3_drop_modules=n.asm.sqlite3_drop_modules).apply(null,arguments)},n._sqlite3_declare_vtab=function(){return(n._sqlite3_declare_vtab=n.asm.sqlite3_declare_vtab).apply(null,arguments)},n._sqlite3_vtab_on_conflict=function(){return(n._sqlite3_vtab_on_conflict=n.asm.sqlite3_vtab_on_conflict).apply(null,arguments)},n._sqlite3_vtab_collation=function(){return(n._sqlite3_vtab_collation=n.asm.sqlite3_vtab_collation).apply(null,arguments)},n._sqlite3_vtab_in=function(){return(n._sqlite3_vtab_in=n.asm.sqlite3_vtab_in).apply(null,arguments)},n._sqlite3_vtab_rhs_value=function(){return(n._sqlite3_vtab_rhs_value=n.asm.sqlite3_vtab_rhs_value).apply(null,arguments)},n._sqlite3_vtab_distinct=function(){return(n._sqlite3_vtab_distinct=n.asm.sqlite3_vtab_distinct).apply(null,arguments)},n._sqlite3_keyword_name=function(){return(n._sqlite3_keyword_name=n.asm.sqlite3_keyword_name).apply(null,arguments)},n._sqlite3_keyword_count=function(){return(n._sqlite3_keyword_count=n.asm.sqlite3_keyword_count).apply(null,arguments)},n._sqlite3_keyword_check=function(){return(n._sqlite3_keyword_check=n.asm.sqlite3_keyword_check).apply(null,arguments)},n._sqlite3_complete=function(){return(n._sqlite3_complete=n.asm.sqlite3_complete).apply(null,arguments)},n._sqlite3_libversion=function(){return(n._sqlite3_libversion=n.asm.sqlite3_libversion).apply(null,arguments)},n._sqlite3_libversion_number=function(){return(n._sqlite3_libversion_number=n.asm.sqlite3_libversion_number).apply(null,arguments)},n._sqlite3_shutdown=function(){return(n._sqlite3_shutdown=n.asm.sqlite3_shutdown).apply(null,arguments)},n._sqlite3_last_insert_rowid=function(){return(n._sqlite3_last_insert_rowid=n.asm.sqlite3_last_insert_rowid).apply(null,arguments)},n._sqlite3_set_last_insert_rowid=function(){return(n._sqlite3_set_last_insert_rowid=n.asm.sqlite3_set_last_insert_rowid).apply(null,arguments)},n._sqlite3_changes64=function(){return(n._sqlite3_changes64=n.asm.sqlite3_changes64).apply(null,arguments)},n._sqlite3_changes=function(){return(n._sqlite3_changes=n.asm.sqlite3_changes).apply(null,arguments)},n._sqlite3_total_changes64=function(){return(n._sqlite3_total_changes64=n.asm.sqlite3_total_changes64).apply(null,arguments)},n._sqlite3_total_changes=function(){return(n._sqlite3_total_changes=n.asm.sqlite3_total_changes).apply(null,arguments)},n._sqlite3_txn_state=function(){return(n._sqlite3_txn_state=n.asm.sqlite3_txn_state).apply(null,arguments)},n._sqlite3_close_v2=function(){return(n._sqlite3_close_v2=n.asm.sqlite3_close_v2).apply(null,arguments)},n._sqlite3_busy_handler=function(){return(n._sqlite3_busy_handler=n.asm.sqlite3_busy_handler).apply(null,arguments)},n._sqlite3_progress_handler=function(){return(n._sqlite3_progress_handler=n.asm.sqlite3_progress_handler).apply(null,arguments)},n._sqlite3_busy_timeout=function(){return(n._sqlite3_busy_timeout=n.asm.sqlite3_busy_timeout).apply(null,arguments)},n._sqlite3_create_function=function(){return(n._sqlite3_create_function=n.asm.sqlite3_create_function).apply(null,arguments)},n._sqlite3_create_function_v2=function(){return(n._sqlite3_create_function_v2=n.asm.sqlite3_create_function_v2).apply(null,arguments)},n._sqlite3_create_window_function=function(){return(n._sqlite3_create_window_function=n.asm.sqlite3_create_window_function).apply(null,arguments)},n._sqlite3_overload_function=function(){return(n._sqlite3_overload_function=n.asm.sqlite3_overload_function).apply(null,arguments)},n._sqlite3_trace_v2=function(){return(n._sqlite3_trace_v2=n.asm.sqlite3_trace_v2).apply(null,arguments)},n._sqlite3_commit_hook=function(){return(n._sqlite3_commit_hook=n.asm.sqlite3_commit_hook).apply(null,arguments)},n._sqlite3_update_hook=function(){return(n._sqlite3_update_hook=n.asm.sqlite3_update_hook).apply(null,arguments)},n._sqlite3_rollback_hook=function(){return(n._sqlite3_rollback_hook=n.asm.sqlite3_rollback_hook).apply(null,arguments)},n._sqlite3_preupdate_hook=function(){return(n._sqlite3_preupdate_hook=n.asm.sqlite3_preupdate_hook).apply(null,arguments)},n._sqlite3_error_offset=function(){return(n._sqlite3_error_offset=n.asm.sqlite3_error_offset).apply(null,arguments)},n._sqlite3_errcode=function(){return(n._sqlite3_errcode=n.asm.sqlite3_errcode).apply(null,arguments)},n._sqlite3_extended_errcode=function(){return(n._sqlite3_extended_errcode=n.asm.sqlite3_extended_errcode).apply(null,arguments)},n._sqlite3_errstr=function(){return(n._sqlite3_errstr=n.asm.sqlite3_errstr).apply(null,arguments)},n._sqlite3_limit=function(){return(n._sqlite3_limit=n.asm.sqlite3_limit).apply(null,arguments)},n._sqlite3_open=function(){return(n._sqlite3_open=n.asm.sqlite3_open).apply(null,arguments)},n._sqlite3_open_v2=function(){return(n._sqlite3_open_v2=n.asm.sqlite3_open_v2).apply(null,arguments)},n._sqlite3_create_collation=function(){return(n._sqlite3_create_collation=n.asm.sqlite3_create_collation).apply(null,arguments)},n._sqlite3_create_collation_v2=function(){return(n._sqlite3_create_collation_v2=n.asm.sqlite3_create_collation_v2).apply(null,arguments)},n._sqlite3_collation_needed=function(){return(n._sqlite3_collation_needed=n.asm.sqlite3_collation_needed).apply(null,arguments)},n._sqlite3_table_column_metadata=function(){return(n._sqlite3_table_column_metadata=n.asm.sqlite3_table_column_metadata).apply(null,arguments)},n._sqlite3_extended_result_codes=function(){return(n._sqlite3_extended_result_codes=n.asm.sqlite3_extended_result_codes).apply(null,arguments)},n._sqlite3_uri_key=function(){return(n._sqlite3_uri_key=n.asm.sqlite3_uri_key).apply(null,arguments)},n._sqlite3_uri_int64=function(){return(n._sqlite3_uri_int64=n.asm.sqlite3_uri_int64).apply(null,arguments)},n._sqlite3_db_name=function(){return(n._sqlite3_db_name=n.asm.sqlite3_db_name).apply(null,arguments)},n._sqlite3_db_filename=function(){return(n._sqlite3_db_filename=n.asm.sqlite3_db_filename).apply(null,arguments)},n._sqlite3_compileoption_used=function(){return(n._sqlite3_compileoption_used=n.asm.sqlite3_compileoption_used).apply(null,arguments)},n._sqlite3_compileoption_get=function(){return(n._sqlite3_compileoption_get=n.asm.sqlite3_compileoption_get).apply(null,arguments)},n._sqlite3session_diff=function(){return(n._sqlite3session_diff=n.asm.sqlite3session_diff).apply(null,arguments)},n._sqlite3session_attach=function(){return(n._sqlite3session_attach=n.asm.sqlite3session_attach).apply(null,arguments)},n._sqlite3session_create=function(){return(n._sqlite3session_create=n.asm.sqlite3session_create).apply(null,arguments)},n._sqlite3session_delete=function(){return(n._sqlite3session_delete=n.asm.sqlite3session_delete).apply(null,arguments)},n._sqlite3session_table_filter=function(){return(n._sqlite3session_table_filter=n.asm.sqlite3session_table_filter).apply(null,arguments)},n._sqlite3session_changeset=function(){return(n._sqlite3session_changeset=n.asm.sqlite3session_changeset).apply(null,arguments)},n._sqlite3session_changeset_strm=function(){return(n._sqlite3session_changeset_strm=n.asm.sqlite3session_changeset_strm).apply(null,arguments)},n._sqlite3session_patchset_strm=function(){return(n._sqlite3session_patchset_strm=n.asm.sqlite3session_patchset_strm).apply(null,arguments)},n._sqlite3session_patchset=function(){return(n._sqlite3session_patchset=n.asm.sqlite3session_patchset).apply(null,arguments)},n._sqlite3session_enable=function(){return(n._sqlite3session_enable=n.asm.sqlite3session_enable).apply(null,arguments)},n._sqlite3session_indirect=function(){return(n._sqlite3session_indirect=n.asm.sqlite3session_indirect).apply(null,arguments)},n._sqlite3session_isempty=function(){return(n._sqlite3session_isempty=n.asm.sqlite3session_isempty).apply(null,arguments)},n._sqlite3session_memory_used=function(){return(n._sqlite3session_memory_used=n.asm.sqlite3session_memory_used).apply(null,arguments)},n._sqlite3session_object_config=function(){return(n._sqlite3session_object_config=n.asm.sqlite3session_object_config).apply(null,arguments)},n._sqlite3session_changeset_size=function(){return(n._sqlite3session_changeset_size=n.asm.sqlite3session_changeset_size).apply(null,arguments)},n._sqlite3changeset_start=function(){return(n._sqlite3changeset_start=n.asm.sqlite3changeset_start).apply(null,arguments)},n._sqlite3changeset_start_v2=function(){return(n._sqlite3changeset_start_v2=n.asm.sqlite3changeset_start_v2).apply(null,arguments)},n._sqlite3changeset_start_strm=function(){return(n._sqlite3changeset_start_strm=n.asm.sqlite3changeset_start_strm).apply(null,arguments)},n._sqlite3changeset_start_v2_strm=function(){return(n._sqlite3changeset_start_v2_strm=n.asm.sqlite3changeset_start_v2_strm).apply(null,arguments)},n._sqlite3changeset_next=function(){return(n._sqlite3changeset_next=n.asm.sqlite3changeset_next).apply(null,arguments)},n._sqlite3changeset_op=function(){return(n._sqlite3changeset_op=n.asm.sqlite3changeset_op).apply(null,arguments)},n._sqlite3changeset_pk=function(){return(n._sqlite3changeset_pk=n.asm.sqlite3changeset_pk).apply(null,arguments)},n._sqlite3changeset_old=function(){return(n._sqlite3changeset_old=n.asm.sqlite3changeset_old).apply(null,arguments)},n._sqlite3changeset_new=function(){return(n._sqlite3changeset_new=n.asm.sqlite3changeset_new).apply(null,arguments)},n._sqlite3changeset_conflict=function(){return(n._sqlite3changeset_conflict=n.asm.sqlite3changeset_conflict).apply(null,arguments)},n._sqlite3changeset_fk_conflicts=function(){return(n._sqlite3changeset_fk_conflicts=n.asm.sqlite3changeset_fk_conflicts).apply(null,arguments)},n._sqlite3changeset_finalize=function(){return(n._sqlite3changeset_finalize=n.asm.sqlite3changeset_finalize).apply(null,arguments)},n._sqlite3changeset_invert=function(){return(n._sqlite3changeset_invert=n.asm.sqlite3changeset_invert).apply(null,arguments)},n._sqlite3changeset_invert_strm=function(){return(n._sqlite3changeset_invert_strm=n.asm.sqlite3changeset_invert_strm).apply(null,arguments)},n._sqlite3changeset_apply_v2=function(){return(n._sqlite3changeset_apply_v2=n.asm.sqlite3changeset_apply_v2).apply(null,arguments)},n._sqlite3changeset_apply=function(){return(n._sqlite3changeset_apply=n.asm.sqlite3changeset_apply).apply(null,arguments)},n._sqlite3changeset_apply_v2_strm=function(){return(n._sqlite3changeset_apply_v2_strm=n.asm.sqlite3changeset_apply_v2_strm).apply(null,arguments)},n._sqlite3changeset_apply_strm=function(){return(n._sqlite3changeset_apply_strm=n.asm.sqlite3changeset_apply_strm).apply(null,arguments)},n._sqlite3changegroup_new=function(){return(n._sqlite3changegroup_new=n.asm.sqlite3changegroup_new).apply(null,arguments)},n._sqlite3changegroup_add=function(){return(n._sqlite3changegroup_add=n.asm.sqlite3changegroup_add).apply(null,arguments)},n._sqlite3changegroup_output=function(){return(n._sqlite3changegroup_output=n.asm.sqlite3changegroup_output).apply(null,arguments)},n._sqlite3changegroup_add_strm=function(){return(n._sqlite3changegroup_add_strm=n.asm.sqlite3changegroup_add_strm).apply(null,arguments)},n._sqlite3changegroup_output_strm=function(){return(n._sqlite3changegroup_output_strm=n.asm.sqlite3changegroup_output_strm).apply(null,arguments)},n._sqlite3changegroup_delete=function(){return(n._sqlite3changegroup_delete=n.asm.sqlite3changegroup_delete).apply(null,arguments)},n._sqlite3changeset_concat=function(){return(n._sqlite3changeset_concat=n.asm.sqlite3changeset_concat).apply(null,arguments)},n._sqlite3changeset_concat_strm=function(){return(n._sqlite3changeset_concat_strm=n.asm.sqlite3changeset_concat_strm).apply(null,arguments)},n._sqlite3session_config=function(){return(n._sqlite3session_config=n.asm.sqlite3session_config).apply(null,arguments)},n._sqlite3_sourceid=function(){return(n._sqlite3_sourceid=n.asm.sqlite3_sourceid).apply(null,arguments)},n._sqlite3_wasm_pstack_ptr=function(){return(n._sqlite3_wasm_pstack_ptr=n.asm.sqlite3_wasm_pstack_ptr).apply(null,arguments)},n._sqlite3_wasm_pstack_restore=function(){return(n._sqlite3_wasm_pstack_restore=n.asm.sqlite3_wasm_pstack_restore).apply(null,arguments)},n._sqlite3_wasm_pstack_alloc=function(){return(n._sqlite3_wasm_pstack_alloc=n.asm.sqlite3_wasm_pstack_alloc).apply(null,arguments)},n._sqlite3_wasm_pstack_remaining=function(){return(n._sqlite3_wasm_pstack_remaining=n.asm.sqlite3_wasm_pstack_remaining).apply(null,arguments)},n._sqlite3_wasm_pstack_quota=function(){return(n._sqlite3_wasm_pstack_quota=n.asm.sqlite3_wasm_pstack_quota).apply(null,arguments)},n._sqlite3_wasm_db_error=function(){return(n._sqlite3_wasm_db_error=n.asm.sqlite3_wasm_db_error).apply(null,arguments)},n._sqlite3_wasm_test_struct=function(){return(n._sqlite3_wasm_test_struct=n.asm.sqlite3_wasm_test_struct).apply(null,arguments)},n._sqlite3_wasm_enum_json=function(){return(n._sqlite3_wasm_enum_json=n.asm.sqlite3_wasm_enum_json).apply(null,arguments)},n._sqlite3_wasm_vfs_unlink=function(){return(n._sqlite3_wasm_vfs_unlink=n.asm.sqlite3_wasm_vfs_unlink).apply(null,arguments)},n._sqlite3_wasm_db_vfs=function(){return(n._sqlite3_wasm_db_vfs=n.asm.sqlite3_wasm_db_vfs).apply(null,arguments)},n._sqlite3_wasm_db_reset=function(){return(n._sqlite3_wasm_db_reset=n.asm.sqlite3_wasm_db_reset).apply(null,arguments)},n._sqlite3_wasm_db_export_chunked=function(){return(n._sqlite3_wasm_db_export_chunked=n.asm.sqlite3_wasm_db_export_chunked).apply(null,arguments)},n._sqlite3_wasm_db_serialize=function(){return(n._sqlite3_wasm_db_serialize=n.asm.sqlite3_wasm_db_serialize).apply(null,arguments)},n._sqlite3_wasm_vfs_create_file=function(){return(n._sqlite3_wasm_vfs_create_file=n.asm.sqlite3_wasm_vfs_create_file).apply(null,arguments)},n._sqlite3_wasm_kvvfsMakeKeyOnPstack=function(){return(n._sqlite3_wasm_kvvfsMakeKeyOnPstack=n.asm.sqlite3_wasm_kvvfsMakeKeyOnPstack).apply(null,arguments)},n._sqlite3_wasm_kvvfs_methods=function(){return(n._sqlite3_wasm_kvvfs_methods=n.asm.sqlite3_wasm_kvvfs_methods).apply(null,arguments)},n._sqlite3_wasm_vtab_config=function(){return(n._sqlite3_wasm_vtab_config=n.asm.sqlite3_wasm_vtab_config).apply(null,arguments)},n._sqlite3_wasm_db_config_ip=function(){return(n._sqlite3_wasm_db_config_ip=n.asm.sqlite3_wasm_db_config_ip).apply(null,arguments)},n._sqlite3_wasm_db_config_pii=function(){return(n._sqlite3_wasm_db_config_pii=n.asm.sqlite3_wasm_db_config_pii).apply(null,arguments)},n._sqlite3_wasm_db_config_s=function(){return(n._sqlite3_wasm_db_config_s=n.asm.sqlite3_wasm_db_config_s).apply(null,arguments)},n._sqlite3_wasm_config_i=function(){return(n._sqlite3_wasm_config_i=n.asm.sqlite3_wasm_config_i).apply(null,arguments)},n._sqlite3_wasm_config_ii=function(){return(n._sqlite3_wasm_config_ii=n.asm.sqlite3_wasm_config_ii).apply(null,arguments)},n._sqlite3_wasm_config_j=function(){return(n._sqlite3_wasm_config_j=n.asm.sqlite3_wasm_config_j).apply(null,arguments)},n._sqlite3_wasm_init_wasmfs=function(){return(n._sqlite3_wasm_init_wasmfs=n.asm.sqlite3_wasm_init_wasmfs).apply(null,arguments)},n._sqlite3_wasm_test_intptr=function(){return(n._sqlite3_wasm_test_intptr=n.asm.sqlite3_wasm_test_intptr).apply(null,arguments)},n._sqlite3_wasm_test_voidptr=function(){return(n._sqlite3_wasm_test_voidptr=n.asm.sqlite3_wasm_test_voidptr).apply(null,arguments)},n._sqlite3_wasm_test_int64_max=function(){return(n._sqlite3_wasm_test_int64_max=n.asm.sqlite3_wasm_test_int64_max).apply(null,arguments)},n._sqlite3_wasm_test_int64_min=function(){return(n._sqlite3_wasm_test_int64_min=n.asm.sqlite3_wasm_test_int64_min).apply(null,arguments)},n._sqlite3_wasm_test_int64_times2=function(){return(n._sqlite3_wasm_test_int64_times2=n.asm.sqlite3_wasm_test_int64_times2).apply(null,arguments)},n._sqlite3_wasm_test_int64_minmax=function(){return(n._sqlite3_wasm_test_int64_minmax=n.asm.sqlite3_wasm_test_int64_minmax).apply(null,arguments)},n._sqlite3_wasm_test_int64ptr=function(){return(n._sqlite3_wasm_test_int64ptr=n.asm.sqlite3_wasm_test_int64ptr).apply(null,arguments)},n._sqlite3_wasm_test_stack_overflow=function(){return(n._sqlite3_wasm_test_stack_overflow=n.asm.sqlite3_wasm_test_stack_overflow).apply(null,arguments)},n._sqlite3_wasm_test_str_hello=function(){return(n._sqlite3_wasm_test_str_hello=n.asm.sqlite3_wasm_test_str_hello).apply(null,arguments)};var tl=n._malloc=function(){return(tl=n._malloc=n.asm.malloc).apply(null,arguments)};n._free=function(){return(n._free=n.asm.free).apply(null,arguments)},n._realloc=function(){return(n._realloc=n.asm.realloc).apply(null,arguments)},n.stackSave=function(){return(n.stackSave=n.asm.stackSave).apply(null,arguments)},n.stackRestore=function(){return(n.stackRestore=n.asm.stackRestore).apply(null,arguments)},n.stackAlloc=function(){return(n.stackAlloc=n.asm.stackAlloc).apply(null,arguments)},n.wasmMemory=Fn;var Ms;ki=function o(){Ms||nl(),Ms||(ki=o)};function nl(o){if(Yn>0||(fc(),Yn>0))return;function i(){Ms||(Ms=!0,n.calledRun=!0,!Da&&(hc(),A(n),n.onRuntimeInitialized&&n.onRuntimeInitialized(),pc()))}n.setStatus?(n.setStatus("Running..."),setTimeout(function(){setTimeout(function(){n.setStatus("")},1),i()},1)):i()}if(n.preInit)for(typeof n.preInit=="function"&&(n.preInit=[n.preInit]);n.preInit.length>0;)n.preInit.pop()();return nl(),n.postRun||(n.postRun=[]),n.postRun.push(function(o){if(globalThis.sqlite3ApiBootstrap=function i(l=globalThis.sqlite3ApiConfig||i.defaultConfig){if(i.sqlite3)return console.warn("sqlite3ApiBootstrap() called multiple times.","Config and external initializers are ignored on calls after the first."),i.sqlite3;const a=Object.assign(Object.create(null),{exports:void 0,memory:void 0,bigIntEnabled:(()=>typeof o<"u"?!!o.HEAPU64:!!globalThis.BigInt64Array)(),debug:console.debug.bind(console),warn:console.warn.bind(console),error:console.error.bind(console),log:console.log.bind(console),wasmfsOpfsDir:"/opfs",useStdAlloc:!1},l||{});Object.assign(a,{allocExportName:a.useStdAlloc?"malloc":"sqlite3_malloc",deallocExportName:a.useStdAlloc?"free":"sqlite3_free",reallocExportName:a.useStdAlloc?"realloc":"sqlite3_realloc"},a),["exports","memory","wasmfsOpfsDir"].forEach(f=>{typeof a[f]=="function"&&(a[f]=a[f]())}),a.wasmOpfsDir=!1;const u=Object.create(null),d=Object.create(null),N=f=>u.sqlite3_js_rc_str&&u.sqlite3_js_rc_str(f)||"Unknown result code #"+f,S=f=>typeof f=="number"&&f===(f|0);class C extends Error{constructor(...p){let _;if(p.length)if(S(p[0]))if(_=p[0],p.length===1)super(N(p[0]));else{const W=N(_);typeof p[1]=="object"?super(W,p[1]):(p[0]=W+":",super(p.join(" ")))}else p.length===2&&typeof p[1]=="object"?super(...p):super(p.join(" "));this.resultCode=_||u.SQLITE_ERROR,this.name="SQLite3Error"}}C.toss=(...f)=>{throw new C(...f)};const V=C.toss;a.wasmfsOpfsDir&&!/^\/[^/]+$/.test(a.wasmfsOpfsDir)&&V("config.wasmfsOpfsDir must be falsy or in the form '/dir-name'.");const J=f=>typeof f!="bigint"&&f===(f|0)&&f<=2147483647&&f>=-2147483648,ie=function f(p){return f._max||(f._max=BigInt("0x7fffffffffffffff"),f._min=~f._max),p>=f._min&&p<=f._max},k=f=>f>=-0x7fffffffn-1n&&f<=0x7fffffffn,m=function f(p){return f._min||(f._min=Number.MIN_SAFE_INTEGER,f._max=Number.MAX_SAFE_INTEGER),p>=f._min&&p<=f._max},y=f=>f&&f.constructor&&J(f.constructor.BYTES_PER_ELEMENT)?f:!1,x=typeof SharedArrayBuffer>"u"?function(){}:SharedArrayBuffer,E=f=>f.buffer instanceof x,b=(f,p,_)=>E(f)?f.slice(p,_):f.subarray(p,_),P=f=>f&&(f instanceof Uint8Array||f instanceof Int8Array||f instanceof ArrayBuffer),M=f=>f&&(f instanceof Uint8Array||f instanceof Int8Array||f instanceof ArrayBuffer),B=f=>P(f)||V("Value is not of a supported TypedArray type."),D=new TextDecoder("utf-8"),le=function(f,p,_){return D.decode(b(f,p,_))},z=function(f){return M(f)?le(f instanceof ArrayBuffer?new Uint8Array(f):f):Array.isArray(f)?f.join(""):(d.isPtr(f)&&(f=d.cstrToJs(f)),f)};class g extends Error{constructor(...p){p.length===2&&typeof p[1]=="object"?super(...p):p.length?super(p.join(" ")):super("Allocation failed."),this.resultCode=u.SQLITE_NOMEM,this.name="WasmAllocError"}}g.toss=(...f)=>{throw new g(...f)},Object.assign(u,{sqlite3_bind_blob:void 0,sqlite3_bind_text:void 0,sqlite3_create_function_v2:(f,p,_,W,L,se,oe,ce,pe)=>{},sqlite3_create_function:(f,p,_,W,L,se,oe,ce)=>{},sqlite3_create_window_function:(f,p,_,W,L,se,oe,ce,pe,de)=>{},sqlite3_prepare_v3:(f,p,_,W,L,se)=>{},sqlite3_prepare_v2:(f,p,_,W,L)=>{},sqlite3_exec:(f,p,_,W,L)=>{},sqlite3_randomness:(f,p)=>{}});const v={affirmBindableTypedArray:B,flexibleString:z,bigIntFits32:k,bigIntFits64:ie,bigIntFitsDouble:m,isBindableTypedArray:P,isInt32:J,isSQLableTypedArray:M,isTypedArray:y,typedArrayToString:le,isUIThread:()=>globalThis.window===globalThis&&!!globalThis.document,isSharedTypedArray:E,toss:function(...f){throw new Error(f.join(" "))},toss3:V,typedArrayPart:b};Object.assign(d,{ptrSizeof:a.wasmPtrSizeof||4,ptrIR:a.wasmPtrIR||"i32",bigIntEnabled:!!a.bigIntEnabled,exports:a.exports||V("Missing API config.exports (WASM module exports)."),memory:a.memory||a.exports.memory||V("API config object requires a WebAssembly.Memory object","in either config.exports.memory (exported)","or config.memory (imported)."),alloc:void 0,realloc:void 0,dealloc:void 0}),d.allocFromTypedArray=function(f){f instanceof ArrayBuffer&&(f=new Uint8Array(f)),B(f);const p=d.alloc(f.byteLength||1);return d.heapForSize(f.constructor).set(f.byteLength?f:[0],p),p};{const f=a.allocExportName,p=a.deallocExportName,_=a.reallocExportName;for(const W of[f,p,_])d.exports[W]instanceof Function||V("Missing required exports[",W,"] function.");d.alloc=function W(L){return W.impl(L)||g.toss("Failed to allocate",L," bytes.")},d.alloc.impl=d.exports[f],d.realloc=function W(L,se){const oe=W.impl(L,se);return se?oe||g.toss("Failed to reallocate",se," bytes."):0},d.realloc.impl=d.exports[_],d.dealloc=d.exports[p]}d.compileOptionUsed=function f(p){if(arguments.length){if(Array.isArray(p)){const _={};return p.forEach(W=>{_[W]=u.sqlite3_compileoption_used(W)}),_}else if(typeof p=="object")return Object.keys(p).forEach(_=>{p[_]=u.sqlite3_compileoption_used(_)}),p}else{if(f._result)return f._result;f._opt||(f._rx=/^([^=]+)=(.+)/,f._rxInt=/^-?\d+$/,f._opt=function(oe,ce){const pe=f._rx.exec(oe);ce[0]=pe?pe[1]:oe,ce[1]=pe?f._rxInt.test(pe[2])?+pe[2]:pe[2]:!0});const _={},W=[0,0];let L=0,se;for(;se=u.sqlite3_compileoption_get(L++);)f._opt(se,W),_[W[0]]=W[1];return f._result=_}return typeof p=="string"?!!u.sqlite3_compileoption_used(p):!1},d.pstack=Object.assign(Object.create(null),{restore:d.exports.sqlite3_wasm_pstack_restore,alloc:function(f){return typeof f=="string"&&!(f=d.sizeofIR(f))&&g.toss("Invalid value for pstack.alloc(",arguments[0],")"),d.exports.sqlite3_wasm_pstack_alloc(f)||g.toss("Could not allocate",f,"bytes from the pstack.")},allocChunks:function(f,p){typeof p=="string"&&!(p=d.sizeofIR(p))&&g.toss("Invalid size value for allocChunks(",arguments[1],")");const _=d.pstack.alloc(f*p),W=[];let L=0,se=0;for(;L<f;++L,se+=p)W.push(_+se);return W},allocPtr:(f=1,p=!0)=>f===1?d.pstack.alloc(p?8:d.ptrSizeof):d.pstack.allocChunks(f,p?8:d.ptrSizeof)}),Object.defineProperties(d.pstack,{pointer:{configurable:!1,iterable:!0,writeable:!1,get:d.exports.sqlite3_wasm_pstack_ptr},quota:{configurable:!1,iterable:!0,writeable:!1,get:d.exports.sqlite3_wasm_pstack_quota},remaining:{configurable:!1,iterable:!0,writeable:!1,get:d.exports.sqlite3_wasm_pstack_remaining}}),u.sqlite3_randomness=(...f)=>{if(f.length===1&&v.isTypedArray(f[0])&&f[0].BYTES_PER_ELEMENT===1){const p=f[0];if(p.byteLength===0)return d.exports.sqlite3_randomness(0,0),p;const _=d.pstack.pointer;try{let W=p.byteLength,L=0;const se=d.exports.sqlite3_randomness,oe=d.heap8u(),ce=W<512?W:512,pe=d.pstack.alloc(ce);do{const de=W>ce?ce:W;se(de,pe),p.set(b(oe,pe,pe+de),L),W-=de,L+=de}while(W>0)}catch(W){console.error("Highly unexpected (and ignored!) exception in sqlite3_randomness():",W)}finally{d.pstack.restore(_)}return p}d.exports.sqlite3_randomness(...f)};let I;if(u.sqlite3_wasmfs_opfs_dir=function(){if(I!==void 0)return I;const f=a.wasmfsOpfsDir;if(console.error("sqlite3_wasmfs_opfs_dir() can no longer work due to incompatible WASMFS changes. It will be removed."),!f||!globalThis.FileSystemHandle||!globalThis.FileSystemDirectoryHandle||!globalThis.FileSystemFileHandle)return I="";try{return f&&d.xCallWrapped("sqlite3_wasm_init_wasmfs","i32",["string"],f)===0?I=f:I=""}catch{return I=""}},u.sqlite3_wasmfs_filename_is_persistent=function(f){const p=u.sqlite3_wasmfs_opfs_dir();return p&&f?f.startsWith(p+"/"):!1},u.sqlite3_js_db_uses_vfs=function(f,p,_=0){try{const W=u.sqlite3_vfs_find(p);return W?f?W===u.sqlite3_js_db_vfs(f,_)?W:!1:W===u.sqlite3_vfs_find(0)?W:!1:!1}catch{return!1}},u.sqlite3_js_vfs_list=function(){const f=[];let p=u.sqlite3_vfs_find(0);for(;p;){const _=new u.sqlite3_vfs(p);f.push(d.cstrToJs(_.$zName)),p=_.$pNext,_.dispose()}return f},u.sqlite3_js_db_export=function(f,p=0){f=d.xWrap.testConvertArg("sqlite3*",f),f||V("Invalid sqlite3* argument."),d.bigIntEnabled||V("BigInt64 support is not enabled.");const _=d.scopedAllocPush();let W;try{const L=d.scopedAlloc(8+d.ptrSizeof),se=L+8,oe=p?d.isPtr(p)?p:d.scopedAllocCString(""+p):0;let ce=d.exports.sqlite3_wasm_db_serialize(f,oe,se,L,0);ce&&V("Database serialization failed with code",w.capi.sqlite3_js_rc_str(ce)),W=d.peekPtr(se);const pe=d.peek(L,"i64");return ce=pe?d.heap8u().slice(W,W+Number(pe)):new Uint8Array,ce}finally{W&&d.exports.sqlite3_free(W),d.scopedAllocPop(_)}},u.sqlite3_js_db_vfs=(f,p=0)=>d.sqlite3_wasm_db_vfs(f,p),u.sqlite3_js_aggregate_context=(f,p)=>u.sqlite3_aggregate_context(f,p)||(p?g.toss("Cannot allocate",p,"bytes for sqlite3_aggregate_context()"):0),u.sqlite3_js_vfs_create_file=function(f,p,_,W){let L;_?(d.isPtr(_)?L=_:_ instanceof ArrayBuffer&&(_=new Uint8Array(_)),_ instanceof Uint8Array?(L=d.allocFromTypedArray(_),(arguments.length<4||!v.isInt32(W)||W<0)&&(W=_.byteLength)):C.toss("Invalid 3rd argument type for sqlite3_js_vfs_create_file().")):L=0,(!v.isInt32(W)||W<0)&&(d.dealloc(L),C.toss("Invalid 4th argument for sqlite3_js_vfs_create_file()."));try{const se=d.sqlite3_wasm_vfs_create_file(f,p,L,W);se&&C.toss("Creation of file failed with sqlite3 result code",u.sqlite3_js_rc_str(se))}finally{d.dealloc(L)}},v.isUIThread()){const f=function(p){const _=Object.create(null);return _.prefix="kvvfs-"+p,_.stores=[],(p==="session"||p==="")&&_.stores.push(globalThis.sessionStorage),(p==="local"||p==="")&&_.stores.push(globalThis.localStorage),_};u.sqlite3_js_kvvfs_clear=function(p=""){let _=0;const W=f(p);return W.stores.forEach(L=>{const se=[];let oe;for(oe=0;oe<L.length;++oe){const ce=L.key(oe);ce.startsWith(W.prefix)&&se.push(ce)}se.forEach(ce=>L.removeItem(ce)),_+=se.length}),_},u.sqlite3_js_kvvfs_size=function(p=""){let _=0;const W=f(p);return W.stores.forEach(L=>{let se;for(se=0;se<L.length;++se){const oe=L.key(se);oe.startsWith(W.prefix)&&(_+=oe.length,_+=L.getItem(oe).length)}}),_*2}}u.sqlite3_db_config=function(f,p,..._){switch(this.s||(this.s=d.xWrap("sqlite3_wasm_db_config_s","int",["sqlite3*","int","string:static"]),this.pii=d.xWrap("sqlite3_wasm_db_config_pii","int",["sqlite3*","int","*","int","int"]),this.ip=d.xWrap("sqlite3_wasm_db_config_ip","int",["sqlite3*","int","int","*"])),p){case u.SQLITE_DBCONFIG_ENABLE_FKEY:case u.SQLITE_DBCONFIG_ENABLE_TRIGGER:case u.SQLITE_DBCONFIG_ENABLE_FTS3_TOKENIZER:case u.SQLITE_DBCONFIG_ENABLE_LOAD_EXTENSION:case u.SQLITE_DBCONFIG_NO_CKPT_ON_CLOSE:case u.SQLITE_DBCONFIG_ENABLE_QPSG:case u.SQLITE_DBCONFIG_TRIGGER_EQP:case u.SQLITE_DBCONFIG_RESET_DATABASE:case u.SQLITE_DBCONFIG_DEFENSIVE:case u.SQLITE_DBCONFIG_WRITABLE_SCHEMA:case u.SQLITE_DBCONFIG_LEGACY_ALTER_TABLE:case u.SQLITE_DBCONFIG_DQS_DML:case u.SQLITE_DBCONFIG_DQS_DDL:case u.SQLITE_DBCONFIG_ENABLE_VIEW:case u.SQLITE_DBCONFIG_LEGACY_FILE_FORMAT:case u.SQLITE_DBCONFIG_TRUSTED_SCHEMA:case u.SQLITE_DBCONFIG_STMT_SCANSTATUS:case u.SQLITE_DBCONFIG_REVERSE_SCANORDER:return this.ip(f,p,_[0],_[1]||0);case u.SQLITE_DBCONFIG_LOOKASIDE:return this.pii(f,p,_[0],_[1],_[2]);case u.SQLITE_DBCONFIG_MAINDBNAME:return this.s(f,p,_[0]);default:return u.SQLITE_MISUSE}}.bind(Object.create(null)),u.sqlite3_value_to_js=function(f,p=!0){let _;const W=u.sqlite3_value_type(f);switch(W){case u.SQLITE_INTEGER:d.bigIntEnabled?(_=u.sqlite3_value_int64(f),v.bigIntFitsDouble(_)&&(_=Number(_))):_=u.sqlite3_value_double(f);break;case u.SQLITE_FLOAT:_=u.sqlite3_value_double(f);break;case u.SQLITE_TEXT:_=u.sqlite3_value_text(f);break;case u.SQLITE_BLOB:{const L=u.sqlite3_value_bytes(f),se=u.sqlite3_value_blob(f);L&&!se&&w.WasmAllocError.toss("Cannot allocate memory for blob argument of",L,"byte(s)"),_=L?d.heap8u().slice(se,se+Number(L)):null;break}case u.SQLITE_NULL:_=null;break;default:p&&V(u.SQLITE_MISMATCH,"Unhandled sqlite3_value_type():",W),_=void 0}return _},u.sqlite3_values_to_js=function(f,p,_=!0){let W;const L=[];for(W=0;W<f;++W)L.push(u.sqlite3_value_to_js(d.peekPtr(p+d.ptrSizeof*W)));return L},u.sqlite3_result_error_js=function(f,p){p instanceof g?u.sqlite3_result_error_nomem(f):u.sqlite3_result_error(f,""+p,-1)},u.sqlite3_result_js=function(f,p){if(p instanceof Error){u.sqlite3_result_error_js(f,p);return}try{switch(typeof p){case"undefined":break;case"boolean":u.sqlite3_result_int(f,p?1:0);break;case"bigint":v.bigIntFits32(p)?u.sqlite3_result_int(f,Number(p)):v.bigIntFitsDouble(p)?u.sqlite3_result_double(f,Number(p)):d.bigIntEnabled?v.bigIntFits64(p)?u.sqlite3_result_int64(f,p):V("BigInt value",p.toString(),"is too BigInt for int64."):V("BigInt value",p.toString(),"is too BigInt.");break;case"number":{let _;v.isInt32(p)?_=u.sqlite3_result_int:d.bigIntEnabled&&Number.isInteger(p)&&v.bigIntFits64(BigInt(p))?_=u.sqlite3_result_int64:_=u.sqlite3_result_double,_(f,p);break}case"string":{const[_,W]=d.allocCString(p,!0);u.sqlite3_result_text(f,_,W,u.SQLITE_WASM_DEALLOC);break}case"object":if(p===null){u.sqlite3_result_null(f);break}else if(v.isBindableTypedArray(p)){const _=d.allocFromTypedArray(p);u.sqlite3_result_blob(f,_,p.byteLength,u.SQLITE_WASM_DEALLOC);break}default:V("Don't not how to handle this UDF result value:",typeof p,p)}}catch(_){u.sqlite3_result_error_js(f,_)}},u.sqlite3_column_js=function(f,p,_=!0){const W=u.sqlite3_column_value(f,p);return W===0?void 0:u.sqlite3_value_to_js(W,_)};const q=function(f,p,_){_=u[_],this.ptr?d.pokePtr(this.ptr,0):this.ptr=d.allocPtr();const W=_(f,p,this.ptr);if(W)return C.toss(W,arguments[2]+"() failed with code "+W);const L=d.peekPtr(this.ptr);return L?u.sqlite3_value_to_js(L,!0):void 0}.bind(Object.create(null));u.sqlite3_preupdate_new_js=(f,p)=>q(f,p,"sqlite3_preupdate_new"),u.sqlite3_preupdate_old_js=(f,p)=>q(f,p,"sqlite3_preupdate_old"),u.sqlite3changeset_new_js=(f,p)=>q(f,p,"sqlite3changeset_new"),u.sqlite3changeset_old_js=(f,p)=>q(f,p,"sqlite3changeset_old");const w={WasmAllocError:g,SQLite3Error:C,capi:u,util:v,wasm:d,config:a,version:Object.create(null),client:void 0,asyncPostInit:async function(){let f=i.initializersAsync;if(delete i.initializersAsync,!f||!f.length)return Promise.resolve(w);f=f.map(_=>(_ instanceof Promise?_:_(w)).catch(L=>{throw console.error("an async sqlite3 initializer failed:",L),L}));const p=()=>(w.__isUnderTest||(delete w.util,delete w.StructBinder),w);{let _=f.shift();for(;f.length;)_=_.then(f.shift());return _.then(p)}},scriptInfo:void 0};try{i.initializers.forEach(f=>{f(w)})}catch(f){throw console.error("sqlite3 bootstrap initializer threw:",f),f}return delete i.initializers,i.sqlite3=w,w},globalThis.sqlite3ApiBootstrap.initializers=[],globalThis.sqlite3ApiBootstrap.initializersAsync=[],globalThis.sqlite3ApiBootstrap.defaultConfig=Object.create(null),globalThis.sqlite3ApiBootstrap.sqlite3=void 0,globalThis.WhWasmUtilInstaller=function(i){var z;i.bigIntEnabled===void 0&&(i.bigIntEnabled=!!self.BigInt64Array);const l=(...g)=>{throw new Error(g.join(" "))};i.exports||Object.defineProperty(i,"exports",{enumerable:!0,configurable:!0,get:()=>i.instance&&i.instance.exports});const a=i.pointerIR||"i32",u=i.ptrSizeof=a==="i32"?4:a==="i64"?8:l("Unhandled ptrSizeof:",a),d=Object.create(null);d.heapSize=0,d.memory=null,d.freeFuncIndexes=[],d.scopedAlloc=[],d.utf8Decoder=new TextDecoder,d.utf8Encoder=new TextEncoder("utf-8"),i.sizeofIR=g=>{switch(g){case"i8":return 1;case"i16":return 2;case"i32":case"f32":case"float":return 4;case"i64":case"f64":case"double":return 8;case"*":return u;default:return(""+g).endsWith("*")?u:void 0}};const N=function(){if(!d.memory)d.memory=i.memory instanceof WebAssembly.Memory?i.memory:i.exports.memory;else if(d.heapSize===d.memory.buffer.byteLength)return d;const g=d.memory.buffer;return d.HEAP8=new Int8Array(g),d.HEAP8U=new Uint8Array(g),d.HEAP16=new Int16Array(g),d.HEAP16U=new Uint16Array(g),d.HEAP32=new Int32Array(g),d.HEAP32U=new Uint32Array(g),i.bigIntEnabled&&(d.HEAP64=new BigInt64Array(g),d.HEAP64U=new BigUint64Array(g)),d.HEAP32F=new Float32Array(g),d.HEAP64F=new Float64Array(g),d.heapSize=g.byteLength,d};i.heap8=()=>N().HEAP8,i.heap8u=()=>N().HEAP8U,i.heap16=()=>N().HEAP16,i.heap16u=()=>N().HEAP16U,i.heap32=()=>N().HEAP32,i.heap32u=()=>N().HEAP32U,i.heapForSize=function(g,v=!0){const I=d.memory&&d.heapSize===d.memory.buffer.byteLength?d:N();switch(g){case Int8Array:return I.HEAP8;case Uint8Array:return I.HEAP8U;case Int16Array:return I.HEAP16;case Uint16Array:return I.HEAP16U;case Int32Array:return I.HEAP32;case Uint32Array:return I.HEAP32U;case 8:return v?I.HEAP8U:I.HEAP8;case 16:return v?I.HEAP16U:I.HEAP16;case 32:return v?I.HEAP32U:I.HEAP32;case 64:if(I.HEAP64)return v?I.HEAP64U:I.HEAP64;break;default:if(i.bigIntEnabled){if(g===self.BigUint64Array)return I.HEAP64U;if(g===self.BigInt64Array)return I.HEAP64;break}}l("Invalid heapForSize() size: expecting 8, 16, 32,","or (if BigInt is enabled) 64.")},i.functionTable=function(){return i.exports.__indirect_function_table},i.functionEntry=function(g){const v=i.functionTable();return g<v.length?v.get(g):void 0},i.jsFuncToWasm=function g(v,I){if(g._||(g._={sigTypes:Object.assign(Object.create(null),{i:"i32",p:"i32",P:"i32",s:"i32",j:"i64",f:"f32",d:"f64"}),typeCodes:Object.assign(Object.create(null),{f64:124,f32:125,i64:126,i32:127}),uleb128Encode:function(f,p,_){_<128?f[p](_):f[p](_%128|128,_>>7)},rxJSig:/^(\w)\((\w*)\)$/,sigParams:function(f){const p=g._.rxJSig.exec(f);return p?p[2]:f.substr(1)},letterType:f=>g._.sigTypes[f]||l("Invalid signature letter:",f),pushSigType:(f,p)=>f.push(g._.typeCodes[g._.letterType(p)])}),typeof v=="string"){const f=I;I=v,v=f}const q=g._.sigParams(I),w=[1,96];g._.uleb128Encode(w,"push",q.length);for(const f of q)g._.pushSigType(w,f);return I[0]==="v"?w.push(0):(w.push(1),g._.pushSigType(w,I[0])),g._.uleb128Encode(w,"unshift",w.length),w.unshift(0,97,115,109,1,0,0,0,1),w.push(2,7,1,1,101,1,102,0,0,7,5,1,1,102,0,0),new WebAssembly.Instance(new WebAssembly.Module(new Uint8Array(w)),{e:{f:v}}).exports.f};const S=function(v,I,q){if(q&&!d.scopedAlloc.length&&l("No scopedAllocPush() scope is active."),typeof v=="string"){const _=I;I=v,v=_}(typeof I!="string"||!(v instanceof Function))&&l("Invalid arguments: expecting (function,signature) or (signature,function).");const w=i.functionTable(),f=w.length;let p;for(;d.freeFuncIndexes.length&&(p=d.freeFuncIndexes.pop(),w.get(p));){p=null;continue}p||(p=f,w.grow(1));try{return w.set(p,v),q&&d.scopedAlloc[d.scopedAlloc.length-1].push(p),p}catch(_){if(!(_ instanceof TypeError))throw p===f&&d.freeFuncIndexes.push(f),_}try{const _=i.jsFuncToWasm(v,I);w.set(p,_),q&&d.scopedAlloc[d.scopedAlloc.length-1].push(p)}catch(_){throw p===f&&d.freeFuncIndexes.push(f),_}return p};i.installFunction=(g,v)=>S(g,v,!1),i.scopedInstallFunction=(g,v)=>S(g,v,!0),i.uninstallFunction=function(g){if(!g&&g!==0)return;const v=d.freeFuncIndexes,I=i.functionTable();v.push(g);const q=I.get(g);return I.set(g,null),q},i.peek=function(v,I="i8"){I.endsWith("*")&&(I=a);const q=d.memory&&d.heapSize===d.memory.buffer.byteLength?d:N(),w=Array.isArray(v)?[]:void 0;let f;do{switch(w&&(v=arguments[0].shift()),I){case"i1":case"i8":f=q.HEAP8[v>>0];break;case"i16":f=q.HEAP16[v>>1];break;case"i32":f=q.HEAP32[v>>2];break;case"float":case"f32":f=q.HEAP32F[v>>2];break;case"double":case"f64":f=Number(q.HEAP64F[v>>3]);break;case"i64":if(i.bigIntEnabled){f=BigInt(q.HEAP64[v>>3]);break}default:l("Invalid type for peek():",I)}w&&w.push(f)}while(w&&arguments[0].length);return w||f},i.poke=function(g,v,I="i8"){I.endsWith("*")&&(I=a);const q=d.memory&&d.heapSize===d.memory.buffer.byteLength?d:N();for(const w of Array.isArray(g)?g:[g])switch(I){case"i1":case"i8":q.HEAP8[w>>0]=v;continue;case"i16":q.HEAP16[w>>1]=v;continue;case"i32":q.HEAP32[w>>2]=v;continue;case"float":case"f32":q.HEAP32F[w>>2]=v;continue;case"double":case"f64":q.HEAP64F[w>>3]=v;continue;case"i64":if(q.HEAP64){q.HEAP64[w>>3]=BigInt(v);continue}default:l("Invalid type for poke(): "+I)}return this},i.peekPtr=(...g)=>i.peek(g.length===1?g[0]:g,a),i.pokePtr=(g,v=0)=>i.poke(g,v,a),i.peek8=(...g)=>i.peek(g.length===1?g[0]:g,"i8"),i.poke8=(g,v)=>i.poke(g,v,"i8"),i.peek16=(...g)=>i.peek(g.length===1?g[0]:g,"i16"),i.poke16=(g,v)=>i.poke(g,v,"i16"),i.peek32=(...g)=>i.peek(g.length===1?g[0]:g,"i32"),i.poke32=(g,v)=>i.poke(g,v,"i32"),i.peek64=(...g)=>i.peek(g.length===1?g[0]:g,"i64"),i.poke64=(g,v)=>i.poke(g,v,"i64"),i.peek32f=(...g)=>i.peek(g.length===1?g[0]:g,"f32"),i.poke32f=(g,v)=>i.poke(g,v,"f32"),i.peek64f=(...g)=>i.peek(g.length===1?g[0]:g,"f64"),i.poke64f=(g,v)=>i.poke(g,v,"f64"),i.getMemValue=i.peek,i.getPtrValue=i.peekPtr,i.setMemValue=i.poke,i.setPtrValue=i.pokePtr,i.isPtr32=g=>typeof g=="number"&&g===(g|0)&&g>=0,i.isPtr=i.isPtr32,i.cstrlen=function(g){if(!g||!i.isPtr(g))return null;const v=N().HEAP8U;let I=g;for(;v[I]!==0;++I);return I-g};const C=typeof SharedArrayBuffer>"u"?function(){}:SharedArrayBuffer,V=function(g,v,I){return d.utf8Decoder.decode(g.buffer instanceof C?g.slice(v,I):g.subarray(v,I))};i.cstrToJs=function(g){const v=i.cstrlen(g);return v?V(N().HEAP8U,g,g+v):v===null?v:""},i.jstrlen=function(g){if(typeof g!="string")return null;const v=g.length;let I=0;for(let q=0;q<v;++q){let w=g.charCodeAt(q);w>=55296&&w<=57343&&(w=65536+((w&1023)<<10)|g.charCodeAt(++q)&1023),w<=127?++I:w<=2047?I+=2:w<=65535?I+=3:I+=4}return I},i.jstrcpy=function(g,v,I=0,q=-1,w=!0){if((!v||!(v instanceof Int8Array)&&!(v instanceof Uint8Array))&&l("jstrcpy() target must be an Int8Array or Uint8Array."),q<0&&(q=v.length-I),!(q>0)||!(I>=0))return 0;let f=0,p=g.length;const _=I,W=I+q-(w?1:0);for(;f<p&&I<W;++f){let L=g.charCodeAt(f);if(L>=55296&&L<=57343&&(L=65536+((L&1023)<<10)|g.charCodeAt(++f)&1023),L<=127){if(I>=W)break;v[I++]=L}else if(L<=2047){if(I+1>=W)break;v[I++]=192|L>>6,v[I++]=128|L&63}else if(L<=65535){if(I+2>=W)break;v[I++]=224|L>>12,v[I++]=128|L>>6&63,v[I++]=128|L&63}else{if(I+3>=W)break;v[I++]=240|L>>18,v[I++]=128|L>>12&63,v[I++]=128|L>>6&63,v[I++]=128|L&63}}return w&&(v[I++]=0),I-_},i.cstrncpy=function(g,v,I){if((!g||!v)&&l("cstrncpy() does not accept NULL strings."),I<0)I=i.cstrlen(strPtr)+1;else if(!(I>0))return 0;const q=i.heap8u();let w=0,f;for(;w<I&&(f=q[v+w]);++w)q[g+w]=f;return w<I&&(q[g+w++]=0),w},i.jstrToUintArray=(g,v=!1)=>d.utf8Encoder.encode(v?g+"\0":g);const J=(g,v)=>{(!(g.alloc instanceof Function)||!(g.dealloc instanceof Function))&&l("Object is missing alloc() and/or dealloc() function(s)","required by",v+"().")},ie=function(g,v,I,q){if(J(i,q),typeof g!="string")return null;{const w=d.utf8Encoder.encode(g),f=I(w.length+1),p=N().HEAP8U;return p.set(w,f),p[f+w.length]=0,v?[f,w.length]:f}};i.allocCString=(g,v=!1)=>ie(g,v,i.alloc,"allocCString()"),i.scopedAllocPush=function(){J(i,"scopedAllocPush");const g=[];return d.scopedAlloc.push(g),g},i.scopedAllocPop=function(g){J(i,"scopedAllocPop");const v=arguments.length?d.scopedAlloc.indexOf(g):d.scopedAlloc.length-1;v<0&&l("Invalid state object for scopedAllocPop()."),arguments.length===0&&(g=d.scopedAlloc[v]),d.scopedAlloc.splice(v,1);for(let I;I=g.pop();)i.functionEntry(I)?i.uninstallFunction(I):i.dealloc(I)},i.scopedAlloc=function(g){d.scopedAlloc.length||l("No scopedAllocPush() scope is active.");const v=i.alloc(g);return d.scopedAlloc[d.scopedAlloc.length-1].push(v),v},Object.defineProperty(i.scopedAlloc,"level",{configurable:!1,enumerable:!1,get:()=>d.scopedAlloc.length,set:()=>l("The 'active' property is read-only.")}),i.scopedAllocCString=(g,v=!1)=>ie(g,v,i.scopedAlloc,"scopedAllocCString()");const k=function(g,v){const I=i[g?"scopedAlloc":"alloc"]((v.length+1)*i.ptrSizeof);let q=0;return v.forEach(w=>{i.pokePtr(I+i.ptrSizeof*q++,i[g?"scopedAllocCString":"allocCString"](""+w))}),i.pokePtr(I+i.ptrSizeof*q,0),I};i.scopedAllocMainArgv=g=>k(!0,g),i.allocMainArgv=g=>k(!1,g),i.cArgvToJs=(g,v)=>{const I=[];for(let q=0;q<g;++q){const w=i.peekPtr(v+i.ptrSizeof*q);I.push(w?i.cstrToJs(w):null)}return I},i.scopedAllocCall=function(g){i.scopedAllocPush();try{return g()}finally{i.scopedAllocPop()}};const m=function(g,v,I){J(i,I);const q=v?"i64":a;let w=i[I](g*(v?8:u));if(i.poke(w,0,q),g===1)return w;const f=[w];for(let p=1;p<g;++p)w+=v?8:u,f[p]=w,i.poke(w,0,q);return f};i.allocPtr=(g=1,v=!0)=>m(g,v,"alloc"),i.scopedAllocPtr=(g=1,v=!0)=>m(g,v,"scopedAlloc"),i.xGet=function(g){return i.exports[g]||l("Cannot find exported symbol:",g)};const y=(g,v)=>l(g+"() requires",v,"argument(s).");i.xCall=function(g,...v){const I=i.xGet(g);return I instanceof Function||l("Exported symbol",g,"is not a function."),I.length!==v.length&&y(g,I.length),arguments.length===2&&Array.isArray(arguments[1])?I.apply(null,arguments[1]):I.apply(null,v)},d.xWrap=Object.create(null),d.xWrap.convert=Object.create(null),d.xWrap.convert.arg=new Map,d.xWrap.convert.result=new Map;const x=d.xWrap.convert.arg,E=d.xWrap.convert.result;i.bigIntEnabled&&x.set("i64",g=>BigInt(g));const b=a==="i32"?g=>g|0:g=>BigInt(g)|BigInt(0);x.set("i32",b).set("i16",g=>(g|0)&65535).set("i8",g=>(g|0)&255).set("f32",g=>Number(g).valueOf()).set("float",x.get("f32")).set("f64",x.get("f32")).set("double",x.get("f64")).set("int",x.get("i32")).set("null",g=>g).set(null,x.get("null")).set("**",b).set("*",b),E.set("*",b).set("pointer",b).set("number",g=>Number(g)).set("void",g=>{}).set("null",g=>g).set(null,E.get("null"));{const g=["i8","i16","i32","int","f32","float","f64","double"];i.bigIntEnabled&&g.push("i64");const v=x.get(a);for(const I of g)x.set(I+"*",v),E.set(I+"*",v),E.set(I,x.get(I)||l("Missing arg converter:",I))}const P=function(g){return typeof g=="string"?i.scopedAllocCString(g):g?b(g):null};x.set("string",P).set("utf8",P).set("pointer",P),E.set("string",g=>i.cstrToJs(g)).set("utf8",E.get("string")).set("string:dealloc",g=>{try{return g?i.cstrToJs(g):null}finally{i.dealloc(g)}}).set("utf8:dealloc",E.get("string:dealloc")).set("json",g=>JSON.parse(i.cstrToJs(g))).set("json:dealloc",g=>{try{return g?JSON.parse(i.cstrToJs(g)):null}finally{i.dealloc(g)}});const M=class{constructor(g){this.name=g.name||"unnamed adapter"}convertArg(g,v,I){l("AbstractArgAdapter must be subclassed.")}};x.FuncPtrAdapter=(z=class extends M{constructor(v){super(v),x.FuncPtrAdapter.warnOnUse&&console.warn("xArg.FuncPtrAdapter is an internal-only API","and is not intended to be invoked from","client-level code. Invoked with:",v),this.signature=v.signature,v.contextKey instanceof Function&&(this.contextKey=v.contextKey,v.bindScope||(v.bindScope="context")),this.bindScope=v.bindScope||l("FuncPtrAdapter options requires a bindScope (explicit or implied)."),z.bindScopes.indexOf(v.bindScope)<0&&l("Invalid options.bindScope ("+v.bindMod+") for FuncPtrAdapter. Expecting one of: ("+z.bindScopes.join(", ")+")"),this.isTransient=this.bindScope==="transient",this.isContext=this.bindScope==="context",this.isPermanent=this.bindScope==="permanent",this.singleton=this.bindScope==="singleton"?[]:void 0,this.callProxy=v.callProxy instanceof Function?v.callProxy:void 0}contextKey(v,I){return this}contextMap(v){const I=this.__cmap||(this.__cmap=new Map);let q=I.get(v);return q===void 0&&I.set(v,q=[]),q}convertArg(v,I,q){let w=this.singleton;if(!w&&this.isContext&&(w=this.contextMap(this.contextKey(I,q))),w&&w[0]===v)return w[1];if(v instanceof Function){this.callProxy&&(v=this.callProxy(v));const f=S(v,this.signature,this.isTransient);if(z.debugFuncInstall&&z.debugOut("FuncPtrAdapter installed",this,this.contextKey(I,q),"@"+f,v),w){if(w[1]){z.debugFuncInstall&&z.debugOut("FuncPtrAdapter uninstalling",this,this.contextKey(I,q),"@"+w[1],v);try{i.uninstallFunction(w[1])}catch{}}w[0]=v,w[1]=f}return f}else if(i.isPtr(v)||v===null||v===void 0){if(w&&w[1]&&w[1]!==v){z.debugFuncInstall&&z.debugOut("FuncPtrAdapter uninstalling",this,this.contextKey(I,q),"@"+w[1],v);try{i.uninstallFunction(w[1])}catch{}w[0]=w[1]=v|0}return v||0}else throw new TypeError("Invalid FuncPtrAdapter argument type. Expecting a function pointer or a "+(this.name?this.name+" ":"")+"function matching signature "+this.signature+".")}},Tt(z,"warnOnUse",!1),Tt(z,"debugFuncInstall",!1),Tt(z,"debugOut",console.debug.bind(console)),Tt(z,"bindScopes",["transient","context","singleton","permanent"]),z);const B=g=>x.get(g)||l("Argument adapter not found:",g),D=g=>E.get(g)||l("Result adapter not found:",g);d.xWrap.convertArg=(g,...v)=>B(g)(...v),d.xWrap.convertArgNoCheck=(g,...v)=>x.get(g)(...v),d.xWrap.convertResult=(g,v)=>g===null?v:g?D(g)(v):void 0,d.xWrap.convertResultNoCheck=(g,v)=>g===null?v:g?E.get(g)(v):void 0,i.xWrap=function(g,v,...I){arguments.length===3&&Array.isArray(arguments[2])&&(I=arguments[2]),i.isPtr(g)&&(g=i.functionEntry(g)||l("Function pointer not found in WASM function table."));const q=g instanceof Function,w=q?g:i.xGet(g);if(q&&(g=w.name||"unnamed function"),I.length!==w.length&&y(g,w.length),v===null&&w.length===0)return w;v!=null&&D(v);for(const p of I)p instanceof M?x.set(p,(..._)=>p.convertArg(..._)):B(p);const f=d.xWrap;return w.length===0?(...p)=>p.length?y(g,w.length):f.convertResult(v,w.call(null)):function(...p){p.length!==w.length&&y(g,w.length);const _=i.scopedAllocPush();try{for(const W in p)p[W]=f.convertArgNoCheck(I[W],p[W],p,W);return f.convertResultNoCheck(v,w.apply(null,p))}finally{i.scopedAllocPop(_)}}};const le=function(g,v,I,q,w,f){if(typeof I=="string"){if(v===1)return f.get(I);if(v===2){if(q)q instanceof Function||l(w,"requires a function argument.");else return delete f.get(I),g;return f.set(I,q),g}}l("Invalid arguments to",w)};return i.xWrap.resultAdapter=function g(v,I){return le(g,arguments.length,v,I,"resultAdapter()",E)},i.xWrap.argAdapter=function g(v,I){return le(g,arguments.length,v,I,"argAdapter()",x)},i.xWrap.FuncPtrAdapter=x.FuncPtrAdapter,i.xCallWrapped=function(g,v,I,...q){return Array.isArray(arguments[3])&&(q=arguments[3]),i.xWrap(g,v,I||[]).apply(null,q||[])},i.xWrap.testConvertArg=d.xWrap.convertArg,i.xWrap.testConvertResult=d.xWrap.convertResult,i},globalThis.WhWasmUtilInstaller.yawl=function(i){const l=()=>fetch(i.uri,{credentials:"same-origin"}),a=this,u=function(N){if(i.wasmUtilTarget){const S=(...V)=>{throw new Error(V.join(" "))},C=i.wasmUtilTarget;if(C.module=N.module,C.instance=N.instance,C.instance.exports.memory||(C.memory=i.imports&&i.imports.env&&i.imports.env.memory||S("Missing 'memory' object!")),!C.alloc&&N.instance.exports.malloc){const V=N.instance.exports;C.alloc=function(J){return V.malloc(J)||S("Allocation of",J,"bytes failed.")},C.dealloc=function(J){V.free(J)}}a(C)}return i.onload&&i.onload(N,i),N};return WebAssembly.instantiateStreaming?function(){return WebAssembly.instantiateStreaming(l(),i.imports||{}).then(u)}:function(){return l().then(S=>S.arrayBuffer()).then(S=>WebAssembly.instantiate(S,i.imports||{})).then(u)}}.bind(globalThis.WhWasmUtilInstaller),globalThis.Jaccwabyt=function i(l){const a=(...T)=>{throw new Error(T.join(" "))};!(l.heap instanceof WebAssembly.Memory)&&!(l.heap instanceof Function)&&a("config.heap must be WebAssembly.Memory instance or a function."),["alloc","dealloc"].forEach(function(T){l[T]instanceof Function||a("Config option '"+T+"' must be a function.")});const u=i,d=l.heap instanceof Function?l.heap:()=>new Uint8Array(l.heap.buffer),N=l.alloc,S=l.dealloc,C=l.log||console.log.bind(console),V=l.memberPrefix||"",J=l.memberSuffix||"",ie=l.bigIntEnabled===void 0?!!self.BigInt64Array:!!l.bigIntEnabled,k=self.BigInt,m=self.BigInt64Array,y=l.ptrSizeof||4,x=l.ptrIR||"i32";u.debugFlags||(u.__makeDebugFlags=function(T=null){T&&T.__flags&&(T=T.__flags);const H=function $(K){return arguments.length===0?$.__flags:(K<0?(delete $.__flags.getter,delete $.__flags.setter,delete $.__flags.alloc,delete $.__flags.dealloc):($.__flags.getter=(1&K)!==0,$.__flags.setter=(2&K)!==0,$.__flags.alloc=(4&K)!==0,$.__flags.dealloc=(8&K)!==0),$._flags)};return Object.defineProperty(H,"__flags",{iterable:!1,writable:!1,value:Object.create(T)}),T||H(0),H},u.debugFlags=u.__makeDebugFlags());const E=function(){const T=new ArrayBuffer(2);return new DataView(T).setInt16(0,256,!0),new Int16Array(T)[0]===256}(),b=T=>T[1]==="(",P=T=>T==="P",M=T=>b(T)?"p":T[0],B=function(T){switch(M(T)){case"c":case"C":return"i8";case"i":return"i32";case"p":case"P":case"s":return x;case"j":return"i64";case"f":return"float";case"d":return"double"}a("Unhandled signature IR:",T)},D=m?()=>!0:()=>a("BigInt64Array is not available."),le=function(T){switch(M(T)){case"p":case"P":case"s":{switch(y){case 4:return"getInt32";case 8:return D()&&"getBigInt64"}break}case"i":return"getInt32";case"c":return"getInt8";case"C":return"getUint8";case"j":return D()&&"getBigInt64";case"f":return"getFloat32";case"d":return"getFloat64"}a("Unhandled DataView getter for signature:",T)},z=function(T){switch(M(T)){case"p":case"P":case"s":{switch(y){case 4:return"setInt32";case 8:return D()&&"setBigInt64"}break}case"i":return"setInt32";case"c":return"setInt8";case"C":return"setUint8";case"j":return D()&&"setBigInt64";case"f":return"setFloat32";case"d":return"setFloat64"}a("Unhandled DataView setter for signature:",T)},g=function(T){switch(M(T)){case"i":case"f":case"c":case"C":case"d":return Number;case"j":return D()&&k;case"p":case"P":case"s":switch(y){case 4:return Number;case 8:return D()&&k}break}a("Unhandled DataView set wrapper for signature:",T)},v=(T,H)=>T+"::"+H,I=function(T,H){return()=>a(v(T,H),"is read-only.")},q=new WeakMap,w="(pointer-is-external)",f=function(T,H,$){if($||($=q.get(H)),$){if(q.delete(H),Array.isArray(H.ondispose)){let K;for(;K=H.ondispose.shift();)try{K instanceof Function?K.call(H):K instanceof be?K.dispose():typeof K=="number"&&S(K)}catch(Ie){console.warn("ondispose() for",T.structName,"@",$,"threw. NOT propagating it.",Ie)}}else if(H.ondispose instanceof Function)try{H.ondispose()}catch(K){console.warn("ondispose() for",T.structName,"@",$,"threw. NOT propagating it.",K)}delete H.ondispose,T.debugFlags.__flags.dealloc&&C("debug.dealloc:",H[w]?"EXTERNAL":"",T.structName,"instance:",T.structInfo.sizeof,"bytes @"+$),H[w]||S($)}},p=T=>({configurable:!1,writable:!1,iterable:!1,value:T}),_=function(T,H,$){let K=!$;$?Object.defineProperty(H,w,p($)):($=N(T.structInfo.sizeof),$||a("Allocation of",T.structName,"structure failed."));try{T.debugFlags.__flags.alloc&&C("debug.alloc:",K?"":"EXTERNAL",T.structName,"instance:",T.structInfo.sizeof,"bytes @"+$),K&&d().fill(0,$,$+T.structInfo.sizeof),q.set(H,$)}catch(Ie){throw f(T,H,$),Ie}},W=function(){const T=this.pointer;return T?new Uint8Array(d().slice(T,T+this.structInfo.sizeof)):null},se=p(T=>V+T+J),oe=function(T,H,$=!0){let K=T.members[H];if(!K&&(V||J)){for(const Ie of Object.values(T.members))if(Ie.key===H){K=Ie;break}!K&&$&&a(v(T.name,H),"is not a mapped struct member.")}return K},ce=function T(H,$,K=!1){T._||(T._=Be=>Be.replace(/[^vipPsjrdcC]/g,"").replace(/[pPscC]/g,"i"));const Ie=oe(H.structInfo,$,!0);return K?T._(Ie.signature):Ie.signature},pe={configurable:!1,enumerable:!1,get:function(){return q.get(this)},set:()=>a("Cannot assign the 'pointer' property of a struct.")},de=p(function(){const T=[];for(const H of Object.keys(this.structInfo.members))T.push(this.memberKey(H));return T}),ve=new TextDecoder("utf-8"),Je=new TextEncoder,mt=typeof SharedArrayBuffer>"u"?function(){}:SharedArrayBuffer,un=function(T,H,$){return ve.decode(T.buffer instanceof mt?T.slice(H,$):T.subarray(H,$))},O=function(T,H,$=!1){const K=oe(T.structInfo,H,$);return K&&K.signature.length===1&&K.signature[0]==="s"?K:!1},j=function(T){T.signature!=="s"&&a("Invalid member type signature for C-string value:",JSON.stringify(T))},Q=function(H,$){const K=oe(H.structInfo,$,!0);j(K);const Ie=H[K.key];if(!Ie)return null;let Be=Ie;const Ae=d();for(;Ae[Be]!==0;++Be);return Ie===Be?"":un(Ae,Ie,Be)},Y=function(T,...H){T.ondispose?Array.isArray(T.ondispose)||(T.ondispose=[T.ondispose]):T.ondispose=[],T.ondispose.push(...H)},G=function(T){const H=Je.encode(T),$=N(H.length+1);$||a("Allocation error while duplicating string:",T);const K=d();return K.set(H,$),K[$+H.length]=0,$},xe=function(T,H,$){const K=oe(T.structInfo,H,!0);j(K);const Ie=G($);return T[K.key]=Ie,Y(T,Ie),T},be=function(H,$){arguments[2]!==p&&a("Do not call the StructType constructor","from client-level code."),Object.defineProperties(this,{structName:p(H),structInfo:p($)})};be.prototype=Object.create(null,{dispose:p(function(){f(this.constructor,this)}),lookupMember:p(function(T,H=!0){return oe(this.structInfo,T,H)}),memberToJsString:p(function(T){return Q(this,T)}),memberIsString:p(function(T,H=!0){return O(this,T,H)}),memberKey:se,memberKeys:de,memberSignature:p(function(T,H=!1){return ce(this,T,H)}),memoryDump:p(W),pointer:pe,setMemberCString:p(function(T,H){return xe(this,T,H)})}),Object.assign(be.prototype,{addOnDispose:function(...T){return Y(this,...T),this}}),Object.defineProperties(be,{allocCString:p(G),isA:p(T=>T instanceof be),hasExternalPointer:p(T=>T instanceof be&&!!T[w]),memberKey:se});const ne=T=>Number.isFinite(T)||T instanceof(k||Number),Vt=function T(H,$,K){if(!T._){T._={getters:{},setters:{},sw:{}};const St=["i","c","C","p","P","s","f","d","v()"];ie&&St.push("j"),St.forEach(function(cn){T._.getters[cn]=le(cn),T._.setters[cn]=z(cn),T._.sw[cn]=g(cn)});const pd=/^[ipPsjfdcC]$/,_d=/^[vipPsjfdcC]\([ipPsjfdcC]*\)$/;T.sigCheck=function(cn,md,rl,wo){Object.prototype.hasOwnProperty.call(cn,rl)&&a(cn.structName,"already has a property named",rl+"."),pd.test(wo)||_d.test(wo)||a("Malformed signature for",v(cn.structName,md)+":",wo)}}const Ie=H.memberKey($);T.sigCheck(H.prototype,$,Ie,K.signature),K.key=Ie,K.name=$;const Be=M(K.signature),Ae=v(H.prototype.structName,Ie),$e=H.prototype.debugFlags.__flags,Fr=Object.create(null);Fr.configurable=!1,Fr.enumerable=!1,Fr.get=function(){$e.getter&&C("debug.getter:",T._.getters[Be],"for",B(Be),Ae,"@",this.pointer,"+",K.offset,"sz",K.sizeof);let St=new DataView(d().buffer,this.pointer+K.offset,K.sizeof)[T._.getters[Be]](0,E);return $e.getter&&C("debug.getter:",Ae,"result =",St),St},K.readOnly?Fr.set=I(H.prototype.structName,Ie):Fr.set=function(St){if($e.setter&&C("debug.setter:",T._.setters[Be],"for",B(Be),Ae,"@",this.pointer,"+",K.offset,"sz",K.sizeof,St),this.pointer||a("Cannot set struct property on disposed instance."),St===null)St=0;else for(;!ne(St);){if(P(K.signature)&&St instanceof be){St=St.pointer||0,$e.setter&&C("debug.setter:",Ae,"resolved to",St);break}a("Invalid value for pointer-type",Ae+".")}new DataView(d().buffer,this.pointer+K.offset,K.sizeof)[T._.setters[Be]](0,T._.sw[Be](St),E)},Object.defineProperty(H.prototype,Ie,Fr)},ct=function T(H,$){arguments.length===1?($=H,H=$.name):$.name||($.name=H),H||a("Struct name is required.");let K=!1;Object.keys($.members).forEach(Ae=>{const $e=$.members[Ae];$e.sizeof?$e.sizeof===1?$e.signature==="c"||$e.signature==="C"||a("Unexpected sizeof==1 member",v($.name,Ae),"with signature",$e.signature):($e.sizeof%4!==0&&(console.warn("Invalid struct member description =",$e,"from",$),a(H,"member",Ae,"sizeof is not aligned. sizeof="+$e.sizeof)),$e.offset%4!==0&&(console.warn("Invalid struct member description =",$e,"from",$),a(H,"member",Ae,"offset is not aligned. offset="+$e.offset))):a(H,"member",Ae,"is missing sizeof."),(!K||K.offset<$e.offset)&&(K=$e)}),K?$.sizeof<K.offset+K.sizeof&&a("Invalid struct config:",H,"max member offset ("+K.offset+") ","extends past end of struct (sizeof="+$.sizeof+")."):a("No member property descriptions found.");const Ie=p(u.__makeDebugFlags(T.debugFlags)),Be=function Ae($e){this instanceof Ae?arguments.length?(($e!==($e|0)||$e<=0)&&a("Invalid pointer value for",H,"constructor."),_(Ae,this,$e)):_(Ae,this):a("The",H,"constructor may only be called via 'new'.")};return Object.defineProperties(Be,{debugFlags:Ie,isA:p(Ae=>Ae instanceof Be),memberKey:se,memberKeys:de,methodInfoForKey:p(function(Ae){}),structInfo:p($),structName:p(H)}),Be.prototype=new be(H,$,p),Object.defineProperties(Be.prototype,{debugFlags:Ie,constructor:p(Be)}),Object.keys($.members).forEach(Ae=>Vt(Be,Ae,$.members[Ae])),Be};return ct.StructType=be,ct.config=l,ct.allocCString=G,ct.debugFlags||(ct.debugFlags=u.__makeDebugFlags(u.debugFlags)),ct},globalThis.sqlite3ApiBootstrap.initializers.push(function(i){const l=(...k)=>{throw new Error(k.join(" "))};i.SQLite3Error.toss;const a=i.capi,u=i.wasm,d=i.util;if(globalThis.WhWasmUtilInstaller(u),delete globalThis.WhWasmUtilInstaller,u.bindingSignatures=[["sqlite3_aggregate_context","void*","sqlite3_context*","int"],["sqlite3_bind_double","int","sqlite3_stmt*","int","f64"],["sqlite3_bind_int","int","sqlite3_stmt*","int","int"],["sqlite3_bind_null",void 0,"sqlite3_stmt*","int"],["sqlite3_bind_parameter_count","int","sqlite3_stmt*"],["sqlite3_bind_parameter_index","int","sqlite3_stmt*","string"],["sqlite3_bind_pointer","int","sqlite3_stmt*","int","*","string:static","*"],["sqlite3_busy_handler","int",["sqlite3*",new u.xWrap.FuncPtrAdapter({signature:"i(pi)",contextKey:(k,m)=>k[0]}),"*"]],["sqlite3_busy_timeout","int","sqlite3*","int"],["sqlite3_changes","int","sqlite3*"],["sqlite3_clear_bindings","int","sqlite3_stmt*"],["sqlite3_collation_needed","int","sqlite3*","*","*"],["sqlite3_column_blob","*","sqlite3_stmt*","int"],["sqlite3_column_bytes","int","sqlite3_stmt*","int"],["sqlite3_column_count","int","sqlite3_stmt*"],["sqlite3_column_double","f64","sqlite3_stmt*","int"],["sqlite3_column_int","int","sqlite3_stmt*","int"],["sqlite3_column_name","string","sqlite3_stmt*","int"],["sqlite3_column_text","string","sqlite3_stmt*","int"],["sqlite3_column_type","int","sqlite3_stmt*","int"],["sqlite3_column_value","sqlite3_value*","sqlite3_stmt*","int"],["sqlite3_commit_hook","void*",["sqlite3*",new u.xWrap.FuncPtrAdapter({name:"sqlite3_commit_hook",signature:"i(p)",contextKey:k=>k[0]}),"*"]],["sqlite3_compileoption_get","string","int"],["sqlite3_compileoption_used","int","string"],["sqlite3_complete","int","string:flexible"],["sqlite3_context_db_handle","sqlite3*","sqlite3_context*"],["sqlite3_data_count","int","sqlite3_stmt*"],["sqlite3_db_filename","string","sqlite3*","string"],["sqlite3_db_handle","sqlite3*","sqlite3_stmt*"],["sqlite3_db_name","string","sqlite3*","int"],["sqlite3_db_status","int","sqlite3*","int","*","*","int"],["sqlite3_errcode","int","sqlite3*"],["sqlite3_errmsg","string","sqlite3*"],["sqlite3_error_offset","int","sqlite3*"],["sqlite3_errstr","string","int"],["sqlite3_exec","int",["sqlite3*","string:flexible",new u.xWrap.FuncPtrAdapter({signature:"i(pipp)",bindScope:"transient",callProxy:k=>{let m;return(y,x,E,b)=>{try{const P=u.cArgvToJs(x,E);return m||(m=u.cArgvToJs(x,b)),k(P,m)|0}catch(P){return P.resultCode||a.SQLITE_ERROR}}}}),"*","**"]],["sqlite3_expanded_sql","string","sqlite3_stmt*"],["sqlite3_extended_errcode","int","sqlite3*"],["sqlite3_extended_result_codes","int","sqlite3*","int"],["sqlite3_file_control","int","sqlite3*","string","int","*"],["sqlite3_finalize","int","sqlite3_stmt*"],["sqlite3_free",void 0,"*"],["sqlite3_get_auxdata","*","sqlite3_context*","int"],["sqlite3_initialize",void 0],["sqlite3_keyword_count","int"],["sqlite3_keyword_name","int",["int","**","*"]],["sqlite3_keyword_check","int",["string","int"]],["sqlite3_libversion","string"],["sqlite3_libversion_number","int"],["sqlite3_limit","int",["sqlite3*","int","int"]],["sqlite3_malloc","*","int"],["sqlite3_open","int","string","*"],["sqlite3_open_v2","int","string","*","int","string"],["sqlite3_progress_handler",void 0,["sqlite3*","int",new u.xWrap.FuncPtrAdapter({name:"xProgressHandler",signature:"i(p)",bindScope:"context",contextKey:(k,m)=>k[0]}),"*"]],["sqlite3_realloc","*","*","int"],["sqlite3_reset","int","sqlite3_stmt*"],["sqlite3_result_blob",void 0,"sqlite3_context*","*","int","*"],["sqlite3_result_double",void 0,"sqlite3_context*","f64"],["sqlite3_result_error",void 0,"sqlite3_context*","string","int"],["sqlite3_result_error_code",void 0,"sqlite3_context*","int"],["sqlite3_result_error_nomem",void 0,"sqlite3_context*"],["sqlite3_result_error_toobig",void 0,"sqlite3_context*"],["sqlite3_result_int",void 0,"sqlite3_context*","int"],["sqlite3_result_null",void 0,"sqlite3_context*"],["sqlite3_result_pointer",void 0,"sqlite3_context*","*","string:static","*"],["sqlite3_result_subtype",void 0,"sqlite3_value*","int"],["sqlite3_result_text",void 0,"sqlite3_context*","string","int","*"],["sqlite3_result_zeroblob",void 0,"sqlite3_context*","int"],["sqlite3_rollback_hook","void*",["sqlite3*",new u.xWrap.FuncPtrAdapter({name:"sqlite3_rollback_hook",signature:"v(p)",contextKey:k=>k[0]}),"*"]],["sqlite3_set_authorizer","int",["sqlite3*",new u.xWrap.FuncPtrAdapter({name:"sqlite3_set_authorizer::xAuth",signature:"i(pissss)",contextKey:(k,m)=>k[0],callProxy:k=>(m,y,x,E,b,P)=>{try{return x=x&&u.cstrToJs(x),E=E&&u.cstrToJs(E),b=b&&u.cstrToJs(b),P=P&&u.cstrToJs(P),k(m,y,x,E,b,P)||0}catch(M){return M.resultCode||a.SQLITE_ERROR}}}),"*"]],["sqlite3_set_auxdata",void 0,["sqlite3_context*","int","*",new u.xWrap.FuncPtrAdapter({name:"xDestroyAuxData",signature:"v(*)",contextKey:(k,m)=>k[0]})]],["sqlite3_shutdown",void 0],["sqlite3_sourceid","string"],["sqlite3_sql","string","sqlite3_stmt*"],["sqlite3_status","int","int","*","*","int"],["sqlite3_step","int","sqlite3_stmt*"],["sqlite3_stmt_isexplain","int",["sqlite3_stmt*"]],["sqlite3_stmt_readonly","int",["sqlite3_stmt*"]],["sqlite3_stmt_status","int","sqlite3_stmt*","int","int"],["sqlite3_strglob","int","string","string"],["sqlite3_stricmp","int","string","string"],["sqlite3_strlike","int","string","string","int"],["sqlite3_strnicmp","int","string","string","int"],["sqlite3_table_column_metadata","int","sqlite3*","string","string","string","**","**","*","*","*"],["sqlite3_total_changes","int","sqlite3*"],["sqlite3_trace_v2","int",["sqlite3*","int",new u.xWrap.FuncPtrAdapter({name:"sqlite3_trace_v2::callback",signature:"i(ippp)",contextKey:(k,m)=>k[0]}),"*"]],["sqlite3_txn_state","int",["sqlite3*","string"]],["sqlite3_uri_boolean","int","sqlite3_filename","string","int"],["sqlite3_uri_key","string","sqlite3_filename","int"],["sqlite3_uri_parameter","string","sqlite3_filename","string"],["sqlite3_user_data","void*","sqlite3_context*"],["sqlite3_value_blob","*","sqlite3_value*"],["sqlite3_value_bytes","int","sqlite3_value*"],["sqlite3_value_double","f64","sqlite3_value*"],["sqlite3_value_dup","sqlite3_value*","sqlite3_value*"],["sqlite3_value_free",void 0,"sqlite3_value*"],["sqlite3_value_frombind","int","sqlite3_value*"],["sqlite3_value_int","int","sqlite3_value*"],["sqlite3_value_nochange","int","sqlite3_value*"],["sqlite3_value_numeric_type","int","sqlite3_value*"],["sqlite3_value_pointer","*","sqlite3_value*","string:static"],["sqlite3_value_subtype","int","sqlite3_value*"],["sqlite3_value_text","string","sqlite3_value*"],["sqlite3_value_type","int","sqlite3_value*"],["sqlite3_vfs_find","*","string"],["sqlite3_vfs_register","int","sqlite3_vfs*","int"],["sqlite3_vfs_unregister","int","sqlite3_vfs*"]],u.exports.sqlite3_activate_see instanceof Function&&u.bindingSignatures.push(["sqlite3_key","int","sqlite3*","string","int"],["sqlite3_key_v2","int","sqlite3*","string","*","int"],["sqlite3_rekey","int","sqlite3*","string","int"],["sqlite3_rekey_v2","int","sqlite3*","string","*","int"],["sqlite3_activate_see",void 0,"string"]),u.bindingSignatures.int64=[["sqlite3_bind_int64","int",["sqlite3_stmt*","int","i64"]],["sqlite3_changes64","i64",["sqlite3*"]],["sqlite3_column_int64","i64",["sqlite3_stmt*","int"]],["sqlite3_create_module","int",["sqlite3*","string","sqlite3_module*","*"]],["sqlite3_create_module_v2","int",["sqlite3*","string","sqlite3_module*","*","*"]],["sqlite3_declare_vtab","int",["sqlite3*","string:flexible"]],["sqlite3_deserialize","int","sqlite3*","string","*","i64","i64","int"],["sqlite3_drop_modules","int",["sqlite3*","**"]],["sqlite3_last_insert_rowid","i64",["sqlite3*"]],["sqlite3_malloc64","*","i64"],["sqlite3_msize","i64","*"],["sqlite3_overload_function","int",["sqlite3*","string","int"]],["sqlite3_preupdate_blobwrite","int","sqlite3*"],["sqlite3_preupdate_count","int","sqlite3*"],["sqlite3_preupdate_depth","int","sqlite3*"],["sqlite3_preupdate_hook","*",["sqlite3*",new u.xWrap.FuncPtrAdapter({name:"sqlite3_preupdate_hook",signature:"v(ppippjj)",contextKey:k=>k[0],callProxy:k=>(m,y,x,E,b,P,M)=>{k(m,y,x,u.cstrToJs(E),u.cstrToJs(b),P,M)}}),"*"]],["sqlite3_preupdate_new","int",["sqlite3*","int","**"]],["sqlite3_preupdate_old","int",["sqlite3*","int","**"]],["sqlite3_realloc64","*","*","i64"],["sqlite3_result_int64",void 0,"*","i64"],["sqlite3_result_zeroblob64","int","*","i64"],["sqlite3_serialize","*","sqlite3*","string","*","int"],["sqlite3_set_last_insert_rowid",void 0,["sqlite3*","i64"]],["sqlite3_status64","int","int","*","*","int"],["sqlite3_total_changes64","i64",["sqlite3*"]],["sqlite3_update_hook","*",["sqlite3*",new u.xWrap.FuncPtrAdapter({name:"sqlite3_update_hook",signature:"v(iippj)",contextKey:k=>k[0],callProxy:k=>(m,y,x,E,b)=>{k(m,y,u.cstrToJs(x),u.cstrToJs(E),b)}}),"*"]],["sqlite3_uri_int64","i64",["sqlite3_filename","string","i64"]],["sqlite3_value_int64","i64","sqlite3_value*"],["sqlite3_vtab_collation","string","sqlite3_index_info*","int"],["sqlite3_vtab_distinct","int","sqlite3_index_info*"],["sqlite3_vtab_in","int","sqlite3_index_info*","int","int"],["sqlite3_vtab_in_first","int","sqlite3_value*","**"],["sqlite3_vtab_in_next","int","sqlite3_value*","**"],["sqlite3_vtab_nochange","int","sqlite3_context*"],["sqlite3_vtab_on_conflict","int","sqlite3*"],["sqlite3_vtab_rhs_value","int","sqlite3_index_info*","int","**"]],u.bigIntEnabled&&u.exports.sqlite3changegroup_add){const k={signature:"i(ps)",callProxy:m=>(y,x)=>{try{return m(y,u.cstrToJs(x))|0}catch(E){return E.resultCode||a.SQLITE_ERROR}}};u.bindingSignatures.int64.push(["sqlite3changegroup_add","int",["sqlite3_changegroup*","int","void*"]],["sqlite3changegroup_add_strm","int",["sqlite3_changegroup*",new u.xWrap.FuncPtrAdapter({name:"xInput",signature:"i(ppp)",bindScope:"transient"}),"void*"]],["sqlite3changegroup_delete",void 0,["sqlite3_changegroup*"]],["sqlite3changegroup_new","int",["**"]],["sqlite3changegroup_output","int",["sqlite3_changegroup*","int*","**"]],["sqlite3changegroup_output_strm","int",["sqlite3_changegroup*",new u.xWrap.FuncPtrAdapter({name:"xOutput",signature:"i(ppi)",bindScope:"transient"}),"void*"]],["sqlite3changeset_apply","int",["sqlite3*","int","void*",new u.xWrap.FuncPtrAdapter({name:"xFilter",bindScope:"transient",...k}),new u.xWrap.FuncPtrAdapter({name:"xConflict",signature:"i(pip)",bindScope:"transient"}),"void*"]],["sqlite3changeset_apply_strm","int",["sqlite3*",new u.xWrap.FuncPtrAdapter({name:"xInput",signature:"i(ppp)",bindScope:"transient"}),"void*",new u.xWrap.FuncPtrAdapter({name:"xFilter",bindScope:"transient",...k}),new u.xWrap.FuncPtrAdapter({name:"xConflict",signature:"i(pip)",bindScope:"transient"}),"void*"]],["sqlite3changeset_apply_v2","int",["sqlite3*","int","void*",new u.xWrap.FuncPtrAdapter({name:"xFilter",bindScope:"transient",...k}),new u.xWrap.FuncPtrAdapter({name:"xConflict",signature:"i(pip)",bindScope:"transient"}),"void*","**","int*","int"]],["sqlite3changeset_apply_v2_strm","int",["sqlite3*",new u.xWrap.FuncPtrAdapter({name:"xInput",signature:"i(ppp)",bindScope:"transient"}),"void*",new u.xWrap.FuncPtrAdapter({name:"xFilter",bindScope:"transient",...k}),new u.xWrap.FuncPtrAdapter({name:"xConflict",signature:"i(pip)",bindScope:"transient"}),"void*","**","int*","int"]],["sqlite3changeset_concat","int",["int","void*","int","void*","int*","**"]],["sqlite3changeset_concat_strm","int",[new u.xWrap.FuncPtrAdapter({name:"xInputA",signature:"i(ppp)",bindScope:"transient"}),"void*",new u.xWrap.FuncPtrAdapter({name:"xInputB",signature:"i(ppp)",bindScope:"transient"}),"void*",new u.xWrap.FuncPtrAdapter({name:"xOutput",signature:"i(ppi)",bindScope:"transient"}),"void*"]],["sqlite3changeset_conflict","int",["sqlite3_changeset_iter*","int","**"]],["sqlite3changeset_finalize","int",["sqlite3_changeset_iter*"]],["sqlite3changeset_fk_conflicts","int",["sqlite3_changeset_iter*","int*"]],["sqlite3changeset_invert","int",["int","void*","int*","**"]],["sqlite3changeset_invert_strm","int",[new u.xWrap.FuncPtrAdapter({name:"xInput",signature:"i(ppp)",bindScope:"transient"}),"void*",new u.xWrap.FuncPtrAdapter({name:"xOutput",signature:"i(ppi)",bindScope:"transient"}),"void*"]],["sqlite3changeset_new","int",["sqlite3_changeset_iter*","int","**"]],["sqlite3changeset_next","int",["sqlite3_changeset_iter*"]],["sqlite3changeset_old","int",["sqlite3_changeset_iter*","int","**"]],["sqlite3changeset_op","int",["sqlite3_changeset_iter*","**","int*","int*","int*"]],["sqlite3changeset_pk","int",["sqlite3_changeset_iter*","**","int*"]],["sqlite3changeset_start","int",["**","int","*"]],["sqlite3changeset_start_strm","int",["**",new u.xWrap.FuncPtrAdapter({name:"xInput",signature:"i(ppp)",bindScope:"transient"}),"void*"]],["sqlite3changeset_start_v2","int",["**","int","*","int"]],["sqlite3changeset_start_v2_strm","int",["**",new u.xWrap.FuncPtrAdapter({name:"xInput",signature:"i(ppp)",bindScope:"transient"}),"void*","int"]],["sqlite3session_attach","int",["sqlite3_session*","string"]],["sqlite3session_changeset","int",["sqlite3_session*","int*","**"]],["sqlite3session_changeset_size","i64",["sqlite3_session*"]],["sqlite3session_changeset_strm","int",["sqlite3_session*",new u.xWrap.FuncPtrAdapter({name:"xOutput",signature:"i(ppp)",bindScope:"transient"}),"void*"]],["sqlite3session_config","int",["int","void*"]],["sqlite3session_create","int",["sqlite3*","string","**"]],["sqlite3session_diff","int",["sqlite3_session*","string","string","**"]],["sqlite3session_enable","int",["sqlite3_session*","int"]],["sqlite3session_indirect","int",["sqlite3_session*","int"]],["sqlite3session_isempty","int",["sqlite3_session*"]],["sqlite3session_memory_used","i64",["sqlite3_session*"]],["sqlite3session_object_config","int",["sqlite3_session*","int","void*"]],["sqlite3session_patchset","int",["sqlite3_session*","*","**"]],["sqlite3session_patchset_strm","int",["sqlite3_session*",new u.xWrap.FuncPtrAdapter({name:"xOutput",signature:"i(ppp)",bindScope:"transient"}),"void*"]],["sqlite3session_table_filter",void 0,["sqlite3_session*",new u.xWrap.FuncPtrAdapter({name:"xFilter",...k,contextKey:(m,y)=>m[0]}),"*"]])}u.bindingSignatures.wasm=[["sqlite3_wasm_db_reset","int","sqlite3*"],["sqlite3_wasm_db_vfs","sqlite3_vfs*","sqlite3*","string"],["sqlite3_wasm_vfs_create_file","int","sqlite3_vfs*","string","*","int"],["sqlite3_wasm_vfs_unlink","int","sqlite3_vfs*","string"]],i.StructBinder=globalThis.Jaccwabyt({heap:u.heap8u,alloc:u.alloc,dealloc:u.dealloc,bigIntEnabled:u.bigIntEnabled,memberPrefix:"$"}),delete globalThis.Jaccwabyt;{const k=u.xWrap.argAdapter("string");u.xWrap.argAdapter("string:flexible",b=>k(d.flexibleString(b))),u.xWrap.argAdapter("string:static",function(b){return u.isPtr(b)?b:(b=""+b,this[b]||(this[b]=u.allocCString(b)))}.bind(Object.create(null)));const m=u.xWrap.argAdapter("*"),y=function(){};u.xWrap.argAdapter("sqlite3_filename",m)("sqlite3_context*",m)("sqlite3_value*",m)("void*",m)("sqlite3_changegroup*",m)("sqlite3_changeset_iter*",m)("sqlite3_session*",m)("sqlite3_stmt*",b=>{var P;return m(b instanceof(((P=i==null?void 0:i.oo1)==null?void 0:P.Stmt)||y)?b.pointer:b)})("sqlite3*",b=>{var P;return m(b instanceof(((P=i==null?void 0:i.oo1)==null?void 0:P.DB)||y)?b.pointer:b)})("sqlite3_index_info*",b=>m(b instanceof(a.sqlite3_index_info||y)?b.pointer:b))("sqlite3_module*",b=>m(b instanceof(a.sqlite3_module||y)?b.pointer:b))("sqlite3_vfs*",b=>typeof b=="string"?a.sqlite3_vfs_find(b)||i.SQLite3Error.toss(a.SQLITE_NOTFOUND,"Unknown sqlite3_vfs name:",b):m(b instanceof(a.sqlite3_vfs||y)?b.pointer:b));const x=u.xWrap.resultAdapter("*");u.xWrap.resultAdapter("sqlite3*",x)("sqlite3_context*",x)("sqlite3_stmt*",x)("sqlite3_value*",x)("sqlite3_vfs*",x)("void*",x);for(const b of u.bindingSignatures)a[b[0]]=u.xWrap.apply(null,b);for(const b of u.bindingSignatures.wasm)u[b[0]]=u.xWrap.apply(null,b);const E=function(b){return()=>l(b+"() is unavailable due to lack","of BigInt support in this build.")};for(const b of u.bindingSignatures.int64)a[b[0]]=u.bigIntEnabled?u.xWrap.apply(null,b):E(b[0]);if(delete u.bindingSignatures,u.exports.sqlite3_wasm_db_error){const b=u.xWrap("sqlite3_wasm_db_error","int","sqlite3*","int","string");d.sqlite3_wasm_db_error=function(P,M,B){return M instanceof i.WasmAllocError?(M=a.SQLITE_NOMEM,B=0):M instanceof Error&&(B=B||""+M,M=M.resultCode||a.SQLITE_ERROR),P?b(P,M,B):M}}else d.sqlite3_wasm_db_error=function(b,P,M){return console.warn("sqlite3_wasm_db_error() is not exported.",arguments),P}}{const k=u.xCall("sqlite3_wasm_enum_json");k||l("Maintenance required: increase sqlite3_wasm_enum_json()'s","static buffer size!"),u.ctype=JSON.parse(u.cstrToJs(k));const m=["access","authorizer","blobFinalizers","changeset","config","dataTypes","dbConfig","dbStatus","encodings","fcntl","flock","ioCap","limits","openFlags","prepareFlags","resultCodes","sqlite3Status","stmtStatus","syncFlags","trace","txnState","udfFlags","version"];u.bigIntEnabled&&m.push("serialize","session","vtab");for(const E of m)for(const b of Object.entries(u.ctype[E]))a[b[0]]=b[1];u.functionEntry(a.SQLITE_WASM_DEALLOC)||l("Internal error: cannot resolve exported function","entry SQLITE_WASM_DEALLOC (=="+a.SQLITE_WASM_DEALLOC+").");const y=Object.create(null);for(const E of["resultCodes"])for(const b of Object.entries(u.ctype[E]))y[b[1]]=b[0];a.sqlite3_js_rc_str=E=>y[E];const x=Object.assign(Object.create(null),{WasmTestStruct:!0,sqlite3_kvvfs_methods:!d.isUIThread(),sqlite3_index_info:!u.bigIntEnabled,sqlite3_index_constraint:!u.bigIntEnabled,sqlite3_index_orderby:!u.bigIntEnabled,sqlite3_index_constraint_usage:!u.bigIntEnabled});for(const E of u.ctype.structs)x[E.name]||(a[E.name]=i.StructBinder(E));if(a.sqlite3_index_info){for(const E of["sqlite3_index_constraint","sqlite3_index_orderby","sqlite3_index_constraint_usage"])a.sqlite3_index_info[E]=a[E],delete a[E];a.sqlite3_vtab_config=u.xWrap("sqlite3_wasm_vtab_config","int",["sqlite3*","int","int"])}}const N=(k,m,y)=>i.util.sqlite3_wasm_db_error(k,a.SQLITE_MISUSE,m+"() requires "+y+" argument"+(y===1?"":"s")+"."),S=k=>d.sqlite3_wasm_db_error(k,a.SQLITE_FORMAT,"SQLITE_UTF8 is the only supported encoding."),C=k=>u.xWrap.argAdapter("sqlite3*")(k),V=k=>u.isPtr(k)?u.cstrToJs(k):k,J=function(k,m){k=C(k);let y=this.dbMap.get(k);if(m)!y&&m>0&&this.dbMap.set(k,y=Object.create(null));else return this.dbMap.delete(k),y;return y}.bind(Object.assign(Object.create(null),{dbMap:new Map}));J.addCollation=function(k,m){const y=J(k,1);y.collation||(y.collation=new Set),y.collation.add(V(m).toLowerCase())},J._addUDF=function(k,m,y,x){m=V(m).toLowerCase();let E=x.get(m);E||x.set(m,E=new Set),E.add(y<0?-1:y)},J.addFunction=function(k,m,y){const x=J(k,1);x.udf||(x.udf=new Map),this._addUDF(k,m,y,x.udf)},J.addWindowFunc=function(k,m,y){const x=J(k,1);x.wudf||(x.wudf=new Map),this._addUDF(k,m,y,x.wudf)},J.cleanup=function(k){k=C(k);const m=[k];for(const E of["sqlite3_busy_handler","sqlite3_commit_hook","sqlite3_preupdate_hook","sqlite3_progress_handler","sqlite3_rollback_hook","sqlite3_set_authorizer","sqlite3_trace_v2","sqlite3_update_hook"]){const b=u.exports[E];m.length=b.length;try{a[E](...m)}catch(P){console.warn("close-time call of",E+"(",m,") threw:",P)}}const y=J(k,0);if(!y)return;if(y.collation){for(const E of y.collation)try{a.sqlite3_create_collation_v2(k,E,a.SQLITE_UTF8,0,0,0)}catch{}delete y.collation}let x;for(x=0;x<2;++x){const E=x?y.wudf:y.udf;if(!E)continue;const b=x?a.sqlite3_create_window_function:a.sqlite3_create_function_v2;for(const P of E){const M=P[0],B=P[1],D=[k,M,0,a.SQLITE_UTF8,0,0,0,0,0];x&&D.push(0);for(const le of B)try{D[2]=le,b.apply(null,D)}catch{}B.clear()}E.clear()}delete y.udf,delete y.wudf};{const k=u.xWrap("sqlite3_close_v2","int","sqlite3*");a.sqlite3_close_v2=function(m){if(arguments.length!==1)return N(m,"sqlite3_close_v2",1);if(m)try{J.cleanup(m)}catch{}return k(m)}}if(a.sqlite3session_table_filter){const k=u.xWrap("sqlite3session_delete",void 0,["sqlite3_session*"]);a.sqlite3session_delete=function(m){if(arguments.length!==1)return N(pDb,"sqlite3session_delete",1);m&&a.sqlite3session_table_filter(m,0,0),k(m)}}{const k=(y,x)=>"argv["+x+"]:"+y[0]+":"+u.cstrToJs(y[1]).toLowerCase(),m=u.xWrap("sqlite3_create_collation_v2","int",["sqlite3*","string","int","*",new u.xWrap.FuncPtrAdapter({name:"xCompare",signature:"i(pipip)",contextKey:k}),new u.xWrap.FuncPtrAdapter({name:"xDestroy",signature:"v(p)",contextKey:k})]);a.sqlite3_create_collation_v2=function(y,x,E,b,P,M){if(arguments.length!==6)return N(y,"sqlite3_create_collation_v2",6);if(!(E&15))E|=a.SQLITE_UTF8;else if(a.SQLITE_UTF8!==(E&15))return S(y);try{const B=m(y,x,E,b,P,M);return B===0&&P instanceof Function&&J.addCollation(y,x),B}catch(B){return d.sqlite3_wasm_db_error(y,B)}},a.sqlite3_create_collation=(y,x,E,b,P)=>arguments.length===5?a.sqlite3_create_collation_v2(y,x,E,b,P,0):N(y,"sqlite3_create_collation",5)}{const k=function(E,b){return E[0]+":"+(E[2]<0?-1:E[2])+":"+b+":"+u.cstrToJs(E[1]).toLowerCase()},m=Object.assign(Object.create(null),{xInverseAndStep:{signature:"v(pip)",contextKey:k,callProxy:E=>(b,P,M)=>{try{E(b,...a.sqlite3_values_to_js(P,M))}catch(B){a.sqlite3_result_error_js(b,B)}}},xFinalAndValue:{signature:"v(p)",contextKey:k,callProxy:E=>b=>{try{a.sqlite3_result_js(b,E(b))}catch(P){a.sqlite3_result_error_js(b,P)}}},xFunc:{signature:"v(pip)",contextKey:k,callProxy:E=>(b,P,M)=>{try{a.sqlite3_result_js(b,E(b,...a.sqlite3_values_to_js(P,M)))}catch(B){a.sqlite3_result_error_js(b,B)}}},xDestroy:{signature:"v(p)",contextKey:k,callProxy:E=>b=>{try{E(b)}catch(P){console.error("UDF xDestroy method threw:",P)}}}}),y=u.xWrap("sqlite3_create_function_v2","int",["sqlite3*","string","int","int","*",new u.xWrap.FuncPtrAdapter({name:"xFunc",...m.xFunc}),new u.xWrap.FuncPtrAdapter({name:"xStep",...m.xInverseAndStep}),new u.xWrap.FuncPtrAdapter({name:"xFinal",...m.xFinalAndValue}),new u.xWrap.FuncPtrAdapter({name:"xDestroy",...m.xDestroy})]),x=u.xWrap("sqlite3_create_window_function","int",["sqlite3*","string","int","int","*",new u.xWrap.FuncPtrAdapter({name:"xStep",...m.xInverseAndStep}),new u.xWrap.FuncPtrAdapter({name:"xFinal",...m.xFinalAndValue}),new u.xWrap.FuncPtrAdapter({name:"xValue",...m.xFinalAndValue}),new u.xWrap.FuncPtrAdapter({name:"xInverse",...m.xInverseAndStep}),new u.xWrap.FuncPtrAdapter({name:"xDestroy",...m.xDestroy})]);a.sqlite3_create_function_v2=function E(b,P,M,B,D,le,z,g,v){if(E.length!==arguments.length)return N(b,"sqlite3_create_function_v2",E.length);if(!(B&15))B|=a.SQLITE_UTF8;else if(a.SQLITE_UTF8!==(B&15))return S(b);try{const I=y(b,P,M,B,D,le,z,g,v);return I===0&&(le instanceof Function||z instanceof Function||g instanceof Function||v instanceof Function)&&J.addFunction(b,P,M),I}catch(I){return console.error("sqlite3_create_function_v2() setup threw:",I),d.sqlite3_wasm_db_error(b,I,"Creation of UDF threw: "+I)}},a.sqlite3_create_function=function E(b,P,M,B,D,le,z,g){return E.length===arguments.length?a.sqlite3_create_function_v2(b,P,M,B,D,le,z,g,0):N(b,"sqlite3_create_function",E.length)},a.sqlite3_create_window_function=function E(b,P,M,B,D,le,z,g,v,I){if(E.length!==arguments.length)return N(b,"sqlite3_create_window_function",E.length);if(!(B&15))B|=a.SQLITE_UTF8;else if(a.SQLITE_UTF8!==(B&15))return S(b);try{const q=x(b,P,M,B,D,le,z,g,v,I);return q===0&&(le instanceof Function||z instanceof Function||g instanceof Function||v instanceof Function||I instanceof Function)&&J.addWindowFunc(b,P,M),q}catch(q){return console.error("sqlite3_create_window_function() setup threw:",q),d.sqlite3_wasm_db_error(b,q,"Creation of UDF threw: "+q)}},a.sqlite3_create_function_v2.udfSetResult=a.sqlite3_create_function.udfSetResult=a.sqlite3_create_window_function.udfSetResult=a.sqlite3_result_js,a.sqlite3_create_function_v2.udfConvertArgs=a.sqlite3_create_function.udfConvertArgs=a.sqlite3_create_window_function.udfConvertArgs=a.sqlite3_values_to_js,a.sqlite3_create_function_v2.udfSetError=a.sqlite3_create_function.udfSetError=a.sqlite3_create_window_function.udfSetError=a.sqlite3_result_error_js}{const k=(y,x)=>(typeof y=="string"?x=-1:d.isSQLableTypedArray(y)?(x=y.byteLength,y=d.typedArrayToString(y instanceof ArrayBuffer?new Uint8Array(y):y)):Array.isArray(y)&&(y=y.join(""),x=-1),[y,x]),m={basic:u.xWrap("sqlite3_prepare_v3","int",["sqlite3*","string","int","int","**","**"]),full:u.xWrap("sqlite3_prepare_v3","int",["sqlite3*","*","int","int","**","**"])};a.sqlite3_prepare_v3=function y(x,E,b,P,M,B){if(y.length!==arguments.length)return N(x,"sqlite3_prepare_v3",y.length);const[D,le]=k(E,b);switch(typeof D){case"string":return m.basic(x,D,le,P,M,null);case"number":return m.full(x,D,le,P,M,B);default:return d.sqlite3_wasm_db_error(x,a.SQLITE_MISUSE,"Invalid SQL argument type for sqlite3_prepare_v2/v3().")}},a.sqlite3_prepare_v2=function y(x,E,b,P,M){return y.length===arguments.length?a.sqlite3_prepare_v3(x,E,b,0,P,M):N(x,"sqlite3_prepare_v2",y.length)}}{const k=u.xWrap("sqlite3_bind_text","int",["sqlite3_stmt*","int","string","int","*"]),m=u.xWrap("sqlite3_bind_blob","int",["sqlite3_stmt*","int","*","int","*"]);a.sqlite3_bind_text=function y(x,E,b,P,M){if(y.length!==arguments.length)return N(a.sqlite3_db_handle(x),"sqlite3_bind_text",y.length);if(u.isPtr(b)||b===null)return k(x,E,b,P,M);b instanceof ArrayBuffer?b=new Uint8Array(b):Array.isArray(pMem)&&(b=pMem.join(""));let B,D;try{if(d.isSQLableTypedArray(b))B=u.allocFromTypedArray(b),D=b.byteLength;else if(typeof b=="string")[B,D]=u.allocCString(b);else return d.sqlite3_wasm_db_error(a.sqlite3_db_handle(x),a.SQLITE_MISUSE,"Invalid 3rd argument type for sqlite3_bind_text().");return k(x,E,B,D,a.SQLITE_WASM_DEALLOC)}catch(le){return u.dealloc(B),d.sqlite3_wasm_db_error(a.sqlite3_db_handle(x),le)}},a.sqlite3_bind_blob=function y(x,E,b,P,M){if(y.length!==arguments.length)return N(a.sqlite3_db_handle(x),"sqlite3_bind_blob",y.length);if(u.isPtr(b)||b===null)return m(x,E,b,P,M);b instanceof ArrayBuffer?b=new Uint8Array(b):Array.isArray(b)&&(b=b.join(""));let B,D;try{if(d.isBindableTypedArray(b))B=u.allocFromTypedArray(b),D=P>=0?P:b.byteLength;else if(typeof b=="string")[B,D]=u.allocCString(b);else return d.sqlite3_wasm_db_error(a.sqlite3_db_handle(x),a.SQLITE_MISUSE,"Invalid 3rd argument type for sqlite3_bind_blob().");return m(x,E,B,D,a.SQLITE_WASM_DEALLOC)}catch(le){return u.dealloc(B),d.sqlite3_wasm_db_error(a.sqlite3_db_handle(x),le)}}}a.sqlite3_config=function(k,...m){if(arguments.length<2)return a.SQLITE_MISUSE;switch(k){case a.SQLITE_CONFIG_COVERING_INDEX_SCAN:case a.SQLITE_CONFIG_MEMSTATUS:case a.SQLITE_CONFIG_SMALL_MALLOC:case a.SQLITE_CONFIG_SORTERREF_SIZE:case a.SQLITE_CONFIG_STMTJRNL_SPILL:case a.SQLITE_CONFIG_URI:return u.exports.sqlite3_wasm_config_i(k,m[0]);case a.SQLITE_CONFIG_LOOKASIDE:return u.exports.sqlite3_wasm_config_ii(k,m[0],m[1]);case a.SQLITE_CONFIG_MEMDB_MAXSIZE:return u.exports.sqlite3_wasm_config_j(k,m[0]);case a.SQLITE_CONFIG_GETMALLOC:case a.SQLITE_CONFIG_GETMUTEX:case a.SQLITE_CONFIG_GETPCACHE2:case a.SQLITE_CONFIG_GETPCACHE:case a.SQLITE_CONFIG_HEAP:case a.SQLITE_CONFIG_LOG:case a.SQLITE_CONFIG_MALLOC:case a.SQLITE_CONFIG_MMAP_SIZE:case a.SQLITE_CONFIG_MULTITHREAD:case a.SQLITE_CONFIG_MUTEX:case a.SQLITE_CONFIG_PAGECACHE:case a.SQLITE_CONFIG_PCACHE2:case a.SQLITE_CONFIG_PCACHE:case a.SQLITE_CONFIG_PCACHE_HDRSZ:case a.SQLITE_CONFIG_PMASZ:case a.SQLITE_CONFIG_SERIALIZED:case a.SQLITE_CONFIG_SINGLETHREAD:case a.SQLITE_CONFIG_SQLLOG:case a.SQLITE_CONFIG_WIN32_HEAPSIZE:default:return a.SQLITE_NOTFOUND}};{const k=new Set;a.sqlite3_auto_extension=function(m){if(m instanceof Function)m=u.installFunction("i(ppp)",m);else if(arguments.length!==1||!u.isPtr(m))return a.SQLITE_MISUSE;const y=u.exports.sqlite3_auto_extension(m);return m!==arguments[0]&&(y===0?k.add(m):u.uninstallFunction(m)),y},a.sqlite3_cancel_auto_extension=function(m){return!m||arguments.length!==1||!u.isPtr(m)?0:u.exports.sqlite3_cancel_auto_extension(m)},a.sqlite3_reset_auto_extension=function(){u.exports.sqlite3_reset_auto_extension();for(const m of k)u.uninstallFunction(m);k.clear()}}const ie=a.sqlite3_vfs_find("kvvfs");if(ie)if(d.isUIThread()){const k=new a.sqlite3_kvvfs_methods(u.exports.sqlite3_wasm_kvvfs_methods());delete a.sqlite3_kvvfs_methods;const m=u.exports.sqlite3_wasm_kvvfsMakeKeyOnPstack,y=u.pstack,x=b=>u.peek(b)===115?sessionStorage:localStorage,E={xRead:(b,P,M,B)=>{const D=y.pointer,le=u.scopedAllocPush();try{const z=m(b,P);if(!z)return-3;const g=u.cstrToJs(z),v=x(b).getItem(g);if(!v)return-1;const I=v.length;if(B<=0)return I;if(B===1)return u.poke(M,0),I;const q=u.scopedAllocCString(v);return B>I+1&&(B=I+1),u.heap8u().copyWithin(M,q,q+B-1),u.poke(M+B-1,0),B-1}catch(z){return console.error("kvstorageRead()",z),-2}finally{y.restore(D),u.scopedAllocPop(le)}},xWrite:(b,P,M)=>{const B=y.pointer;try{const D=m(b,P);if(!D)return 1;const le=u.cstrToJs(D);return x(b).setItem(le,u.cstrToJs(M)),0}catch(D){return console.error("kvstorageWrite()",D),a.SQLITE_IOERR}finally{y.restore(B)}},xDelete:(b,P)=>{const M=y.pointer;try{const B=m(b,P);return B?(x(b).removeItem(u.cstrToJs(B)),0):1}catch(B){return console.error("kvstorageDelete()",B),a.SQLITE_IOERR}finally{y.restore(M)}}};for(const b of Object.keys(E))k[k.memberKey(b)]=u.installFunction(k.memberSignature(b),E[b])}else a.sqlite3_vfs_unregister(ie);u.xWrap.FuncPtrAdapter.warnOnUse=!0}),globalThis.sqlite3ApiBootstrap.initializers.push(function(i){i.version={libVersion:"3.42.0",libVersionNumber:3042e3,sourceId:"2023-05-16 12:36:15 831d0fb2836b71c9bc51067c49fee4b8f18047814f2ff22d817d25195cf350b0",downloadVersion:342e4}}),globalThis.sqlite3ApiBootstrap.initializers.push(function(i){const l=(...q)=>{throw new i.SQLite3Error(...q)},a=i.capi,u=i.wasm,d=i.util,N=new WeakMap,S=new WeakMap,C=(q,w,f)=>{const p=Object.getOwnPropertyDescriptor(q,w);return p?p.value:f},V=function(q,w){return w&&(q instanceof m&&(q=q.pointer),l("sqlite3 result code",w+":",q?a.sqlite3_errmsg(q):a.sqlite3_errstr(w))),arguments[0]},J=u.installFunction("i(ippp)",function(q,w,f,p){a.SQLITE_TRACE_STMT===q&&console.log("SQL TRACE #"+ ++this.counter+" via sqlite3@"+w+":",u.cstrToJs(p))}.bind({counter:0})),ie=Object.create(null),k=function q(...w){if(!q._name2vfs){q._name2vfs=Object.create(null);const de=typeof importScripts=="function"?ve=>l("The VFS for",ve,"is only available in the main window thread."):!1;q._name2vfs[":localStorage:"]={vfs:"kvvfs",filename:de||(()=>"local")},q._name2vfs[":sessionStorage:"]={vfs:"kvvfs",filename:de||(()=>"session")}}const f=q.normalizeArgs(...w);let p=f.filename,_=f.vfs,W=f.flags;(typeof p!="string"&&typeof p!="number"||typeof W!="string"||_&&typeof _!="string"&&typeof _!="number")&&(i.config.error("Invalid DB ctor args",f,arguments),l("Invalid arguments for DB constructor."));let L=typeof p=="number"?u.cstrToJs(p):p;const se=q._name2vfs[L];se&&(_=se.vfs,p=L=se.filename(L));let oe,ce=0;W.indexOf("c")>=0&&(ce|=a.SQLITE_OPEN_CREATE|a.SQLITE_OPEN_READWRITE),W.indexOf("w")>=0&&(ce|=a.SQLITE_OPEN_READWRITE),ce===0&&(ce|=a.SQLITE_OPEN_READONLY),ce|=a.SQLITE_OPEN_EXRESCODE;const pe=u.pstack.pointer;try{const de=u.pstack.allocPtr();let ve=a.sqlite3_open_v2(p,de,ce,_||0);oe=u.peekPtr(de),V(oe,ve),a.sqlite3_extended_result_codes(oe,1),W.indexOf("t")>=0&&a.sqlite3_trace_v2(oe,a.SQLITE_TRACE_STMT,J,oe)}catch(de){throw oe&&a.sqlite3_close_v2(oe),de}finally{u.pstack.restore(pe)}this.filename=L,N.set(this,oe),S.set(this,Object.create(null));try{const de=a.sqlite3_js_db_vfs(oe);de||l("Internal error: cannot get VFS for new db handle.");const ve=ie[de];ve instanceof Function?ve(this,i):ve&&V(oe,a.sqlite3_exec(oe,ve,0,0,0))}catch(de){throw this.close(),de}};k.setVfsPostOpenSql=function(q,w){ie[q]=w},k.normalizeArgs=function(q=":memory:",w="c",f=null){const p={};return arguments.length===1&&arguments[0]&&typeof arguments[0]=="object"?(Object.assign(p,arguments[0]),p.flags===void 0&&(p.flags="c"),p.vfs===void 0&&(p.vfs=null),p.filename===void 0&&(p.filename=":memory:")):(p.filename=q,p.flags=w,p.vfs=f),p};const m=function(...q){k.apply(this,q)};m.dbCtorHelper=k;const y={null:1,number:2,string:3,boolean:4,blob:5};y.undefined==y.null,u.bigIntEnabled&&(y.bigint=y.number);const x=function(){y!==arguments[2]&&l(a.SQLITE_MISUSE,"Do not call the Stmt constructor directly. Use DB.prepare()."),this.db=arguments[0],N.set(this,arguments[1]),this.columnCount=a.sqlite3_column_count(this.pointer),this.parameterCount=a.sqlite3_bind_parameter_count(this.pointer)},E=function(q){return q.pointer||l("DB has been closed."),q},b=function(q,w){return(w!==(w|0)||w<0||w>=q.columnCount)&&l("Column index",w,"is out of range."),q},P=function(q,w){const f=Object.create(null);switch(f.opt=Object.create(null),w.length){case 1:typeof w[0]=="string"||d.isSQLableTypedArray(w[0])||Array.isArray(w[0])?f.sql=w[0]:w[0]&&typeof w[0]=="object"&&(f.opt=w[0],f.sql=f.opt.sql);break;case 2:f.sql=w[0],f.opt=w[1];break;default:l("Invalid argument count for exec().")}f.sql=d.flexibleString(f.sql),typeof f.sql!="string"&&l("Missing SQL argument or unsupported SQL value type.");const p=f.opt;switch(p.returnValue){case"resultRows":p.resultRows||(p.resultRows=[]),f.returnVal=()=>p.resultRows;break;case"saveSql":p.saveSql||(p.saveSql=[]),f.returnVal=()=>p.saveSql;break;case void 0:case"this":f.returnVal=()=>q;break;default:l("Invalid returnValue value:",p.returnValue)}if(!p.callback&&!p.returnValue&&p.rowMode!==void 0&&(p.resultRows||(p.resultRows=[]),f.returnVal=()=>p.resultRows),p.callback||p.resultRows)switch(p.rowMode===void 0?"array":p.rowMode){case"object":f.cbArg=_=>_.get(Object.create(null));break;case"array":f.cbArg=_=>_.get([]);break;case"stmt":Array.isArray(p.resultRows)&&l("exec(): invalid rowMode for a resultRows array: must","be one of 'array', 'object',","a result column number, or column name reference."),f.cbArg=_=>_;break;default:if(d.isInt32(p.rowMode)){f.cbArg=_=>_.get(p.rowMode);break}else if(typeof p.rowMode=="string"&&p.rowMode.length>1&&p.rowMode[0]==="$"){const _=p.rowMode.substr(1);f.cbArg=W=>{const L=W.get(Object.create(null))[_];return L===void 0?l(a.SQLITE_NOTFOUND,"exec(): unknown result column:",_):L};break}l("Invalid rowMode:",p.rowMode)}return f},M=(q,w,f,...p)=>{const _=q.prepare(w);try{return _.bind(f).step()?_.get(...p):void 0}finally{_.finalize()}},B=(q,w,f,p)=>q.exec({sql:w,bind:f,rowMode:p,returnValue:"resultRows"});m.checkRc=(q,w)=>V(q,w),m.prototype={isOpen:function(){return!!this.pointer},affirmOpen:function(){return E(this)},close:function(){if(this.pointer){if(this.onclose&&this.onclose.before instanceof Function)try{this.onclose.before(this)}catch{}const q=this.pointer;if(Object.keys(S.get(this)).forEach((w,f)=>{f&&f.pointer&&f.finalize()}),N.delete(this),S.delete(this),a.sqlite3_close_v2(q),this.onclose&&this.onclose.after instanceof Function)try{this.onclose.after(this)}catch{}delete this.filename}},changes:function(q=!1,w=!1){const f=E(this).pointer;return q?w?a.sqlite3_total_changes64(f):a.sqlite3_total_changes(f):w?a.sqlite3_changes64(f):a.sqlite3_changes(f)},dbFilename:function(q="main"){return a.sqlite3_db_filename(E(this).pointer,q)},dbName:function(q=0){return a.sqlite3_db_name(E(this).pointer,q)},dbVfsName:function(q=0){let w;const f=a.sqlite3_js_db_vfs(E(this).pointer,q);if(f){const p=new a.sqlite3_vfs(f);try{w=u.cstrToJs(p.$zName)}finally{p.dispose()}}return w},prepare:function(q){E(this);const w=u.pstack.pointer;let f,p;try{f=u.pstack.alloc(8),m.checkRc(this,a.sqlite3_prepare_v2(this.pointer,q,-1,f,null)),p=u.peekPtr(f)}finally{u.pstack.restore(w)}p||l("Cannot prepare empty SQL.");const _=new x(this,p,y);return S.get(this)[p]=_,_},exec:function(){E(this);const q=P(this,arguments);if(!q.sql)return l("exec() requires an SQL string.");const w=q.opt,f=w.callback,p=Array.isArray(w.resultRows)?w.resultRows:void 0;let _,W=w.bind,L=!!(q.cbArg||w.columnNames||p);const se=u.scopedAllocPush(),oe=Array.isArray(w.saveSql)?w.saveSql:void 0;try{const ce=d.isSQLableTypedArray(q.sql);let pe=ce?q.sql.byteLength:u.jstrlen(q.sql);const de=u.scopedAlloc(2*u.ptrSizeof+(pe+1)),ve=de+u.ptrSizeof;let Je=ve+u.ptrSizeof;const mt=Je+pe;for(ce?u.heap8().set(q.sql,Je):u.jstrcpy(q.sql,u.heap8(),Je,pe,!1),u.poke(Je+pe,0);Je&&u.peek(Je,"i8");){u.pokePtr([de,ve],0),m.checkRc(this,a.sqlite3_prepare_v3(this.pointer,Je,pe,0,de,ve));const un=u.peekPtr(de);if(Je=u.peekPtr(ve),pe=mt-Je,!!un){if(oe&&oe.push(a.sqlite3_sql(un).trim()),_=new x(this,un,y),W&&_.parameterCount&&(_.bind(W),W=null),L&&_.columnCount){if(L=!1,Array.isArray(w.columnNames)&&_.getColumnNames(w.columnNames),q.cbArg||p){for(;_.step();_._isLocked=!1){_._isLocked=!0;const O=q.cbArg(_);if(p&&p.push(O),f&&f.call(w,O,_)===!1)break}_._isLocked=!1}}else _.step();_.finalize(),_=null}}}finally{_&&(delete _._isLocked,_.finalize()),u.scopedAllocPop(se)}return q.returnVal()},createFunction:function(w,f,p){const _=j=>j instanceof Function;switch(arguments.length){case 1:p=w,w=p.name,f=p.xFunc||0;break;case 2:_(f)||(p=f,f=p.xFunc||0);break}p||(p={}),typeof w!="string"&&l("Invalid arguments: missing function name.");let W=p.xStep||0,L=p.xFinal||0;const se=p.xValue||0,oe=p.xInverse||0;let ce;_(f)?(ce=!1,(_(W)||_(L))&&l("Ambiguous arguments: scalar or aggregate?"),W=L=null):_(W)?(_(L)||l("Missing xFinal() callback for aggregate or window UDF."),f=null):_(L)?l("Missing xStep() callback for aggregate or window UDF."):l("Missing function-type properties."),ce===!1?(_(se)||_(oe))&&l("xValue and xInverse are not permitted for non-window UDFs."):_(se)?(_(oe)||l("xInverse must be provided if xValue is."),ce=!0):_(oe)&&l("xValue must be provided if xInverse is.");const pe=p.pApp;pe!=null&&(typeof pe!="number"||!d.isInt32(pe))&&l("Invalid value for pApp property. Must be a legal WASM pointer value.");const de=p.xDestroy||0;de&&!_(de)&&l("xDestroy property must be a function.");let ve=0;C(p,"deterministic")&&(ve|=a.SQLITE_DETERMINISTIC),C(p,"directOnly")&&(ve|=a.SQLITE_DIRECTONLY),C(p,"innocuous")&&(ve|=a.SQLITE_INNOCUOUS),w=w.toLowerCase();const Je=f||W,mt=C(p,"arity"),un=typeof mt=="number"?mt:Je.length?Je.length-1:0;let O;return ce?O=a.sqlite3_create_window_function(this.pointer,w,un,a.SQLITE_UTF8|ve,pe||0,W,L,se,oe,de):O=a.sqlite3_create_function_v2(this.pointer,w,un,a.SQLITE_UTF8|ve,pe||0,f,W,L,de),m.checkRc(this,O),this},selectValue:function(q,w,f){return M(this,q,w,0,f)},selectValues:function(q,w,f){const p=this.prepare(q),_=[];try{for(p.bind(w);p.step();)_.push(p.get(0,f))}finally{p.finalize()}return _},selectArray:function(q,w){return M(this,q,w,[])},selectObject:function(q,w){return M(this,q,w,{})},selectArrays:function(q,w){return B(this,q,w,"array")},selectObjects:function(q,w){return B(this,q,w,"object")},openStatementCount:function(){return this.pointer?Object.keys(S.get(this)).length:0},transaction:function(q){let w="BEGIN";arguments.length>1&&(/[^a-zA-Z]/.test(arguments[0])&&l(a.SQLITE_MISUSE,"Invalid argument for BEGIN qualifier."),w+=" "+arguments[0],q=arguments[1]),E(this).exec(w);try{const f=q(this);return this.exec("COMMIT"),f}catch(f){throw this.exec("ROLLBACK"),f}},savepoint:function(q){E(this).exec("SAVEPOINT oo1");try{const w=q(this);return this.exec("RELEASE oo1"),w}catch(w){throw this.exec("ROLLBACK to SAVEPOINT oo1; RELEASE SAVEPOINT oo1"),w}},checkRc:function(q){return m.checkRc(this,q)}};const D=function(q){return q.pointer||l("Stmt has been closed."),q},le=function(q){let w=y[q==null?"null":typeof q];switch(w){case y.boolean:case y.null:case y.number:case y.string:return w;case y.bigint:if(u.bigIntEnabled)return w;default:return d.isBindableTypedArray(q)?y.blob:void 0}},z=function(q){return le(q)||l("Unsupported bind() argument type:",typeof q)},g=function(q,w){const f=typeof w=="number"?w:a.sqlite3_bind_parameter_index(q.pointer,w);return f===0||!d.isInt32(f)?l("Invalid bind() parameter name: "+w):(f<1||f>q.parameterCount)&&l("Bind index",w,"is out of range."),f},v=function(q,w){return q._isLocked&&l("Operation is illegal when statement is locked:",w),q},I=function q(w,f,p,_){v(D(w),"bind()"),q._||(q._tooBigInt=L=>l("BigInt value is too big to store without precision loss:",L),q._={string:function(L,se,oe,ce){const[pe,de]=u.allocCString(oe,!0);return(ce?a.sqlite3_bind_blob:a.sqlite3_bind_text)(L.pointer,se,pe,de,a.SQLITE_WASM_DEALLOC)}}),z(_),f=g(w,f);let W=0;switch(_==null?y.null:p){case y.null:W=a.sqlite3_bind_null(w.pointer,f);break;case y.string:W=q._.string(w,f,_,!1);break;case y.number:{let L;d.isInt32(_)?L=a.sqlite3_bind_int:typeof _=="bigint"?d.bigIntFits64(_)?u.bigIntEnabled?L=a.sqlite3_bind_int64:d.bigIntFitsDouble(_)?(_=Number(_),L=a.sqlite3_bind_double):q._tooBigInt(_):q._tooBigInt(_):(_=Number(_),u.bigIntEnabled&&Number.isInteger(_)?L=a.sqlite3_bind_int64:L=a.sqlite3_bind_double),W=L(w.pointer,f,_);break}case y.boolean:W=a.sqlite3_bind_int(w.pointer,f,_?1:0);break;case y.blob:{if(typeof _=="string"){W=q._.string(w,f,_,!0);break}else _ instanceof ArrayBuffer?_=new Uint8Array(_):d.isBindableTypedArray(_)||l("Binding a value as a blob requires","that it be a string, Uint8Array, Int8Array, or ArrayBuffer.");const L=u.alloc(_.byteLength||1);u.heap8().set(_.byteLength?_:[0],L),W=a.sqlite3_bind_blob(w.pointer,f,L,_.byteLength,a.SQLITE_WASM_DEALLOC);break}default:i.config.warn("Unsupported bind() argument type:",_),l("Unsupported bind() argument type: "+typeof _)}return W&&m.checkRc(w.db.pointer,W),w._mayGet=!1,w};x.prototype={finalize:function(){this.pointer&&(v(this,"finalize()"),delete S.get(this.db)[this.pointer],a.sqlite3_finalize(this.pointer),N.delete(this),delete this._mayGet,delete this.columnCount,delete this.parameterCount,delete this.db,delete this._isLocked)},clearBindings:function(){return v(D(this),"clearBindings()"),a.sqlite3_clear_bindings(this.pointer),this._mayGet=!1,this},reset:function(q){return v(this,"reset()"),q&&this.clearBindings(),a.sqlite3_reset(D(this).pointer),this._mayGet=!1,this},bind:function(){D(this);let q,w;switch(arguments.length){case 1:q=1,w=arguments[0];break;case 2:q=arguments[0],w=arguments[1];break;default:l("Invalid bind() arguments.")}return w===void 0?this:(this.parameterCount||l("This statement has no bindable parameters."),this._mayGet=!1,w===null?I(this,q,y.null,w):Array.isArray(w)?(arguments.length!==1&&l("When binding an array, an index argument is not permitted."),w.forEach((f,p)=>I(this,p+1,z(f),f)),this):(w instanceof ArrayBuffer&&(w=new Uint8Array(w)),typeof w=="object"&&!d.isBindableTypedArray(w)?(arguments.length!==1&&l("When binding an object, an index argument is not permitted."),Object.keys(w).forEach(f=>I(this,f,z(w[f]),w[f])),this):I(this,q,z(w),w)))},bindAsBlob:function(q,w){D(this),arguments.length===1&&(w=q,q=1);const f=z(w);return y.string!==f&&y.blob!==f&&y.null!==f&&l("Invalid value type for bindAsBlob()"),I(this,q,y.blob,w)},step:function(){v(this,"step()");const q=a.sqlite3_step(D(this).pointer);switch(q){case a.SQLITE_DONE:return this._mayGet=!1;case a.SQLITE_ROW:return this._mayGet=!0;default:this._mayGet=!1,i.config.warn("sqlite3_step() rc=",q,a.sqlite3_js_rc_str(q),"SQL =",a.sqlite3_sql(this.pointer)),m.checkRc(this.db.pointer,q)}},stepReset:function(){return this.step(),this.reset()},stepFinalize:function(){const q=this.step();return this.finalize(),q},get:function(q,w){if(D(this)._mayGet||l("Stmt.step() has not (recently) returned true."),Array.isArray(q)){let f=0;for(;f<this.columnCount;)q[f]=this.get(f++);return q}else if(q&&typeof q=="object"){let f=0;for(;f<this.columnCount;)q[a.sqlite3_column_name(this.pointer,f)]=this.get(f++);return q}switch(b(this,q),w===void 0?a.sqlite3_column_type(this.pointer,q):w){case a.SQLITE_NULL:return null;case a.SQLITE_INTEGER:if(u.bigIntEnabled){const f=a.sqlite3_column_int64(this.pointer,q);return f>=Number.MIN_SAFE_INTEGER&&f<=Number.MAX_SAFE_INTEGER?Number(f).valueOf():f}else{const f=a.sqlite3_column_double(this.pointer,q);return(f>Number.MAX_SAFE_INTEGER||f<Number.MIN_SAFE_INTEGER)&&l("Integer is out of range for JS integer range: "+f),d.isInt32(f)?f|0:f}case a.SQLITE_FLOAT:return a.sqlite3_column_double(this.pointer,q);case a.SQLITE_TEXT:return a.sqlite3_column_text(this.pointer,q);case a.SQLITE_BLOB:{const f=a.sqlite3_column_bytes(this.pointer,q),p=a.sqlite3_column_blob(this.pointer,q),_=new Uint8Array(f);return f&&_.set(u.heap8u().slice(p,p+f),0),f&&this.db._blobXfer instanceof Array&&this.db._blobXfer.push(_.buffer),_}default:l("Don't know how to translate","type of result column #"+q+".")}l("Not reached.")},getInt:function(q){return this.get(q,a.SQLITE_INTEGER)},getFloat:function(q){return this.get(q,a.SQLITE_FLOAT)},getString:function(q){return this.get(q,a.SQLITE_TEXT)},getBlob:function(q){return this.get(q,a.SQLITE_BLOB)},getJSON:function(q){const w=this.get(q,a.SQLITE_STRING);return w===null?w:JSON.parse(w)},getColumnName:function(q){return a.sqlite3_column_name(b(D(this),q).pointer,q)},getColumnNames:function(q=[]){b(D(this),0);for(let w=0;w<this.columnCount;++w)q.push(a.sqlite3_column_name(this.pointer,w));return q},getParamIndex:function(q){return D(this).parameterCount?a.sqlite3_bind_parameter_index(this.pointer,q):void 0}};{const q={enumerable:!0,get:function(){return N.get(this)},set:()=>l("The pointer property is read-only.")};Object.defineProperty(x.prototype,"pointer",q),Object.defineProperty(m.prototype,"pointer",q)}if(i.oo1={DB:m,Stmt:x},d.isUIThread()){i.oo1.JsStorageDb=function(w="session"){w!=="session"&&w!=="local"&&l("JsStorageDb db name must be one of 'session' or 'local'."),k.call(this,{filename:w,flags:"c",vfs:"kvvfs"})};const q=i.oo1.JsStorageDb;q.prototype=Object.create(m.prototype),q.clearStorage=a.sqlite3_js_kvvfs_clear,q.prototype.clearStorage=function(){return q.clearStorage(E(this).filename)},q.storageSize=a.sqlite3_js_kvvfs_size,q.prototype.storageSize=function(){return q.storageSize(E(this).filename)}}}),globalThis.sqlite3ApiBootstrap.initializers.push(function(i){i.initWorker1API=function(){const l=(...m)=>{throw new Error(m.join(" "))};globalThis.WorkerGlobalScope instanceof Function||l("initWorker1API() must be run from a Worker thread."),this.self;const a=this.sqlite3||l("Missing this.sqlite3 object."),u=a.oo1.DB,d=function(m){let y=N.idMap.get(m);return y||(y="db#"+ ++N.idSeq+"@"+m.pointer,N.idMap.set(m,y),y)},N={dbList:[],idSeq:0,idMap:new WeakMap,xfer:[],open:function(m){const y=new u(m);return this.dbs[d(y)]=y,this.dbList.indexOf(y)<0&&this.dbList.push(y),y},close:function(m,y){if(m){delete this.dbs[d(m)];const x=m.filename,E=a.wasm.sqlite3_wasm_db_vfs(m.pointer,0);m.close();const b=this.dbList.indexOf(m);b>=0&&this.dbList.splice(b,1),y&&x&&E&&a.wasm.sqlite3_wasm_vfs_unlink(E,x)}},post:function(m,y){y&&y.length?(globalThis.postMessage(m,Array.from(y)),y.length=0):globalThis.postMessage(m)},dbs:Object.create(null),getDb:function(m,y=!0){return this.dbs[m]||(y?l("Unknown (or closed) DB ID:",m):void 0)}},S=function(m=N.dbList[0]){return m&&m.pointer?m:l("DB is not opened.")},C=function(m,y=!0){const x=N.getDb(m.dbId,!1)||N.dbList[0];return y?S(x):x},V=function(){return N.dbList[0]&&d(N.dbList[0])},J=function(m){const y=/^file:.+(vfs=(\w+))/.exec(m);return a.capi.sqlite3_vfs_find(y?y[2]:0)},ie=m=>m===""||m[0]===":",k={open:function(m){const y=Object.create(null),x=m.args||Object.create(null);x.simulateError&&l("Throwing because of simulateError flag.");const E=Object.create(null);let b,P;if(y.vfs=x.vfs,ie(x.filename)?y.filename=x.filename||"":(y.filename=x.filename,b=x.byteArray,b&&(P=J(x.filename))),P){let B;try{B=a.wasm.allocFromTypedArray(b);const D=a.wasm.sqlite3_wasm_vfs_create_file(P,y.filename,B,b.byteLength);D&&a.SQLite3Error.toss(D)}catch(D){throw new a.SQLite3Error(D.name+" creating "+x.filename+": "+D.message,{cause:D})}finally{B&&a.wasm.dealloc(B)}}const M=N.open(y);return E.filename=M.filename,E.persistent=!!a.capi.sqlite3_js_db_uses_vfs(M.pointer,"opfs"),E.dbId=d(M),E.vfs=M.dbVfsName(),E},close:function(m){const y=C(m,!1),x={filename:y&&y.filename};if(y){const E=m.args&&typeof m.args=="object"?!!m.args.unlink:!1;N.close(y,E)}return x},exec:function(m){const y=typeof m.args=="string"?{sql:m.args}:m.args||Object.create(null);y.rowMode==="stmt"?l("Invalid rowMode for 'exec': stmt mode","does not work in the Worker API."):y.sql||l("'exec' requires input SQL.");const x=C(m);(y.callback||Array.isArray(y.resultRows))&&(x._blobXfer=N.xfer);const E=y.callback;let b=0;const P=!!y.columnNames;typeof E=="string"&&(P||(y.columnNames=[]),y.callback=function(M,B){N.post({type:E,columnNames:y.columnNames,rowNumber:++b,row:M},N.xfer)});try{x.exec(y),y.callback instanceof Function&&(y.callback=E,N.post({type:E,columnNames:y.columnNames,rowNumber:null,row:void 0}))}finally{delete x._blobXfer,y.callback&&(y.callback=E)}return y},"config-get":function(){const m=Object.create(null),y=a.config;return["bigIntEnabled"].forEach(function(x){Object.getOwnPropertyDescriptor(y,x)&&(m[x]=y[x])}),m.version=a.version,m.vfsList=a.capi.sqlite3_js_vfs_list(),m.opfsEnabled=!!a.opfs,m},export:function(m){const y=C(m),x={byteArray:a.capi.sqlite3_js_db_export(y.pointer),filename:y.filename,mimetype:"application/x-sqlite3"};return N.xfer.push(x.byteArray.buffer),x},toss:function(m){l("Testing worker exception")},"opfs-tree":async function(m){return a.opfs||l("OPFS support is unavailable."),await a.opfs.treeList()}};globalThis.onmessage=async function(m){m=m.data;let y,x=m.dbId,E=m.type;const b=performance.now();try{k.hasOwnProperty(E)&&k[E]instanceof Function?y=await k[E](m):l("Unknown db worker message type:",m.type)}catch(P){E="error",y={operation:m.type,message:P.message,errorClass:P.name,input:m},P.stack&&(y.stack=typeof P.stack=="string"?P.stack.split(/\n\s*/):P.stack)}x||(x=y.dbId||V()),N.post({type:E,dbId:x,messageId:m.messageId,workerReceivedTime:b,workerRespondTime:performance.now(),departureTime:m.departureTime,result:y},N.xfer)},globalThis.postMessage({type:"sqlite3-api",result:"worker1-ready"})}.bind({self,sqlite3:i})}),globalThis.sqlite3ApiBootstrap.initializers.push(function(i){const l=i.wasm,a=i.capi,u=i.util.toss3,d=Object.create(null),N=Object.create(null),S=i.StructBinder;i.vfs=d,i.vtab=N;const C=a.sqlite3_index_info;C.prototype.nthConstraint=function(m,y=!1){if(m<0||m>=this.$nConstraint)return!1;const x=this.$aConstraint+C.sqlite3_index_constraint.structInfo.sizeof*m;return y?x:new C.sqlite3_index_constraint(x)},C.prototype.nthConstraintUsage=function(m,y=!1){if(m<0||m>=this.$nConstraint)return!1;const x=this.$aConstraintUsage+C.sqlite3_index_constraint_usage.structInfo.sizeof*m;return y?x:new C.sqlite3_index_constraint_usage(x)},C.prototype.nthOrderBy=function(m,y=!1){if(m<0||m>=this.$nOrderBy)return!1;const x=this.$aOrderBy+C.sqlite3_index_orderby.structInfo.sizeof*m;return y?x:new C.sqlite3_index_orderby(x)};const V=function m(y,x,E,b=m.installMethodArgcCheck){if(y instanceof S.StructType?!(E instanceof Function)&&!l.isPtr(E)&&u("Usage errror: expecting a Function or WASM pointer to one."):u("Usage error: target object is-not-a StructType."),arguments.length===1)return(D,le)=>m(y,D,le,b);m.argcProxy||(m.argcProxy=function(D,le,z,g){return function(...v){return z.length!==arguments.length&&u("Argument mismatch for",D.structInfo.name+"::"+le+": Native signature is:",g),z.apply(this,v)}},m.removeFuncList=function(){this.ondispose.__removeFuncList&&(this.ondispose.__removeFuncList.forEach((D,le)=>{if(typeof D=="number")try{l.uninstallFunction(D)}catch{}}),delete this.ondispose.__removeFuncList)});const P=y.memberSignature(x);P.length<2&&u("Member",x,"does not have a function pointer signature:",P);const M=y.memberKey(x),B=b&&!l.isPtr(E)?m.argcProxy(y,M,E,P):E;if(l.isPtr(B))B&&!l.functionEntry(B)&&u("Pointer",B,"is not a WASM function table entry."),y[M]=B;else{const D=l.installFunction(B,y.memberSignature(x,!0));y[M]=D,(!y.ondispose||!y.ondispose.__removeFuncList)&&(y.addOnDispose("ondispose.__removeFuncList handler",m.removeFuncList),y.ondispose.__removeFuncList=[]),y.ondispose.__removeFuncList.push(M,D)}return(D,le)=>m(y,D,le,b)};V.installMethodArgcCheck=!1;const J=function(m,y,x=V.installMethodArgcCheck){const E=new Map;for(const b of Object.keys(y)){const P=y[b],M=E.get(P);if(M){const B=m.memberKey(b);m[B]=m[m.memberKey(M)]}else V(m,b,P,x),E.set(P,b)}return m};S.StructType.prototype.installMethod=function(y,x,E=V.installMethodArgcCheck){return arguments.length<3&&y&&typeof y=="object"?J(this,...arguments):V(this,...arguments)},S.StructType.prototype.installMethods=function(m,y=V.installMethodArgcCheck){return J(this,m,y)},a.sqlite3_vfs.prototype.registerVfs=function(m=!1){this instanceof i.capi.sqlite3_vfs||u("Expecting a sqlite3_vfs-type argument.");const y=a.sqlite3_vfs_register(this,m?1:0);return y&&u("sqlite3_vfs_register(",this,") failed with rc",y),this.pointer!==a.sqlite3_vfs_find(this.$zName)&&u("BUG: sqlite3_vfs_find(vfs.$zName) failed for just-installed VFS",this),this},d.installVfs=function(m){let y=0;const x=["io","vfs"];for(const E of x){const b=m[E];b&&(++y,J(b.struct,b.methods,!!b.applyArgcCheck),E==="vfs"&&(!b.struct.$zName&&typeof b.name=="string"&&b.struct.addOnDispose(b.struct.$zName=l.allocCString(b.name)),b.struct.registerVfs(!!b.asDefault)))}return y||u("Misuse: installVfs() options object requires at least","one of:",x),this};const ie=function(m,y){return function(x,E=!1){if(arguments.length===0&&(x=new y),x instanceof y)return this.set(x.pointer,x),x;l.isPtr(x)||i.SQLite3Error.toss("Invalid argument to",m+"()");let b=this.get(x);return E&&this.delete(x),b}.bind(new Map)},k=function(m,y){const x=ie(m,y);return Object.assign(Object.create(null),{StructType:y,create:E=>{const b=x();return l.pokePtr(E,b.pointer),b},get:E=>x(E),unget:E=>x(E,!0),dispose:E=>{const b=x(E,!0);b&&b.dispose()}})};N.xVtab=k("xVtab",a.sqlite3_vtab),N.xCursor=k("xCursor",a.sqlite3_vtab_cursor),N.xIndexInfo=m=>new a.sqlite3_index_info(m),N.xError=function m(y,x,E){if(m.errorReporter instanceof Function)try{m.errorReporter("sqlite3_module::"+y+"(): "+x.message)}catch{}let b;return x instanceof i.WasmAllocError?b=a.SQLITE_NOMEM:arguments.length>2?b=E:x instanceof i.SQLite3Error&&(b=x.resultCode),b||a.SQLITE_ERROR},N.xError.errorReporter=console.error.bind(console),N.xRowid=(m,y)=>l.poke(m,y,"i64"),N.setupModule=function(m){let y=!1;const x=this instanceof a.sqlite3_module?this:m.struct||(y=new a.sqlite3_module);try{const E=m.methods||u("Missing 'methods' object.");for(const b of Object.entries({xConnect:"xCreate",xDisconnect:"xDestroy"})){const P=b[0],M=b[1];E[P]===!0?E[P]=E[M]:E[M]===!0&&(E[M]=E[P])}if(m.catchExceptions){const b=function(B,D){return["xConnect","xCreate"].indexOf(B)>=0?function(le,z,g,v,I,q){try{return D(...arguments)||0}catch(w){return w instanceof i.WasmAllocError||(l.dealloc(l.peekPtr(q)),l.pokePtr(q,l.allocCString(w.message))),N.xError(B,w)}}:function(...le){try{return D(...le)||0}catch(z){return N.xError(B,z)}}},P=["xCreate","xConnect","xBestIndex","xDisconnect","xDestroy","xOpen","xClose","xFilter","xNext","xEof","xColumn","xRowid","xUpdate","xBegin","xSync","xCommit","xRollback","xFindFunction","xRename","xSavepoint","xRelease","xRollbackTo","xShadowName"],M=Object.create(null);for(const B of P){const D=E[B];if(D instanceof Function)B==="xConnect"&&E.xCreate===D?M[B]=E.xCreate:B==="xCreate"&&E.xConnect===D?M[B]=E.xConnect:M[B]=b(B,D);else continue}J(x,M,!1)}else J(x,E,!!m.applyArgcCheck);if(x.$iVersion===0){let b;typeof m.iVersion=="number"?b=m.iVersion:x.$xShadowName?b=3:x.$xSavePoint||x.$xRelease||x.$xRollbackTo?b=2:b=1,x.$iVersion=b}}catch(E){throw y&&y.dispose(),E}return x},a.sqlite3_module.prototype.setupModule=function(m){return N.setupModule.call(this,m)}}),globalThis.sqlite3ApiBootstrap.initializers.push(function(i){const l=function a(u){var S;if(!globalThis.SharedArrayBuffer||!globalThis.Atomics)return Promise.reject(new Error("Cannot install OPFS: Missing SharedArrayBuffer and/or Atomics. The server must emit the COOP/COEP response headers to enable those. See https://sqlite.org/wasm/doc/trunk/persistence.md#coop-coep"));if(typeof WorkerGlobalScope>"u")return Promise.reject(new Error("The OPFS sqlite3_vfs cannot run in the main thread because it requires Atomics.wait()."));if(!globalThis.FileSystemHandle||!globalThis.FileSystemDirectoryHandle||!globalThis.FileSystemFileHandle||!globalThis.FileSystemFileHandle.prototype.createSyncAccessHandle||!((S=navigator==null?void 0:navigator.storage)!=null&&S.getDirectory))return Promise.reject(new Error("Missing required OPFS APIs."));(!u||typeof u!="object")&&(u=Object.create(null));const d=new URL(globalThis.location.href).searchParams;return u.verbose===void 0&&(u.verbose=d.has("opfs-verbose")?+d.get("opfs-verbose")||2:1),u.sanityChecks===void 0&&(u.sanityChecks=d.has("opfs-sanity-check")),u.proxyUri===void 0&&(u.proxyUri=a.defaultProxyUri),typeof u.proxyUri=="function"&&(u.proxyUri=u.proxyUri()),new Promise(function(C,V){const J={0:i.config.error,1:i.config.warn,2:i.config.log},ie=(O,...j)=>{u.verbose>O&&J[O]("OPFS syncer:",...j)},k=(...O)=>ie(2,...O),m=(...O)=>ie(1,...O),y=(...O)=>ie(0,...O),x=i.util.toss,E=i.capi,b=i.wasm,P=E.sqlite3_vfs,M=E.sqlite3_file,B=E.sqlite3_io_methods,D=Object.create(null),le=()=>{var O;return globalThis.FileSystemHandle&&globalThis.FileSystemDirectoryHandle&&globalThis.FileSystemFileHandle&&globalThis.FileSystemFileHandle.prototype.createSyncAccessHandle&&((O=navigator==null?void 0:navigator.storage)==null?void 0:O.getDirectory)};D.metrics={dump:function(){let O,j=0,Q=0,Y=0;for(O in _.opIds){const G=W[O];j+=G.count,Q+=G.time,Y+=G.wait,G.avgTime=G.count&&G.time?G.time/G.count:0,G.avgWait=G.count&&G.wait?G.wait/G.count:0}i.config.log(globalThis.location.href,"metrics for",globalThis.location.href,":",W,`
Total of`,j,"op(s) for",Q,"ms (incl. "+Y+" ms of waiting on the async side)"),i.config.log("Serialization metrics:",W.s11n),w.postMessage({type:"opfs-async-metrics"})},reset:function(){let O;const j=Y=>Y.count=Y.time=Y.wait=0;for(O in _.opIds)j(W[O]=Object.create(null));let Q=W.s11n=Object.create(null);Q=Q.serialize=Object.create(null),Q.count=Q.time=0,Q=W.s11n.deserialize=Object.create(null),Q.count=Q.time=0}};const z=new P,g=new B;let v;const I=O=>(v=!0,z.dispose(),V(O)),q=O=>(v=!1,C(O)),w=new Worker(new URL(""+new URL("sqlite3-opfs-async-proxy-9f074d6f.js",self.location.href).href,self.location));setTimeout(()=>{v===void 0&&I(new Error("Timeout while waiting for OPFS async proxy worker."))},4e3),w._originalOnError=w.onerror,w.onerror=function(O){y("Error initializing OPFS asyncer:",O),I(new Error("Loading OPFS async Worker failed for unknown reasons."))};const f=E.sqlite3_vfs_find(null),p=f?new P(f):null;z.$iVersion=2,z.$szOsFile=E.sqlite3_file.structInfo.sizeof,z.$mxPathname=1024,z.$zName=b.allocCString("opfs"),z.$xDlOpen=z.$xDlError=z.$xDlSym=z.$xDlClose=null,z.ondispose=["$zName",z.$zName,"cleanup default VFS wrapper",()=>p?p.dispose():null,"cleanup opfsIoMethods",()=>g.dispose()];const _=Object.create(null);_.verbose=u.verbose,_.littleEndian=(()=>{const O=new ArrayBuffer(2);return new DataView(O).setInt16(0,256,!0),new Int16Array(O)[0]===256})(),_.asyncIdleWaitTime=150,_.asyncS11nExceptions=1,_.fileBufferSize=1024*64,_.sabS11nOffset=_.fileBufferSize,_.sabS11nSize=z.$mxPathname*2,_.sabIO=new SharedArrayBuffer(_.fileBufferSize+_.sabS11nSize),_.opIds=Object.create(null);const W=Object.create(null);{let O=0;_.opIds.whichOp=O++,_.opIds.rc=O++,_.opIds.xAccess=O++,_.opIds.xClose=O++,_.opIds.xDelete=O++,_.opIds.xDeleteNoWait=O++,_.opIds.xFileSize=O++,_.opIds.xLock=O++,_.opIds.xOpen=O++,_.opIds.xRead=O++,_.opIds.xSleep=O++,_.opIds.xSync=O++,_.opIds.xTruncate=O++,_.opIds.xUnlock=O++,_.opIds.xWrite=O++,_.opIds.mkdir=O++,_.opIds["opfs-async-metrics"]=O++,_.opIds["opfs-async-shutdown"]=O++,_.opIds.retry=O++,_.sabOP=new SharedArrayBuffer(O*4),D.metrics.reset()}_.sq3Codes=Object.create(null),["SQLITE_ACCESS_EXISTS","SQLITE_ACCESS_READWRITE","SQLITE_BUSY","SQLITE_ERROR","SQLITE_IOERR","SQLITE_IOERR_ACCESS","SQLITE_IOERR_CLOSE","SQLITE_IOERR_DELETE","SQLITE_IOERR_FSYNC","SQLITE_IOERR_LOCK","SQLITE_IOERR_READ","SQLITE_IOERR_SHORT_READ","SQLITE_IOERR_TRUNCATE","SQLITE_IOERR_UNLOCK","SQLITE_IOERR_WRITE","SQLITE_LOCK_EXCLUSIVE","SQLITE_LOCK_NONE","SQLITE_LOCK_PENDING","SQLITE_LOCK_RESERVED","SQLITE_LOCK_SHARED","SQLITE_LOCKED","SQLITE_MISUSE","SQLITE_NOTFOUND","SQLITE_OPEN_CREATE","SQLITE_OPEN_DELETEONCLOSE","SQLITE_OPEN_MAIN_DB","SQLITE_OPEN_READONLY"].forEach(O=>{(_.sq3Codes[O]=E[O])===void 0&&x("Maintenance required: not found:",O)}),_.opfsFlags=Object.assign(Object.create(null),{OPFS_UNLOCK_ASAP:1,defaultUnlockAsap:!1});const L=(O,...j)=>{const Q=_.opIds[O]||x("Invalid op ID:",O);_.s11n.serialize(...j),Atomics.store(_.sabOPView,_.opIds.rc,-1),Atomics.store(_.sabOPView,_.opIds.whichOp,Q),Atomics.notify(_.sabOPView,_.opIds.whichOp);const Y=performance.now();Atomics.wait(_.sabOPView,_.opIds.rc,-1);const G=Atomics.load(_.sabOPView,_.opIds.rc);if(W[O].wait+=performance.now()-Y,G&&_.asyncS11nExceptions){const xe=_.s11n.deserialize();xe&&y(O+"() async error:",...xe)}return G};D.debug={asyncShutdown:()=>{m("Shutting down OPFS async listener. The OPFS VFS will no longer work."),L("opfs-async-shutdown")},asyncRestart:()=>{m("Attempting to restart OPFS VFS async listener. Might work, might not."),w.postMessage({type:"opfs-async-restart"})}};const se=()=>{if(_.s11n)return _.s11n;const O=new TextDecoder,j=new TextEncoder("utf-8"),Q=new Uint8Array(_.sabIO,_.sabS11nOffset,_.sabS11nSize),Y=new DataView(_.sabIO,_.sabS11nOffset,_.sabS11nSize);_.s11n=Object.create(null);const G=Object.create(null);G.number={id:1,size:8,getter:"getFloat64",setter:"setFloat64"},G.bigint={id:2,size:8,getter:"getBigInt64",setter:"setBigInt64"},G.boolean={id:3,size:4,getter:"getInt32",setter:"setInt32"},G.string={id:4};const xe=ne=>G[typeof ne]||x("Maintenance required: this value type cannot be serialized.",ne),be=ne=>{switch(ne){case G.number.id:return G.number;case G.bigint.id:return G.bigint;case G.boolean.id:return G.boolean;case G.string.id:return G.string;default:x("Invalid type ID:",ne)}};return _.s11n.deserialize=function(ne=!1){++W.s11n.deserialize.count;const Vt=performance.now(),ct=Q[0],T=ct?[]:null;if(ct){const H=[];let $=1,K,Ie,Be;for(K=0;K<ct;++K,++$)H.push(be(Q[$]));for(K=0;K<ct;++K){const Ae=H[K];Ae.getter?(Be=Y[Ae.getter]($,_.littleEndian),$+=Ae.size):(Ie=Y.getInt32($,_.littleEndian),$+=4,Be=O.decode(Q.slice($,$+Ie)),$+=Ie),T.push(Be)}}return ne&&(Q[0]=0),W.s11n.deserialize.time+=performance.now()-Vt,T},_.s11n.serialize=function(...ne){const Vt=performance.now();if(++W.s11n.serialize.count,ne.length){const ct=[];let T=0,H=1;for(Q[0]=ne.length&255;T<ne.length;++T,++H)ct.push(xe(ne[T])),Q[H]=ct[T].id;for(T=0;T<ne.length;++T){const $=ct[T];if($.setter)Y[$.setter](H,ne[T],_.littleEndian),H+=$.size;else{const K=j.encode(ne[T]);Y.setInt32(H,K.byteLength,_.littleEndian),H+=4,Q.set(K,H),H+=K.byteLength}}}else Q[0]=0;W.s11n.serialize.time+=performance.now()-Vt},_.s11n},oe=function O(j=16){O._chars||(O._chars="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ012346789",O._n=O._chars.length);const Q=[];let Y=0;for(;Y<j;++Y){const G=Math.random()*(O._n*64)%O._n|0;Q[Y]=O._chars[G]}return Q.join("")},ce=Object.create(null),pe=Object.create(null);pe.op=void 0,pe.start=void 0;const de=O=>{pe.start=performance.now(),pe.op=O,++W[O].count},ve=()=>W[pe.op].time+=performance.now()-pe.start,Je={xCheckReservedLock:function(O,j){const Q=ce[O];return b.poke(j,Q.lockType?1:0,"i32"),0},xClose:function(O){de("xClose");let j=0;const Q=ce[O];return Q&&(delete ce[O],j=L("xClose",O),Q.sq3File&&Q.sq3File.dispose()),ve(),j},xDeviceCharacteristics:function(O){return E.SQLITE_IOCAP_UNDELETABLE_WHEN_OPEN},xFileControl:function(O,j,Q){return E.SQLITE_NOTFOUND},xFileSize:function(O,j){de("xFileSize");let Q=L("xFileSize",O);if(Q==0)try{const Y=_.s11n.deserialize()[0];b.poke(j,Y,"i64")}catch(Y){y("Unexpected error reading xFileSize() result:",Y),Q=_.sq3Codes.SQLITE_IOERR}return ve(),Q},xLock:function(O,j){de("xLock");const Q=ce[O];let Y=0;return Q.lockType?Q.lockType=j:(Y=L("xLock",O,j),Y===0&&(Q.lockType=j)),ve(),Y},xRead:function(O,j,Q,Y){de("xRead");const G=ce[O];let xe;try{xe=L("xRead",O,Q,Number(Y)),(xe===0||E.SQLITE_IOERR_SHORT_READ===xe)&&b.heap8u().set(G.sabView.subarray(0,Q),j)}catch(be){y("xRead(",arguments,") failed:",be,G),xe=E.SQLITE_IOERR_READ}return ve(),xe},xSync:function(O,j){de("xSync"),++W.xSync.count;const Q=L("xSync",O,j);return ve(),Q},xTruncate:function(O,j){de("xTruncate");const Q=L("xTruncate",O,Number(j));return ve(),Q},xUnlock:function(O,j){de("xUnlock");const Q=ce[O];let Y=0;return E.SQLITE_LOCK_NONE===j&&Q.lockType&&(Y=L("xUnlock",O,j)),Y===0&&(Q.lockType=j),ve(),Y},xWrite:function(O,j,Q,Y){de("xWrite");const G=ce[O];let xe;try{G.sabView.set(b.heap8u().subarray(j,j+Q)),xe=L("xWrite",O,Q,Number(Y))}catch(be){y("xWrite(",arguments,") failed:",be,G),xe=E.SQLITE_IOERR_WRITE}return ve(),xe}},mt={xAccess:function(O,j,Q,Y){de("xAccess");const G=L("xAccess",b.cstrToJs(j));return b.poke(Y,G?0:1,"i32"),ve(),0},xCurrentTime:function(O,j){return b.poke(j,24405875e-1+new Date().getTime()/864e5,"double"),0},xCurrentTimeInt64:function(O,j){return b.poke(j,24405875e-1*864e5+new Date().getTime(),"i64"),0},xDelete:function(O,j,Q){return de("xDelete"),L("xDelete",b.cstrToJs(j),Q,!1),ve(),0},xFullPathname:function(O,j,Q,Y){return b.cstrncpy(Y,j,Q)<Q?0:E.SQLITE_CANTOPEN},xGetLastError:function(O,j,Q){return m("OPFS xGetLastError() has nothing sensible to return."),0},xOpen:function(j,Q,Y,G,xe){de("xOpen");let be=0;Q===0?Q=oe():typeof Q=="number"&&(E.sqlite3_uri_boolean(Q,"opfs-unlock-asap",0)&&(be|=_.opfsFlags.OPFS_UNLOCK_ASAP),Q=b.cstrToJs(Q));const ne=Object.create(null);ne.fid=Y,ne.filename=Q,ne.sab=new SharedArrayBuffer(_.fileBufferSize),ne.flags=G;const Vt=L("xOpen",Y,Q,G,be);return Vt||(ne.readOnly&&b.poke(xe,E.SQLITE_OPEN_READONLY,"i32"),ce[Y]=ne,ne.sabView=_.sabFileBufView,ne.sq3File=new M(Y),ne.sq3File.$pMethods=g.pointer,ne.lockType=E.SQLITE_LOCK_NONE),ve(),Vt}};if(p&&(z.$xRandomness=p.$xRandomness,z.$xSleep=p.$xSleep),z.$xRandomness||(mt.xRandomness=function(O,j,Q){const Y=b.heap8u();let G=0;for(;G<j;++G)Y[Q+G]=Math.random()*255e3&255;return G}),z.$xSleep||(mt.xSleep=function(O,j){return Atomics.wait(_.sabOPView,_.opIds.xSleep,0,j),0}),D.getResolvedPath=function(O,j){const Q=new URL(O,"file://irrelevant").pathname;return j?Q.split("/").filter(Y=>!!Y):Q},D.getDirForFilename=async function(j,Q=!1){const Y=D.getResolvedPath(j,!0),G=Y.pop();let xe=D.rootDirectory;for(const be of Y)be&&(xe=await xe.getDirectoryHandle(be,{create:!!Q}));return[xe,G]},D.mkdir=async function(O){try{return await D.getDirForFilename(O+"/filepart",!0),!0}catch{return!1}},D.entryExists=async function(O){try{const[j,Q]=await D.getDirForFilename(O);return await j.getFileHandle(Q),!0}catch{return!1}},D.randomFilename=oe,D.registerVfs=(O=!1)=>b.exports.sqlite3_vfs_register(z.pointer,O?1:0),D.treeList=async function(){const O=async function Q(Y,G){G.name=Y.name,G.dirs=[],G.files=[];for await(const xe of Y.values())if(xe.kind==="directory"){const be=Object.create(null);G.dirs.push(be),await Q(xe,be)}else G.files.push(xe.name)},j=Object.create(null);return await O(D.rootDirectory,j),j},D.rmfr=async function(){const O=D.rootDirectory,j={recurse:!0};for await(const Q of O.values())O.removeEntry(Q.name,j)},D.unlink=async function(O,j=!1,Q=!1){try{const[Y,G]=await D.getDirForFilename(O,!1);return await Y.removeEntry(G,{recursive:j}),!0}catch(Y){if(Q)throw new Error("unlink(",arguments[0],") failed: "+Y.message,{cause:Y});return!1}},D.traverse=async function(O){const j={recursive:!0,directory:D.rootDirectory};typeof O=="function"&&(O={callback:O}),O=Object.assign(j,O||{}),async function Y(G,xe){for await(const be of G.values()){if(O.callback(be,G,xe)===!1)return!1;if(O.recursive&&be.kind==="directory"&&await Y(be,xe+1)===!1)break}}(O.directory,0)},i.oo1){const O=function(...j){const Q=i.oo1.DB.dbCtorHelper.normalizeArgs(...j);Q.vfs=z.$zName,i.oo1.DB.dbCtorHelper.call(this,Q)};O.prototype=Object.create(i.oo1.DB.prototype),i.oo1.OpfsDb=O,i.oo1.DB.dbCtorHelper.setVfsPostOpenSql(z.pointer,function(j,Q){Q.capi.sqlite3_busy_timeout(j,1e4),Q.capi.sqlite3_exec(j,["pragma journal_mode=persist;","pragma cache_size=-16384;"],0,0,0)})}const un=function(){const O=b.scopedAllocPush(),j=new M;try{const Q=j.pointer,Y=E.SQLITE_OPEN_CREATE|E.SQLITE_OPEN_READWRITE|E.SQLITE_OPEN_MAIN_DB,G=b.scopedAlloc(8),xe="/sanity/check/file"+oe(8),be=b.scopedAllocCString(xe);let ne;if(_.s11n.serialize("This is ä string."),ne=_.s11n.deserialize(),k("deserialize() says:",ne),ne[0]!=="This is ä string."&&x("String d13n error."),mt.xAccess(z.pointer,be,0,G),ne=b.peek(G,"i32"),k("xAccess(",xe,") exists ?=",ne),ne=mt.xOpen(z.pointer,be,Q,Y,G),k("open rc =",ne,"state.sabOPView[xOpen] =",_.sabOPView[_.opIds.xOpen]),ne!==0){y("open failed with code",ne);return}mt.xAccess(z.pointer,be,0,G),ne=b.peek(G,"i32"),ne||x("xAccess() failed to detect file."),ne=Je.xSync(j.pointer,0),ne&&x("sync failed w/ rc",ne),ne=Je.xTruncate(j.pointer,1024),ne&&x("truncate failed w/ rc",ne),b.poke(G,0,"i64"),ne=Je.xFileSize(j.pointer,G),ne&&x("xFileSize failed w/ rc",ne),k("xFileSize says:",b.peek(G,"i64")),ne=Je.xWrite(j.pointer,be,10,1),ne&&x("xWrite() failed!");const Vt=b.scopedAlloc(16);ne=Je.xRead(j.pointer,Vt,6,2),b.poke(Vt+6,0);let ct=b.cstrToJs(Vt);k("xRead() got:",ct),ct!=="sanity"&&x("Unexpected xRead() value."),mt.xSleep&&(k("xSleep()ing before close()ing..."),mt.xSleep(z.pointer,2e3),k("waking up from xSleep()")),ne=Je.xClose(Q),k("xClose rc =",ne,"sabOPView =",_.sabOPView),k("Deleting file:",xe),mt.xDelete(z.pointer,be,4660),mt.xAccess(z.pointer,be,0,G),ne=b.peek(G,"i32"),ne&&x("Expecting 0 from xAccess(",xe,") after xDelete()."),m("End of OPFS sanity checks.")}finally{j.dispose(),b.scopedAllocPop(O)}};w.onmessage=function({data:O}){switch(O.type){case"opfs-unavailable":I(new Error(O.payload.join(" ")));break;case"opfs-async-loaded":w.postMessage({type:"opfs-async-init",args:_});break;case"opfs-async-inited":{if(v===!0)break;try{i.vfs.installVfs({io:{struct:g,methods:Je},vfs:{struct:z,methods:mt}}),_.sabOPView=new Int32Array(_.sabOP),_.sabFileBufView=new Uint8Array(_.sabIO,0,_.fileBufferSize),_.sabS11nView=new Uint8Array(_.sabIO,_.sabS11nOffset,_.sabS11nSize),se(),u.sanityChecks&&(m("Running sanity checks because of opfs-sanity-check URL arg..."),un()),le()?navigator.storage.getDirectory().then(j=>{w.onerror=w._originalOnError,delete w._originalOnError,i.opfs=D,D.rootDirectory=j,k("End of OPFS sqlite3_vfs setup.",z),q(i)}).catch(I):q(i)}catch(j){y(j),I(j)}break}default:{const j="Unexpected message from the OPFS async worker: "+JSON.stringify(O);y(j),I(new Error(j));break}}}})};l.defaultProxyUri="sqlite3-opfs-async-proxy.js",globalThis.sqlite3ApiBootstrap.initializersAsync.push(async a=>{try{let u=l.defaultProxyUri;return a.scriptInfo.sqlite3Dir&&(l.defaultProxyUri=a.scriptInfo.sqlite3Dir+u),l().catch(d=>{a.config.warn("Ignoring inability to install OPFS sqlite3_vfs:",d.message)})}catch(u){throw a.config.error("installOpfsVfs() exception:",u),u}})}),typeof o<"u"){const i=Object.assign(Object.create(null),{exports:o.asm,memory:o.wasmMemory},globalThis.sqlite3ApiConfig||{});globalThis.sqlite3ApiConfig=i;let l;try{l=globalThis.sqlite3ApiBootstrap()}catch(a){throw console.error("sqlite3ApiBootstrap() error:",a),a}finally{delete globalThis.sqlite3ApiBootstrap,delete globalThis.sqlite3ApiConfig}o.sqlite3=l}else console.warn("This is not running in an Emscripten module context, so","globalThis.sqlite3ApiBootstrap() is _not_ being called due to lack","of config info for the WASM environment.","It must be called manually.")}),r.ready}})();const Zu=function(){var r,n;const t=Yu;if(!t)throw new Error("Expecting globalThis.sqlite3InitModule to be defined by the Emscripten build.");const e=globalThis.sqlite3InitModuleState=Object.assign(Object.create(null),{moduleScript:(r=globalThis==null?void 0:globalThis.document)==null?void 0:r.currentScript,isWorker:typeof WorkerGlobalScope<"u",location:globalThis.location,urlParams:(n=globalThis==null?void 0:globalThis.location)!=null&&n.href?new URL(globalThis.location.href).searchParams:new URLSearchParams});if(e.debugModule=e.urlParams.has("sqlite3.debugModule")?(...A)=>console.warn("sqlite3.debugModule:",...A):()=>{},e.urlParams.has("sqlite3.dir"))e.sqlite3Dir=e.urlParams.get("sqlite3.dir")+"/";else if(e.moduleScript){const A=e.moduleScript.src.split("/");A.pop(),e.sqlite3Dir=A.join("/")+"/"}if(globalThis.sqlite3InitModule=function A(...X){return t(...X).then(ae=>{var At,nt,rt;if(typeof WorkerGlobalScope<"u"&&(ae.ENVIRONMENT_IS_PTHREAD||ae._pthread_self||typeof threadAlert=="function"||(rt=(nt=(At=globalThis==null?void 0:globalThis.location)==null?void 0:At.pathname)==null?void 0:nt.endsWith)!=null&&rt.call(nt,".worker.js")))return ae;const me=ae.sqlite3;me.scriptInfo=e,A.__isUnderTest&&(me.__isUnderTest=!0);const Oe=me.asyncPostInit;return delete me.asyncPostInit,Oe()}).catch(ae=>{throw console.error("Exception loading sqlite3 module:",ae),ae})},globalThis.sqlite3InitModule.ready=t.ready,globalThis.sqlite3InitModuleState.moduleScript){const A=globalThis.sqlite3InitModuleState;let X=A.moduleScript.src.split("/");X.pop(),A.scriptDir=X.join("/")+"/"}return e.debugModule("sqlite3InitModuleState =",e),globalThis.sqlite3InitModule}();var ec=t=>t==null||typeof t=="bigint"||typeof t=="number"||typeof t=="object"&&"buffer"in t?t:typeof t=="boolean"?`${t}`:t instanceof Date?t.toISOString():JSON.stringify(t),tc=t=>{if(t==null||typeof t=="bigint"||typeof t=="number"||typeof t=="object"&&"buffer"in t)return t;if(typeof t=="string"){const e=/^\d{4}-\d{2}-\d{2}[T ]\d{2}:\d{2}:\d{2}(?:\.\d+)?Z?$/;if(/^(true|false)$/.test(t))return t==="true";if(e.test(t))return new Date(t);try{return JSON.parse(t,(r,n)=>typeof n=="string"&&e.exec(n)?new Date(n):n)}catch{}}return t},nc=(Fa=class extends Xs{constructor(e){super();R(this,Xn,void 0);U(this,Xn,e||ec)}transformPrimitiveValueList(e){return{...e,values:e.values.map(s(this,Xn))}}transformColumnUpdate(e){const{value:r}=e;if(r.kind!=="ValueNode")return super.transformColumnUpdate(e);const{value:n,...A}=r,X=s(this,Xn).call(this,n);return n===X?super.transformColumnUpdate(e):super.transformColumnUpdate({...e,value:{...A,value:X}})}transformValue(e){return{...e,value:s(this,Xn).call(this,e.value)}}},Xn=new WeakMap,Fa),rc=(Pa=class{constructor(t={}){R(this,qi,void 0);R(this,bi,void 0);R(this,Cr,void 0);U(this,qi,new nc(t.serializer)),U(this,bi,t.deserializer||tc),U(this,Cr,new WeakMap)}transformQuery(t){const{node:e,queryId:r}=t;return e.kind==="SelectQueryNode"&&s(this,Cr).set(r,e.kind),s(this,qi).transformNode(t.node)}async parseResult(t){return await Promise.all(t.map(async e=>{const r={...e};for(const n in r)r[n]=await s(this,bi).call(this,r[n]);return r}))}async transformResult(t){const{result:e,queryId:r}=t,{rows:n}=e,A=s(this,Cr).get(r);return n&&A==="SelectQueryNode"?{...t.result,rows:await this.parseResult(n)}:t.result}},qi=new WeakMap,bi=new WeakMap,Cr=new WeakMap,Pa);function ao(t){return typeof t=="string"}function ic(t){return typeof t=="boolean"}async function Ia(t,e,r,n,A="rowid"){await Wt`
      create trigger if not exists ${Wt.raw(e)}_${Wt.raw(n)}
      after ${Wt.raw(r)}
      on ${Wt.table(e)}
      begin
        update ${Wt.table(e)}
        set ${Wt.ref(n)} = datetime('now','localtime')
        where ${Wt.ref(A)} = NEW.${Wt.ref(A)};
      end
    `.execute(t).catch(X=>{console.error(X)})}function sc(t){const e=new Map;for(const r in t){if(!Object.prototype.hasOwnProperty.call(t,r))continue;const n=t[r];e.set(r,n)}return e}async function oc(t,e,r=!1){for(const[n,A]of e){const{columns:X,property:ae}=A;r&&await t.schema.dropTable(n).ifExists().execute().catch();let me=t.schema.createTable(n),Oe="rowid",At=!1,nt="createAt",rt="updateAt";if(ae!=null&&ae.timestamp&&!ic(ae.timestamp)){const{create:ue,update:Qt}=ae.timestamp;nt=ue??"createAt",rt=Qt??"updateAt"}for(const ue in X){if(!Object.prototype.hasOwnProperty.call(X,ue))continue;const Qt=X[ue];let Qe="text";const{type:gn,notNull:vi,defaultTo:wn}=Qt;switch(gn){case"boolean":case"date":case"object":case"string":Qe="text";break;case"increments":Oe=ue;case"number":Qe="integer";break;case"blob":Qe="blob"}[nt,rt].includes(ue)||(me=me.addColumn(ue,Qe,Et=>gn==="increments"?(At=!0,Et.autoIncrement().primaryKey()):(vi&&(Et=Et.notNull()),wn!==void 0&&(Et=Et.defaultTo(wn instanceof Function?wn(Wt):wn)),Et)))}if(ae){const ue=ae.primary,Qt=ae.unique;if(ae.timestamp&&(nt&&(me=me.addColumn(nt,"text")),rt&&(me=me.addColumn(rt,"text"))),!At&&ue){const Qe=ao(ue);Oe=Qe?ue:ue[0],me=me.addPrimaryKeyConstraint(`pk_${Qe?ue:ue.join("_")}`,Qe?[ue]:ue)}Qt==null||Qt.forEach(Qe=>{const gn=ao(Qe);Oe=!ue&&!At?gn?Qe:Qe[0]:Oe,me=me.addUniqueConstraint(`un_${gn?Qe:Qe.join("_")}`,gn?[Qe]:Qe)})}if(await me.ifNotExists().execute(),ae!=null&&ae.index)for(const ue of ae.index){const Qt=ao(ue);let Qe=t.schema.createIndex(`idx_${Qt?ue:ue.join("_")}`).on(n);Qe=Qt?Qe.column(ue):Qe.columns(ue),await Qe.ifNotExists().execute()}ae!=null&&ae.timestamp&&(nt&&await Ia(t,n,"insert",nt,Oe),rt&&await Ia(t,n,"update",rt,Oe))}}var ac=(La=class{constructor(t){Tt(this,"kysely");R(this,Wn,void 0);R(this,Ni,void 0);const{dialect:e,tables:r,dropTableBeforeInit:n,onError:A,onQuery:X,plugins:ae}=t,me=ae??[];me.push(new rc),this.kysely=new Yr({dialect:e,log:Oe=>{Oe.level==="error"?A&&A(Oe.error):X&&X(Oe.query,Oe.queryDurationMillis)},plugins:me}),U(this,Wn,n?0:1),U(this,Ni,sc(r))}async init(t=!1){const e=t||s(this,Wn)===0;return await oc(this.kysely,s(this,Ni),e),U(this,Wn,2),this}async checkInit(){if(s(this,Wn)!==2&&await this.init(),s(this,Wn)!==2)throw new Error("fail to init table")}async transaction(t,e=!1){return await this.checkInit(),await this.kysely.transaction().execute(t).catch(r=>{e&&console.error(r)})}async exec(t,e=!1){return await this.checkInit(),t(this.kysely).catch(r=>{e&&console.error(r)})}async toSQL(t){return await this.checkInit(),t(this.kysely).compile()}async raw(t){return await this.checkInit(),t(Wt).execute(this.kysely)}},Wn=new WeakMap,Ni=new WeakMap,La);async function lc(t){const e=await new ac({dialect:t,tables:{test:{columns:{id:{type:"increments"},name:{type:"string"},blobtest:{type:"blob"},createAt:{type:"date"},updateAt:{type:"date"}},property:{timestamp:!0}}}}).init();console.log("test"),console.log(await e.raw(r=>r`PRAGMA table_info(${r.table("test")});`)),console.log(await e.raw(r=>r`select last_insert_rowid()`));for(let r=0;r<100;r++)await e.transaction(n=>n.insertInto("test").values({name:`test at ${Date.now()}`,blobtest:Uint8Array.from([2,3,4,5,6,7,8])}).execute());return e.exec(r=>r.selectFrom("test").selectAll().execute())}const uc=new Xu({database:async()=>{const t=(await Zu()).oo1;if(!t)return Promise.reject("fail to load sqlite");const e="/test.db";return t.OpfsDb?(console.log("support OPFS"),new t.OpfsDb(e)):(console.log("doesn't support OPFS"),new t.DB(e))}});onmessage=()=>{console.log("start official wasm test"),lc(uc).then(t=>{t==null||t.forEach(e=>console.log("[official wasm]",e))})}})();
